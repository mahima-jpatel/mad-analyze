{"purpose": "Clean inconsistent movie genre names, standardize date formats, and fix pricing and rating inconsistencies in an entertainment dataset.", "raw_table": "MovieTitle,ReleaseDate,Genre,TicketPrice,Rating\nInception,07/16/2010,SCI-FI,12.5,8.8\nThe GodFather,1972-03-24,Crime,-15,9.2\ntoy story 3,06-18-2010,Adventure_,ten,8.3\nFrozen,2013/11/27,animation,11,7.5\nJoker,10.02.2019,Crime_Drama,14.0,8.5\nparasite,2019-05-30,thriller,12,,\nAvengers:ENDGAME,04/26/2019,action,13.5,8.4\nThe Dark Knight,,action,15,9.0\nLa La Land,12-09-2016,Musical,12.00,8.0\nSpider_man,2018-07-07,sci fi,ten,7.4\nInterstellar,2014-11-07,Sci-Fi,14.00,8.6\nThe Lion king,07/19/1994,Animation,ten,8.5\nTitanic,12-19-1997,romance,13.00,7.8\nCoco,2017-11-22,animation,11.5,8.4\nGet Out,02/24/2017,horror,ten,7.7", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize Genre names by removing underscores and correcting capitalization", "columnName": "Genre", "expression": "value.toLowercase().replace(/[_-]/g, ' ').split(' ').map(w, w.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Fix known genre misspellings", "columnName": "Genre", "edits": [{"from": ["Sci Fi", "Sci-fi", "Sci-fi", "Sci Fi"], "to": "Sci-Fi"}, {"from": ["Crime Drama"], "to": "Crime Drama"}]}, {"op": "core/text-transform", "description": "Parse various ReleaseDate formats to standard yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "value.length() == 0 ? null : (value.match(/^\\d{4}-\\d{2}-\\d{2}$/) ? value : (value.match(/^\\d{2}\\/\\d{2}\\/\\d{4}$/) ? value.toDate('MM/dd/yyyy').toString('yyyy-MM-dd') : (value.match(/^\\d{2}-\\d{2}-\\d{4}$/) ? value.toDate('MM-dd-yyyy').toString('yyyy-MM-dd') : (value.match(/^\\d{4}\\/\\d{2}\\/\\d{2}$/) ? value.toDate('yyyy/MM/dd').toString('yyyy-MM-dd') : (value.match(/^\\d{2}\\.\\d{2}\\.\\d{4}$/) ? value.toDate('dd.MM.yyyy').toString('yyyy-MM-dd') : null)))))"}, {"op": "core/mass-edit", "description": "Replace spelling errors in TicketPrice", "columnName": "TicketPrice", "edits": [{"from": ["ten"], "to": "10"}, {"from": ["-15"], "to": "15"}]}, {"op": "core/text-transform", "description": "Convert TicketPrice to number type", "columnName": "TicketPrice", "expression": "value.toNumber()"}, {"op": "core/mass-edit", "description": "Fill missing Rating values with average rating", "columnName": "Rating", "edits": [{"from": [""], "to": "8.0"}, {"from": [null], "to": "8.0"}]}, {"op": "core/text-transform", "description": "Convert Rating to number type", "columnName": "Rating", "expression": "value.toNumber()"}, {"op": "core/mass-edit", "description": "Capitalize MovieTitle properly", "columnName": "MovieTitle", "edits": [{"from": ["toy story 3"], "to": "Toy Story 3"}, {"from": ["parasite"], "to": "Parasite"}, {"from": ["Avengers:ENDGAME"], "to": "Avengers: Endgame"}, {"from": ["Spider_man"], "to": "Spider Man"}, {"from": ["The Lion king"], "to": "The Lion King"}]}, {"op": "core/fill-down", "description": "Fill missing ReleaseDate for The Dark Knight", "columnName": "ReleaseDate"}], "clean_table": "MovieTitle,ReleaseDate,Genre,TicketPrice,Rating\nInception,2010-07-16,Sci-Fi,12.5,8.8\nThe GodFather,1972-03-24,Crime,15,9.2\nToy Story 3,2010-06-18,Adventure,10,8.3\nFrozen,2013-11-27,Animation,11,7.5\nJoker,2019-02-10,Crime Drama,14,8.5\nParasite,2019-05-30,Thriller,12,8.0\nAvengers: Endgame,2019-04-26,Action,13.5,8.4\nThe Dark Knight,2012-07-18,Action,15,9.0\nLa La Land,2016-12-09,Musical,12,8\nSpider Man,2018-07-07,Sci-Fi,10,7.4\nInterstellar,2014-11-07,Sci-Fi,14,8.6\nThe Lion King,1994-07-19,Animation,10,8.5\nTitanic,1997-12-19,Romance,13,7.8\nCoco,2017-11-22,Animation,11.5,8.4\nGet Out,2017-02-24,Horror,10,7.7"}
{"purpose": "Clean inconsistent city names, normalize business types, and fix date and numeric formats for government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew-york,NY,restuarant,23000,10000,01/12/2022\nlos_angeles,CA,RETAIL,45000,25000,2022-02-15\nchicago,il,Resturant,55000,30000,15-Mar-2022\nhouston,TX,retail,31000,,03/20/22\nPHOENIX,az,Reta-il,28000,15000,2022/04/05\nphiladelphia,PA,restaurant,26000,12000,2022-05-01\nsan-antonio,TX,RestauranT,27000,13000,May 10 2022\nsan diego,CA,retail,33000,17000,2022.06.15\ndal-las,TX,retail,29000,16000,2022-07-20\nsan_jose,CA,retail,31000,18000,08-01-2022\naustin,Tx,restaurent,34000,17500,2022-09-10\njacksonville,fl,RETAIL,30000,14000,10/12/2022\nfort-worth,TX,restaurant,35000,19000,Nov 15 2022\ncolumbus,OH,restaurent,37000,21000,2022-12-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize city names by replacing underscores and hyphens with spaces and proper case", "columnName": "City", "expression": "value.replace('_',' ').replace('-',' ').toTitlecase()"}, {"op": "core/mass-edit", "description": "Correct misspellings and inconsistent capitalization in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["restuarant", "Resturant", "RestauranT", "restaurent", "restaurent"], "to": "Restaurant"}, {"from": ["RETAIL", "retail", "Reta-il"], "to": "Retail"}]}, {"op": "core/mass-edit", "description": "Normalize state abbreviations to uppercase", "columnName": "State", "edits": [{"from": ["il", "az", "Tx", "fl", "OH"], "to": "IL"}, {"from": ["az"], "to": "AZ"}, {"from": ["Tx"], "to": "TX"}, {"from": ["fl"], "to": "FL"}, {"from": ["OH"], "to": "OH"}]}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/date-parse", "description": "Parse Date column into yyyy-MM-dd format", "columnName": "Date", "expression": "value.toDate()"}, {"op": "core/text-transform", "description": "Format Date column consistently as yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/text-transform", "description": "Remove commas in Price and convert to number string", "columnName": "Price", "expression": "value.replace(',', '')"}, {"op": "core/text-transform", "description": "Remove commas in LoanAmount and convert to number string", "columnName": "LoanAmount", "expression": "value.replace(',', '')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,23000,10000,2022-01-12\nLos Angeles,CA,Retail,45000,25000,2022-02-15\nChicago,IL,Restaurant,55000,30000,2022-03-15\nHouston,TX,Retail,31000,30000,2022-03-20\nPhoenix,AZ,Retail,28000,15000,2022-04-05\nPhiladelphia,PA,Restaurant,26000,12000,2022-05-01\nSan Antonio,TX,Restaurant,27000,13000,2022-05-10\nSan Diego,CA,Retail,33000,17000,2022-06-15\nDal Las,TX,Retail,29000,16000,2022-07-20\nSan Jose,CA,Retail,31000,18000,2022-08-01\nAustin,TX,Restaurant,34000,17500,2022-09-10\nJacksonville,FL,Retail,30000,14000,2022-10-12\nFort Worth,TX,Restaurant,35000,19000,2022-11-15\nColumbus,OH,Restaurant,37000,21000,2022-12-01"}
{"purpose": "Standardize city and crop type names, fix numeric formats, and unify date formats for agricultural loan records.", "raw_table": "City,State,CropType,Price_per_Ton,Loan_Amount,Planting_Date\nSpringfield,IL,corn,1500,25000,03/15/2023\nSPRINGFIELD,IL,Corn,1,5000,2023-03-16\nspring_field,IL,soYbean,1400,20000,15-03-2023\nGreenville,SC,wheat, 1300 ,18000,2023/03/17\ngreenville,SC,Wheat,1300,18,000,Mar 18 2023\nGreenville,SC,RICE,1250,17500,03-19-2023\nFairview,OR,Barley,1100,,2023.03.20\nfairview_OR,OR,Barley,1100,16000,2023-03-21\nFair-View,OR,barley,1100,16000,03/22/2023\nHilltop,CA,corn,1_450,23000,03/23/2023\nhilltop,CA,Corn,1450,23000,2023-03-24\nHillTop,CA,soybean,1350,21000,24/03/2023\nOakwood,TX,wheat,1250,19000,03-25-2023\noakwood,TX,wheat,1250,19000,2023/03/26\nOakwood,TX,wheat,1250,19000,March 27 2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from Price_per_Ton and Loan_Amount", "columnName": "Price_per_Ton", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Remove underscores and commas from numeric fields", "columnName": "Price_per_Ton", "expression": "value.replaceAll('_','').replaceAll(',','')"}, {"op": "core/text-transform", "description": "Remove underscores and commas from Loan_Amount", "columnName": "Loan_Amount", "expression": "value.replaceAll('_','').replaceAll(',','')"}, {"op": "core/mass-edit", "description": "Normalize City names to proper capitalization and spacing", "columnName": "City", "edits": [{"from": ["springfield", "spring_field", "SPRINGFIELD"], "to": "Springfield"}, {"from": ["greenville", "Greenville"], "to": "Greenville"}, {"from": ["fairview", "fairview_OR", "Fair-View", "Fairview", "Fair-View"], "to": "Fairview"}, {"from": ["hilltop", "HillTop", "Hilltop", "hilltop"], "to": "Hilltop"}, {"from": ["oakwood", "Oakwood", "oakwood"], "to": "Oakwood"}]}, {"op": "core/mass-edit", "description": "Standardize CropType names", "columnName": "CropType", "edits": [{"from": ["corn", "Corn", "CORN"], "to": "Corn"}, {"from": ["soybean", "soYbean", "Soybean"], "to": "Soybean"}, {"from": ["wheat", "Wheat", "wheat "], "to": "Wheat"}, {"from": ["rice", "RICE"], "to": "Rice"}, {"from": ["barley", "Barley", "barley "], "to": "Barley"}]}, {"op": "core/fill-down", "description": "Fill down missing Loan_Amount values", "columnName": "Loan_Amount"}, {"op": "core/text-transform", "description": "Parse Planting_Date to ISO format yyyy-MM-dd", "columnName": "Planting_Date", "expression": "value.toDate(\"MM/dd/yyyy\").toString(\"yyyy-MM-dd\") || value.toDate(\"yyyy-MM-dd\").toString(\"yyyy-MM-dd\") || value.toDate(\"dd-MM-yyyy\").toString(\"yyyy-MM-dd\") || value.toDate(\"yyyy/MM/dd\").toString(\"yyyy-MM-dd\") || value.toDate(\"MMM dd yyyy\").toString(\"yyyy-MM-dd\") || value.toDate(\"dd/MM/yyyy\").toString(\"yyyy-MM-dd\") || value.toDate(\"yyyy.MM.dd\").toString(\"yyyy-MM-dd\")"}, {"op": "core/column-rename", "description": "Rename Price_per_Ton to PricePerTon", "oldColumnName": "Price_per_Ton", "newColumnName": "PricePerTon"}, {"op": "core/text-transform", "description": "Convert PricePerTon to number", "columnName": "PricePerTon", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Convert Loan_Amount to number", "columnName": "Loan_Amount", "expression": "value.toNumber()"}], "clean_table": "City,State,CropType,PricePerTon,Loan_Amount,Planting_Date\nSpringfield,IL,Corn,1500,25000,2023-03-15\nSpringfield,IL,Corn,1500,5000,2023-03-16\nSpringfield,IL,Soybean,1400,20000,2023-03-15\nGreenville,SC,Wheat,1300,18000,2023-03-17\nGreenville,SC,Wheat,1300,18000,2023-03-18\nGreenville,SC,Rice,1250,17500,2023-03-19\nFairview,OR,Barley,1100,16000,2023-03-20\nFairview,OR,Barley,1100,16000,2023-03-21\nFairview,OR,Barley,1100,16000,2023-03-22\nHilltop,CA,Corn,1450,23000,2023-03-23\nHilltop,CA,Corn,1450,23000,2023-03-24\nHilltop,CA,Soybean,1350,21000,2023-03-24\nOakwood,TX,Wheat,1250,19000,2023-03-25\nOakwood,TX,Wheat,1250,19000,2023-03-26\nOakwood,TX,Wheat,1250,19000,2023-03-27"}
{"purpose": "Clean inconsistent movie genre labels, fix date formats, and normalize box office revenue figures in the dataset.", "raw_table": "MovieTitle,Genre,ReleaseDate,BoxOffice,Rating\nAvengers_endgame,action/sci-fi,04-26-2019,2.798B,8.4\njoker,Drama ,10/04/2019,$1,074,000,000,8.5\nTitanic,romance,12-19-1997,2.187b,7.8\nspider-man: far from home,Action,07/02/2019,1.132 B,7.5\nparasite,thriller,05/30/2019, $257000000,8.6\nThe Lion King,Animation,07-19-2019,1.656B,6.9\nfrozen 2,animation,11/22/2019,1.450B,6.8\nInception,Sci-Fi,2010-07-16,829895144,8.8\nThe Godfather,Crime,03-24-1972,246120974,9.2\nAvengers_infinity_war,action/Sci-Fi,04-27-2018,2.048B,8.5\nBlack Panther,action,single,1346913161,7.3\nLa La Land,Musical,12-09-2016,$446,000,000,8.0\nJumanji: The Next Level,Adventure,12/13/2019,800,059,000,6.7\nThe Irishman,Crime,11-01-2019, 0,7.9\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize Genre capitalization and replace slashes with commas", "columnName": "Genre", "expression": "value.toLowercase().replace('/', ', ').trim().split(',').map(g => g.trim().capitalize()).join(', ')"}, {"op": "core/text-transform", "description": "Fix ReleaseDate formats to yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "if(value.match(/\\d{4}-\\d{2}-\\d{2}/)) { value } else if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/)) {\n  var parts = value.split('/'); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0')\n} else if(value.match(/\\d{2}-\\d{2}-\\d{4}/)) {\n  var parts = value.split('-'); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0')\n} else if(value.toLowercase() == 'single' || value.trim() == '') { null } else { null }"}, {"op": "core/text-transform", "description": "Normalize BoxOffice to numeric in billions (float)", "columnName": "BoxOffice", "expression": "var v = value.replace(/\\$/g, '').replace(/,/g, '').toLowercase().trim();\nif(v.endsWith('b')) {\n  parseFloat(v.replace('b',''))\n} else if(parseFloat(v) > 1000000000) {\n  parseFloat(v)/1000000000\n} else if(parseFloat(v) > 1000000) {\n  parseFloat(v)/1000000000\n} else if(v == '0' || v == '') {\n  null\n} else {\n  parseFloat(v)\n}"}, {"op": "core/mass-edit", "description": "Correct inconsistent MovieTitle formatting", "columnName": "MovieTitle", "edits": [{"from": ["Avengers_endgame", "Avengers_infinity_war"], "to": ["Avengers Endgame", "Avengers Infinity War"]}, {"from": ["spider-man: far from home", "frozen 2"], "to": ["Spider-Man: Far From Home", "Frozen 2"]}]}, {"op": "core/text-transform", "description": "Capitalize MovieTitle properly", "columnName": "MovieTitle", "expression": "value.split(/\\b/).map(w => w.charAt(0).toUpperCase() + w.slice(1)).join('')"}, {"op": "core/mass-edit", "description": "Fix missing or incorrect Ratings", "columnName": "Rating", "edits": [{"from": ["0", ""], "to": "null"}]}], "clean_table": "MovieTitle,Genre,ReleaseDate,BoxOffice,Rating\nAvengers Endgame,Action, Sci-Fi,2019-04-26,2.798,8.4\nJoker,Drama,2019-10-04,1.074,8.5\nTitanic,Romance,1997-12-19,2.187,7.8\nSpider-Man: Far From Home,Action,2019-07-02,1.132,7.5\nParasite,Thriller,2019-05-30,0.257,8.6\nThe Lion King,Animation,2019-07-19,1.656,6.9\nFrozen 2,Animation,2019-11-22,1.45,6.8\nInception,Sci-Fi,2010-07-16,0.83,8.8\nThe Godfather,Crime,1972-03-24,0.246,9.2\nAvengers Infinity War,Action, Sci-Fi,2018-04-27,2.048,8.5\nBlack Panther,Action, null,1.347,7.3\nLa La Land,Musical,2016-12-09,0.446,8.0\nJumanji: The Next Level,Adventure,2019-12-13,0.8,6.7\nThe Irishman,Crime,2019-11-01,null,7.9\n"}
{"purpose": "Standardize city and business type names, fix date formats, and clean numeric values for energy loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nnew_york,NY,solar_Company,10000,5000,2023/01/15\nLos-Angeles,ca,Wind Energy,12000,6500,15-02-2023\nCHICAGO,IL,solar company,9500,,2023-03-10\nhouston,Tx,Geothermal,11000,7000,03/25/2023\nphoenix,AZ,Wind Energy,NaN,6000,2023.04.01\nPhiladelphia,PA,solar-company,10500,5500,April 5 2023\nsan antonio,tx,,9800,5200,2023/04/10\nSan Diego,CA,Solar_Company,10100,5300,2023-04-15\nDallas,tx,Geothermal,9700,5100,2023/04/20\nsan jose,ca,wind energy,10200,,2023/04/25\nAustin,TX,solar company,NaN,5400,2023/04/30\nJacksonville,fl,Geothermal,9300,5000,2023-05-05\nFort Worth,TX,Solar_Company,10000,5250,2023/05/10", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names properly and replace underscores/hyphens with spaces", "columnName": "City", "expression": "value.toLowercase().split(/[_\\- ]+/).map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Capitalize state abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType (replace underscores and hyphens, fix capitalization, and standardize terms)", "columnName": "BusinessType", "expression": "value ? value.toLowercase().replace(/[_\\-]/g,' ').trim() : ''"}, {"op": "core/mass-edit", "description": "Standardize BusinessType entries", "columnName": "BusinessType", "edits": [{"from": ["solar company", "solar company", "solar company", "solar company", "solar company", "solar company", "solar company", "solar company"], "to": "Solar Company"}, {"from": ["solar company", "solar-company", "solar_company"], "to": "Solar Company"}, {"from": ["wind energy", "wind energy", "wind energy"], "to": "Wind Energy"}, {"from": ["geothermal", "geothermal", "geothermal"], "to": "Geothermal"}, {"from": [""], "to": ""}]}, {"op": "core/text-transform", "description": "Parse and normalize LoanDate to yyyy-MM-dd", "columnName": "LoanDate", "expression": "value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/) ? value.replace(/\\//g,'-') : value.match(/\\d{2}-\\d{2}-\\d{4}/) ? value.split('-').reverse().join('-') : value.match(/\\d{4}-\\d{2}-\\d{2}/) ? value : value.match(/[A-Za-z]+ \\d{1,2} \\d{4}/) ? Date.parse(value).toISOString().substring(0,10) : value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/) ? value.replace(/\\./g,'-') : value"}, {"op": "core/text-transform", "description": "Fill missing LoanAmount with mean value", "columnName": "LoanAmount", "expression": "isNaN(value) || value == '' ? '5750' : value"}, {"op": "core/text-transform", "description": "Replace 'NaN' and blanks in Price with mean price 10000", "columnName": "Price", "expression": "value.toLowercase() == 'nan' || value == '' ? '10000' : value"}, {"op": "core/column-rename", "description": "Rename LoanDate to Date for clarity", "oldColumnName": "LoanDate", "newColumnName": "Date"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Company,10000,5000,2023-01-15\nLos Angeles,CA,Wind Energy,12000,6500,2023-02-15\nChicago,IL,Solar Company,9500,5750,2023-03-10\nHouston,TX,Geothermal,11000,7000,2023-03-25\nPhoenix,AZ,Wind Energy,10000,6000,2023-04-01\nPhiladelphia,PA,Solar Company,10500,5500,2023-04-05\nSan Antonio,TX,,9800,5200,2023-04-10\nSan Diego,CA,Solar Company,10100,5300,2023-04-15\nDallas,TX,Geothermal,9700,5100,2023-04-20\nSan Jose,CA,Wind Energy,10200,5750,2023-04-25\nAustin,TX,Solar Company,10000,5400,2023-04-30\nJacksonville,FL,Geothermal,9300,5000,2023-05-05\nFort Worth,TX,Solar Company,10000,5250,2023-05-10"}
{"purpose": "Standardize movie genres and clean movie release dates for analysis.", "raw_table": "Title,Genre,ReleaseDate,BoxOffice\nAvengers_Endgame,Action-SciFi,2019/04/26,$2.798B\njoker ,DRAMA,10-04-2019,1074 million\nThe Lion King,Animation,07.19.2019,$1.65 Billion\nparasite,thriller,2019-05-30,258.8M\nFrozen_2,animation, November 22 2019,1.45 billion\n1917,war-drama,2019/12/25,384M\nSpider-Man: Far From Home,Action,2019-07-02,$1.132b\nonce upon a time in hollywood,drama,2019/07/26,374 million\nToy Story 4,ANIMATION,2019-06-21,$1.073B\nKnives Out,Mystery-Thriller,2019_11_27,311M\nCaptain Marvel,Action_Sci-fi,2019-03-08,$1.128 billion\nFord v Ferrari,Action,15-11-2019,225.5 M\nJumanji: The Next Level,action-adventure,12/13/2019,$796 million\nStar Wars: Episode IX,Action-SciFi,2019-12-20,1.074B\nLittle Women,Drama,2019-12-25,216 million", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "Genre", "expression": "value.toLowercase().replace(/[_-]/g, ' ').replace(/ sci fi| scifi| sci-fi/g, ' sci-fi').split(' ').sort().join('-')"}, {"op": "core/mass-edit", "columnName": "Genre", "edits": [{"from": ["thriller", "mystery-thriller"], "to": "mystery-thriller"}, {"from": ["drama", "war-drama"], "to": "drama"}, {"from": ["action sci-fi", "action-sci-fi", "action_sci-fi"], "to": "action-sci-fi"}, {"from": ["animation"], "to": "animation"}, {"from": ["action adventure", "action-adventure", "action"], "to": "action"}]}, {"op": "core/text-transform", "columnName": "ReleaseDate", "expression": "value.trim().replace(/\\.|_/g, '/').replace(/(\\d{4})[\\/\\-_](\\d{2})[\\/\\-_](\\d{2})/, '$1/$2/$3').replace(/(\\d{2})-(\\d{2})-(\\d{4})/, '$3/$2/$1').replace(/(\\w+) (\\d{1,2}) (\\d{4})/, function(m){var months={'January':'01','February':'02','March':'03','April':'04','May':'05','June':'06','July':'07','August':'08','September':'09','October':'10','November':'11','December':'12'};var parts=m.split(' ');return parts[2]+'/'+months[parts[0]]+'/'+(parts[1].length==1?'0'+parts[1]:parts[1]);})"}, {"op": "core/date-parse", "columnName": "ReleaseDate", "expression": "value", "onError": "set-to-blank", "dateFormat": "yyyy/MM/dd"}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "value.toLowercase().replace(/\\$|billion|million|m|b| /g, '').replace(/,/g, '')"}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "if(value.endsWith('b')) { (value.replace('b','') * 1000).toFixed(0) } else if(value.endsWith('m')) { (value.replace('m','')).toFixed(0) } else if(value.length > 6) { (parseFloat(value)/1000000).toFixed(0) } else value"}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "value.match(/\\d+/) ? Number(value).toString() : ''"}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "if(value.length < 4) { Number(value) } else { Number(value) }"}], "clean_table": "Title,Genre,ReleaseDate,BoxOffice\nAvengers_Endgame,action-sci-fi,2019-04-26,2798\njoker,drama,2019-10-04,1074\nThe Lion King,animation,2019-07-19,1650\nparasite,mystery-thriller,2019-05-30,258\nFrozen_2,animation,2019-11-22,1450\n1917,drama,2019-12-25,384\nSpider-Man: Far From Home,action,2019-07-02,1132\nonce upon a time in hollywood,drama,2019-07-26,374\nToy Story 4,animation,2019-06-21,1073\nKnives Out,mystery-thriller,2019-11-27,311\nCaptain Marvel,action-sci-fi,2019-03-08,1128\nFord v Ferrari,action,2019-11-15,225\nJumanji: The Next Level,action,2019-12-13,796\nStar Wars: Episode IX,action-sci-fi,2019-12-20,1074\nLittle Women,drama,2019-12-25,216"}
{"purpose": "Clean inconsistent city names, normalize business types, and standardize date and numeric formats in government loan data.", "raw_table": "City,State,BusinessType,LoanAmount,Price,ApplicationDate\nNew_york,NY,retailer, 50000,100000.5,01/12/2022\nlos-angeles,ca,Restaurent,75000,85000,2022-02-15\nCHICAGO,IL,retAiler,60000,95000,15-03-2022\nhouston,TX,Consulting, 80000, 120000,2022/04/10\nPhoenix,az,restaurent,,75000,2022-05-05\nphiladelphia,PA,CONSULTING,70000,110000,2022-06-07\nSan-antonio,TX,retailer,65000,98000,07/07/22\nSan Diego,CA,Consultant,72000,105000,2022-08-15\nDallas,tx,RETAILER,68000,99000,08-20-2022\nSanJose,CA,restaurent,71000,102000,2022-09-01\nAustin,TX,consulting,69000, ,2022-10-10\nJacksonville,FL,restaurent,53000,87000,10/12/2022\nFort_Worth,TX,retailer,64000,96500,2022-11-11\nColumbus,OH,Consulting,67000,100000,2022-12-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names with spaces, capitalize properly", "columnName": "City", "expression": "value.replace(/[_\\-]/, ' ').toTitlecase()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType variants to standard terms", "columnName": "BusinessType", "edits": [{"from": ["retailer", "retAiler", "RETAILER"], "to": "Retailer"}, {"from": ["restaurent", "Restaurent", "restaurent"], "to": "Restaurant"}, {"from": ["consulting", "CONSULTING", "Consultant"], "to": "Consulting"}]}, {"op": "core/text-transform", "description": "Trim spaces in numeric columns LoanAmount and Price", "columnName": "LoanAmount", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim spaces in Price column", "columnName": "Price", "expression": "value.trim()"}, {"op": "core/fill-down", "description": "Fill missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Convert Price empty strings to null", "columnName": "Price", "expression": "if(value=='',null,value)"}, {"op": "core/date-parse", "description": "Parse ApplicationDate with flexible formats", "columnName": "ApplicationDate", "format": "MM/dd/yyyy", "mode": "lenient"}, {"op": "core/text-transform", "description": "Standardize Price to numeric string without trailing decimals", "columnName": "Price", "expression": "if(isNonBlank(value), toNumber(value).toString(), null)"}, {"op": "core/text-transform", "description": "Standardize LoanAmount to numeric string", "columnName": "LoanAmount", "expression": "toNumber(value).toString()"}], "clean_table": "City,State,BusinessType,LoanAmount,Price,ApplicationDate\nNew York,NY,Retailer,50000,100000.5,2022-01-12\nLos Angeles,CA,Restaurant,75000,85000,2022-02-15\nChicago,IL,Retailer,60000,95000,2022-03-15\nHouston,TX,Consulting,80000,120000,2022-04-10\nPhoenix,AZ,Restaurant,80000,75000,2022-05-05\nPhiladelphia,PA,Consulting,70000,110000,2022-06-07\nSan Antonio,TX,Retailer,65000,98000,2022-07-07\nSan Diego,CA,Consulting,72000,105000,2022-08-15\nDallas,TX,Retailer,68000,99000,2022-08-20\nSan Jose,CA,Restaurant,71000,102000,2022-09-01\nAustin,TX,Consulting,69000,,2022-10-10\nJacksonville,FL,Restaurant,53000,87000,2022-10-12\nFort Worth,TX,Retailer,64000,96500,2022-11-11\nColumbus,OH,Consulting,67000,100000,2022-12-01"}
{"purpose": "Standardize city names, business types, and date formats for energy loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar_company,12000,50000,12/01/2022\nlos-angeles,CA,wind farm,15000,45000,2022-11-15\nChicago,IL,solar company,11000,48000,Nov 5 2022\nhouston,TX,Wind-Farm,13000,52000,2022/10/20\nPHOENIX,Az,solr_company,12500,,10-15-2022\nphiladeLphia,pa,solar-company,11800,47000,2022.09.30\nSan Antonio,TX,,14000,53000,09/25/22\nSan-diego,Ca,windfarm,13500,49000,2022-08-15\nDallas,TX,Solar_Company,12800,51000,2022-07-30\nsan jose,ca,wind_farm,13200,48500,07/20/22\nAustin,TX,Solarcompany,11500,47500,2022/06/28\nJacksonville,fl,wind-farm,14000,50000,06-15-2022\nFort Worth,TX,solar-company,11900,46000,2022-05-10\nColumbus,OH,solarCompany,12200,48000,May 5 2022\nCharlotte,NC,wind farm,13000,49500,2022-04-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names properly and remove underscores and hyphens", "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/g, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize state abbreviations to uppercase", "columnName": "State", "edits": [{"from": ["ny", "ca", "az", "pa", "fl", "oh", "nc"], "to": ["NY", "CA", "AZ", "PA", "FL", "OH", "NC"]}]}, {"op": "core/text-transform", "description": "Normalize BusinessType values to consistent terms", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[-_]/g, ' ').replace('solr', 'solar').replace('solar company', 'Solar Company').replace('solar company', 'Solar Company').replace('solarcompany', 'Solar Company').replace('solar company', 'Solar Company').replace('windfarm', 'Wind Farm').replace('wind farm', 'Wind Farm').replace('wind-farm', 'Wind Farm').replace('wind_farm', 'Wind Farm').trim().split(' ').map(w => w.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Fill missing BusinessType with 'Solar Company'", "columnName": "BusinessType", "edits": [{"from": [null, ""], "to": "Solar Company"}]}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount with average of existing (approx 48821)", "columnName": "LoanAmount", "edits": [{"from": [""], "to": "48821"}]}, {"op": "core/text-transform", "description": "Parse and normalize Date to ISO format yyyy-MM-dd", "columnName": "Date", "expression": "if(value.match(/\\d{4}-\\d{2}-\\d{2}/)) { value } else if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/)) { value.split('/')[2] + '-' + (value.split('/')[0].length==1 ? '0'+value.split('/')[0] : value.split('/')[0]) + '-' + (value.split('/')[1].length==1 ? '0'+value.split('/')[1] : value.split('/')[1]) } else if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/)) { value.replace(/\\//g, '-') } else if(value.match(/\\d{2}-\\d{2}-\\d{4}/)) { let parts = value.split('-'); parts[2] + '-' + (parts[0].length==1 ? '0'+parts[0] : parts[0]) + '-' + (parts[1].length==1 ? '0'+parts[1] : parts[1]) } else if(value.match(/[A-Za-z]{3} \\d{1,2} \\d{4}/)) { var d = new Date(value); d.getFullYear() + '-' + ('0' + (d.getMonth()+1)).slice(-2) + '-' + ('0' + d.getDate()).slice(-2) } else { value }"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Company,12000,50000,2022-12-01\nLos Angeles,CA,Wind Farm,15000,45000,2022-11-15\nChicago,IL,Solar Company,11000,48000,2022-11-05\nHouston,TX,Wind Farm,13000,52000,2022-10-20\nPhoenix,AZ,Solar Company,12500,48821,2022-10-15\nPhiladelphia,PA,Solar Company,11800,47000,2022-09-30\nSan Antonio,TX,Solar Company,14000,53000,2022-09-25\nSan Diego,CA,Wind Farm,13500,49000,2022-08-15\nDallas,TX,Solar Company,12800,51000,2022-07-30\nSan Jose,CA,Wind Farm,13200,48500,2022-07-20\nAustin,TX,Solar Company,11500,47500,2022-06-28\nJacksonville,FL,Wind Farm,14000,50000,2022-06-15\nFort Worth,TX,Solar Company,11900,46000,2022-05-10\nColumbus,OH,Solar Company,12200,48000,2022-05-05\nCharlotte,NC,Wind Farm,13000,49500,2022-04-01"}
{"purpose": "Clean and standardize farm loan application data including city names, loan amounts, dates, and crop types.", "raw_table": "City,State,CropType,LoanAmount,ApplicationDate,FarmerName\nSpring_field,IA,Corn,50000,2023/03/15,john doe\nClayton,ia,soy_beans,45,000,15-04-2023,Jane Smith\nTrenton,MO,Wheat,40000,2023-04-01,robert brown\nspringfield,IA,corn,50000.00,03-14-2023,Mary-jane\nClayton,IA,soybeans,,2023/04/16,Will_Johnson\nTrenton,MO,wheat,40,000,2023/04/02,Jessica_Lee\nSPRINGFIELD,IA,CoRn,50000,2023.03.15,John Doe\nClayton,IA,soyBeans,45000,April 15 2023,Jane Smith\nTrenton,MO,wheat,40000,2023/4/1,Robert Brown\nSpringField,IA,corn,50000,2023-03-15,John_Doe\nClayton,IA,soy beans,45000,15/04/2023,Jane Smith\nTrenton,MO,WhEAt,40,000,1-Apr-2023,Jessica Lee\nSpring_field,IA,CORN,50000,2023-03-15,john doe\nClayton,IA,soy_beans,45000,2023-04-15,will johnson\nTrenton,MO,Wheat,40000,2023/04/01,Jessica Lee", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and remove underscores and hyphens in City", "columnName": "City", "expression": "value.trim().replaceAll('[_-]', '').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Standardize CropType to lowercase with no underscores or spaces", "columnName": "CropType", "expression": "value.toLowercase().replaceAll('[ _]', '')"}, {"op": "core/text-transform", "description": "Normalize LoanAmount by removing commas and converting to number string", "columnName": "LoanAmount", "expression": "if(value == null || value == '', '', value.replaceAll(',', '').replaceAll(' ', ''))"}, {"op": "core/text-transform", "description": "Parse ApplicationDate into yyyy-MM-dd format", "columnName": "ApplicationDate", "expression": "if(value == null || value == '', '', date.parse(value).toString('yyyy-MM-dd'))"}, {"op": "core/text-transform", "description": "Capitalize FarmerName properly and remove underscores and hyphens", "columnName": "FarmerName", "expression": "value.trim().replaceAll('[_-]', ' ').split(' ').map(v, v.toLowercase().capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount with 45000 (most common value)", "columnName": "LoanAmount", "edits": [{"from": [""], "to": "45000"}]}], "clean_table": "City,State,CropType,LoanAmount,ApplicationDate,FarmerName\nSpringfield,IA,corn,50000,2023-03-15,John Doe\nClayton,IA,soybeans,45000,2023-04-15,Jane Smith\nTrenton,MO,wheat,40000,2023-04-01,Robert Brown\nSpringfield,IA,corn,50000,2023-03-14,Mary Jane\nClayton,IA,soybeans,45000,2023-04-16,Will Johnson\nTrenton,MO,wheat,40000,2023-04-02,Jessica Lee\nSpringfield,IA,corn,50000,2023-03-15,John Doe\nClayton,IA,soybeans,45000,2023-04-15,Jane Smith\nTrenton,MO,wheat,40000,2023-04-01,Robert Brown\nSpringfield,IA,corn,50000,2023-03-15,John Doe\nClayton,IA,soybeans,45000,2023-04-15,Jane Smith\nTrenton,MO,wheat,40000,2023-04-01,Jessica Lee\nSpringfield,IA,corn,50000,2023-03-15,John Doe\nClayton,IA,soybeans,45000,2023-04-15,Will Johnson\nTrenton,MO,wheat,40000,2023-04-01,Jessica Lee"}
{"purpose": "Standardize city names and business types, fix date formats, and clean numeric fields in energy loan records.", "raw_table": "City,State,BusinessType,LoanAmount,Price,Date\nNew_york,NY,solar-energy,50000,0.12,2023-01-15\nlos angeles,ca,Wind_Energy,75000,,15/02/2023\nhouston,TX,Solar energy,60000,0.10,2023/03/01\nCHIcaGO,IL,windenergy,55000,0.11,03-15-2023\nPhoenix,AZ,,45000,0.13,March 31 2023\nPhiladelphia,PA,solar-Energy,52000,0.115,2023.04.15\nsan antonio,TX,Wind Energy,58000,0.105,2023-04-30\nSan Diego,CA,Solar_energy,6000O,0.12,04/15/2023\nDallas,TX,Solar-energy,62000,0.11,2023-05-01\nSan jose,CA,windEnergy,57000,0.10,2023-05-15\nAustin,TX,Wind-energy,59000,0.09,2023-05-31\nJacksonville,FL,SOLAR ENERGY,53000,0.13,2023-06-15\nFort Worth,TX,WInd Energy,61000,0.11,2023-06-30\nColumbus,OH,Solar-energy,50000,0.12,2023-07-15", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in City", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Trim and standardize capitalization for State", "columnName": "State", "expression": "value.toUppercase().trim()"}, {"op": "core/text-transform", "description": "Normalize BusinessType to standard values", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[_-]/g, ' ').replace(/windenergy|wind energy|w ind energy/, 'Wind Energy').replace(/solar energy|solar-energy|solar_energy|solarenergy/, 'Solar Energy').trim()"}, {"op": "core/mass-edit", "description": "Fill missing BusinessType with 'Solar Energy'", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Solar Energy"}]}, {"op": "core/text-transform", "description": "Fix common OCR error in LoanAmount (letter 'O' to zero)", "columnName": "LoanAmount", "expression": "value.replace(/O/g, '0').replace(/[^0-9]/g, '').toNumber()"}, {"op": "core/text-transform", "description": "Fill missing Price with average (0.11)", "columnName": "Price", "expression": "value == null || value == '' ? 0.11 : value.toNumber()"}, {"op": "core/date-parse", "description": "Parse Date to standard yyyy-MM-dd", "columnName": "Date", "dateFormat": "automatic"}, {"op": "core/text-transform", "description": "Format Date column to yyyy-MM-dd string", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,LoanAmount,Price,Date\nNew York,NY,Solar Energy,50000,0.12,2023-01-15\nLos Angeles,CA,Wind Energy,75000,0.11,2023-02-15\nHouston,TX,Solar Energy,60000,0.10,2023-03-01\nChicago,IL,Wind Energy,55000,0.11,2023-03-15\nPhoenix,AZ,Solar Energy,45000,0.13,2023-03-31\nPhiladelphia,PA,Solar Energy,52000,0.115,2023-04-15\nSan Antonio,TX,Wind Energy,58000,0.105,2023-04-30\nSan Diego,CA,Solar Energy,60000,0.12,2023-04-15\nDallas,TX,Solar Energy,62000,0.11,2023-05-01\nSan Jose,CA,Wind Energy,57000,0.10,2023-05-15\nAustin,TX,Wind Energy,59000,0.09,2023-05-31\nJacksonville,FL,Solar Energy,53000,0.13,2023-06-15\nFort Worth,TX,Wind Energy,61000,0.11,2023-06-30\nColumbus,OH,Solar Energy,50000,0.12,2023-07-15"}
{"purpose": "Clean inconsistent city and state names, normalize business types, and fix date and numeric formats in a government loan application dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew_york,ny,restaUrant,50000,$150000,01-15-2023\nlos-angeles,CA,retail,75000,200000,2023/02/10\nchicago,il,RETAIL,65000,180000,15 Mar 2023\nhouston,tx,Construction,55000,,03-20-2023\nPhoenix,Az,restaurent,70000,210000,2023-04-01\nphiladelphia,PA,retail,68000,190000,April 5 2023\nSan-antonio,TX,construction,60000,170000,2023.04.10\nsan_diego,ca,RESTAURANT,72000,195000,2023-04-15\nDALLAS,TX,retail,69000,$185000,16-04-2023\nsan_jose,CA,retail,68000,,2023/04/18\nAustin,tx,restaUrant,71000,200000,04-20-2023\njacksonville,FL,construction,58000,160000,2023-04-22\nFort-worth,TX,restaUrant,73000,205000,April 23 2023\ncolumbus,oh,RETAIL,67000,175000,2023-04-25", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City names by replacing underscores and hyphens with spaces and title casing", "columnName": "City", "expression": "value.replace('_',' ').replace('-',' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Uppercase State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Correct misspellings and normalize BusinessType", "columnName": "BusinessType", "edits": [{"from": ["restaurent", "restaUrant", "RESTAURANT"], "to": "Restaurant"}, {"from": ["retail", "RETAIL"], "to": "Retail"}, {"from": ["construction", "Construction"], "to": "Construction"}]}, {"op": "core/text-transform", "description": "Remove $ sign and convert Price to number", "columnName": "Price", "expression": "value.replace('$','').toNumber()"}, {"op": "core/text-transform", "description": "Remove $ sign and convert LoanAmount to number, empty string to null", "columnName": "LoanAmount", "expression": "value.trim() == '' ? null : value.replace('$','').toNumber()"}, {"op": "core/date-parse", "description": "Parse ApplicationDate into ISO format yyyy-MM-dd", "columnName": "ApplicationDate", "format": "auto", "onError": "keep-original", "useNewColumn": false}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew York,NY,Restaurant,50000,150000,2023-01-15\nLos Angeles,CA,Retail,75000,200000,2023-02-10\nChicago,IL,Retail,65000,180000,2023-03-15\nHouston,TX,Construction,55000,,2023-03-20\nPhoenix,AZ,Restaurant,70000,210000,2023-04-01\nPhiladelphia,PA,Retail,68000,190000,2023-04-05\nSan Antonio,TX,Construction,60000,170000,2023-04-10\nSan Diego,CA,Restaurant,72000,195000,2023-04-15\nDallas,TX,Retail,69000,185000,2023-04-16\nSan Jose,CA,Retail,68000,,2023-04-18\nAustin,TX,Restaurant,71000,200000,2023-04-20\nJacksonville,FL,Construction,58000,160000,2023-04-22\nFort Worth,TX,Restaurant,73000,205000,2023-04-23\nColumbus,OH,Retail,67000,175000,2023-04-25"}
{"purpose": "Standardize city and business type names, fix date formats, and clean numeric fields in telecom loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,Retail-store,100.50,10000,2023/01/15\nlos-angeles,CA,retail Store,200.00, FifteenThousand,15-02-2023\nChicago,IL,RetailStore,150.75,12000,2023.03.20\nhouston,TX,retail_store,99.99,11000,Mar 25 2023\nPHOENIX,az,retal store,105.00,,2023/04/01\nphiladelphia,PA,RETAIL_STORE,NaN,13000,2023-04-10\nSan antonio,TX,retail-store,120,12500,2023-4-15\nsan-diego,ca,Retailstore,115.30, 14000 ,04/20/2023\nDallas,tx,Retail_Store,105.75,13500,2023-04-25\nsan_jose,CA,RetailStore,100.00,NaN,2023/05/01\nAustin,tx,retailStore,110.0,12800,May 5, 2023\nJacksonville,FL,retail-store,99.50,12200,2023_05_10\nFort Worth,tx,retail_store,102.25,13000,2023-05-15\nColumbus,OH,RetailStore,107.00,13100,2023/05/20\nCharlotte,NC,Retail store,108.50,12900,2023-05-25", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.toLowercase().replace(/[_-]/g, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Fix BusinessType inconsistent capitalization and underscore/hyphen", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[_-]/g, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Correct misspelled BusinessType 'retal store' to 'Retail Store'", "columnName": "BusinessType", "edits": [{"from": ["Retal Store"], "to": "Retail Store"}]}, {"op": "core/text-transform", "description": "Clean Price column: convert to number, replace NaN with empty", "columnName": "Price", "expression": "if(value.toLowercase() == 'nan' || value.trim() == '', '', Number(value))"}, {"op": "core/text-transform", "description": "Clean LoanAmount: convert to number, fix 'FifteenThousand' to 15000, empty to null", "columnName": "LoanAmount", "expression": "value.replace(/FifteenThousand/i, '15000').trim() == '' ? null : Number(value.replace(/,/g,''))"}, {"op": "core/date-parse", "description": "Parse Date column with multiple formats", "columnName": "Date", "format": "yyyy/MM/dd", "onError": "keep-original", "guessCellType": false}, {"op": "core/text-transform", "description": "Normalize dates to ISO yyyy-MM-dd", "columnName": "Date", "expression": "if(value instanceof Date, value.toISOString().substring(0,10), value)"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail Store,100.5,10000,2023-01-15\nLos Angeles,CA,Retail Store,200,15000,2023-02-15\nChicago,IL,Retail Store,150.75,12000,2023-03-20\nHouston,TX,Retail Store,99.99,11000,2023-03-25\nPhoenix,AZ,Retail Store,105,11000,2023-04-01\nPhiladelphia,PA,Retail Store,,13000,2023-04-10\nSan Antonio,TX,Retail Store,120,12500,2023-04-15\nSan Diego,CA,Retail Store,115.3,14000,2023-04-20\nDallas,TX,Retail Store,105.75,13500,2023-04-25\nSan Jose,CA,Retail Store,100,13500,2023-05-01\nAustin,TX,Retail Store,110,12800,2023-05-05\nJacksonville,FL,Retail Store,99.5,12200,2023-05-10\nFort Worth,TX,Retail Store,102.25,13000,2023-05-15\nColumbus,OH,Retail Store,107,13100,2023-05-20\nCharlotte,NC,Retail Store,108.5,12900,2023-05-25"}
{"purpose": "Clean and standardize movie titles, genres, release dates, and box office revenue for analysis.", "raw_table": "MovieID,Title,Genre,ReleaseDate,BoxOffice\n1,The_godfather,crime,03/24/1972,134_966_411\n2,star_wars: a new hope,Sci-Fi ,May 25 1977,775_398_007\n3,Incepton,Action ,2010-07-16,829895144\n4,Titanic,romance,12-19-97,2,187,463,944\n5,The Dark Knight,action,07/18/08,1_005_973_645\n6,pulp Fiction,Crime,October 14,1994,213_928_762\n7,forrest_gump,Drama,07/06/1994,677_387_716\n8,Avengers Endgame,Action ,2019/04/26,2_797_501_328\n9,The Shawshank Redemption,Drama,1994-09-22,28341469\n10,Gladiator,action,2000/05/05,460_583_960\n11,Jurrasic Park,Sci-fi,06/11/93,1_034_968_852\n12,La La land,Musical,12-09-2016,446_000_000\n13,The Lion King,animation,06/15/1994,968_483_777\n14,Intersteller,Sci-Fi,11/07/14,677_471_339\n15,Parasite,thriller,2019-05-30,258_700_000", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and colons in Title with spaces", "columnName": "Title", "expression": "value.replace(/[_:]/g,' ').trim()"}, {"op": "core/text-transform", "description": "Capitalize first letter of each word in Title", "columnName": "Title", "expression": "value.split(' ').map(w => w.toLowerCase().replace(/^./,c=>c.toUpperCase())).join(' ')"}, {"op": "core/text-transform", "description": "Normalize Genre capitalization", "columnName": "Genre", "expression": "value.toLowerCase().trim().replace('sci-fi','Sci-Fi').replace('sci-fi','Sci-Fi').replace('sci-fi','Sci-Fi').replace('sci fi','Sci-Fi').replace('musical','Musical').replace('animation','Animation').replace('thriller','Thriller').replace('romance','Romance').replace('crime','Crime').replace('action','Action').replace('drama','Drama')"}, {"op": "core/text-transform", "description": "Parse and standardize ReleaseDate into yyyy-MM-dd format", "columnName": "ReleaseDate", "expression": "date.parse(value).toString('yyyy-MM-dd')"}, {"op": "core/text-transform", "description": "Remove underscores, commas, and spaces from BoxOffice and convert to numbers", "columnName": "BoxOffice", "expression": "value.replace(/[_ ,]/g,'')"}, {"op": "core/text-transform", "description": "Convert BoxOffice column to numeric", "columnName": "BoxOffice", "expression": "parseInt(value,10)"}], "clean_table": "MovieID,Title,Genre,ReleaseDate,BoxOffice\n1,The Godfather,Crime,1972-03-24,134966411\n2,Star Wars A New Hope,Sci-Fi,1977-05-25,775398007\n3,Incepton,Action,2010-07-16,829895144\n4,Titanic,Romance,1997-12-19,2187463944\n5,The Dark Knight,Action,2008-07-18,1005973645\n6,Pulp Fiction,Crime,1994-10-14,213928762\n7,Forrest Gump,Drama,1994-07-06,677387716\n8,Avengers Endgame,Action,2019-04-26,2797501328\n9,The Shawshank Redemption,Drama,1994-09-22,28341469\n10,Gladiator,Action,2000-05-05,460583960\n11,Jurrasic Park,Sci-Fi,1993-06-11,1034968852\n12,La La Land,Musical,2016-12-09,446000000\n13,The Lion King,Animation,1994-06-15,968483777\n14,Intersteller,Sci-Fi,2014-11-07,677471339\n15,Parasite,Thriller,2019-05-30,258700000"}
{"purpose": "Clean inconsistent city names and standardize business types and date formats for government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,restuarant,150000,$50000,01-15-2023\nLos Angeles,CA,RETAIL,200000,75000,2023/02/20\nCHicago,il,restaurannt,175000,65000,03-10-23\nhouston,TX,retail_,160000,$70000,April 5 2023\nPhoenix,Az,,145000,60000,2023-04-25\nphiladelphia,pa,restuarant,155000,68000,25/05/2023\nsan-antonio,tx,RETAIL,150000,64000,2023.06.15\nSan Diego,ca,Retail,165000,72000,Jun 20 2023\nDallas,TX,resturant,158000,67000,07-01-2023\nsan jose,ca,RETAIL,170000,,2023/07/18\nAustin,TX,Restaurent,162000,69000,08-05-23\nJacksonville,fl,retail,140000,63000,2023-08-22\nFort Worth,TX,Retail,155000,66000,09/10/2023\nColumbus,OH,restaurant,149000,61000,October 15 2023\nCharlotte,nc,Retail,151000,64000,2023-10-30\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens from City names and capitalize properly", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Uppercase State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["restuarant", "restaurannt", "resturant", "restaurent", "restuarant", "restaurant"], "to": "Restaurant"}, {"from": ["retail", "RETAIL", "retail_", "Retail"], "to": "Retail"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Remove $ and commas from Price and LoanAmount and convert to number string", "columnName": "Price", "expression": "value.replace(/[^\\d.]/g, '')"}, {"op": "core/text-transform", "description": "Remove $ and commas from LoanAmount and convert to number string", "columnName": "LoanAmount", "expression": "if(value==null || value.trim()==='') '', else value.replace(/[^\\d.]/g, '')"}, {"op": "core/date-parse", "description": "Parse Date column to standard yyyy-MM-dd", "columnName": "Date", "format": "auto", "toColumn": "Date", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Format Date to yyyy-MM-dd string", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,150000,50000,2023-01-15\nLos Angeles,CA,Retail,200000,75000,2023-02-20\nChicago,IL,Restaurant,175000,65000,2023-03-10\nHouston,TX,Retail,160000,70000,2023-04-05\nPhoenix,AZ,Unknown,145000,60000,2023-04-25\nPhiladelphia,PA,Restaurant,155000,68000,2023-05-25\nSan Antonio,TX,Retail,150000,64000,2023-06-15\nSan Diego,CA,Retail,165000,72000,2023-06-20\nDallas,TX,Restaurant,158000,67000,2023-07-01\nSan Jose,CA,Retail,170000,,2023-07-18\nAustin,TX,Restaurant,162000,69000,2023-08-05\nJacksonville,FL,Retail,140000,63000,2023-08-22\nFort Worth,TX,Retail,155000,66000,2023-09-10\nColumbus,OH,Restaurant,149000,61000,2023-10-15\nCharlotte,NC,Retail,151000,64000,2023-10-30\n"}
{"purpose": "Standardize inconsistent city and state names, correct misspelled business types, and normalize date and numeric fields in government loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,restuarant,12000,10000,01-15-2023\nlos-angeles,CA,RETAIL,15000,NA,2023/02/20\nChicago,il,manufacturing,18000,20000,3/5/23\nhouston,TX,RETAIL-,17000,15000,2023-04-10\nPhoenix,az,restarant,NA,13000,April 25 2023\nphiladelphia,PA,Manufacturing,16000,14000,2023.05.30\nSan Antonio,tx,retail,15500,13500,06-15-2023\nsan_diego,CA,RETAIL,16500,14500,07/20/2023\nDallas,tx,restuarant,14000,12000,2023/08/15\nSan Jose,CA,retail,15000,NA,September 10, 2023\nAustin,Tx,manufacturing,17500,16000,10-05-2023\nJacksonville,fl,restuarant,13000,11000,11/12/2023\nFort Worth,TX,retail,NA,12500,12.01.2023\nColumbus,OH,Manufacturing,18500,17000,2023-12-25\nCharlotte,NC,RETAIL,16000,15000,2023/11/30", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["los-angeles"], "to": "Los Angeles"}, {"from": ["san_diego"], "to": "San Diego"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["restuarant", "restarant", "restuarant"], "to": "Restaurant"}, {"from": ["RETAIL-", "RETAIL"], "to": "Retail"}, {"from": ["Manufacturing", "manufacturing"], "to": "Manufacturing"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value == 'NA' ? null : value.toNumber()"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value == 'NA' ? null : value.toNumber()"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value", "dateFormat": "MM-dd-yyyy", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "Date", "expression": "if(isDate(value), value.toDate('yyyy-MM-dd'),\n  \n  \n    \n  \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n value.toDate('yyyy-MM-dd'))"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,12000,10000,2023-01-15\nLos Angeles,CA,Retail,15000,,2023-02-20\nChicago,IL,Manufacturing,18000,20000,2023-03-05\nHouston,TX,Retail,17000,15000,2023-04-10\nPhoenix,AZ,Restaurant,,13000,2023-04-25\nPhiladelphia,PA,Manufacturing,16000,14000,2023-05-30\nSan Antonio,TX,Retail,15500,13500,2023-06-15\nSan Diego,CA,Retail,16500,14500,2023-07-20\nDallas,TX,Restaurant,14000,12000,2023-08-15\nSan Jose,CA,Retail,15000,,2023-09-10\nAustin,TX,Manufacturing,17500,16000,2023-10-05\nJacksonville,FL,Restaurant,13000,11000,2023-11-12\nFort Worth,TX,Retail,,12500,2023-12-01\nColumbus,OH,Manufacturing,18500,17000,2023-12-25\nCharlotte,NC,Retail,16000,15000,2023-11-30"}
{"purpose": "Standardize city and business type names, fix date formats, and clean numeric fields in a telecommunications loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,ISP, 1000, 5000,01-15-2023\nlos Angeles,CA,Mobile Carrier,800,4500,2023/02/20\nChicago,IL,isp,1200,$6000,15-Mar-2023\nHOUSTON,tx,wireless-provider,-900,4000,2023-04-10\nPhoenix,Az,mobile carrier,700,3500,4/25/2023\nphiladelphia,pa,,750,3000,2023-05-05\nSan Antonio,TX,ISP,NaN,4200,2023.06.01\nDallas,Tx,wireless-provider,850,unknown,June 10 2023\nsan-diego,CA,Mobile carrier,950,4800,2023-07-15\nSan Jose,Ca,isP,1000,5000,15/08/2023\nAustin,tx,wireless_provider,1100,5200,2023-09-01\nJacksonville,fl,ISP,1050,5400,2023-10-12\nFort Worth,TX,Mobile-Carrier,900,4300,10-15-2023\nColumbus,oh,ISP,800,4000,\nCharlotte,NC,wireless provider,850,4500,2023-12-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens from City names and capitalize properly", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toLowercase().split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Capitalize State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType entries", "columnName": "BusinessType", "edits": [{"from": ["isp", "ISP", "isP"], "to": "ISP"}, {"from": ["mobile carrier", "Mobile Carrier", "Mobile carrier", "Mobile-Carrier"], "to": "Mobile Carrier"}, {"from": ["wireless provider", "wireless-provider", "wireless_provider"], "to": "Wireless Provider"}]}, {"op": "core/mass-edit", "description": "Fix missing BusinessType values", "columnName": "BusinessType", "edits": [{"from": [""], "to": "ISP"}]}, {"op": "core/text-transform", "description": "Remove currency symbols and convert Price to number", "columnName": "Price", "expression": "value.replace(/[^0-9\\.\\-]/g, '').trim() === '' ? null : Number(value.replace(/[^0-9\\.\\-]/g, ''))"}, {"op": "core/text-transform", "description": "Convert LoanAmount to numbers; treat 'unknown' and missing as null", "columnName": "LoanAmount", "expression": "['unknown', '', 'NaN', null].includes(value.toLowercase()) ? null : Number(value.replace(/[^0-9]/g, ''))"}, {"op": "core/date-parse", "description": "Parse Date column with multiple formats", "columnName": "Date", "expression": "value.toString().parseDate(['MM-dd-yyyy','yyyy/MM/dd','dd-MMM-yyyy','yyyy-MM-dd','M/dd/yyyy','yyyy.MM.dd','MMMM dd yyyy','dd/MM/yyyy','MM-dd-yyyy','yyyy-MM-dd'])"}, {"op": "core/text-transform", "description": "Format Date column to ISO standard yyyy-MM-dd", "columnName": "Date", "expression": "value ? value.toDate().toString('yyyy-MM-dd') : ''"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,ISP,1000,5000,2023-01-15\nLos Angeles,CA,Mobile Carrier,800,4500,2023-02-20\nChicago,IL,ISP,1200,6000,2023-03-15\nHouston,TX,Wireless Provider,-900,4000,2023-04-10\nPhoenix,AZ,Mobile Carrier,700,3500,2023-04-25\nPhiladelphia,PA,ISP,750,3000,2023-05-05\nSan Antonio,TX,ISP,null,4200,2023-06-01\nDallas,TX,Wireless Provider,850,4200,2023-06-10\nSan Diego,CA,Mobile Carrier,950,4800,2023-07-15\nSan Jose,CA,ISP,1000,5000,2023-08-15\nAustin,TX,Wireless Provider,1100,5200,2023-09-01\nJacksonville,FL,ISP,1050,5400,2023-10-12\nFort Worth,TX,Mobile Carrier,900,4300,2023-10-15\nColumbus,OH,ISP,800,4000,\nCharlotte,NC,Wireless Provider,850,4500,2023-12-01"}
{"purpose": "Clean and standardize farm loan application data with inconsistent city names, dates, and numeric formats.", "raw_table": "City,State,BusinessType,LoanAmount,Price,ApplicationDate\nGreen_Vale,TX,Farm-ing,12000,15.5,2022/02/15\nGreenvale,Tx,FARMING,12000.0,15,15-02-2022\nGreenvale,TX,Farmng,12,000,15.50,2022-02-15\nRed-Hill,ca,Ranching,,12.5,03/11/2022\nRedhill,CA,Ranch-ing,15000,12.50,2022/11/03\nredhill,CA,Ranching,15000,12,50,2022-11-03\nSunnyvale,TX,,13000,14.75,2022/03/01\nSunnyvale,Tx,Organic Farming,13000,14.75,01-03-2022\nSunnyvale,Tx,organic-farming,13000,14.75,2022-03-01\nBluefield,WA,Farming,9000,13.0,2022/01/29\nBluefield,WA,Farming,9000,13,00,29-01-2022\nBlue_field,Wa,Farming,9000,13,00,2022-01-29\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens and trim spaces in City", "columnName": "City", "expression": "value.replace(/[_-]/g, '').toTitlecase()"}, {"op": "core/text-transform", "description": "Uppercase State codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType misspellings and variants", "columnName": "BusinessType", "edits": [{"from": ["Farm-ing", "FARMING", "Farmng", "organic-farming", "Organic Farming", "organic farming"], "to": "Farming"}, {"from": ["Ranch-ing"], "to": "Ranching"}, {"from": [null, ""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Normalize LoanAmount numbers, remove commas", "columnName": "LoanAmount", "expression": "value.replace(/[,]/g, '').trim() == '' ? null : Number(value.replace(/[,]/g, ''))"}, {"op": "core/text-transform", "description": "Normalize Price to decimal with dot separator", "columnName": "Price", "expression": "value.replace(/,/g, '.').trim()"}, {"op": "core/text-transform", "description": "Parse and standardize ApplicationDate to yyyy-MM-dd", "columnName": "ApplicationDate", "expression": "date.parse(value).toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,LoanAmount,Price,ApplicationDate\nGreenvale,TX,Farming,12000,15.5,2022-02-15\nGreenvale,TX,Farming,12000,15,2022-02-15\nGreenvale,TX,Farming,12000,15.50,2022-02-15\nRedhill,CA,Ranching,,12.5,2022-03-11\nRedhill,CA,Ranching,15000,12.50,2022-11-03\nRedhill,CA,Ranching,15000,12.50,2022-11-03\nSunnyvale,TX,Unknown,13000,14.75,2022-03-01\nSunnyvale,TX,Farming,13000,14.75,2022-03-01\nSunnyvale,TX,Farming,13000,14.75,2022-03-01\nBluefield,WA,Farming,9000,13.0,2022-01-29\nBluefield,WA,Farming,9000,13.00,2022-01-29\nBluefield,WA,Farming,9000,13.00,2022-01-29\n"}
{"purpose": "Clean and standardize city names, business types, and date formats; fix numeric columns in a telecommunications loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew-york,NY,telecom-company,1000,50000,01/15/2023\nSan_francisco,ca,TeleCom_Operator,1500,70000,2023.02.05\nlos angeles,CA,ISP,1200,,March 10 2023\nChicago,IL,telecom Co.,1100,60000,2023-03-20\nhouston,TX,ISP,950,45000,04/01/23\nPhoenix,AZ,telecom-operator,1100,55000,2023/04/15\nphiladelphia,pa,Telecom company,1050,52000,15-05-2023\nSan Antonio,TX,isp,1150,48000,2023 05 20\nDallas,tx,Telecom-Operator,1000,50000,05-25-2023\nSan_diego,CA,telecom-company,1300,65000,2023.06.01\nAustin,TX,ISP,-1200,47000,06/10/2023\nJacksonville,FL,telecom co,950,43000,06/15/2023\nFort Worth,TX,Telecom Operator,1050,50000,2023-06-20\nColumbus,OH,ISP,1150,49000,06/25/2023", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase().replace(/[_-]/, ' ')", "description": "Standardize city names with title case and replace underscores/hyphens with spaces"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()", "description": "Convert state abbreviations to uppercase"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["telecom-company", "telecom-operator", "Telecom-Operator", "TeleCom_Operator", "telecom co.", "telecom co", "Telecom company", "telecom Co.", "Telecom Operator", "telecom co"], "to": "Telecom Operator"}, {"from": ["ISP", "isp"], "to": "ISP"}, {"from": ["telecom-company"], "to": "Telecom Operator"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "if(isNumber(value) && toNumber(value) > 0, toNumber(value), null)", "description": "Replace negative or invalid price values with null"}, {"op": "core/column-rename", "oldColumnName": "Price", "newColumnName": "UnitPrice", "description": "Rename Price column to UnitPrice for clarity"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "if(value == '' || value == null, null, toNumber(value))", "description": "Convert LoanAmount to numeric, empty strings to null"}, {"op": "core/date-parse", "columnName": "Date", "ignoreError": true, "format": "auto", "description": "Parse Date column to standardized date format"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value.toString('yyyy-MM-dd')", "description": "Format dates uniformly as yyyy-MM-dd"}], "clean_table": "City,State,BusinessType,UnitPrice,LoanAmount,Date\nNew York,NY,Telecom Operator,1000,50000,2023-01-15\nSan Francisco,CA,Telecom Operator,1500,70000,2023-02-05\nLos Angeles,CA,ISP,1200,,2023-03-10\nChicago,IL,Telecom Operator,1100,60000,2023-03-20\nHouston,TX,ISP,950,45000,2023-04-01\nPhoenix,AZ,Telecom Operator,1100,55000,2023-04-15\nPhiladelphia,PA,Telecom Operator,1050,52000,2023-05-15\nSan Antonio,TX,ISP,1150,48000,2023-05-20\nDallas,TX,Telecom Operator,1000,50000,2023-05-25\nSan Diego,CA,Telecom Operator,1300,65000,2023-06-01\nAustin,TX,ISP,,47000,2023-06-10\nJacksonville,FL,Telecom Operator,950,43000,2023-06-15\nFort Worth,TX,Telecom Operator,1050,50000,2023-06-20\nColumbus,OH,ISP,1150,49000,2023-06-25"}
{"purpose": "Clean and standardize farm product sales data including city names, product types, prices, loan amounts, and dates.", "raw_table": "FarmID,City,State,ProductType,Price,LoanAmount,SaleDate\n101,SpringField,IL,coRn,12.5,1500,03-12-2022\n102,oakville,MO,soybean,15.0,1800,2022/04/15\n103,Green_farm,KS,wheat,11.75,,04-30-22\n104,SPRINGFIELD,IL,corn,13.00,1600,2022-05-01\n105,oakville,,SoyBean,14.75,1750,05/10/2022\n106,GreEn-farm,KS,Wheat,12.00,1550,May 15, 2022\n107,,MO,Corn,12.85,1600,2022-06-01\n108,Springfield,il,soy-bean,15.20,1825,06-12-2022\n109,oakville,MO,soybean,15,1800,2022.06.15\n110,Green_farm,KS,wheat,12.30,1580,2022-06-20\n111,Springfield ,IL,corn,13.10,1610,2022-06-25\n112,oakville,MO,,14.90,1790,06/28/2022\n113,green_farm,KS,wheat,12.50,,2022/07/01\n114,SpringField,IL,corn,13.25,1620,07-05-2022", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from City and State columns", "columnName": "City", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace from State", "columnName": "State", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Standardize City names: replace underscores and hyphens with spaces, lowercase then title case", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').toLowercase().replace(/\\b\\w/g, v => v.toUppercase())"}, {"op": "core/mass-edit", "description": "Standardize State codes to uppercase two-letter", "columnName": "State", "edits": [{"from": ["il", "Il", "iL"], "to": "IL"}, {"from": ["mo", "Mo", "mO"], "to": "MO"}, {"from": ["ks", "Ks", "kS"], "to": "KS"}, {"from": [""], "to": ""}]}, {"op": "core/text-transform", "description": "Normalize ProductType values to lowercase, remove hyphens and underscores, then capitalize first letter", "columnName": "ProductType", "expression": "value.toLowercase().replace(/[-_]/g, '').replace(/^(.)/, v => v.toUppercase())"}, {"op": "core/mass-edit", "description": "Fix common misspellings and variations in ProductType", "columnName": "ProductType", "edits": [{"from": ["Corn", "corn", "coRn"], "to": "Corn"}, {"from": ["Soybean", "Soybean", "Soybean"], "to": "Soybean"}, {"from": ["Soybean", "Soybean"], "to": "Soybean"}, {"from": ["Wheat", "wheat"], "to": "Wheat"}, {"from": [""], "to": ""}]}, {"op": "core/text-transform", "description": "Convert Price to number with two decimals", "columnName": "Price", "expression": "isNonBlank(value) ? Number(value).toFixed(2) : ''"}, {"op": "core/text-transform", "description": "Convert LoanAmount to integer, fill missing with 0", "columnName": "LoanAmount", "expression": "isNonBlank(value) ? Number(value).toFixed(0) : '0'"}, {"op": "core/date-parse", "description": "Parse SaleDate into ISO format", "columnName": "SaleDate", "valueType": "date", "dateFormat": "auto", "onError": "keep-original"}], "clean_table": "FarmID,City,State,ProductType,Price,LoanAmount,SaleDate\n101,Springfield,IL,Corn,12.50,1500,2022-03-12\n102,Oakville,MO,Soybean,15.00,1800,2022-04-15\n103,Green Farm,KS,Wheat,11.75,0,2022-04-30\n104,Springfield,IL,Corn,13.00,1600,2022-05-01\n105,Oakville,,Soybean,14.75,1750,2022-05-10\n106,Green Farm,KS,Wheat,12.00,1550,2022-05-15\n107,,MO,Corn,12.85,1600,2022-06-01\n108,Springfield,IL,Soybean,15.20,1825,2022-06-12\n109,Oakville,MO,Soybean,15.00,1800,2022-06-15\n110,Green Farm,KS,Wheat,12.30,1580,2022-06-20\n111,Springfield,IL,Corn,13.10,1610,2022-06-25\n112,Oakville,MO,,14.90,1790,2022-06-28\n113,Green Farm,KS,Wheat,12.50,0,2022-07-01\n114,Springfield,IL,Corn,13.25,1620,2022-07-05"}
{"purpose": "Clean and standardize farm loan application data with consistent capitalization, date formats, and numeric fields.", "raw_table": "Farm_ID,City,State,Crop_Type,Loan_Amount,Application_Date\nF001,Green_field,TX,CoRn,15000,2023/01/15\nF002,oak-vale,ca,WHEAT,20000,15-02-2023\nF003,,TX,Rice,18000,2023-03-05\nF004,Sunnytown,TX,soy-bean,twenty thousand,03/25/2023\nF005,River_side,CA,Wheat,22000,2023.04.01\nF006,Green_field,tx,Corn,15000,2023-01-15\nF007,oak-vale,CA,soybean,NaN,2023/02/20\nF008,SunnyTown,TX,SOY,19500,2023-03-25\nF009,River_Side,ca,Rice,18000,2023-04-01\nF010,GreenField,TX,Corn,15000,01/15/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize City names and replace underscores/hyphens with spaces", "columnName": "City", "expression": "value.replace(/[-_]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Standardize Crop_Type names to capitalized standard names", "columnName": "Crop_Type", "expression": "value.toLowercase().replace('corn', 'Corn').replace('wheat', 'Wheat').replace('rice', 'Rice').replace('soy-bean', 'Soybean').replace('soy', 'Soybean').replace('soybean', 'Soybean')"}, {"op": "core/mass-edit", "description": "Fix common Loan_Amount errors", "columnName": "Loan_Amount", "edits": [{"from": ["twenty thousand", "NaN", ""], "to": "20000"}]}, {"op": "core/text-transform", "description": "Convert Loan_Amount to numeric, removing commas if present", "columnName": "Loan_Amount", "expression": "value.toNumber()"}, {"op": "core/date-parse", "description": "Parse dates in various formats to YYYY-MM-DD", "columnName": "Application_Date", "format": "yyyy-MM-dd"}, {"op": "core/fill-down", "description": "Fill missing City values down", "columnName": "City"}], "clean_table": "Farm_ID,City,State,Crop_Type,Loan_Amount,Application_Date\nF001,Green Field,TX,Corn,15000,2023-01-15\nF002,Oak Vale,CA,Wheat,20000,2023-02-15\nF003,Oak Vale,TX,Rice,18000,2023-03-05\nF004,Sunnytown,TX,Soybean,20000,2023-03-25\nF005,River Side,CA,Wheat,22000,2023-04-01\nF006,Green Field,TX,Corn,15000,2023-01-15\nF007,Oak Vale,CA,Soybean,20000,2023-02-20\nF008,Sunnytown,TX,Soybean,19500,2023-03-25\nF009,River Side,CA,Rice,18000,2023-04-01\nF010,Green Field,TX,Corn,15000,2023-01-15"}
{"purpose": "Clean inconsistent city names, normalize business type entries, and fix date and numeric formats in government loan records.", "raw_table": "City,State,BusinessType,LoanAmount,Price,Date\nnew_york,ny,Resturant,10000,25.5,01/15/2021\nLos-Angeles,CA,retail,20000,30,2021-02-20\nChicago,IL,restaurent,15000,,15-03-2021\nhouston,tx,RETAIL,25000,40,03/25/2021\nPhoenix,az,,18000,35.5,2021/04/10\nphiladelphia,PA,Resturant,17000,28.75,04-15-21\nsan antonio,TX,Retail,22000,38,2021.05.20\nSan Diego,CA,Restaurannt,11000,26,05/22/2021\nDallas,Tx,retail,24000,39,06-01-2021\nSan_Jose,CA,RESTAURANT,13000,27.5,2021/06/15\nAustin,TX,retail,21000,37.5,06-30-2021\nJacksonville,FL,resturant,9000,24,07/10/2021\nFort Worth,tx,RETAIL,23000,39.5,07-20-2021", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names and replace underscores/hyphens with spaces", "columnName": "City", "expression": "value.replace('_',' ').replace('-',' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Uppercase state abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType spellings", "columnName": "BusinessType", "edits": [{"from": ["Resturant", "restaurent", "Restaurannt", "resturant", "RESTAURANT"], "to": "Restaurant"}, {"from": ["retail", "RETAIL", "Retail"], "to": "Retail"}, {"from": [null, ""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Fix Price column to ensure numeric format with two decimals", "columnName": "Price", "expression": "if(value==null || value=='') '', else value.toNumber().toFixed(2)"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number", "columnName": "LoanAmount", "expression": "value.toNumber()"}, {"op": "core/date-parse", "description": "Parse Date column to ISO format", "columnName": "Date", "expression": "value.toDate()"}, {"op": "core/text-transform", "description": "Format Date to yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,LoanAmount,Price,Date\nNew York,NY,Restaurant,10000,25.50,2021-01-15\nLos Angeles,CA,Retail,20000,30.00,2021-02-20\nChicago,IL,Restaurant,15000,,2021-03-15\nHouston,TX,Retail,25000,40.00,2021-03-25\nPhoenix,AZ,Unknown,18000,35.50,2021-04-10\nPhiladelphia,PA,Restaurant,17000,28.75,2021-04-15\nSan Antonio,TX,Retail,22000,38.00,2021-05-20\nSan Diego,CA,Restaurant,11000,26.00,2021-05-22\nDallas,TX,Retail,24000,39.00,2021-06-01\nSan Jose,CA,Restaurant,13000,27.50,2021-06-15\nAustin,TX,Retail,21000,37.50,2021-06-30\nJacksonville,FL,Restaurant,9000,24.00,2021-07-10\nFort Worth,TX,Retail,23000,39.50,2021-07-20"}
{"purpose": "Standardize inconsistent city names and formats in government loan application records.", "raw_table": "ApplicantID,City,State,BusinessType,Price,LoanAmount,ApplicationDate\n001,new_york,NY,retail,120000,50000,2023/02/15\n002,LOS ANGELES,CA,REStauraNt,85000,30000,15-03-2023\n003,ChIcAgo,il,Manufacturing,95000,,2023-04-01\n004,Houston-TX,TX,retail,70000,25000,2023/04/12\n005,phoenix,az,service,65000,20000,04/20/2023\n006,philadelphia,pa,restaurant,90000,35000,2023.05.05\n007,san-antonio,TX,RETAIL,,40000,May 10 2023\n008,san diego,ca,Manufacturing,110000,55000,2023/05/15\n009,dallas,Tx,service,80000,30000,2023-05-20\n010,san jose,CA,restaurant,75000,25000,2023-06-01\n011,Austin TX,TX,RETAIL,68000,27000,2023/06/05\n012,jacksonville,fl,Service,73000,28000,2023/07/01\n013,FORT_WORTH,tx,manufacturing,90000,40000,2023-07-10", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["new_york"], "to": "New York"}, {"from": ["LOS ANGELES"], "to": "Los Angeles"}, {"from": ["ChIcAgo"], "to": "Chicago"}, {"from": ["phoenix"], "to": "Phoenix"}, {"from": ["philadelphia"], "to": "Philadelphia"}, {"from": ["san-antonio"], "to": "San Antonio"}, {"from": ["san diego"], "to": "San Diego"}, {"from": ["dallas"], "to": "Dallas"}, {"from": ["san jose"], "to": "San Jose"}, {"from": ["Austin TX"], "to": "Austin"}, {"from": ["FORT_WORTH"], "to": "Fort Worth"}, {"from": ["Houston-TX"], "to": "Houston"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.trim()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "columnName": "BusinessType", "expression": "value.toLowercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["restauraNt"], "to": "restaurant"}, {"from": ["RETAIL"], "to": "retail"}, {"from": ["Manufacturing"], "to": "manufacturing"}, {"from": ["service"], "to": "service"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value == null || value == '' ? null : Number(value)"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value == null || value == '' ? null : Number(value)"}, {"op": "core/date-parse", "columnName": "ApplicationDate", "options": {"guessCellType": false, "mode": "normal", "format": "yyyy-MM-dd"}}, {"op": "core/text-transform", "columnName": "ApplicationDate", "expression": "if(isDate(value)) value.toString('yyyy-MM-dd') else if(value.match(/^\\d{2}-\\d{2}-\\d{4}$/)) value.toDate('dd-MM-yyyy').toString('yyyy-MM-dd') else if(value.match(/^\\d{2}\\/\\d{2}\\/\\d{4}$/)) value.toDate('MM/dd/yyyy').toString('yyyy-MM-dd') else if(value.match(/^\\d{4}\\/\\d{2}\\/\\d{2}$/)) value.toDate('yyyy/MM/dd').toString('yyyy-MM-dd') else if(value.match(/^\\d{4}\\.\\d{2}\\.\\d{2}$/)) value.toDate('yyyy.MM.dd').toString('yyyy-MM-dd') else if(value.match(/^[A-Za-z]{3} \\d{1,2} \\d{4}$/)) value.toDate('MMM dd yyyy').toString('yyyy-MM-dd') else null"}, {"op": "core/fill-down", "columnName": "LoanAmount"}], "clean_table": "ApplicantID,City,State,BusinessType,Price,LoanAmount,ApplicationDate\n001,New York,NY,retail,120000,50000,2023-02-15\n002,Los Angeles,CA,restaurant,85000,30000,2023-03-15\n003,Chicago,IL,manufacturing,95000,30000,2023-04-01\n004,Houston,TX,retail,70000,25000,2023-04-12\n005,Phoenix,AZ,service,65000,20000,2023-04-20\n006,Philadelphia,PA,restaurant,90000,35000,2023-05-05\n007,San Antonio,TX,retail,null,40000,2023-05-10\n008,San Diego,CA,manufacturing,110000,55000,2023-05-15\n009,Dallas,TX,service,80000,30000,2023-05-20\n010,San Jose,CA,restaurant,75000,25000,2023-06-01\n011,Austin,TX,retail,68000,27000,2023-06-05\n012,Jacksonville,FL,service,73000,28000,2023-07-01\n013,Fort Worth,TX,manufacturing,90000,40000,2023-07-10"}
{"purpose": "Standardize city names, normalize business types, and correct date formats in government loan application data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew-york,ny,RetaIl,120000,50000,01/15/2022\nlos angeles,CA,restaraunt,85000,40000,2022-02-30\nChicago,IL,Consulting,75000,,03-10-2022\nhouston,tx,Retail,95000,45000,03/15/22\nPHOENIX,Az,restaurent, ,55000,2022/04/01\nphiladelphia,pa,Consulting,110000,60000,Apr 5 2022\nsan_antonio,TX,RETAIL,70000,35000,2022.04.10\nsan diego,ca,Consulting,80000,40000,2022/04/15\n_dallas,Tx,restaurnt,90000,45000,04-20-2022\nsan jose,CA,Retail,85000,42000,2022-04-25\nAustin,Tx,Consulting, ,38000,04/30/2022\njacksonville,fl,resturant,67000,34000,05/05/2022\nfort-worth,TX,Retail,72000,36000,2022/05/10\ncolumbus,OH,Consulting,88000,,2022-05-15\ncharlotte,nc,Restaurent,95000,47000,2022-05-20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and remove underscores/hyphens from City", "columnName": "City", "expression": "value.trim().replaceAll(\"[_-]\", \" \").toTitlecase()"}, {"op": "core/text-transform", "description": "Capitalize State abbreviations", "columnName": "State", "expression": "value.toUppercase().trim()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType misspellings and capitalization", "columnName": "BusinessType", "edits": [{"from": ["restaraunt", "restaurent", "restaurent", "restaurnt", "resturant"], "to": "Restaurant"}, {"from": ["retaIl", "RETAIL", "Retail"], "to": "Retail"}, {"from": ["Consulting"], "to": "Consulting"}]}, {"op": "core/text-transform", "description": "Replace blanks in Price and LoanAmount with null", "columnName": "Price", "expression": "value.trim() == \"\" ? null : value"}, {"op": "core/text-transform", "description": "Replace blanks in LoanAmount with null", "columnName": "LoanAmount", "expression": "value.trim() == \"\" ? null : value"}, {"op": "core/text-transform", "description": "Correct invalid ApplicationDate entries to null", "columnName": "ApplicationDate", "expression": "value.match(/^(0?[1-9]|1[012])[\\/\\-](0?[1-9]|[12][0-9]|3[01])[\\/\\-](\\d{4})$/) || value.match(/^\\d{4}[\\/\\-.](0?[1-9]|1[012])[\\/\\-.](0?[1-9]|[12][0-9]|3[01])$/) || value.match(/^[A-Za-z]{3} \\d{1,2} \\d{4}$/) ? value : null"}, {"op": "core/date-parse", "description": "Parse ApplicationDate into standard yyyy-MM-dd", "columnName": "ApplicationDate", "format": "auto"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numbers", "columnName": "Price", "expression": "value == null ? null : Number(value)"}, {"op": "core/text-transform", "description": "Convert LoanAmount to numbers", "columnName": "LoanAmount", "expression": "value == null ? null : Number(value)"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew York,NY,Retail,120000,50000,2022-01-15\nLos Angeles,CA,Restaurant,85000,40000,null\nChicago,IL,Consulting,75000,40000,2022-03-10\nHouston,TX,Retail,95000,45000,2022-03-15\nPhoenix,AZ,Restaurant,null,55000,2022-04-01\nPhiladelphia,PA,Consulting,110000,60000,2022-04-05\nSan Antonio,TX,Retail,70000,35000,2022-04-10\nSan Diego,CA,Consulting,80000,40000,2022-04-15\nDallas,TX,Restaurant,90000,45000,2022-04-20\nSan Jose,CA,Retail,85000,42000,2022-04-25\nAustin,TX,Consulting,null,38000,2022-04-30\nJacksonville,FL,Restaurant,67000,34000,2022-05-05\nFort Worth,TX,Retail,72000,36000,2022-05-10\nColumbus,OH,Consulting,88000,36000,2022-05-15\nCharlotte,NC,Restaurant,95000,47000,2022-05-20"}
{"purpose": "Standardize city and business type names, fix date formats, and clean numeric fields for telecom customer loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,retAiler,100.50,$1,000.00,01-15-2023\nLOS ANGELES,CA,Telecom-Provider,200.00,$2000,15/02/2023\nchicago,IL,retailer, 150 ,1500.5,2023/03/05\nHousTon,TX,telecom_provider, ninety, $1,200,2023-04-01\nphoenix,AZ,,120,1100,4-15-23\nphiladelphia,pa,RETAILER,130,,March 20, 2023\nSan Antonio,TX,TelecomProvider,140.75,$1,400.00,2023.04.25\nsan-diego,ca,Retailer,125,NaN,2023/05/10\nDallas,TX,retAiler, 135,1300,2023-05-15\nsan jose,ca,Telecom_provider, 145.80,1400,2023-6-01\nAustin,TX,Retailer-$,115,1050,06/10/2023\nJacksonville,FL,telecom-provider, 110,1000,June 15 2023\nfort worth,TX,retailer,100,950,6/20/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.toLowercase().replace(/[_-]/, ' ').trim().split(' ').map(word => word.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Fix BusinessType inconsistent naming", "columnName": "BusinessType", "edits": [{"from": ["retAiler", "retailer", "RETAILER", "retAiler", "Retailer-$", "retailer"], "to": "Retailer"}, {"from": ["Telecom-Provider", "telecom_provider", "TelecomProvider", "Telecom_provider", "telecom-provider"], "to": "Telecom Provider"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Clean Price column: remove spaces and convert 'ninety' to 90.0", "columnName": "Price", "expression": "value.trim() == 'ninety' ? '90' : value.replace(/\\s+/g, '')"}, {"op": "core/text-transform", "description": "Clean LoanAmount: remove $ and commas, replace NaN with blank", "columnName": "LoanAmount", "expression": "value.toString().replace(/[$,]/g, '').trim() == 'NaN' ? '' : value.toString().replace(/[$,]/g, '').trim()"}, {"op": "core/date-parse", "description": "Parse Date into yyyy-MM-dd", "columnName": "Date", "format": "yyyy-MM-dd"}, {"op": "core/fill-down", "description": "Fill down missing BusinessType values", "columnName": "BusinessType"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retailer,100.50,1000.00,2023-01-15\nLos Angeles,CA,Telecom Provider,200.00,2000,2023-02-15\nChicago,IL,Retailer,150,1500.5,2023-03-05\nHouston,TX,Telecom Provider,90,1200,2023-04-01\nPhoenix,AZ,Unknown,120,1100,2023-04-15\nPhiladelphia,PA,Retailer,130,,2023-03-20\nSan Antonio,TX,Telecom Provider,140.75,1400.00,2023-04-25\nSan Diego,CA,Retailer,125,,2023-05-10\nDallas,TX,Retailer,135,1300,2023-05-15\nSan Jose,CA,Telecom Provider,145.80,1400,2023-06-01\nAustin,TX,Retailer,115,1050,2023-06-10\nJacksonville,FL,Telecom Provider,110,1000,2023-06-15\nFort Worth,TX,Retailer,100,950,2023-06-20"}
{"purpose": "Normalize city names and standardize date formats in an energy loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar-installation,15000,5000,2023/01/15\nlos-Angeles,CA,Wind_Turbine,20000,7000,15-02-2023\nhouston,tx,solar-installation,13000,,2023-03-10\nChicago,IL,coal_power,18000,6000,03/20/2023\nPhoenix,AZ,solar_installation,14000,4000,March 25 2023\nphiladelphia,pa,Wind turbine,16000,5500,2023.04.10\nSan Antonio,Tx,solar-installation,13500,4800,2023-04-15\nsan_diego,CA,solar_installation,14500,5200,04/20/2023\nDallas,TX,coal-power,17500,5800,2023/04/25\nSan Jose,CA,Solar-Installation,15500,5100,April 30 2023\nAustin,Tx,wind_turbine,16500,6000,05-05-2023\nJacksonville,FL,solarInstallation,,4900,2023/05/10\nFort Worth,TX,coal_power,17000,5900,2023-05-15\nColumbus,OH,wind-turbine,16000,5300,2023/05/20\nCharlotte,NC,solar-installation,15000,5000,2023-05-25", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in City column", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize capitalization in State column", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType values to lowercase with spaces", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[-_]/g, ' ')"}, {"op": "core/mass-edit", "description": "Fix common misspellings and variants in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["solarinstallation", "solar installation", "solarinstallation"], "to": "solar installation"}, {"from": ["wind turbine", "wind turbine", "wind-turbine", "wind turbine"], "to": "wind turbine"}, {"from": ["coal power", "coal-power", "coal_power"], "to": "coal power"}]}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Standardize Price and LoanAmount columns to numbers", "columnName": "Price", "expression": "value ? Number(value) : null"}, {"op": "core/text-transform", "description": "Standardize LoanAmount column to numbers", "columnName": "LoanAmount", "expression": "value ? Number(value) : null"}, {"op": "core/date-parse", "description": "Parse Date column with multiple possible formats", "columnName": "Date", "guessCellType": true, "mode": "lenient", "dateFormats": ["yyyy/MM/dd", "dd-MM-yyyy", "yyyy-MM-dd", "MM/dd/yyyy", "MMMM dd yyyy", "yyyy.MM.dd", "MM-dd-yyyy"]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,solar installation,15000,5000,2023-01-15T00:00:00Z\nLos Angeles,CA,wind turbine,20000,7000,2023-02-15T00:00:00Z\nHouston,TX,solar installation,13000,7000,2023-03-10T00:00:00Z\nChicago,IL,coal power,18000,6000,2023-03-20T00:00:00Z\nPhoenix,AZ,solar installation,14000,4000,2023-03-25T00:00:00Z\nPhiladelphia,PA,wind turbine,16000,5500,2023-04-10T00:00:00Z\nSan Antonio,TX,solar installation,13500,4800,2023-04-15T00:00:00Z\nSan Diego,CA,solar installation,14500,5200,2023-04-20T00:00:00Z\nDallas,TX,coal power,17500,5800,2023-04-25T00:00:00Z\nSan Jose,CA,solar installation,15500,5100,2023-04-30T00:00:00Z\nAustin,TX,wind turbine,16500,6000,2023-05-05T00:00:00Z\nJacksonville,FL,solar installation,,4900,2023-05-10T00:00:00Z\nFort Worth,TX,coal power,17000,5900,2023-05-15T00:00:00Z\nColumbus,OH,wind turbine,16000,5300,2023-05-20T00:00:00Z\nCharlotte,NC,solar installation,15000,5000,2023-05-25T00:00:00Z"}
{"purpose": "Standardize movie release data by correcting titles, normalizing genres, and fixing date formats.", "raw_table": "Title,Genre,Release_Date,Rating,Box_Office\ninception,SCI-FI,07/16/2010,8.8,829895144\nThe Godfather,crime,03-24-1972,9.2,245066411\nAvengers_Endgame,Action,2019/04/26,8.4,2797800564\nParasite,thriller,11/08/2019,8.6,258708790\nJurrasic-park,Adventure,06/11/1993,8.1,1030000000\nThe Shawshank Redemption,Drama,1994-09-23,9.3,28341469\npulp fiction,CRIME,1994/10/14,8.9,213928762\nFight_club,drama,15-10-1999,8.8,100853753\nInterstellar,Sci-Fi,2014-11-07,8.6,677471339\nThe Dark Knight,Action,2008-07-18,9.0,1004558444\nForrest Gump,Drama,1994-07-06,,678226465\nInception,ScI-Fi,16-07-2010,8.8,829895144\njoker,crime,10/04/19,8.5,1074251311", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize first letter of each word in Title and replace underscores/hyphens with spaces", "columnName": "Title", "expression": "value.replace(/[_-]/, ' ').split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1).toLowerCase()).join(' ')"}, {"op": "core/text-transform", "description": "Normalize Genre capitalization", "columnName": "Genre", "expression": "value.toLowerCase().replace('sci-fi','Sci-Fi').replace('crime','Crime').replace('thriller','Thriller').replace('adventure','Adventure').replace('drama','Drama').replace('action','Action')"}, {"op": "core/date-parse", "description": "Parse Release_Date to yyyy-MM-dd", "columnName": "Release_Date", "expression": "value.toDate('MM/dd/yyyy') != null ? value.toDate('MM/dd/yyyy').toString('yyyy-MM-dd') : (value.toDate('yyyy/MM/dd') != null ? value.toDate('yyyy/MM/dd').toString('yyyy-MM-dd') : (value.toDate('MM-dd-yyyy') != null ? value.toDate('MM-dd-yyyy').toString('yyyy-MM-dd') : (value.toDate('yyyy-MM-dd') != null ? value.toDate('yyyy-MM-dd').toString('yyyy-MM-dd') : (value.toDate('dd-MM-yyyy') != null ? value.toDate('dd-MM-yyyy').toString('yyyy-MM-dd') : (value.toDate('dd/MM/yyyy') != null ? value.toDate('dd/MM/yyyy').toString('yyyy-MM-dd') : null)))))"}, {"op": "core/mass-edit", "description": "Fix missing Rating by filling with average rating", "columnName": "Rating", "edits": [{"from": [""], "to": "8.7"}]}, {"op": "core/text-transform", "description": "Convert Rating column to number with one decimal", "columnName": "Rating", "expression": "value.toNumber().toFixed(1)"}, {"op": "core/text-transform", "description": "Convert Box_Office column to number with no commas", "columnName": "Box_Office", "expression": "value.replace(/,/g,'').toNumber()"}], "clean_table": "Title,Genre,Release_Date,Rating,Box_Office\nInception,Sci-Fi,2010-07-16,8.8,829895144\nThe Godfather,Crime,1972-03-24,9.2,245066411\nAvengers Endgame,Action,2019-04-26,8.4,2797800564\nParasite,Thriller,2019-11-08,8.6,258708790\nJurrasic Park,Adventure,1993-06-11,8.1,1030000000\nThe Shawshank Redemption,Drama,1994-09-23,9.3,28341469\nPulp Fiction,Crime,1994-10-14,8.9,213928762\nFight Club,Drama,1999-10-15,8.8,100853753\nInterstellar,Sci-Fi,2014-11-07,8.6,677471339\nThe Dark Knight,Action,2008-07-18,9.0,1004558444\nForrest Gump,Drama,1994-07-06,8.7,678226465\nInception,Sci-Fi,2010-07-16,8.8,829895144\nJoker,Crime,2019-10-04,8.5,1074251311"}
{"purpose": "Standardize city names and business types, fix price and date formats, and clean loan amount values in energy sector data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar_installation,12000,15,000,2023/01/05\nlos angeles,CA,Wind-Turbine,15000,20000,05-12-2023\nChicago,IL,solar Installation,11000,18000,2023.03.10\nhouston,TX,hydro-power,10000,not available,2023/15/04\nphoenix,AZ,,13000,17000,2023-04-20\nphiladelphia,PA,solar_installation,12000.5,16000,April 25 2023\nSAN antonio,TX,wind-turbine,invalid,14000,2023/05/30\nsan diego,CA,Hydro Power,12500,15000,2023-06-01\nDALLAS,TX,solar_installation,11500,15500,2023/07/15\nsan jose,CA,wind turbine,14000,16500,15-08-2023\nAustin,TX,solar_installation,13000,,2023/09/01\njacksonville,FL,hydro_power,10500,13500,2023/10/11\nfort worth,TX,solar-installation,11800,14500,2023-11-25\ncolumbus,OH,Wind_Turbine,15000,17500,2023/12/05", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["los angeles"], "to": "Los Angeles"}, {"from": ["houston"], "to": "Houston"}, {"from": ["philadelphia"], "to": "Philadelphia"}, {"from": ["SAN antonio"], "to": "San Antonio"}, {"from": ["DALLAS"], "to": "Dallas"}, {"from": ["fort worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Solar Installation"}, {"from": ["solar_installation", "solar-installation", "solar Installation"], "to": "Solar Installation"}, {"from": ["Wind-Turbine", "wind turbine", "Wind_Turbine"], "to": "Wind Turbine"}, {"from": ["hydro-power", "hydro_power", "Hydro Power"], "to": "Hydro Power"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "if(value.toLowercase() == 'invalid', null, value.replaceAll(',', '').toNumber())"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value.replaceAll(',', '').match(/\\d+/) ? value.replaceAll(',', '').toNumber() : null"}, {"op": "core/date-parse", "columnName": "Date", "format": "yyyy/MM/dd", "mode": "lenient"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value ? value.toDate().toString('yyyy-MM-dd') : null"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,12000,15000,2023-01-05\nLos Angeles,CA,Wind Turbine,15000,20000,2023-05-12\nChicago,IL,Solar Installation,11000,18000,2023-03-10\nHouston,TX,Hydro Power,10000,null,2023-04-15\nPhoenix,AZ,Solar Installation,13000,17000,2023-04-20\nPhiladelphia,PA,Solar Installation,12000.5,16000,2023-04-25\nSan Antonio,TX,Wind Turbine,null,14000,2023-05-30\nSan Diego,CA,Hydro Power,12500,15000,2023-06-01\nDallas,TX,Solar Installation,11500,15500,2023-07-15\nSan Jose,CA,Wind Turbine,14000,16500,2023-08-15\nAustin,TX,Solar Installation,13000,null,2023-09-01\nJacksonville,FL,Hydro Power,10500,13500,2023-10-11\nFort Worth,TX,Solar Installation,11800,14500,2023-11-25\nColumbus,OH,Wind Turbine,15000,17500,2023-12-05"}
{"purpose": "Standardize and clean city and business type names, fix date formats, and normalize numeric fields in government loan application data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew_york,NY,Restaur-ent,120000,50000,2023/01/15\nlos angeles,CA,retail ,85000,40000,15-02-2023\nChicago,IL,ConsultinG,NaN,30000,2023-03-01\nhouston,TX,restaurent,95000,NaN,03/15/2023\nPHOENIX,AZ,Healthcare,67000,20000,2023-04-10\nphiladelphia,PA,Retail,72000,25000,2023/05/05\nSan-Antonio,TX,consulting,89000,40000,2023-06-20\nSan diego,CA,,78000,35000,2023/07/25\nDallas,TX,Healthcare,NaN,27000,2023-08-12\nSan_Jose,CA,Retail,83000,,2023-09-01\nAustin,TX,restaur-ent,90000,45000,2023-10-15\nJacksonville,FL,Retail,88000,37000,2023-11-30\nFort Worth,TX,Consulting,77000,33000,2023-12-05", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens from City names, capitalize properly", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').toLowercase().split(' ').map(s, s.substring(0,1).toUppercase()+s.substring(1)).join(' ')"}, {"op": "core/text-transform", "description": "Trim trailing spaces and lowercase BusinessType for mass edits", "columnName": "BusinessType", "expression": "value.trim().toLowercase()"}, {"op": "core/mass-edit", "description": "Correct common misspellings and variants in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["restaur-ent", "restaurent"], "to": "Restaurant"}, {"from": ["consulting", "consultingg", "consultinG"], "to": "Consulting"}, {"from": ["retail"], "to": "Retail"}, {"from": ["healthcare"], "to": "Healthcare"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Capitalize BusinessType after mass edit", "columnName": "BusinessType", "expression": "value.split(' ').map(s, s.substring(0,1).toUppercase()+s.substring(1)).join(' ')"}, {"op": "core/text-transform", "description": "Replace 'NaN' or empty Price cells with null", "columnName": "Price", "expression": "value && (value.toLowercase()!='nan') ? value : null"}, {"op": "core/text-transform", "description": "Replace empty LoanAmount with null", "columnName": "LoanAmount", "expression": "value ? value : null"}, {"op": "core/text-transform", "description": "Normalize ApplicationDate to ISO format yyyy-MM-dd", "columnName": "ApplicationDate", "expression": "value.match(/^\\d{4}\\/\\d{2}\\/\\d{2}$/) ? value.replace(/\\//g, '-') : (value.match(/^\\d{2}-\\d{2}-\\d{4}$/) ? value.split('-').reverse().join('-') : value)"}, {"op": "core/date-parse", "description": "Parse ApplicationDate to date type", "columnName": "ApplicationDate", "format": "yyyy-MM-dd"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew York,NY,Restaurant,120000,50000,2023-01-15\nLos Angeles,CA,Retail,85000,40000,2023-02-15\nChicago,IL,Consulting,,30000,2023-03-01\nHouston,TX,Restaurant,95000,,2023-03-15\nPhoenix,AZ,Healthcare,67000,20000,2023-04-10\nPhiladelphia,PA,Retail,72000,25000,2023-05-05\nSan Antonio,TX,Consulting,89000,40000,2023-06-20\nSan Diego,CA,Unknown,78000,35000,2023-07-25\nDallas,TX,Healthcare,,27000,2023-08-12\nSan Jose,CA,Retail,83000,,2023-09-01\nAustin,TX,Restaurant,90000,45000,2023-10-15\nJacksonville,FL,Retail,88000,37000,2023-11-30\nFort Worth,TX,Consulting,77000,33000,2023-12-05"}
{"purpose": "Standardize city names and business types, normalize date formats, and fix numeric fields in government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,restaurant,100000,50000,12/31/2021\nlos-angeles,CA,Retaurant,150000,75000,31-01-2022\nChicago,IL,STORE,85000,,2022/02/28\nhouston,TX,store,90000,45000,03/15/22\nphoenix,AZ,retail_store,120000,60000,2022.04.01\nphiladelphia,PA,Restuarant,110000,55000,April 5 2022\nsanantonio,TX,RETAIL-STORE,95000,47500,2022-04-10\nsan-diego,CA,restaurant,102000,51000,2022/13/04\nDallas,TX,,97000,48500,05/20/2022\nsan_jose,CA,store,88000,44000,2022-06-01\nAustin,TX,restaurant,93000,46500,2022/06/15\njacksonville,FL,store,87000,43500,2022-07-01\nfort worth,TX,RETAIL_STORE,94000,47000,07/15/2022\ncolumbus,OH,restaurant,91000,45500,2022-08-01\ncharlotte,NC,retail-store,96000,48000,2022-08-15", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["los-angeles"], "to": "Los Angeles"}, {"from": ["sanantonio"], "to": "San Antonio"}, {"from": ["san-diego"], "to": "San Diego"}, {"from": ["san_jose"], "to": "San Jose"}, {"from": ["fort worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.split(/[_\\-]/).map(s => s.toLowerCase().capitalize()).join(' ')", "description": "Capitalize city names and replace underscores/hyphens with spaces"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["Retaurant", "Restuarant", "restaurant", "RESTAURANT"], "to": "Restaurant"}, {"from": ["store", "STORE"], "to": "Store"}, {"from": ["retail_store", "RETAIL_STORE", "retail-store", "RETAIL-STORE"], "to": "Retail Store"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.toNumber()", "description": "Convert Price to number"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value == null || value.trim() == '' ? null : value.toNumber()", "description": "Convert LoanAmount to number and nullify empty"}, {"op": "core/date-parse", "columnName": "Date", "options": {"mode": "lenient", "format": null, "guessCell": true, "guessFormat": true, "preferMonthFirst": true, "outputFormat": "yyyy-MM-dd"}, "description": "Normalize Date column to yyyy-MM-dd"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Unknown"}]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,100000,50000,2021-12-31\nLos Angeles,CA,Restaurant,150000,75000,2022-01-31\nChicago,IL,Store,85000,,2022-02-28\nHouston,TX,Store,90000,45000,2022-03-15\nPhoenix,AZ,Retail Store,120000,60000,2022-04-01\nPhiladelphia,PA,Restaurant,110000,55000,2022-04-05\nSan Antonio,TX,Retail Store,95000,47500,2022-04-10\nSan Diego,CA,Restaurant,102000,51000,2022-04-13\nDallas,TX,Unknown,97000,48500,2022-05-20\nSan Jose,CA,Store,88000,44000,2022-06-01\nAustin,TX,Restaurant,93000,46500,2022-06-15\nJacksonville,FL,Store,87000,43500,2022-07-01\nFort Worth,TX,Retail Store,94000,47000,2022-07-15\nColumbus,OH,Restaurant,91000,45500,2022-08-01\nCharlotte,NC,Retail Store,96000,48000,2022-08-15"}
{"purpose": "Clean inconsistent city names, normalize business type entries, and correct date formats for telecom loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,Telecom-Provider,1500,5000,2023/04/31\nlos angeles,CA,TELCOM provider,1200,4500,04-12-2023\nChicago,il,telecom provider,1300,4800,2023.05.10\nhouston,TX,Telecom_provider,1400,5200,May 15 2023\nPHOENIX,az,telecomProvider,1250,4700,\nphiladelphia,PA,Tele-Provider,1350,4900,2023/06/01\nSan_Antonio,TX,telecom provider,1100,4300,2023-05-20\nSan Diego,CA,Telecom_Provider,1150,4400,2023/13/05\nDallas,tx,telecom-ProVider,1400,5100,2023-05-25\nSan Jose ,CA,telecom provider,1300,4850,2023-05-15\nAustin,tx,TEL-COM PROVIDER,1250,,2023/05/18\nJacksonville,fl,Telecom Provider,1200,4450,2023/05/22\nFort Worth,TX,telecomprovider,1100,4300,May 30, 2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names by removing underscores and trimming spaces", "columnName": "City", "expression": "value.replace('_', ' ').trim().toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType entries to 'Telecom Provider'", "columnName": "BusinessType", "edits": [{"from": ["Telecom-Provider", "TELCOM provider", "telecom provider", "Telecom_provider", "telecomProvider", "Tele-Provider", "telecom provider", "Telecom_Provider", "telecom-ProVider", "TEL-COM PROVIDER", "telecomprovider", "Telecom Provider"], "to": "Telecom Provider"}]}, {"op": "core/text-transform", "description": "Fix known date format issues and parse into ISO format string", "columnName": "Date", "expression": "if(value=='') null else if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/)) {\n  // fix invalid date 2023/04/31 to 2023-04-30\n  var parts = value.split('/');\n  var y=parts[0]; var m=parts[1]; var d=parts[2];\n  if(d == '31' && (m=='04' || m=='06' || m=='09' || m=='11')) d='30';\n  y+'-'+m+'-'+d\n} else if(value.match(/\\d{2}-\\d{2}-\\d{4}/)) {\n  // MM-DD-YYYY to YYYY-MM-DD\n  var parts=value.split('-');\n  parts[2]+'-'+parts[0]+'-'+parts[1]\n} else if(value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/)) {\n  // YYYY.MM.DD to YYYY-MM-DD\n  value.replace('.', '-').replace('.', '-')\n} else if(value.match(/[A-Za-z]+\\s\\d{1,2}\\s\\d{4}/)) {\n  // parse 'May 15 2023' or 'May 30, 2023'\n  var dt=toDate(value);\n  dt==null ? null : dt.toISOString().substring(0,10)\n} else if(value.match(/\\d{4}-\\d{2}-\\d{2}/)) {\n  value\n} else null"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Trim whitespace from City and BusinessType", "columnName": "City", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace from BusinessType", "columnName": "BusinessType", "expression": "value.trim()"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom Provider,1500,5000,2023-04-30\nLos Angeles,CA,Telecom Provider,1200,4500,2023-04-12\nChicago,IL,Telecom Provider,1300,4800,2023-05-10\nHouston,TX,Telecom Provider,1400,5200,2023-05-15\nPhoenix,AZ,Telecom Provider,1250,4700,\nPhiladelphia,PA,Telecom Provider,1350,4900,2023-06-01\nSan Antonio,TX,Telecom Provider,1100,4300,2023-05-20\nSan Diego,CA,Telecom Provider,1150,4400,2023-05-13\nDallas,TX,Telecom Provider,1400,5100,2023-05-25\nSan Jose,CA,Telecom Provider,1300,4850,2023-05-15\nAustin,TX,Telecom Provider,1250,4850,2023-05-18\nJacksonville,FL,Telecom Provider,1200,4450,2023-05-22\nFort Worth,TX,Telecom Provider,1100,4300,2023-05-30"}
{"purpose": "Clean and standardize city names, business types, and date formats; correct numeric fields and fill missing values in a telecommunications loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew-york,NY,Wireless,299.99,10000,01/15/2022\nlos angeles,CA,wire-less,399.99,15000,2022-02-20\nCHICAGO,IL,WireLess,NaN,12000,03/05/2022\nhouston,TX,wireless,350,NaN,2022/04/10\nPHOENIX,az,Wireless,320.00,11000,15-05-2022\nphiladelphia,PA,wire_less,NaN,13000,2022-06-01\nsan antonio,TX,Wireless,340.5,14000,\nSan_diego,CA,wireless,360.00,NaN,2022-07-15\nDALLAS,tx,wireless,370.00,12500,2022-08-20\nsan jose,CA,wire_less,355.00,13500,08/25/2022\nAustin,TX,wireless,NaN,NaN,2022-09-10\nJacksonville,fl,Wireless,330.00,11500,2022-10-05\nfort worth,TX,,345.00,NaN,2022-11-12\nColumbus,OH,wireless,325.00,11200,2022-12-01\ncharlotte,NC,wire_less,355,13000,12/15/2022", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens from City names and capitalize each word", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').split(' ').map(w, w.trim().toLowerCase().replace(/^./, c, c.toUpperCase())).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase State abbreviations", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["wire-less", "wire_less", "Wireless", "wireless", "WireLess", "wire_less"], "to": "Wireless"}]}, {"op": "core/mass-edit", "description": "Fill missing BusinessType with 'Wireless'", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Wireless"}]}, {"op": "core/text-transform", "description": "Parse dates to ISO format yyyy-MM-dd", "columnName": "Date", "expression": "value.length() == 0 ? null : value.match(/\\d{4}-\\d{2}-\\d{2}/) ? value : (date.parse(value).toString(\"yyyy-MM-dd\"))"}, {"op": "core/mass-edit", "description": "Replace 'NaN' strings with empty for Price and LoanAmount", "columnName": "Price", "edits": [{"from": ["NaN"], "to": ""}]}, {"op": "core/mass-edit", "description": "Replace 'NaN' strings with empty for LoanAmount", "columnName": "LoanAmount", "edits": [{"from": ["NaN"], "to": ""}]}, {"op": "core/fill-down", "description": "Fill down missing Price values with mean price approximation", "columnName": "Price"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values with mean loan amount approximation", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Convert Price to two decimal format", "columnName": "Price", "expression": "isNaN(value) || value == null || value == '' ? '' : (value + 0).toFixed(2)"}, {"op": "core/text-transform", "description": "Convert LoanAmount to integer string", "columnName": "LoanAmount", "expression": "isNaN(value) || value == null || value == '' ? '' : String(Math.round(value))"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Wireless,299.99,10000,2022-01-15\nLos Angeles,CA,Wireless,399.99,15000,2022-02-20\nChicago,IL,Wireless,342.55,12000,2022-03-05\nHouston,TX,Wireless,350.00,12388,2022-04-10\nPhoenix,AZ,Wireless,320.00,11000,2022-05-15\nPhiladelphia,PA,Wireless,342.55,13000,2022-06-01\nSan Antonio,TX,Wireless,340.50,14000,\nSan Diego,CA,Wireless,360.00,12388,2022-07-15\nDallas,TX,Wireless,370.00,12500,2022-08-20\nSan Jose,CA,Wireless,355.00,13500,2022-08-25\nAustin,TX,Wireless,342.55,12388,2022-09-10\nJacksonville,FL,Wireless,330.00,11500,2022-10-05\nFort Worth,TX,Wireless,345.00,12388,2022-11-12\nColumbus,OH,Wireless,325.00,11200,2022-12-01\nCharlotte,NC,Wireless,355.00,13000,2022-12-15"}
{"purpose": "Clean and standardize customer records with inconsistent city names, business types, and malformed dates in a telecommunications dataset.", "raw_table": "CustomerID,City,State,BusinessType,MonthlyCharge,LoanAmount,RegistrationDate\n101,New-York,ny,Retail_store,75.5,5000,12/31/2020\n102,los_angeles,CA,Wholesale ,85.00,,2020-13-01\n103,Chicago,IL,retail store,65.75,3000,2021-02-28\n104,Houston,Tx,Retail-Store,70.00,4500,03-15-2021\n105,phoenix,AZ,wholesale,80.,4000,2021-04-31\n106,Philadelphia,PA,Retail_store,69.99,3500,2021/05/20\n107,San Antonio,TX, WholesAle,90.5,4200,May 25 2021\n108,san-diego,CA,Retail store,NaN,3800,2021-06-15\n109,Dallas,TX,retail_store,72.00,3900,2021-07-07\n110,San Jose,CA,Wholesale,85.00,4100,2021-07-25\n111,Austin,TX,retail-store,68.00,NaN,2021-08-10\n112,Jacksonville,FL,Retail Store,70.5,3600,2021-09-01\n113,Fort-Worth,TX,Wholesale,82.00,4300,2021/09/15\n114,Columbus,OH,Retail_Store,67.00,3400,2021-10-10\n115,Charlotte,NC,wholesale,88.00,4500,2021-11-31", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names by replacing underscores and hyphens with spaces and capitalizing each word", "columnName": "City", "expression": "value.replace(/[_-]/g,' ').split(' ').map(w, w[0].toUpperCase()+w.slice(1).toLowerCase()).join(' ')"}, {"op": "core/text-transform", "description": "Trim extra spaces and lowercase BusinessType for consistent mapping", "columnName": "BusinessType", "expression": "value.trim().toLowerCase()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["retail store", "retail_store", "retail-store"], "to": "Retail Store"}, {"from": ["wholesale", "wholesale "], "to": "Wholesale"}]}, {"op": "core/text-transform", "description": "Convert State to uppercase", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/text-transform", "description": "Fix malformed MonthlyCharge values by converting to number or null", "columnName": "MonthlyCharge", "expression": "isNaN(toNumber(value)) ? null : toNumber(value)"}, {"op": "core/text-transform", "description": "Fix malformed LoanAmount values by converting to number or null", "columnName": "LoanAmount", "expression": "isNaN(toNumber(value)) ? null : toNumber(value)"}, {"op": "core/text-transform", "description": "Parse RegistrationDate using multiple date formats and output ISO format", "columnName": "RegistrationDate", "expression": "value.match(/\\d{4}-\\d{2}-\\d{2}/) ? value : (value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/) ? toDate(value, 'MM/dd/yyyy').toString('yyyy-MM-dd') : (value.match(/[A-Za-z]{3,} \\d{1,2} \\d{4}/) ? toDate(value, 'MMM dd yyyy').toString('yyyy-MM-dd') : (value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/) ? toDate(value, 'yyyy/MM/dd').toString('yyyy-MM-dd') : null)))"}, {"op": "core/mass-edit", "description": "Correct invalid dates such as 2021-04-31 and 2021-11-31 by setting to null", "columnName": "RegistrationDate", "edits": [{"from": ["2021-04-31", "2021-11-31"], "to": null}]}], "clean_table": "CustomerID,City,State,BusinessType,MonthlyCharge,LoanAmount,RegistrationDate\n101,New York,NY,Retail Store,75.5,5000,2020-12-31\n102,Los Angeles,CA,Wholesale,85, null,2020-01-13\n103,Chicago,IL,Retail Store,65.75,3000,2021-02-28\n104,Houston,TX,Retail Store,70,4500,2021-03-15\n105,Phoenix,AZ,Wholesale,80,4000,null\n106,Philadelphia,PA,Retail Store,69.99,3500,2021-05-20\n107,San Antonio,TX,Wholesale,90.5,4200,2021-05-25\n108,San Diego,CA,Retail Store,null,3800,2021-06-15\n109,Dallas,TX,Retail Store,72,3900,2021-07-07\n110,San Jose,CA,Wholesale,85,4100,2021-07-25\n111,Austin,TX,Retail Store,68,null,2021-08-10\n112,Jacksonville,FL,Retail Store,70.5,3600,2021-09-01\n113,Fort Worth,TX,Wholesale,82,4300,2021-09-15\n114,Columbus,OH,Retail Store,67,3400,2021-10-10\n115,Charlotte,NC,Wholesale,88,4500,null"}
{"purpose": "Clean inconsistent city names and standardize business types and date formats in telecom loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_York,ny,Telecom Provider,5000,15000,2023/01/15\nlos-angeles,CA,telecom  provider,4500,14000,15-02-2023\nChicago,IL,Telecom_Provider,4800,missing,2023.03.10\nhouston,TX,telecome provider,4700,16000,2023-04-05\nPHOENIX,az,Telecom-provider,5300,,2023/05/30\nphiladelphia,PA,telecom provider,4900,15500,06/15/2023\nsan antonio,Tx,telecom provider,missing,14500,2023-07-20\nSan_Diego,CA,Telecom Provider,5200,15000,2023.08.25\nDALLAS,tx,telecom-provider,5100,15800,2023-09-10\nSan jose,CA,telecom_provider,4950,15200,2023-10-05\nAustin,Tx,telecom provider,4800,15000,11-15-2023\nJacksonville,FL,TELECOM PROVIDER,4700,14900,2023/12/01\nFort Worth,TX,telecom-provider,4600,14800,12.20.2023\nColumbus,oh,telecom_provider,4550,14700,2023-12-31", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize capitalization and replace underscores/hyphens in City", "columnName": "City", "expression": "value.toLowercase().replace('_',' ').replace('-',' ').split(' ').map(s, s[0].toUppercase()+s.substring(1)).join(' ')"}, {"op": "core/text-transform", "description": "Standardize State to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Trim whitespace and standardize BusinessType to 'Telecom Provider'", "columnName": "BusinessType", "expression": "\"Telecom Provider\""}, {"op": "core/mass-edit", "description": "Replace 'missing' and empty Price with '0'", "columnName": "Price", "edits": [{"from": ["missing", ""], "to": "0"}]}, {"op": "core/mass-edit", "description": "Replace 'missing' and empty LoanAmount with '0'", "columnName": "LoanAmount", "edits": [{"from": ["missing", ""], "to": "0"}]}, {"op": "core/text-transform", "description": "Normalize Date formats into yyyy-MM-dd", "columnName": "Date", "expression": "value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/) ? value.replace(/\\//g,'-') : (value.match(/\\d{2}-\\d{2}-\\d{4}/) ? value.split('-')[2] + '-' + value.split('-')[1] + '-' + value.split('-')[0] : (value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/) ? value.replace(/\\./g,'-') : (value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/) ? value.split('/')[2] + '-' + value.split('/')[0].padStart(2,'0') + '-' + value.split('/')[1].padStart(2,'0') : (value.match(/\\d{2}\\.\\d{2}\\.\\d{4}/) ? value.split('.')[2] + '-' + value.split('.')[0].padStart(2,'0') + '-' + value.split('.')[1].padStart(2,'0') : value)))) )"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom Provider,5000,15000,2023-01-15\nLos Angeles,CA,Telecom Provider,4500,14000,2023-02-15\nChicago,IL,Telecom Provider,4800,0,2023-03-10\nHouston,TX,Telecom Provider,4700,16000,2023-04-05\nPhoenix,AZ,Telecom Provider,5300,0,2023-05-30\nPhiladelphia,PA,Telecom Provider,4900,15500,2023-06-15\nSan Antonio,TX,Telecom Provider,0,14500,2023-07-20\nSan Diego,CA,Telecom Provider,5200,15000,2023-08-25\nDallas,TX,Telecom Provider,5100,15800,2023-09-10\nSan Jose,CA,Telecom Provider,4950,15200,2023-10-05\nAustin,TX,Telecom Provider,4800,15000,2023-11-15\nJacksonville,FL,Telecom Provider,4700,14900,2023-12-01\nFort Worth,TX,Telecom Provider,4600,14800,2023-12-20\nColumbus,OH,Telecom Provider,4550,14700,2023-12-31"}
{"purpose": "Standardize city and crop type names, fix numeric formats, and parse dates in an agriculture loan dataset.", "raw_table": "City,State,Crop_Type,Loan_Amount,Price_per_Ton,Planting_Date\nDAllas,TX,Corn,10000,250.5,03-15-2023\nhouston,tx,WHEAT,8500,200.45,2023/04/01\nAustin,TX,Rice,NaN,180.0,15-04-2023\nSan-Antonio,TX,C0rn,12000,260,2023-03-30\nDallas,tx,soy_bean,9000,NaN,2023/03/10\nhouston,TX,wheat,8800,199,03-28-2023\nAustin,Tx,Rice,9500,182.75,April 5 2023\nSan Antonio,TX,soybean,9200,210,2023-04-01\nDALlAS,TX,corn,10500,255.0,03/20/2023\nHouston,TX,Wheat,8700,198.5,2023-03-25\nAUSTIN,TX,Rice,9800,185,2023.04.07\nSan-Antonio,TX,soybean,9400,215.0,2023-04-03", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize City names properly and remove hyphens", "columnName": "City", "expression": "value.toLowercase().replace(/-/,' ').split(' ').map(s, s[0].toUppercase() + s.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Standardize State to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix Crop_Type misspellings and format", "columnName": "Crop_Type", "edits": [{"from": ["C0rn", "corn", "CORN"], "to": "Corn"}, {"from": ["soy_bean", "soybean"], "to": "Soybean"}, {"from": ["WHEAT", "wheat", "Wheat"], "to": "Wheat"}, {"from": ["Rice", "rice", "RICE"], "to": "Rice"}]}, {"op": "core/mass-edit", "description": "Replace missing Loan_Amount with 0", "columnName": "Loan_Amount", "edits": [{"from": ["NaN", ""], "to": "0"}]}, {"op": "core/text-transform", "description": "Normalize Price_per_Ton to have two decimal places and fill missing with 0", "columnName": "Price_per_Ton", "expression": "value==null || value=='' || value=='NaN' ? '0.00' : Number(value).toFixed(2)"}, {"op": "core/date-parse", "description": "Parse Planting_Date into ISO format yyyy-MM-dd", "columnName": "Planting_Date", "dateFormat": "auto-detect", "mode": "normal"}], "clean_table": "City,State,Crop_Type,Loan_Amount,Price_per_Ton,Planting_Date\nDallas,TX,Corn,10000,250.50,2023-03-15\nHouston,TX,Wheat,8500,200.45,2023-04-01\nAustin,TX,Rice,0,180.00,2023-04-15\nSan Antonio,TX,Corn,12000,260.00,2023-03-30\nDallas,TX,Soybean,9000,0.00,2023-03-10\nHouston,TX,Wheat,8800,199.00,2023-03-28\nAustin,TX,Rice,9500,182.75,2023-04-05\nSan Antonio,TX,Soybean,9200,210.00,2023-04-01\nDallas,TX,Corn,10500,255.00,2023-03-20\nHouston,TX,Wheat,8700,198.50,2023-03-25\nAustin,TX,Rice,9800,185.00,2023-04-07\nSan Antonio,TX,Soybean,9400,215.00,2023-04-03"}
{"purpose": "Standardize city and business type names, fix date formats, and correct numeric values for energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew-york,NY,solar_installation,50000,100000,12/01/2023\nlos_angeles,CA,Wind_Farm,75000,150000,2023-02-15\nhouston,tx,solar-Install,60000,abc,03-10-2023\nCHICAGO,IL,solar Installation, ,120000,2023/04/05\nPhoenix,AZ,wind_farm,85000,160000,April 15 2023\nphiladelphia,PA,solar_install,55000,110000,2023.05.20\nSan Antonio,TX,Wind-Farm,70000,140000,5/25/2023\nsan_diego,ca,,65000,130000,2023-06-01\nDallas,TX,solar_installation,58000,,06-10-2023\nSan Jose,ca,solar_install,62000,124000,2023/07/15\nAustin,TX,Wind-Farm,72000,145000,2023-08-20\nJacksonville,FL,solar_installation,59000,118000,08/25/2023\nfort-worth,tx,windfarm,70000,140000,2023-09-10\nColumbus,OH,solar_install,53000,106000,September 15, 2023\nCharlotte,NC,Wind_Farm,68000,136000,2023-10-01", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["new-york"], "to": "New York"}, {"from": ["los_angeles"], "to": "Los Angeles"}, {"from": ["houston"], "to": "Houston"}, {"from": ["philadelphia"], "to": "Philadelphia"}, {"from": ["san_diego"], "to": "San Diego"}, {"from": ["fort-worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["solar_installation", "solar-Install", "solar Installation", "solar_install", "solar_installation"], "to": "Solar Installation"}, {"from": ["wind_farm", "Wind_Farm", "Wind-Farm", "windfarm"], "to": "Wind Farm"}, {"from": [null, ""], "to": "Unknown"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.trim() == '' ? null : Number(value)"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "isNaN(Number(value)) ? null : Number(value)"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value", "onError": "set-to-null"}, {"op": "core/column-rename", "oldColumnName": "Price", "newColumnName": "PriceUSD"}, {"op": "core/column-rename", "oldColumnName": "LoanAmount", "newColumnName": "LoanAmountUSD"}], "clean_table": "City,State,BusinessType,PriceUSD,LoanAmountUSD,Date\nNew York,NY,Solar Installation,50000,100000,2023-12-01T00:00:00Z\nLos Angeles,CA,Wind Farm,75000,150000,2023-02-15T00:00:00Z\nHouston,TX,Solar Installation,60000,null,2023-03-10T00:00:00Z\nChicago,IL,Solar Installation,null,120000,2023-04-05T00:00:00Z\nPhoenix,AZ,Wind Farm,85000,160000,2023-04-15T00:00:00Z\nPhiladelphia,PA,Solar Installation,55000,110000,2023-05-20T00:00:00Z\nSan Antonio,TX,Wind Farm,70000,140000,2023-05-25T00:00:00Z\nSan Diego,CA,Unknown,65000,130000,2023-06-01T00:00:00Z\nDallas,TX,Solar Installation,58000,null,2023-06-10T00:00:00Z\nSan Jose,CA,Solar Installation,62000,124000,2023-07-15T00:00:00Z\nAustin,TX,Wind Farm,72000,145000,2023-08-20T00:00:00Z\nJacksonville,FL,Solar Installation,59000,118000,2023-08-25T00:00:00Z\nFort Worth,TX,Wind Farm,70000,140000,2023-09-10T00:00:00Z\nColumbus,OH,Solar Installation,53000,106000,2023-09-15T00:00:00Z\nCharlotte,NC,Wind Farm,68000,136000,2023-10-01T00:00:00Z"}
{"purpose": "Standardize and clean farm equipment sales records with inconsistent naming, formats, and missing values.", "raw_table": "FarmID,City,State,EquipmentType,Price,LoanAmount,SaleDate\n001,Green-Field,TX,TrActor,15000,12000,03/15/2023\n002,oak valley,tx,combine-harvester,85000,,2023-04-10\n003,Sunset_City,CA,plow,3500,3000,15-05-2023\n004,,CA,Seeder,4500,4500,2023/06/01\n005,Greenfield,TX,Tractor,,10000,06/20/2023\n006,oak Valley,TX,Plow,4000,3500,2023-07-15\n007,Sunset city,ca,combine harvester,87000,80000,July 5, 2023\n008,Green-Field,Tx,Seeder,4600,4600,2023-08-01\n009,oak valley,TX,tracTOR,16000,14000,08-15-2023\n010,Sunset_City,CA,Combine-Harvester,,85000,2023/09/10\n011,Greenfield,tx,Plow,3800,3800,2023-10-05\n012,,CA,Seeder,4700,,2023-11-01", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["Green-Field", "Greenfield", "Green-Field", "Greenfield"], "to": "Greenfield"}, {"from": ["oak valley", "oak Valley", "oak valley"], "to": "Oak Valley"}, {"from": ["Sunset_City", "Sunset city", "Sunset_City"], "to": "Sunset City"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitleCase()"}, {"op": "core/mass-edit", "columnName": "State", "edits": [{"from": ["tx", "Tx", "TX"], "to": "TX"}, {"from": ["ca", "CA"], "to": "CA"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "columnName": "EquipmentType", "expression": "value.toLowercase().replace(/[-_]/, ' ').trim()"}, {"op": "core/mass-edit", "columnName": "EquipmentType", "edits": [{"from": ["tractor", "tracTOR", "tractOR", "trActor"], "to": "Tractor"}, {"from": ["combine harvester", "combine-harvester", "combine-harvester", "combine harvester"], "to": "Combine Harvester"}, {"from": ["plow"], "to": "Plow"}, {"from": ["seeder"], "to": "Seeder"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.trim() === '' ? null : Number(value)"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value.trim() === '' ? null : Number(value)"}, {"op": "core/date-parse", "columnName": "SaleDate", "expression": "value.replace(/(\\d{2})-(\\d{2})-(\\d{4})/, '$2/$1/$3').replace(/-/g, '/').replace(/,/, '').trim()", "ignoreFailure": false, "dateFormat": "MM/dd/yyyy"}, {"op": "core/fill-down", "columnName": "City"}, {"op": "core/fill-down", "columnName": "State"}], "clean_table": "FarmID,City,State,EquipmentType,Price,LoanAmount,SaleDate\n001,Greenfield,TX,Tractor,15000,12000,03/15/2023\n002,Oak Valley,TX,Combine Harvester,85000,,04/10/2023\n003,Sunset City,CA,Plow,3500,3000,05/15/2023\n004,Unknown,CA,Seeder,4500,4500,06/01/2023\n005,Greenfield,TX,Tractor,,10000,06/20/2023\n006,Oak Valley,TX,Plow,4000,3500,07/15/2023\n007,Sunset City,CA,Combine Harvester,87000,80000,07/05/2023\n008,Greenfield,TX,Seeder,4600,4600,08/01/2023\n009,Oak Valley,TX,Tractor,16000,14000,08/15/2023\n010,Sunset City,CA,Combine Harvester,,85000,09/10/2023\n011,Greenfield,TX,Plow,3800,3800,10/05/2023\n012,Unknown,CA,Seeder,4700,,11/01/2023"}
{"purpose": "Standardize city names and business types, fix date formats, and clean numeric fields in government loan application data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew_york,NY,REtail,100000,50000,01-15-2023\nlos Angeles,CA,Retail,-200000,75000,2023/02/20\nchicago,il,wholesAling,300000,NA,15-03-2023\nHouston,TX,retail, ,100000,2023-04-10\nPhoenix,az,Wholesaling,250000,125000,04/25/2023\nphiladelphia,PA,Retail,180000,90000,May 5 2023\nsan antonio,tx,retail,175000,87500,2023.06.01\nSan-diego,CA,wholesaling,160000,80000,06-15-2023\nDallas,TX,Retail,140000,70000,2023/07/01\nSan jose,ca,Wholesaling,130000,65000,07-20-2023\nAustin,TX,Retail,120,000,60000,08-05-2023\njacksonville,fl,retail,110000,55000,2023-08-15\nfort worth,TX,wholesaling,105000,52500,08/30/2023\ncolumbus,OH,Retail,,50000,September 5 2023\ncharlotte,nc,Retail,95000,47500,2023-09-20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names with space", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()", "onError": "keep-original"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["REtail", "retail", "Retail"], "to": "Retail"}, {"from": ["wholesAling", "Wholesaling", "wholesaling"], "to": "Wholesaling"}]}, {"op": "core/text-transform", "description": "Fix Price field to be numeric without commas or spaces", "columnName": "Price", "expression": "value.replace(/[^0-9.]/g, '').trim()", "onError": "set-to-blank"}, {"op": "core/mass-edit", "description": "Fix missing Price values to blank", "columnName": "Price", "edits": [{"from": ["", " "], "to": ""}]}, {"op": "core/text-transform", "description": "Convert ApplicationDate to ISO format YYYY-MM-DD", "columnName": "ApplicationDate", "expression": "if(value.match(/\\d{4}-\\d{2}-\\d{2}/)) value else if(value.match(/(\\d{2})-(\\d{2})-(\\d{4})/)) { var parts = value.split('-'); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0') } else if(value.match(/(\\d{4})\\/(\\d{2})\\/(\\d{2})/)) { var parts = value.split('/'); parts[0] + '-' + parts[1] + '-' + parts[2] } else if(value.match(/(\\d{2})\\/(\\d{2})\\/(\\d{4})/)) { var parts = value.split('/'); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0') } else if(value.match(/[A-Za-z]+ \\d{1,2} \\d{4}/)) { var d = new Date(value); d.getFullYear() + '-' + (d.getMonth()+1).toString().padStart(2,'0') + '-' + d.getDate().toString().padStart(2,'0') } else if(value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/)) { value.replace('.', '-').replace('.', '-') } else value", "onError": "keep-original"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values if any", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Convert LoanAmount to numeric and fix NA values", "columnName": "LoanAmount", "expression": "value.toLowercase() == 'na' || value.trim() == '' ? '' : value", "onError": "set-to-blank"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew York,NY,Retail,100000,50000,2023-01-15\nLos Angeles,CA,Retail,200000,75000,2023-02-20\nChicago,IL,Wholesaling,300000,,2023-03-15\nHouston,TX,Retail,,100000,2023-04-10\nPhoenix,AZ,Wholesaling,250000,125000,2023-04-25\nPhiladelphia,PA,Retail,180000,90000,2023-05-05\nSan Antonio,TX,Retail,175000,87500,2023-06-01\nSan Diego,CA,Wholesaling,160000,80000,2023-06-15\nDallas,TX,Retail,140000,70000,2023-07-01\nSan Jose,CA,Wholesaling,130000,65000,2023-07-20\nAustin,TX,Retail,120000,60000,2023-08-05\nJacksonville,FL,Retail,110000,55000,2023-08-15\nFort Worth,TX,Wholesaling,105000,52500,2023-08-30\nColumbus,OH,Retail,,50000,2023-09-05\nCharlotte,NC,Retail,95000,47500,2023-09-20"}
{"purpose": "Standardize and clean agricultural loan application data including city names, business types, dates, and numeric values.", "raw_table": "ApplicantID,City,State,BusinessType,LoanAmount,Price,ApplicationDate\n1001,new-york,NY,grain_farming,250000,15000,01/15/2023\n1002,los angeles,CA,Vegetable_farming,180000,12000,2023-02-18\n1003,CHIcaGo,IL,Grain Farming,NaN,11000,15-03-2023\n1004,Houston,tx,fruit-farming,100000,NaN,03/25/23\n1005,Phoenix,AZ,livestock_farming,90000,8000,2023/04/05\n1006,philadelphia,PA,vegetable-farming,NaN,9000,April 10 2023\n1007,san antonio,Tx,Grain_farming,85000,10000,06-15-2023\n1008,San Diego,CA,livestock-Farming,70000,7500,07/20/2023\n1009,dallas,Tx,fruit_farming,110000,9500,Aug 01 2023\n1010,san jose,CA,Vegetable_farming,82000,8700,2023-09-10\n1011,Austin,tx,grain_farming,NaN,9300,09/25/2023\n1012,Jacksonville,FL,grain_farming,60000,7200,10/10/2023\n1013,fort worth,TX,Fruit_farming,115000,9800,2023-11-05\n1014,Columbus,OH,Livestock_Farming,95000,8500,11-15-2023\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City names by capitalizing first letters and removing extra characters", "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/g, ' ').split(' ').map(w, w.length > 0 ? w[0].toUppercase() + w.slice(1) : '').join(' ')"}, {"op": "core/text-transform", "description": "Normalize State to uppercase two-letter codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Standardize BusinessType by removing underscores and hyphens, lowercase then title case each word", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[-_]/g, ' ').split(' ').map(w, w.length > 0 ? w[0].toUppercase() + w.slice(1) : '').join(' ')"}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount values with median of available LoanAmount", "columnName": "LoanAmount", "edits": [{"from": [null, "NaN", ""], "to": "90000"}]}, {"op": "core/mass-edit", "description": "Fill missing Price values with median of available Price", "columnName": "Price", "edits": [{"from": [null, "NaN", ""], "to": "9000"}]}, {"op": "core/date-parse", "description": "Normalize ApplicationDate format to yyyy-MM-dd", "columnName": "ApplicationDate", "expression": "value.toDate()", "dateFormat": "yyyy-MM-dd"}, {"op": "core/text-transform", "description": "Convert LoanAmount and Price to numbers (remove commas if any, ensure numeric type)", "columnName": "LoanAmount", "expression": "value.replace(/,/g, '').toNumber()"}, {"op": "core/text-transform", "description": "Convert Price to numbers", "columnName": "Price", "expression": "value.replace(/,/g, '').toNumber()"}], "clean_table": "ApplicantID,City,State,BusinessType,LoanAmount,Price,ApplicationDate\n1001,New York,NY,Grain Farming,250000,15000,2023-01-15\n1002,Los Angeles,CA,Vegetable Farming,180000,12000,2023-02-18\n1003,Chicago,IL,Grain Farming,90000,11000,2023-03-15\n1004,Houston,TX,Fruit Farming,100000,9000,2023-03-25\n1005,Phoenix,AZ,Livestock Farming,90000,8000,2023-04-05\n1006,Philadelphia,PA,Vegetable Farming,90000,9000,2023-04-10\n1007,San Antonio,TX,Grain Farming,85000,10000,2023-06-15\n1008,San Diego,CA,Livestock Farming,70000,7500,2023-07-20\n1009,Dallas,TX,Fruit Farming,110000,9500,2023-08-01\n1010,San Jose,CA,Vegetable Farming,82000,8700,2023-09-10\n1011,Austin,TX,Grain Farming,90000,9300,2023-09-25\n1012,Jacksonville,FL,Grain Farming,60000,7200,2023-10-10\n1013,Fort Worth,TX,Fruit Farming,115000,9800,2023-11-05\n1014,Columbus,OH,Livestock Farming,95000,8500,2023-11-15\n"}
{"purpose": "Clean and standardize movie titles, release dates, and box office revenue data for accurate reporting.", "raw_table": "MovieID,MovieTitle,ReleaseDate,BoxOffice,Genre\n1,star_wars,May 25 1977,775.3 million,SCi-fi\n2,The godfather,03/24/1972,134.9 million,Crime\n3,Inception,July 16th 2010,829.89M,Sci-Fi\n4,The Shawshank Redemption,1994-09-22,28.34m,Drama\n5,avatar,12-18-2009,2.847 billion,Sci-fi\n6,Gladiator ,05.05.2000,457.64 million,Action\n7,Jurassic park,06/11/1993,1.046 billion,Adventure\n8,Avengers: Endgame,2019/04/26,2.798B,Action\n9,Forrest Gump,07 06 1994,678.2 million,Drama\n10,Titanic,1997-12-19,2.195 billion,Romance\n11,star trek,09_08_2009,385.7 million,SciFi\n12,The Dark Knight,07-18-2008,1.005B,action\n", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "MovieTitle", "edits": [{"from": ["star_wars"], "to": "Star Wars"}, {"from": ["The godfather"], "to": "The Godfather"}, {"from": ["avatar"], "to": "Avatar"}, {"from": ["star trek"], "to": "Star Trek"}]}, {"op": "core/text-transform", "columnName": "MovieTitle", "expression": "value.trim().split(' ').map(w, w[0].toUppercase() + w.slice(1).toLowercase()).join(' ')", "description": "Capitalize each word in MovieTitle"}, {"op": "core/text-transform", "columnName": "ReleaseDate", "expression": "value.replace(/(\\d{2})[-_](\\d{2})[-_](\\d{4})/, '$3-$1-$2').replace(/(\\w+) (\\d+)[a-z]{2} (\\d{4})/, '$2 $1 $3').replace(/[-\\/]/g, '-')", "description": "Normalize date formats before parsing"}, {"op": "core/date-parse", "columnName": "ReleaseDate", "format": "yyyy-MM-dd"}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "value.toLowercase().replace(/[^0-9\\.]/g, '').replace(/b$/, '*1000000000').replace(/m$/, '*1000000').replace(/k$/, '*1000').eval()", "description": "Convert BoxOffice to numeric value in dollars"}, {"op": "core/text-transform", "columnName": "Genre", "expression": "value.toLowercase().replace(/sci[-_]?fi|scifi|sci fi/, 'Sci-Fi').replace(/action/i, 'Action').replace(/crime/i, 'Crime').replace(/drama/i, 'Drama').replace(/romance/i, 'Romance').replace(/adventure/i, 'Adventure')", "description": "Normalize Genre names"}, {"op": "core/text-transform", "columnName": "MovieTitle", "expression": "value.replace(/\\s+$/, '')", "description": "Trim trailing spaces in MovieTitle"}], "clean_table": "MovieID,MovieTitle,ReleaseDate,BoxOffice,Genre\n1,Star Wars,1977-05-25,775300000,Sci-Fi\n2,The Godfather,1972-03-24,134900000,Crime\n3,Inception,2010-07-16,829890000,Sci-Fi\n4,The Shawshank Redemption,1994-09-22,28340000,Drama\n5,Avatar,2009-12-18,2847000000,Sci-Fi\n6,Gladiator,2000-05-05,457640000,Action\n7,Jurassic Park,1993-06-11,1046000000,Adventure\n8,Avengers: Endgame,2019-04-26,2798000000,Action\n9,Forrest Gump,1994-07-06,678200000,Drama\n10,Titanic,1997-12-19,2195000000,Romance\n11,Star Trek,2009-09-08,385700000,Sci-Fi\n12,The Dark Knight,2008-07-18,1005000000,Action\n"}
{"purpose": "Standardize city names, correct business type labels, and normalize date and numeric fields for telecom customer data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,RegistrationDate\nNew_york,NY,telecom Co,150.00,5000,01/15/2023\nlos angeles,CA,Telecom_co,200,7000,2023-02-20\nChicago,IL,TEL-COM,175.5,6500,15-03-2023\nhouston,tx,TeleCom,NaN,5500,04/25/23\nPhoenix,AZ,telecomco,180.00,missing,2023/05/10\nphiladelphia,Pa,Telecom co,160,6000,13/06/2023\nSan Antonio,TX,,170.75,5800,2023-07-01\nSAN_diego,CA,telecom_co,195.00,6200,07/15/23\nDallas,TX,TELLECOM,165,5300,2023-08-05\nsan jose,CA,telecom co,180,5400,08-10-2023\nAustin,TX,Telecom-co,NaN,5600,2023/09/01\nJacksonville,FL,telecomco,170,5000,09/15/2023\nFort Worth,TX,Telecom_co,185.50,6100,10/05/2023\nColumbus,OH,TELECOM CO,175,6000,2023-11-11", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City names by replacing underscores/hyphens with spaces and capitalizing words", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix inconsistent BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["telecom Co", "Telecom_co", "TEL-COM", "TeleCom", "telecomco", "Telecom co", "telecom_co", "TELLECOM", "Telecom-co", "TELECOM CO"], "to": "Telecom Co"}]}, {"op": "core/mass-edit", "description": "Fill missing BusinessType with 'Telecom Co'", "columnName": "BusinessType", "edits": [{"from": [null, ""], "to": "Telecom Co"}]}, {"op": "core/mass-edit", "description": "Replace 'NaN' and 'missing' in Price and LoanAmount with blank", "columnName": "Price", "edits": [{"from": ["NaN", "missing"], "to": ""}]}, {"op": "core/mass-edit", "description": "Replace 'NaN' and 'missing' in LoanAmount with blank", "columnName": "LoanAmount", "edits": [{"from": ["NaN", "missing"], "to": ""}]}, {"op": "core/text-transform", "description": "Normalize Price to two decimal places", "columnName": "Price", "expression": "if(value.trim()==='', '', Number(value).toFixed(2))"}, {"op": "core/text-transform", "description": "Normalize LoanAmount to integer string", "columnName": "LoanAmount", "expression": "if(value.trim()==='', '', parseInt(value).toString())"}, {"op": "core/date-parse", "description": "Parse RegistrationDate with multiple known formats", "columnName": "RegistrationDate", "format": "auto-detect"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,RegistrationDate\nNew York,NY,Telecom Co,150.00,5000,2023-01-15\nLos Angeles,CA,Telecom Co,200.00,7000,2023-02-20\nChicago,IL,Telecom Co,175.50,6500,2023-03-15\nHouston,TX,Telecom Co,,5500,2023-04-25\nPhoenix,AZ,Telecom Co,180.00,,2023-05-10\nPhiladelphia,PA,Telecom Co,160.00,6000,2023-06-13\nSan Antonio,TX,Telecom Co,170.75,5800,2023-07-01\nSan Diego,CA,Telecom Co,195.00,6200,2023-07-15\nDallas,TX,Telecom Co,165.00,5300,2023-08-05\nSan Jose,CA,Telecom Co,180.00,5400,2023-08-10\nAustin,TX,Telecom Co,,5600,2023-09-01\nJacksonville,FL,Telecom Co,170.00,5000,2023-09-15\nFort Worth,TX,Telecom Co,185.50,6100,2023-10-05\nColumbus,OH,Telecom Co,175.00,6000,2023-11-11"}
{"purpose": "Standardize inconsistent city and business type names, normalize date formats, and fix numeric fields in government loan data.", "raw_table": "City,State,BusinessType,LoanAmount,Price,Date\nNew_york,NY,retail,50000,20,01-15-2023\nlos angeles,ca,Wholesale,75000,15.5,2023/02/10\nChicago,IL,Retaail,60000,,03-05-23\nhouston,tx,Manufacturing,abc,30,4/1/2023\nPHOENIX,AZ,retail,-45000,25,2023.04.15\nphiladelphia,PA,Wholesale,90000,12.5,May 5 2023\nsan antonio,TX,manufacturing,85000,20,2023-13-05\nsan_diego,ca,,70000,18.0,2023-06-25\nDallas,TX,retail,65000,twenty,07-10-2023\nsan jose,CA,wholesale,72000,22,08/15/2023\nAustin,TX,Manufacturing,80000,28,09-30-2023\njacksonville,FL,retail,55000,19.5,2023-10-05\nfort worth,TX,Wholesale,73000,17,11-31-2023\ncolumbus,OH,manufacturing,78000,23,12/01/2023\ncharlotte,NC,retail,62000,21,2023-11-20", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["san_diego"], "to": "San Diego"}]}, {"op": "core/text-transform", "description": "Capitalize city names properly", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "description": "Capitalize state abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["retail", "Retail"], "to": "Retail"}, {"from": ["Wholesale", "wholesale", "Wholesale"], "to": "Wholesale"}, {"from": ["Manufacturing", "manufacturing", "Manufacturing"], "to": "Manufacturing"}, {"from": ["Retaail"], "to": "Retail"}]}, {"op": "core/text-transform", "description": "Fix Price field: convert textual, missing or invalid values to blank", "columnName": "Price", "expression": "if(value.toNumber() != null, value.toNumber(), '')"}, {"op": "core/text-transform", "description": "Fix LoanAmount: convert non-numeric or negative values to blank", "columnName": "LoanAmount", "expression": "if(value.toNumber() != null && value.toNumber() > 0, value.toNumber(), '')"}, {"op": "core/date-parse", "description": "Parse dates to yyyy-MM-dd", "columnName": "Date", "format": "auto", "onError": "set-to-blank"}, {"op": "core/text-transform", "description": "Fix invalid dates (e.g., 2023-13-05 and 11-31-2023) by setting blank", "columnName": "Date", "expression": "if(value.match(/\\d{4}-\\d{2}-\\d{2}/) && new Date(value).toString() === 'Invalid Date', '', value)"}], "clean_table": "City,State,BusinessType,LoanAmount,Price,Date\nNew York,NY,Retail,50000,20,2023-01-15\nLos Angeles,CA,Wholesale,75000,15.5,2023-02-10\nChicago,IL,Retail,60000,,2023-03-05\nHouston,TX,Manufacturing,,30,2023-04-01\nPhoenix,AZ,Retail,,25,2023-04-15\nPhiladelphia,PA,Wholesale,90000,12.5,2023-05-05\nSan Antonio,TX,Manufacturing,85000,20,\nSan Diego,CA,,70000,18,2023-06-25\nDallas,TX,Retail,65000,,2023-07-10\nSan Jose,CA,Wholesale,72000,22,2023-08-15\nAustin,TX,Manufacturing,80000,28,2023-09-30\nJacksonville,FL,Retail,55000,19.5,2023-10-05\nFort Worth,TX,Wholesale,73000,17,\nColumbus,OH,Manufacturing,78000,23,2023-12-01\nCharlotte,NC,Retail,62000,21,2023-11-20"}
{"purpose": "Standardize city names and business types, correct date formats, and fix numeric inconsistencies in government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,NY,REtail,10000,5000,01-15-2023\nlos_angeles,CA,restaurant,12000,$7000,2023/02/20\nChicago,IL,retail,9500,4500,15-03-2023\nhouston,TX,Retail,11000,6000,2023-04-10\nPHOENIX,AZ,restaurtant,13000,8000,2023.05.25\nphiladelphia,PA,RETAIL,10500,5500,2023-06-30\nsan-antonio,TX,restaurant,11500,6500,07/15/2023\nsan diego,CA,Retail,12500,7000,2023-08-05\ndallas,tx,Restuarant,9000,4000,2023-09-10\nsan_jose,CA,RETAIL,14000,7500,10-12-2023\nAustin,TX,restaurant,13500,7200,2023/11/20\njacksonville,FL,retail,9800,4800,12-01-2023\nfort worth,TX,restuarant,11200,6300,2023-13-01\ncolumbus,OH,RETAIL,10700,5700,2023-02-28\ncharlotte,NC,restaurant,11800,6800,03-15-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names properly and replace underscores/hyphens with space", "columnName": "City", "expression": "value.toLowercase().replace('_',' ').replace('-', ' ').split(' ').map(w, w.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["REtail", "retail", "RETAIL"], "to": "Retail"}, {"from": ["restaurant", "restaurtant", "Restuarant"], "to": "Restaurant"}]}, {"op": "core/text-transform", "description": "Remove $ sign from LoanAmount and convert to number", "columnName": "LoanAmount", "expression": "value.replace('$', '').toNumber()"}, {"op": "core/text-transform", "description": "Convert Price to number", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Normalize Date format to yyyy-MM-dd", "columnName": "Date", "expression": "value.match(/\\d{4}[\\/\\-.]\\d{2}[\\/\\-.]\\d{2}/) ? value.replace(/[\\/\\.]/g, '-'): (value.match(/\\d{2}[-\\/]\\d{2}[-\\/]\\d{4}/) ? (let(parts = value.split(/[-\\/]/); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0')) : (value.match(/\\d{2}-\\d{2}-\\d{4}/) ? (let(parts = value.split('-'); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0')) : value)))"}, {"op": "core/mass-edit", "description": "Fix invalid date '2023-13-01' to '2024-01-13'", "columnName": "Date", "edits": [{"from": ["2023-13-01"], "to": "2024-01-13"}]}, {"op": "core/column-rename", "description": "Rename City to Municipality", "oldColumnName": "City", "newColumnName": "Municipality"}], "clean_table": "Municipality,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,10000,5000,2023-01-15\nLos Angeles,CA,Restaurant,12000,7000,2023-02-20\nChicago,IL,Retail,9500,4500,2023-03-15\nHouston,TX,Retail,11000,6000,2023-04-10\nPhoenix,AZ,Restaurant,13000,8000,2023-05-25\nPhiladelphia,PA,Retail,10500,5500,2023-06-30\nSan Antonio,TX,Restaurant,11500,6500,2023-07-15\nSan Diego,CA,Retail,12500,7000,2023-08-05\nDallas,TX,Restaurant,9000,4000,2023-09-10\nSan Jose,CA,Retail,14000,7500,2023-10-12\nAustin,TX,Restaurant,13500,7200,2023-11-20\nJacksonville,FL,Retail,9800,4800,2023-12-01\nFort Worth,TX,Restaurant,11200,6300,2024-01-13\nColumbus,OH,Retail,10700,5700,2023-02-28\nCharlotte,NC,Restaurant,11800,6800,2023-03-15"}
{"purpose": "Clean inconsistent city and state names, standardize business types, and normalize dates and numeric fields in government loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,resturant,12000,$50000,01/15/2022\nlos-angeles,CA,RETAIL,15000,75000,2022-02-20\nChcago,il,manufacturing,13000,,15-Mar-2022\nhouston,Tx,service,11000,$30000,2022/04/10\nPhoenix,az,RETAIL,14000,65000,Apr 25 2022\nphiladelphia,PA,resturant,,45000,2022.05.30\nSan-antonio,tx,Service,9000,40000,05-15-2022\nsan_diego,CA,Manufacturing,16000,70000,2022-06-01\nDallas,TX,retail,15500,72000,6/10/2022\nsan_jose,ca,,14500,68000,2022-07-20\nAustin,Tx,RESTAURANT,13500,$48000,2022-08-05\nJacksonville,fl,service,12500,53000,2022.09.10\nfort-worth,TX,Manufacturing,15000,71000,2022-10-15", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["los-angeles"], "to": "Los Angeles"}, {"from": ["Chcago"], "to": "Chicago"}, {"from": ["San-antonio"], "to": "San Antonio"}, {"from": ["san_diego"], "to": "San Diego"}, {"from": ["san_jose"], "to": "San Jose"}, {"from": ["fort-worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "State", "edits": [{"from": ["ny"], "to": "NY"}, {"from": ["Tx"], "to": "TX"}, {"from": ["ca"], "to": "CA"}, {"from": ["fl"], "to": "FL"}, {"from": ["il"], "to": "IL"}, {"from": ["az"], "to": "AZ"}]}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["resturant", "RESTAURANT", "resturant"], "to": "Restaurant"}, {"from": ["RETAIL", "retail"], "to": "Retail"}, {"from": ["manufacturing", "Manufacturing"], "to": "Manufacturing"}, {"from": ["service", "Service"], "to": "Service"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value==null || value=='' ? null : Number(value)"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value==null || value=='' ? null : value.replace(/\\$/,'').replace(/,/g,'').toNumber()"}, {"op": "core/date-parse", "columnName": "Date", "mode": "cells", "valueType": "date", "dateFormat": "auto"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,12000,50000,2022-01-15\nLos Angeles,CA,Retail,15000,75000,2022-02-20\nChicago,IL,Manufacturing,13000,,2022-03-15\nHouston,TX,Service,11000,30000,2022-04-10\nPhoenix,AZ,Retail,14000,65000,2022-04-25\nPhiladelphia,PA,Restaurant,,45000,2022-05-30\nSan Antonio,TX,Service,9000,40000,2022-05-15\nSan Diego,CA,Manufacturing,16000,70000,2022-06-01\nDallas,TX,Retail,15500,72000,2022-06-10\nSan Jose,CA,,14500,68000,2022-07-20\nAustin,TX,Restaurant,13500,48000,2022-08-05\nJacksonville,FL,Service,12500,53000,2022-09-10\nFort Worth,TX,Manufacturing,15000,71000,2022-10-15"}
{"purpose": "Clean and standardize city and business type names, fix date formats, and normalize numeric values in telecommunications loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,Wireless-Provider,12000,5000,2023/01/15\nlos angeles,ca,wireless_provider,15000,7000,15-02-2023\nChicago,IL,ISP,13000,,2023-03-01\nhouston,Tx,isp,11000,6000,03/15/2023\nPHOENIX,AZ,Cable-Company,9000,4000,2023.04.10\nphiladelphia,PA,Cable_Company,8500,3500,April 20 2023\nsan antonio,TX,Wireless Provider,12500,6500,2023-05-05\nSan-Diego,ca,ISP,14000,7000,05/20/2023\ndallas,tx,,10000,5000,2023/06/01\nsan jose,CA,Wireless-provider,11500,5500,06-15-2023\nAustin,TX,Cable company,9500,,2023/07/01\njacksonville,FL,ISP,10500,4800,2023-07-20\nfort worth,tx,wireless_provider,11000,5300,07/25/2023\nColumbus,OH,Cable_company,9000,4000,2023/08/05\ncharlotte,nc,ISP,10000,4700,08/15/2023", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["los angeles"], "to": "Los Angeles"}, {"from": ["houston"], "to": "Houston"}, {"from": ["PHOENIX"], "to": "Phoenix"}, {"from": ["philadelphia"], "to": "Philadelphia"}, {"from": ["san antonio"], "to": "San Antonio"}, {"from": ["San-Diego"], "to": "San Diego"}, {"from": ["dallas"], "to": "Dallas"}, {"from": ["san jose"], "to": "San Jose"}, {"from": ["Austin"], "to": "Austin"}, {"from": ["jacksonville"], "to": "Jacksonville"}, {"from": ["fort worth"], "to": "Fort Worth"}, {"from": ["charlotte"], "to": "Charlotte"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.split(/[-_]/).map(s => s.toLowerCase()).map(s => s.capitalize()).join(' ')", "onError": "keep-original", "repeat": false}, {"op": "core/mass-edit", "columnName": "State", "edits": [{"from": ["ca", "CA"], "to": "CA"}, {"from": ["Tx", "tx", "TX"], "to": "TX"}, {"from": ["ny", "NY"], "to": "NY"}, {"from": ["pa", "PA"], "to": "PA"}, {"from": ["fl", "FL"], "to": "FL"}, {"from": ["oh", "OH"], "to": "OH"}, {"from": ["nc", "NC"], "to": "NC"}, {"from": ["az", "AZ"], "to": "AZ"}, {"from": ["il", "IL"], "to": "IL"}]}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["Wireless-Provider", "wireless_provider", "Wireless Provider", "Wireless-provider", "wireless_provider"], "to": "Wireless Provider"}, {"from": ["ISP", "isp"], "to": "ISP"}, {"from": ["Cable-Company", "Cable_Company", "Cable company", "Cable_company"], "to": "Cable Company"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.toNumber()", "onError": "set-to-null"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value && value.trim() != '' ? value.toNumber() : null", "onError": "set-to-null"}, {"op": "core/date-parse", "columnName": "Date", "valueType": "date", "dateFormat": "yyyy-MM-dd", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')", "onError": "set-to-blank"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Wireless Provider,12000,5000,2023-01-15\nLos Angeles,CA,Wireless Provider,15000,7000,2023-02-15\nChicago,IL,ISP,13000,,2023-03-01\nHouston,TX,ISP,11000,6000,2023-03-15\nPhoenix,AZ,Cable Company,9000,4000,2023-04-10\nPhiladelphia,PA,Cable Company,8500,3500,2023-04-20\nSan Antonio,TX,Wireless Provider,12500,6500,2023-05-05\nSan Diego,CA,ISP,14000,7000,2023-05-20\nDallas,TX,Unknown,10000,5000,2023-06-01\nSan Jose,CA,Wireless Provider,11500,5500,2023-06-15\nAustin,TX,Cable Company,9500,,2023-07-01\nJacksonville,FL,ISP,10500,4800,2023-07-20\nFort Worth,TX,Wireless Provider,11000,5300,2023-07-25\nColumbus,OH,Cable Company,9000,4000,2023-08-05\nCharlotte,NC,ISP,10000,4700,2023-08-15"}
{"purpose": "Normalize city and business type names, fix date formats, and clean financial figures in energy sector loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar_install.,15000,50000,12/15/2022\nlos-angeles,CA,Wind_Turbine,  20000 ,45000,2022-11-30\nchicago ,il,solarInstall,13000, ,2022/10/25\nhouston,TX,bio_mass,11000,40000,15-09-2022\nPHOENIX,az,wind turbine,14000,42000,2022.09.10\nphiladelphia,PA,solar install,16000,48000,09/31/2022\nsan-antonio,Tx,solar_Install, ,47000,2022-08-05\nsan diego,ca,wind-turbine,17000,46000,2022/07/20\ndallas,tx,bioMass,12000,44000,07-15-2022\nsan jose,CA,solar_install,13000,43000,2022/06/10\nAustin,TX,Bio_mass,12500, ,2022-05-05\njacksonville,fl,solar_instal,13500,41000,2022/04/30\nfort worth,TX,wind turbine,15000,45500,04-25-2022\ncolumbus,oh,solar_install.,14000,44500,2022-03-15\ncharlotte,NC,bio_mass,11000,42000,2022-02-28", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from all columns", "columnName": "City", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace from all columns", "columnName": "State", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace from all columns", "columnName": "BusinessType", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace from all columns", "columnName": "Price", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace from all columns", "columnName": "LoanAmount", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace from all columns", "columnName": "Date", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Standardize City names: replace underscores and hyphens with spaces and capitalize properly", "columnName": "City", "expression": "value.replace(/[_-]/g,' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix BusinessType inconsistent names", "columnName": "BusinessType", "edits": [{"from": ["solar_install.", "solarInstall", "solar_install", "solar_Install", "solar_instal", "solar install"], "to": "Solar Installation"}, {"from": ["Wind_Turbine", "wind turbine", "wind-turbine"], "to": "Wind Turbine"}, {"from": ["bio_mass", "Bio_mass", "bioMass", "Bio_mass"], "to": "Biomass"}]}, {"op": "core/text-transform", "description": "Normalize Price and LoanAmount to numeric with no extra spaces", "columnName": "Price", "expression": "isNonBlank(value) ? value.replace(/[^0-9.]/g,'') : ''"}, {"op": "core/text-transform", "description": "Normalize LoanAmount to numeric with no extra spaces", "columnName": "LoanAmount", "expression": "isNonBlank(value) ? value.replace(/[^0-9.]/g,'') : ''"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/date-parse", "description": "Parse and standardize Date format to yyyy-MM-dd", "columnName": "Date", "format": "auto-detect"}, {"op": "core/text-transform", "description": "Remove invalid dates (like 09/31/2022) replaced by blank", "columnName": "Date", "expression": "if(isDate(value), value, '')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,15000,50000,2022-12-15\nLos Angeles,CA,Wind Turbine,20000,45000,2022-11-30\nChicago,IL,Solar Installation,13000,45000,2022-10-25\nHouston,TX,Biomass,11000,40000,2022-09-15\nPhoenix,AZ,Wind Turbine,14000,42000,2022-09-10\nPhiladelphia,PA,Solar Installation,16000,48000,\nSan Antonio,TX,Solar Installation,,47000,2022-08-05\nSan Diego,CA,Wind Turbine,17000,46000,2022-07-20\nDallas,TX,Biomass,12000,44000,2022-07-15\nSan Jose,CA,Solar Installation,13000,43000,2022-06-10\nAustin,TX,Biomass,12500,43000,2022-05-05\nJacksonville,FL,Solar Installation,13500,41000,2022-04-30\nFort Worth,TX,Wind Turbine,15000,45500,2022-04-25\nColumbus,OH,Solar Installation,14000,44500,2022-03-15\nCharlotte,NC,Biomass,11000,42000,2022-02-28"}
{"purpose": "Standardize city and business type names, fix date and numeric formats, and clean inconsistent loan amount data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,retail,1200,USD 15000,01-15-2023\nlos-angeles,ca,Service,1300,12000,2023/02/20\nchiCago,IL,RETAIL,1100,,2023-03-05\nhouston,TX,manufacturing,900,ten thousand,03-25-2023\nphoenix,Az,Service,800,8000,2023.04.15\nphiladelphia,pa,,1000,7000,15/05/2023\nsan antonio,TX,retail,-,6500,2023-06-10\nsan-diego,CA,service,950,7000,2023-07-01\n_dallas,tx,Manufacturing,1050,9500,07/20/2023\nsan_jose,CA,RETAIL,1000,9000,2023-08-05\n-austin,TX,service,870,8500,2023-09-10\njacksonville,fl,Manufacturing,980,not available,2023-10-12\nfort-worth,TX,Retail,1100,10000,2023-11-22\ncolumbus,OH,service,920,7800,2023-12-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove leading/trailing underscores and hyphens from City names", "columnName": "City", "expression": "value.replace(/^[_-]+|[_-]+$/g, '').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Standardize BusinessType capitalization", "columnName": "BusinessType", "expression": "if(value == null || value.trim() == '') null else value.toLowercase().replace(/^./, v, v.toUppercase())"}, {"op": "core/mass-edit", "description": "Fix common BusinessType misspellings and blanks", "columnName": "BusinessType", "edits": [{"from": ["", null], "to": "Service"}, {"from": ["Manufacturing", "manufacturing"], "to": "Manufacturing"}, {"from": ["Retail", "retail", "RETAIL"], "to": "Retail"}, {"from": ["Service", "service", "Service"], "to": "Service"}]}, {"op": "core/text-transform", "description": "Clean Price column: convert '-' or empty to null, parse as number", "columnName": "Price", "expression": "if(value == '-' || value == null || value.trim() == '') null else value.toNumber()"}, {"op": "core/text-transform", "description": "Clean LoanAmount: remove currency symbols and text, convert to number or null", "columnName": "LoanAmount", "expression": "if(value == null || value.trim() == '' || /not available/i.test(value)) null else value.replace(/[^0-9]/g, '').toNumber()"}, {"op": "core/text-transform", "description": "Parse Date column into ISO format yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,1200,15000,2023-01-15\nLos Angeles,CA,Service,1300,12000,2023-02-20\nChicago,IL,Retail,1100,,2023-03-05\nHouston,TX,Manufacturing,900,10000,2023-03-25\nPhoenix,AZ,Service,800,8000,2023-04-15\nPhiladelphia,PA,Service,1000,7000,2023-05-15\nSan Antonio,TX,Retail,,6500,2023-06-10\nSan Diego,CA,Service,950,7000,2023-07-01\nDallas,TX,Manufacturing,1050,9500,2023-07-20\nSan Jose,CA,Retail,1000,9000,2023-08-05\nAustin,TX,Service,870,8500,2023-09-10\nJacksonville,FL,Manufacturing,980,,2023-10-12\nFort Worth,TX,Retail,1100,10000,2023-11-22\nColumbus,OH,Service,920,7800,2023-12-01"}
{"purpose": "Standardize city and state names, fix business type inconsistencies, and normalize price and date formats in energy loan records.", "raw_table": "City,State,BusinessType,LoanAmount,Price,LoanDate\n\"new_york\",\"Ny\",\"solar-installation\",50000,\"$20,000\",\"01-15-2023\"\n\"Los Angeles\",\"ca\",\"Solar-Installation\",45000,\"15000\",\"2023/02/20\"\n\"chicago\",\"IL\",\"Wind-Turbine\",,\"$18000\",\"March 5 2023\"\n\"houston\",\"Tx\",\"wind_turbine\",40000,\"$17,500\",\"2023-03-28\"\n\"Phoenix\",\"AZ\",\"solar_installation\",35000,\"16000\",\"04-01-2023\"\n\"philadelphia\",\"pa \",\"wind-Turbine\",30000,\"$15,000\",\"2023/04/15\"\n\"San Antonio\",\"TX\",\"SOLAR_installation\",,\"14000\",\"2023-05-01\"\n\"san_diego\",\"CA\",\"Wind-turbine\",28000,\"$13000\",\"05-15-2023\"\n\"Dallas\",\"TX\",\"solar-installation\",33000,\"$14,500\",\"2023.06.01\"\n\"san jose\",\"ca\",\"wind_turbine\",27000,\"13500\",\"06/15/2023\"\n\"austin\",\"Tx\",\"solar_installation\",32000,\"$14500\",\"2023-07-01\"\n\"Jacksonville\",,\"wind-turbine\",25000,\"12000\",\"07-15-2023\"\n\"fort worth\",\"TX\",\"solar-installation\",31000,\"$14200\",\"2023-08-01\"\n\"columbus\",\"oh\",\"wind_turbine\",22000,\"11500\",\"2023/08/15\"\n\"Charlotte\",\"NC\",\"solar_installation\",29000,\"$13800\",\"08-30-2023\"", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names properly and replace underscores/hyphens with spaces", "columnName": "City", "expression": "value.toLowercase().replace(/[_-]/g, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Trim spaces and convert state abbreviations to uppercase", "columnName": "State", "expression": "value.trim().toUppercase()"}, {"op": "core/mass-edit", "description": "Fix missing State values to 'TX' assuming defaults", "columnName": "State", "edits": [{"from": [""], "to": "TX"}]}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["solar-installation", "Solar-Installation", "solar_installation", "SOLAR_installation", "solar_installation", "solar-installation"], "to": "Solar Installation"}, {"from": ["wind_turbine", "wind-turbine", "Wind-Turbine", "Wind-turbine", "wind_turbine"], "to": "Wind Turbine"}]}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Clean Price column by removing dollar signs and commas, convert to number string", "columnName": "Price", "expression": "value.replace(/[$,]/g, '')"}, {"op": "core/text-transform", "description": "Parse LoanDate into YYYY-MM-DD format", "columnName": "LoanDate", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,LoanAmount,Price,LoanDate\nNew York,NY,Solar Installation,50000,20000,2023-01-15\nLos Angeles,CA,Solar Installation,45000,15000,2023-02-20\nChicago,IL,Wind Turbine,45000,18000,2023-03-05\nHouston,TX,Wind Turbine,40000,17500,2023-03-28\nPhoenix,AZ,Solar Installation,35000,16000,2023-04-01\nPhiladelphia,PA,Wind Turbine,30000,15000,2023-04-15\nSan Antonio,TX,Solar Installation,30000,14000,2023-05-01\nSan Diego,CA,Wind Turbine,28000,13000,2023-05-15\nDallas,TX,Solar Installation,33000,14500,2023-06-01\nSan Jose,CA,Wind Turbine,27000,13500,2023-06-15\nAustin,TX,Solar Installation,32000,14500,2023-07-01\nJacksonville,TX,Wind Turbine,25000,12000,2023-07-15\nFort Worth,TX,Solar Installation,31000,14200,2023-08-01\nColumbus,OH,Wind Turbine,22000,11500,2023-08-15\nCharlotte,NC,Solar Installation,29000,13800,2023-08-30"}
{"purpose": "Standardize movie titles, release dates, and genres for consistent analysis in an entertainment dataset.", "raw_table": "Title,Release_Date,Genre,Rating,BoxOffice\n\"the avengers\",\"05-04-2012\",ACTION,8.0,$1,518,812,988\n\"Incepton\",\"2010/07/16\",Sci-Fi,8.8,$829,895,144\n\"jUrasSic_Park\",\"06-11-1993\",sci-Fi,8.1,$1,029,153,882\n\"Toy-Story\",\"11/22/1995\",Animation,8.3,$373,554,033\n\"The godfather\",\"1972-03-24\",crime,9.2,$246,120,986\n\"Star Wars Ep IV\",\"1977/05/25\", sci-fi,8.6,\"$775,398,007\"\n,\"12-15-2017\",Action,7.5,$225,000,000\n\"avengers: endgame\",\"2019-04-26\",ACTION,8.4,$2,797,501,328\n\"Black panther\",\"02-16-2018\",action,7.3,$1,346,913,161\n\"forrest gump\",\"07-06-1994\",Drama,8.8,$678,226,465\n\"the dark_knight\",\"07-18-2008\",Action,9.0,\"$1,005,973,645\"\n\"Interstellar\",\"2014-11-07\",SciFi,8.6,$677,471,339\n\"Toy Story 4\",\"2019/06/21\",animation,7.8,$1,073,394,593\n\"The Lion King\",\"1994-06-15\",animation,8.5,$968,483,777\n\"Pulp_Fiction\",\"1994/10/14\",crime,8.9,$213,928,762", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens from Title and replace with spaces", "columnName": "Title", "expression": "value.replace(/[_-]/g, ' ').trim()"}, {"op": "core/text-transform", "description": "Capitalize each word in Title", "columnName": "Title", "expression": "value.toLowercase().split(' ').map(word, word.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Fix common misspellings in Title", "columnName": "Title", "edits": [{"from": ["Incepton"], "to": "Inception"}, {"from": ["Jurassic Park"], "to": "Jurassic Park"}]}, {"op": "core/text-transform", "description": "Standardize Genre capitalization", "columnName": "Genre", "expression": "value.toLowercase().trim().replace(/^sci[- ]?fi$/, 'Sci-Fi').replace(/^action$/, 'Action').replace(/^animation$/, 'Animation').replace(/^crime$/, 'Crime').replace(/^drama$/, 'Drama')"}, {"op": "core/text-transform", "description": "Parse Release_Date to ISO format yyyy-MM-dd", "columnName": "Release_Date", "expression": "if(value.matches(/^\\d{4}-\\d{2}-\\d{2}$/)) value else if(value.matches(/^\\d{2}-\\d{2}-\\d{4}$/)) value.split('-')[2] + '-' + value.split('-')[0].pad(2, '0') + '-' + value.split('-')[1].pad(2, '0') else if(value.matches(/^\\d{4}\\/\\d{2}\\/\\d{2}$/)) value.replace(/\\//g, '-') else if(value.matches(/^\\d{2}\\/\\d{2}\\/\\d{4}$/)) { var parts = value.split('/'); parts[2] + '-' + parts[0].pad(2, '0') + '-' + parts[1].pad(2, '0') } else value"}, {"op": "core/mass-edit", "description": "Fill missing Title with 'Unknown'", "columnName": "Title", "edits": [{"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Remove $ and commas from BoxOffice and convert to number", "columnName": "BoxOffice", "expression": "value.replace(/[$,]/g, '')"}, {"op": "core/text-transform", "description": "Convert Rating to number", "columnName": "Rating", "expression": "value.toNumber()"}], "clean_table": "Title,Release_Date,Genre,Rating,BoxOffice\nThe Avengers,2012-05-04,Action,8.0,1518812988\nInception,2010-07-16,Sci-Fi,8.8,829895144\nJurassic Park,1993-06-11,Sci-Fi,8.1,1029153882\nToy Story,1995-11-22,Animation,8.3,373554033\nThe Godfather,1972-03-24,Crime,9.2,246120986\nStar Wars Ep Iv,1977-05-25,Sci-Fi,8.6,775398007\nUnknown,2017-12-15,Action,7.5,225000000\nAvengers Endgame,2019-04-26,Action,8.4,2797501328\nBlack Panther,2018-02-16,Action,7.3,1346913161\nForrest Gump,1994-07-06,Drama,8.8,678226465\nThe Dark Knight,2008-07-18,Action,9.0,1005973645\nInterstellar,2014-11-07,Sci-Fi,8.6,677471339\nToy Story 4,2019-06-21,Animation,7.8,1073394593\nThe Lion King,1994-06-15,Animation,8.5,968483777\nPulp Fiction,1994-10-14,Crime,8.9,213928762"}
{"purpose": "Standardize and clean city names, state abbreviations, business types, and monetary formats in government loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew-York,nyc,Retail,1,000,15000,01/12/2020\nlos_Angeles,CA,restuarant,$2000,20000,2020-02-15\nCHICAGO,il,Manufacturing,1500,25000,3/5/2020\nHouston,tx,government,1,250,30000,04-10-2020\nphiladelphia,PA,Retail,1000,NA,2020/05/20\nPhoenix,Az,Non-profit,$1,500,22000,2020-06-25\nsan-antonio,TX,retail,1750,18000,07/15/20\nDALLAS,Tx,manufacturing,1600,27000,2020.08.10\nSan Diego,CA,Restaurant,1300,23000,09-12-2020\nSan_Jose,ca,Government,1100,21000,2020/10/05\nAustin,TX,non_profit,1200,19000,11/01/2020\nJacksonville,fl,retail,1350,19500,2020-12-20\nFort-Worth,TX,Manufacturing,1450,25000,01-15-2021", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in City", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize State to uppercase 2-letter codes (fix known city/state combos)", "columnName": "State", "expression": "if(value.toLowerCase() == 'nyc', 'NY', if(value.toLowerCase() == 'az', 'AZ', value.toUpperCase()))"}, {"op": "core/mass-edit", "description": "Correct common misspellings and unify BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["restuarant", "Restaurant", "restaurant"], "to": "Restaurant"}, {"from": ["retail", "Retail"], "to": "Retail"}, {"from": ["manufacturing", "Manufacturing"], "to": "Manufacturing"}, {"from": ["government", "Government"], "to": "Government"}, {"from": ["non-profit", "non_profit"], "to": "Non-Profit"}]}, {"op": "core/text-transform", "description": "Clean Price column: remove commas, dollar signs and convert to number format", "columnName": "Price", "expression": "value.replace(/[,$]/g, '').trim()"}, {"op": "core/text-transform", "description": "Clean LoanAmount column: convert 'NA' to empty and remove commas", "columnName": "LoanAmount", "expression": "value == 'NA' ? '' : value.replace(/,/g, '').trim()"}, {"op": "core/date-parse", "description": "Parse Date column to yyyy-MM-dd format", "columnName": "Date", "expression": "value", "onError": "keep-original", "dateFormat": "automatic"}, {"op": "core/text-transform", "description": "Standardize Date column to yyyy-MM-dd", "columnName": "Date", "expression": "if(value instanceof Date) value.toISOString().slice(0,10) else value"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,1000,15000,2020-01-12\nLos Angeles,CA,Restaurant,2000,20000,2020-02-15\nChicago,IL,Manufacturing,1500,25000,2020-03-05\nHouston,TX,Government,1250,30000,2020-04-10\nPhiladelphia,PA,Retail,1000,30000,2020-05-20\nPhoenix,AZ,Non-Profit,1500,22000,2020-06-25\nSan Antonio,TX,Retail,1750,18000,2020-07-15\nDallas,TX,Manufacturing,1600,27000,2020-08-10\nSan Diego,CA,Restaurant,1300,23000,2020-09-12\nSan Jose,CA,Government,1100,21000,2020-10-05\nAustin,TX,Non-Profit,1200,19000,2020-11-01\nJacksonville,FL,Retail,1350,19500,2020-12-20\nFort Worth,TX,Manufacturing,1450,25000,2021-01-15"}
{"purpose": "Standardize city names, fix date formats, unify business types, and clean numeric fields in energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar_InstalLation,15000,5000,01/15/2023\nlos-angeles,CA,WIND Power,20000,7000,2023-02-20\nChicago,IL,solar installation,13000,missing,3/10/23\nhouston,TX,Wind-power, ,6000,2023/04/01\nPHOENIX,AZ,solar_Install,11000,4000,April 5, 2023\nphiladelphia,PA,windpower,17000,6500,2023-05-10\nsan antonio,TX,solar installation,14000, ,05-20-2023\nSan Diego,CA,Wind Power,16000,6200,2023.06.15\nDallas,TX,Solar_installation,13500,5300,06/25/2023\nsan-jose,CA,wind-power,18000,7000,2023-07-05\nAustin,TX,solar-install,12500,4800,7/15/23\nJacksonville,FL,WIND_power,15500,6100,2023-08-01\nfort worth,TX,Solar Installation,14000,5500,2023-08-20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City with spaces and capitalize each word", "columnName": "City", "expression": "value.replace('_', ' ').replace('-', ' ').split(' ').map(word => word.toLowercase().replace(/^(.)/, v => v.toUppercase())).join(' ')"}, {"op": "core/text-transform", "description": "Capitalize all letters in State", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType values to 'Solar Installation' or 'Wind Power'", "columnName": "BusinessType", "expression": "if(value.toLowercase().match(/solar/), 'Solar Installation', if(value.toLowercase().match(/wind/), 'Wind Power', value))"}, {"op": "core/mass-edit", "description": "Fix missing Price to '0'", "columnName": "Price", "edits": [{"from": [null, "", " "], "to": "0"}]}, {"op": "core/mass-edit", "description": "Fix missing LoanAmount to '0' and 'missing' to '0'", "columnName": "LoanAmount", "edits": [{"from": ["missing", null, "", " "], "to": "0"}]}, {"op": "core/text-transform", "description": "Parse Date to standard yyyy-MM-dd", "columnName": "Date", "expression": "if(value.match(/\\d{4}[-\\/.]\\d{2}[-\\/.]\\d{2}/), value.replace(/[.]/g,'-'), \n  toDate(value).toString('yyyy-MM-dd'))"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,15000,5000,2023-01-15\nLos Angeles,CA,Wind Power,20000,7000,2023-02-20\nChicago,IL,Solar Installation,13000,0,2023-03-10\nHouston,TX,Wind Power,0,6000,2023-04-01\nPhoenix,AZ,Solar Installation,11000,4000,2023-04-05\nPhiladelphia,PA,Wind Power,17000,6500,2023-05-10\nSan Antonio,TX,Solar Installation,14000,0,2023-05-20\nSan Diego,CA,Wind Power,16000,6200,2023-06-15\nDallas,TX,Solar Installation,13500,5300,2023-06-25\nSan Jose,CA,Wind Power,18000,7000,2023-07-05\nAustin,TX,Solar Installation,12500,4800,2023-07-15\nJacksonville,FL,Wind Power,15500,6100,2023-08-01\nFort Worth,TX,Solar Installation,14000,5500,2023-08-20"}
{"purpose": "Clean and standardize energy provider data with consistent city names, business types, price formats, loan amounts, and dates.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_York,NY,industrial, $1200.5 ,10000,2023/01/15\nlos-angeles,CA,Residential, 950, twelve_thousand,01-20-2023\nChicago,IL,commercial,1100.00,9000,2023.02.05\nhouston,TX,Industiral,1150,$11000,15-02-2023\nPhoenix,AZ,residential,1050,8500,2023/02/20\nphiladelphia,PA,Commercial, 1000 ,missing,2023/03/01\nSan Antonio,TX,Industrial,NA,12000,2023-03-15\nsan_diego,CA,Residential,$980,9500,03/20/2023\nDallas,TX,Commercial, 1025 ,10500,2023/03/25\nsan_jose,CA,industiral,1005.5,11000,2023/04/01\nAustin,TX,Residential,990,missing,2023/04/05\nJacksonville,FL,Industrial,1010,8800,2023/04/10\nFort-Worth,TX,commercial,995,9000,2023-04-15\nColumbus,OH,Residential,970,8700,2023/04/20", "cleaning_workflow": [{"op": "core/mass-edit", "description": "Standardize city names by replacing underscores and hyphens with spaces and fixing capitalization", "columnName": "City", "edits": [{"from": ["New_York"], "to": "New York"}, {"from": ["los-angeles"], "to": "Los Angeles"}, {"from": ["san_diego"], "to": "San Diego"}, {"from": ["san_jose"], "to": "San Jose"}, {"from": ["Fort-Worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "description": "Capitalize city names properly", "columnName": "City", "expression": "value.split(' ').map(s => s.toLowerCase().capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Correct misspelled BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["industiral", "Industiral"], "to": "Industrial"}, {"from": ["industrial"], "to": "Industrial"}, {"from": ["commercial"], "to": "Commercial"}, {"from": ["residential"], "to": "Residential"}]}, {"op": "core/text-transform", "description": "Trim whitespace and remove $ sign in Price, convert to number", "columnName": "Price", "expression": "value.trim().replace('$','')", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Convert Price to number where possible", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Clean LoanAmount to numeric values, replace 'missing' and 'twelve_thousand' with blank or numeric", "columnName": "LoanAmount", "expression": "value.toLowerCase()=='missing' ? '' : (value=='twelve_thousand' ? '12000' : value.replace(/[^0-9]/g, ''))"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number", "columnName": "LoanAmount", "expression": "value=='' ? null : value.toNumber()"}, {"op": "core/text-transform", "description": "Normalize date formats to yyyy-MM-dd", "columnName": "Date", "expression": "value.match(/\\d{4}[-/.]\\d{2}[-/.]\\d{2}/) ? value.replace(/[/.]/g,'-') : (value.match(/\\d{2}[-/]\\d{2}[-/]\\d{4}/) ? value.split(/[-\\/]/).reverse().join('-') : value)", "onError": "keep-original"}, {"op": "core/date-parse", "description": "Parse dates into ISO format yyyy-MM-dd", "columnName": "Date", "format": "yyyy-MM-dd", "onError": "keep-original"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Industrial,1200.5,10000,2023-01-15\nLos Angeles,CA,Residential,950,12000,2023-01-20\nChicago,IL,Commercial,1100,9000,2023-02-05\nHouston,TX,Industrial,1150,11000,2023-02-15\nPhoenix,AZ,Residential,1050,8500,2023-02-20\nPhiladelphia,PA,Commercial,1000,,2023-03-01\nSan Antonio,TX,Industrial,,12000,2023-03-15\nSan Diego,CA,Residential,980,9500,2023-03-20\nDallas,TX,Commercial,1025,10500,2023-03-25\nSan Jose,CA,Industrial,1005.5,11000,2023-04-01\nAustin,TX,Residential,990,,2023-04-05\nJacksonville,FL,Industrial,1010,8800,2023-04-10\nFort Worth,TX,Commercial,995,9000,2023-04-15\nColumbus,OH,Residential,970,8700,2023-04-20"}
{"purpose": "Clean inconsistent crop names and normalize units in price and loan amount columns.", "raw_table": "FarmID,City,State,Crop,PricePerTon,Loan_Amount,HarvestDate\n101,Springfield,il,CoRn,500.0,15000,2023/10/15\n102,decatur,IL,soy-bean,450,12,000,15-09-2023\n103,Peoria,IL,wheat,490.50,14000,2023-09-30\n104,decatur,il,corn,Five Hundred,13000,2023/10/01\n105,CHAMPAIGN,il,Soy_bean,460,,09/25/2023\n106,Peoria,IL,WHEAT,495.75,13500.00,2023/09/28\n107,Peoria,IL,Corn,505,16000,2023-10-05\n108,,IL,soybean,455,12500,2023-09-20\n109,Champaign,IL, corn ,480,11000,09-22-2023\n110,Springfield,IL,Wheat,485,14500,2023/09/29\n111,Decatur,IL,soybean,460,,2023-09-21\n112,Champaign,IL,CORN,490,13800,2023/09/27", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace in Crop column", "columnName": "Crop", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Normalize Crop names capitalization", "columnName": "Crop", "expression": "value.toLowerCase().replace(/[_-]/g, '').replace(/^corn$/, 'Corn').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^soybean$/, 'Soybean').replace(/^wheat$/, 'Wheat').replace(/^corn$/, 'Corn').replace(/^soybean$/, 'Soybean')"}, {"op": "core/mass-edit", "description": "Fix Loan_Amount commas and convert text numbers", "columnName": "Loan_Amount", "edits": [{"from": ["12,000"], "to": "12000"}, {"from": ["Five Hundred"], "to": "500"}, {"from": [""], "to": ""}]}, {"op": "core/text-transform", "description": "Remove commas from Loan_Amount and convert to number", "columnName": "Loan_Amount", "expression": "value.replace(/,/g, '').trim() == '' ? null : Number(value.replace(/,/g, ''))"}, {"op": "core/text-transform", "description": "Convert PricePerTon to number", "columnName": "PricePerTon", "expression": "isNaN(Number(value)) ? null : Number(value)"}, {"op": "core/text-transform", "description": "Parse and standardize HarvestDate", "columnName": "HarvestDate", "expression": "value.match(/\\d{4}-\\d{2}-\\d{2}/) ? value : (value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/) ? value.replace(/\\//g, '-') : (value.match(/\\d{2}-\\d{2}-\\d{4}/) ? value.split('-').reverse().join('-') : (value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/) ? value.split('/').reverse().join('-') : value)))"}, {"op": "core/date-parse", "description": "Convert HarvestDate strings to date format yyyy-MM-dd", "columnName": "HarvestDate", "format": "yyyy-MM-dd", "mode": "loose"}, {"op": "core/fill-down", "description": "Fill missing City values", "columnName": "City"}, {"op": "core/text-transform", "description": "Capitalize City and State properly", "columnName": "City", "expression": "value.toLowerCase().split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Capitalize State abbreviation", "columnName": "State", "expression": "value.toUpperCase()"}], "clean_table": "FarmID,City,State,Crop,PricePerTon,Loan_Amount,HarvestDate\n101,Springfield,IL,Corn,500.0,15000,2023-10-15\n102,Decatur,IL,Soybean,450,12000,2023-09-15\n103,Peoria,IL,Wheat,490.5,14000,2023-09-30\n104,Decatur,IL,Corn,500,13000,2023-10-01\n105,Champaign,IL,Soybean,460,,2023-09-25\n106,Peoria,IL,Wheat,495.75,13500,2023-09-28\n107,Peoria,IL,Corn,505,16000,2023-10-05\n108,Peoria,IL,Soybean,455,12500,2023-09-20\n109,Champaign,IL,Corn,480,11000,2023-09-22\n110,Springfield,IL,Wheat,485,14500,2023-09-29\n111,Decatur,IL,Soybean,460,,2023-09-21\n112,Champaign,IL,Corn,490,13800,2023-09-27"}
{"purpose": "Standardize and clean city names, state abbreviations, business types, and normalize price and loan amount values for government grant applications.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew_york,ny,Retail,15000,100000,2023/01/15\nlos-angeles,CA,retail,15,000,120000,15-02-2023\nCHIcago,il,Manufacturing,20000,abc,2023-03-10\nHouston,Tx,manufacturinG,18000,90000,2023/04/05\nPhoenix,az,Health-Care,17000,85000,04/25/2023\nphiladelphia,PA,healthcare,NaN,80000,2023.05.10\nSan-antonio,tx,Education,16000,75000,\nSan Diego,Ca,education,15500,70000,2023/07/15\nDallas,TX,RETAIL,14000,,2023-08-01\nSan_jose,ca,Manufacturing,13000,65000,2023-09-10\nAustin,Tx,Health_Care,12500,60000,2023/10/05\nJacksonville,fl,,11000,55000,2023-11-20\nFort Worth,tx,manufacturing,11500,58000,2023/12/01\nColumbus,oh,Retail,12000,62000,2023/13/01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in City", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').trim()"}, {"op": "core/text-transform", "description": "Capitalize each word in City", "columnName": "City", "expression": "value.toLowerCase().split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Convert State to uppercase", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/mass-edit", "description": "Correct invalid state abbreviations", "columnName": "State", "edits": [{"from": ["NY", "CA", "IL", "TX", "AZ", "PA", "FL", "OH"], "to": null}, {"from": ["ny"], "to": "NY"}, {"from": ["Ca", "ca"], "to": "CA"}, {"from": ["il"], "to": "IL"}, {"from": ["Tx", "tx", "Tx"], "to": "TX"}, {"from": ["az"], "to": "AZ"}, {"from": ["pa"], "to": "PA"}, {"from": ["fl"], "to": "FL"}, {"from": ["oh"], "to": "OH"}]}, {"op": "core/text-transform", "description": "Normalize BusinessType values", "columnName": "BusinessType", "expression": "value.toLowerCase().replace(/[-_]/g,'').trim()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType names", "columnName": "BusinessType", "edits": [{"from": ["retail"], "to": "Retail"}, {"from": ["manufacturing", "manufacturinG"], "to": "Manufacturing"}, {"from": ["healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "healthcare", "Healthcare"], "to": "Healthcare"}, {"from": ["education"], "to": "Education"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Clean Price column, remove commas and convert to number", "columnName": "Price", "expression": "value.toString().replace(/[, ]+/g, '').match(/\\d+/) ? parseInt(value.toString().replace(/[, ]+/g, '')) : null"}, {"op": "core/text-transform", "description": "Clean LoanAmount column, convert non-numeric to null", "columnName": "LoanAmount", "expression": "value.match(/^\\d+$/) ? parseInt(value) : null"}, {"op": "core/date-parse", "description": "Parse ApplicationDate column into ISO format", "columnName": "ApplicationDate", "mode": "lenient", "dateFormat": "auto"}, {"op": "core/fill-down", "description": "Fill down missing BusinessType values", "columnName": "BusinessType"}, {"op": "core/column-rename", "description": "Rename ApplicationDate to Date", "oldColumnName": "ApplicationDate", "newColumnName": "Date"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,15000,100000,2023-01-15T00:00:00Z\nLos Angeles,CA,Retail,15000,120000,2023-02-15T00:00:00Z\nChicago,IL,Manufacturing,20000,,2023-03-10T00:00:00Z\nHouston,TX,Manufacturing,18000,90000,2023-04-05T00:00:00Z\nPhoenix,AZ,Healthcare,17000,85000,2023-04-25T00:00:00Z\nPhiladelphia,PA,Healthcare,,80000,2023-05-10T00:00:00Z\nSan Antonio,TX,Education,16000,75000,\nSan Diego,CA,Education,15500,70000,2023-07-15T00:00:00Z\nDallas,TX,Retail,14000,,2023-08-01T00:00:00Z\nSan Jose,CA,Manufacturing,13000,65000,2023-09-10T00:00:00Z\nAustin,TX,Healthcare,12500,60000,2023-10-05T00:00:00Z\nJacksonville,FL,Unknown,11000,55000,2023-11-20T00:00:00Z\nFort Worth,TX,Manufacturing,11500,58000,2023-12-01T00:00:00Z\nColumbus,OH,Retail,12000,62000,"}
{"purpose": "Clean and standardize movie titles and release dates with inconsistent formatting in the dataset.", "raw_table": "MovieTitle,ReleaseDate,Genre,Rating,BoxOffice\n\"the_lord of the rings\",\"07/29/2001\",Fantasy,8.8,\"$317 million\"\n\"Inception\",\"2010-07-16\",Sci-fi,8.8,\"829 million\"\n\"star wars: episode IV\",\"May 25 1977\",Sci-Fi,8.6,\"775 million\"\n\"Jurrasic-park\",06/11/1993,Adventure,8.1,\"$1.03 Billion\"\n\"avatar\",\"December 18 2009\",sci-fi,7.8,\"$2.79 Billion\"\n\"the_dark_knight\",07-18-2008,Action,9.0,\"$1.005 billion\"\n\"forrest gump\",07/06/1994,Drama,8.8,\"$678 million\"\n\"The Godfather\",\"24 March 1972\",Crime,9.2,\"$246 million\"\n\"pulp-fiction\",10/14/1994,Crime,8.9,\"213 million\"\n\"the shawshank redemption\",1994-09-23,Drama,9.3,\"$28 million\"\n\"Fight Club\",10-15-1999,drama,8.8,\"$101 million\"\n\"Toy-Story\",11/22/1995,Animation,8.3,\"$373 million\"\n\"Gladiator\",\"05-05-2000\",Action,8.5,\"$460 million\"\n\"Titanic\",\"12/19/1997\",romance,7.8,\"$2.2 billion\"\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in MovieTitle", "columnName": "MovieTitle", "expression": "value.replace(/[_-]/g, ' ').trim()"}, {"op": "core/text-transform", "description": "Capitalize each word in MovieTitle", "columnName": "MovieTitle", "expression": "value.split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1).toLowerCase()).join(' ')"}, {"op": "core/text-transform", "description": "Standardize Genre capitalization", "columnName": "Genre", "expression": "value.toLowerCase().split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Parse ReleaseDate to ISO format yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "value.toDate().toISOString().slice(0,10)"}, {"op": "core/text-transform", "description": "Clean BoxOffice values by removing $ and commas, convert to numeric string in millions", "columnName": "BoxOffice", "expression": "var s = value.replace(/\\$/g,'').toLowerCase().trim(); var mult = 1; if (s.indexOf('billion') !== -1) { mult = 1000; s = s.replace('billion','').trim(); } else if (s.indexOf('million') !== -1) { s = s.replace('million','').trim(); } s = s.replace(/,/g,''); var n = parseFloat(s); if (isNaN(n)) { n = 0; } (n * mult).toFixed(1) + 'M'"}, {"op": "core/mass-edit", "columnName": "Rating", "description": "Fix lowercase genre entries in Rating column", "edits": [{"from": ["drama"], "to": "8.8"}]}], "clean_table": "MovieTitle,ReleaseDate,Genre,Rating,BoxOffice\nThe Lord Of The Rings,2001-07-29,Fantasy,8.8,317.0M\nInception,2010-07-16,Sci Fi,8.8,829.0M\nStar Wars: Episode Iv,1977-05-25,Sci Fi,8.6,775.0M\nJurrasic Park,1993-06-11,Adventure,8.1,1030.0M\nAvatar,2009-12-18,Sci Fi,7.8,2790.0M\nThe Dark Knight,2008-07-18,Action,9.0,1005.0M\nForrest Gump,1994-07-06,Drama,8.8,678.0M\nThe Godfather,1972-03-24,Crime,9.2,246.0M\nPulp Fiction,1994-10-14,Crime,8.9,213.0M\nThe Shawshank Redemption,1994-09-23,Drama,9.3,28.0M\nFight Club,1999-10-15,Drama,8.8,101.0M\nToy Story,1995-11-22,Animation,8.3,373.0M\nGladiator,2000-05-05,Action,8.5,460.0M\nTitanic,1997-12-19,Romance,7.8,2200.0M\n"}
{"purpose": "Clean and standardize energy project data including city names, business types, and date formats.", "raw_table": "City,State,BusinessType,Price,LoanAmount,InstallationDate\nLos_angeles,CA,Solar-Installer,15000,5000,2023-02-30\nsan francisco,ca,Wind_Turbine,12000,,02/15/23\nSeattle,WA,solar INSTALLER,13000,4500,15-03-2023\nPortland,Or,wind turbine,11000,4000,2023/04/01\nNew_york,NY,Hydro-Plant,20000,7000,2023-13-01\nmiami,FL,Solar_Installer,14000,4800,2023-03-12\nHouston,tx,solar-installer,13500,4700,03-18-2023\nBoston,MA,wind-turbine,11500,4200,2023/03/25\nChicago,IL,Hydro_Plant,21000,7200,2023.02.28\nDenver,CO,solar installer,12500,4600,2023-03-05\nAustin,TX,wind_Turbine,11800,,2023-03-15\nSan_diego,CA,solar installer,14500,4900,2023-02-20\nAtlanta,GA,Hydro_Plant,20500,7100,28/02/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City with spaces and proper capitalization", "columnName": "City", "expression": "value.toLowercase().replace(/[_-]/g, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Normalize State to uppercase two-letter codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType to title case without underscores or hyphens", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[_-]/g,' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Correct invalid dates in InstallationDate", "columnName": "InstallationDate", "edits": [{"from": ["2023-02-30"], "to": "2023-02-28"}, {"from": ["2023-13-01"], "to": "2023-01-13"}]}, {"op": "core/text-transform", "description": "Parse various date formats to ISO yyyy-MM-dd", "columnName": "InstallationDate", "expression": "value.match(/\\d{4}[-/.]\\d{2}[-/.]\\d{2}/) ? value.replace(/[.]/g,'-') : (value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/) ? value.split('/')[2] + '-' + value.split('/')[0].padStart(2,'0') + '-' + value.split('/')[1].padStart(2,'0') : (value.match(/\\d{2}-\\d{2}-\\d{4}/) ? value.split('-')[2] + '-' + value.split('-')[0].padStart(2,'0') + '-' + value.split('-')[1].padStart(2,'0') : value))"}, {"op": "core/fill-down", "description": "Fill missing LoanAmount values with previous non-empty", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numbers", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numbers", "columnName": "LoanAmount", "expression": "value.toNumber()"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,InstallationDate\nLos Angeles,CA,Solar Installer,15000,5000,2023-02-28\nSan Francisco,CA,Wind Turbine,12000,5000,2023-02-15\nSeattle,WA,Solar Installer,13000,4500,2023-03-15\nPortland,OR,Wind Turbine,11000,4000,2023-04-01\nNew York,NY,Hydro Plant,20000,7000,2023-01-13\nMiami,FL,Solar Installer,14000,4800,2023-03-12\nHouston,TX,Solar Installer,13500,4700,2023-03-18\nBoston,MA,Wind Turbine,11500,4200,2023-03-25\nChicago,IL,Hydro Plant,21000,7200,2023-02-28\nDenver,CO,Solar Installer,12500,4600,2023-03-05\nAustin,TX,Wind Turbine,11800,4600,2023-03-15\nSan Diego,CA,Solar Installer,14500,4900,2023-02-20\nAtlanta,GA,Hydro Plant,20500,7100,2023-02-28"}
{"purpose": "Clean and standardize city names, business types, and date formats in government loan application data.", "raw_table": "City,State,BusinessType,LoanAmount,Price,ApplicationDate\nnew york,NY,retail_store,50000,25.5,2023/04/15\nLos_Angeles,ca,Food--Service,75000,15.00,15-05-2023\nCHICAGO,IL,Consultng,100000,20,2023.06.01\nhouston,TX,RetailStore,,30.75,2023-07-12\nPhoenix,AZ,food service,60000,18.5,2023/08/01\nphiladelphia,pa,Consulting,85000,22.0,2023-09-05\nSan Antonio,TX,Retail_store,70000,28.0,2023/10/10\nsan-diego,CA,Food service,55000,16,10/11/2023\nDALLAS,tx,Consulting,90000,21.5,2023-12-01\nSan Jose,CA,retail-store,65000,,2023/11/20\nAustin,TX,FOOD Service,72000,17.0,2023-13-01\nJacksonville,FL,Consulting,80000,19.5,2023-03-15\nfort worth,TX,retailstore,68000,24.0,2023/02/28\nColumbus,OH,food_service,63000,14.5,2023/01/20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City names: replace underscores and hyphens with spaces, and capitalize each word", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Correct common misspellings and inconsistent business type values", "columnName": "BusinessType", "edits": [{"from": ["retail_store", "RetailStore", "Retail_store", "retail-store", "retailstore"], "to": "Retail Store"}, {"from": ["food service", "Food--Service", "FOOD Service", "Food service", "food_service"], "to": "Food Service"}, {"from": ["Consultng"], "to": "Consulting"}]}, {"op": "core/text-transform", "description": "Fill missing LoanAmount with 0", "columnName": "LoanAmount", "expression": "if(value==null || value.trim()=='', '0', value)"}, {"op": "core/text-transform", "description": "Fill missing Price with 0", "columnName": "Price", "expression": "if(value==null || value.trim()=='', '0', value)"}, {"op": "core/date-parse", "description": "Parse ApplicationDate into yyyy-MM-dd format", "columnName": "ApplicationDate", "dateFormat": "auto-detect"}, {"op": "core/text-transform", "description": "Correct invalid dates by replacing impossible months (like month 13) with empty string", "columnName": "ApplicationDate", "expression": "if(value.match(/^\\d{4}-\\d{2}-\\d{2}$/) && value.split('-')[1].toNumber()>12, '', value)"}], "clean_table": "City,State,BusinessType,LoanAmount,Price,ApplicationDate\nNew York,NY,Retail Store,50000,25.5,2023-04-15\nLos Angeles,CA,Food Service,75000,15.00,2023-05-15\nChicago,IL,Consulting,100000,20,2023-06-01\nHouston,TX,Retail Store,0,30.75,2023-07-12\nPhoenix,AZ,Food Service,60000,18.5,2023-08-01\nPhiladelphia,PA,Consulting,85000,22.0,2023-09-05\nSan Antonio,TX,Retail Store,70000,28.0,2023-10-10\nSan Diego,CA,Food Service,55000,16,2023-10-11\nDallas,TX,Consulting,90000,21.5,2023-12-01\nSan Jose,CA,Retail Store,65000,0,2023-11-20\nAustin,TX,Food Service,72000,17.0,\nJacksonville,FL,Consulting,80000,19.5,2023-03-15\nFort Worth,TX,Retail Store,68000,24.0,2023-02-28\nColumbus,OH,Food Service,63000,14.5,2023-01-20"}
{"purpose": "Standardize city names, normalize business types, and clean numeric and date fields in telecommunications loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_York,ny,Cell-Phone Store,1200,10000,01-15-2023\nlos-angeles,CA,Internet PROVIDER,1100,15000,2023/02/20\nchicago,IL,Cell phone store,950,8000,15/03/2023\nHouston,tx,Internet-provider,1050,NaN,03-22-2023\nPHOENIX,AZ,Cell-phone store,1100,12000,2023.04.01\nphiladelphia,pa,,1000,11000,04-05-2023\nSan_Antonio,TX,Internet Provider,NaN,13000,2023-06-15\nsan diego,CA,cell phone store,1150,,06/20/2023\nDallas,Tx,Internet-provider,1000,12500,2023-07-10\nsan jose,ca,Cell_Phone Store,950,9000,07-25-2023\nAustin,TX,Internet PROVIDER,1050,14000,2023/08/01\nJacksonville,FL,cell-phone store,1050,11500,,\nfort worth,TX,Internet-Provider,1100,13500,08-15-2023\nColumbus,oh,cell phone store,1000,10000,2023-09-05", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City names by replacing underscores and hyphens with spaces and title case", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Uppercase state codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["cell-Phone Store", "Cell phone store", "Cell-phone store", "cell phone store", "Cell_Phone Store", "cell-phone store"], "to": "Cell Phone Store"}, {"from": ["Internet PROVIDER", "Internet-provider", "Internet Provider", "Internet-Provider"], "to": "Internet Provider"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Fix Price missing values by setting to 1000", "columnName": "Price", "expression": "value == null || value == '' || value.toString().toLowerCase() == 'nan' ? '1000' : value"}, {"op": "core/text-transform", "description": "Fix LoanAmount missing values by setting to median 11500", "columnName": "LoanAmount", "expression": "value == null || value == '' || value.toString().toLowerCase() == 'nan' ? '11500' : value"}, {"op": "core/date-parse", "description": "Parse Date column with multiple formats", "columnName": "Date", "format": "MM-dd-yyyy"}, {"op": "core/text-transform", "description": "Handle empty or missing dates by filling with placeholder date", "columnName": "Date", "expression": "value == null || value == '' ? '2023-01-01' : value"}, {"op": "core/date-parse", "description": "Convert all dates to ISO format yyyy-MM-dd", "columnName": "Date", "format": "yyyy-MM-dd"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Cell Phone Store,1200,10000,2023-01-15\nLos Angeles,CA,Internet Provider,1100,15000,2023-02-20\nChicago,IL,Cell Phone Store,950,8000,2023-03-15\nHouston,TX,Internet Provider,1050,11500,2023-03-22\nPhoenix,AZ,Cell Phone Store,1100,12000,2023-04-01\nPhiladelphia,PA,Unknown,1000,11000,2023-04-05\nSan Antonio,TX,Internet Provider,1000,13000,2023-06-15\nSan Diego,CA,Cell Phone Store,1150,11500,2023-06-20\nDallas,TX,Internet Provider,1000,12500,2023-07-10\nSan Jose,CA,Cell Phone Store,950,9000,2023-07-25\nAustin,TX,Internet Provider,1050,14000,2023-08-01\nJacksonville,FL,Cell Phone Store,1050,11500,2023-01-01\nFort Worth,TX,Internet Provider,1100,13500,2023-08-15\nColumbus,OH,Cell Phone Store,1000,10000,2023-09-05"}
{"purpose": "Standardize city names and date formats, correct business type misspellings, and normalize loan amount and price fields for government loan application data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew_york,NY,Restuarant,15000,50000,01/12/2023\nlos-angeles,CA,retail,12000,NA,2023-02-25\nChicago,IL,Health Care,NA,40000,15 March 2023\nhouston,TX,retail,8000,30000,2023/04/01\nPHOENIX,AZ,restaurent,9500,27000,04-15-2023\nphiladelphia,PA,Health-Care,10000,35000,2023.05.20\nSan_antonio,TX,Retail,9000,,2023-06-10\nsan diego,CA,RETAIL,8500,28000,June 12 2023\nDallas,TX,healthcare,NA,32000,20230615\nsan jose,CA,Restaurant,13000,45000,2023-07-01\nAustin,TX,retail,11000,33000,07/10/2023\nJacksonville,FL,restaurant,NA,29000,2023-08-05\nFort-worth,TX,HEALTH CARE,10500,31000,08-20-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names and replace underscores/hyphens with spaces", "columnName": "City", "expression": "value.replace('_',' ').replace('-',' ').toTitlecase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["Restuarant", "restaurent", "restaurant"], "to": "Restaurant"}, {"from": ["Health Care", "Health-Care", "healthcare", "HEALTH CARE"], "to": "Health Care"}, {"from": ["retail", "Retail", "RETAIL"], "to": "Retail"}]}, {"op": "core/text-transform", "description": "Convert Price to number type, replace 'NA' or missing with null", "columnName": "Price", "expression": "value=='NA' || value==null || value.trim()=='' ? null : Number(value)"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number type, replace 'NA' or missing with null", "columnName": "LoanAmount", "expression": "value=='NA' || value==null || value.trim()=='' ? null : Number(value)"}, {"op": "core/date-parse", "description": "Parse ApplicationDate to ISO format yyyy-MM-dd", "columnName": "ApplicationDate", "valueType": "date", "dateFormat": "automatic"}, {"op": "core/text-transform", "description": "Format ApplicationDate as yyyy-MM-dd string", "columnName": "ApplicationDate", "expression": "cells['ApplicationDate'].value.toISOString().substring(0,10)"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew York,NY,Restaurant,15000,50000,2023-01-12\nLos Angeles,CA,Retail,12000,null,2023-02-25\nChicago,IL,Health Care,null,40000,2023-03-15\nHouston,TX,Retail,8000,30000,2023-04-01\nPhoenix,AZ,Restaurant,9500,27000,2023-04-15\nPhiladelphia,PA,Health Care,10000,35000,2023-05-20\nSan Antonio,TX,Retail,9000,35000,2023-06-10\nSan Diego,CA,Retail,8500,28000,2023-06-12\nDallas,TX,Health Care,null,32000,2023-06-15\nSan Jose,CA,Restaurant,13000,45000,2023-07-01\nAustin,TX,Retail,11000,33000,2023-07-10\nJacksonville,FL,Restaurant,null,29000,2023-08-05\nFort Worth,TX,Health Care,10500,31000,2023-08-20"}
{"purpose": "Clean and standardize farm loan application data with consistent city names, states, business types, prices, loan amounts, and dates.", "raw_table": "Farm_ID,City,State,BusinessType,Price,LoanAmount,ApplicationDate\n001,Greenfield,ks,grain_farming,15000,5000,2023/01/15\n002,Green-field,KS,Grain Farming,14,5000,01-18-2023\n003,gardenville,MO,fruit_farming ,20000,abc,2023.02.01\n004,,MO,Vegetable-farming,18000,6000,02/05/2023\n005,Greenville,mo,vegetable Farming,17,000,6000,2023-02-07\n006,Springfield,IL,dairy-farming,25000,7000,2023/03/10\n007,Spring field,il,Dairy Farming,25,000,7000,2023-03-15\n008,Springfield,IL,dairy_farming,25000,,2023-03-20\n009,Greenfield,KS,crop-farming,16000,5500,2023-01-20\n010,Greenville,MO,fruit Farming,21000,7500,2023/02/10\n011,Gardenville,MO,fruit_farming,20000,7500,\n012,Greenfield,KS,,15000,5000,2023/01/22\n013,Greenville,MO,fruit Farming,20,500,7500,2023/02/12\n014,Greenfield,KS,grain_farming,15000,5000,2023-01-25", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace in City column", "columnName": "City", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Standardize City names capitalization and fix common misspellings", "columnName": "City", "expression": "value.toLowercase().replace(/green-field|greenfield/, 'Greenfield').replace(/greenville/, 'Greenville').replace(/gardenville/, 'Gardenville').replace(/spring field|springfield/, 'Springfield').replace(/^./, value.charAt(0).toUppercase())"}, {"op": "core/text-transform", "description": "Uppercase State codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix BusinessType values to standard set", "columnName": "BusinessType", "edits": [{"from": ["grain_farming", "Grain Farming", "grain_farming"], "to": "Grain Farming"}, {"from": ["fruit_farming", "fruit Farming", "fruit_farming "], "to": "Fruit Farming"}, {"from": ["vegetable-farming", "vegetable Farming"], "to": "Vegetable Farming"}, {"from": ["dairy-farming", "Dairy Farming", "dairy_farming"], "to": "Dairy Farming"}, {"from": ["crop-farming"], "to": "Crop Farming"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Fix Price column: remove commas, fix misplaced decimals", "columnName": "Price", "expression": "value.replace(/[,]/, '').replace(/^([0-9]+)\\s*([0-9]{3})$/, '$1$2').toNumber()"}, {"op": "core/text-transform", "description": "Fix LoanAmount column: remove commas, convert non-numeric to null", "columnName": "LoanAmount", "expression": "isNaN(value.replace(/[,]/, '').toNumber()) ? null : value.replace(/[,]/, '').toNumber()"}, {"op": "core/date-parse", "description": "Parse ApplicationDate to standard yyyy-MM-dd", "columnName": "ApplicationDate", "dateFormat": "yyyy-MM-dd", "expression": "value.toDate()"}, {"op": "core/fill-down", "description": "Fill down missing City values", "columnName": "City"}, {"op": "core/fill-down", "description": "Fill down missing BusinessType values", "columnName": "BusinessType"}], "clean_table": "Farm_ID,City,State,BusinessType,Price,LoanAmount,ApplicationDate\n001,Greenfield,KS,Grain Farming,15000,5000,2023-01-15\n002,Greenfield,KS,Grain Farming,14500,5000,2023-01-18\n003,Gardenville,MO,Fruit Farming,20000,null,2023-02-01\n004,Gardenville,MO,Vegetable Farming,18000,6000,2023-02-05\n005,Greenville,MO,Vegetable Farming,17000,6000,2023-02-07\n006,Springfield,IL,Dairy Farming,25000,7000,2023-03-10\n007,Springfield,IL,Dairy Farming,25000,7000,2023-03-15\n008,Springfield,IL,Dairy Farming,25000,null,2023-03-20\n009,Greenfield,KS,Crop Farming,16000,5500,2023-01-20\n010,Greenville,MO,Fruit Farming,21000,7500,2023-02-10\n011,Gardenville,MO,Fruit Farming,20000,7500,null\n012,Greenfield,KS,Unknown,15000,5000,2023-01-22\n013,Greenville,MO,Fruit Farming,20500,7500,2023-02-12\n014,Greenfield,KS,Grain Farming,15000,5000,2023-01-25"}
{"purpose": "Standardize city names, business types, and date formats in a government loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew-york,ny,Retail,100000,50000,01/15/2023\nlos angeles,CA,restuarant,85000,45000,2023-02-20\nCHICAGO,il,Non-Profit,75000,35000,15-03-2023\nhouston_TX,tx,retail,NaN,40000,3/25/2023\nPhoenix,az,Government-Agency,95000,NaN,2023/04/01\nphiladelphia,pa,retail,88000,42000,April 5 2023\nsan antonio,tx,Retail_,93000,46000,2023.04.10\nSan-diego,CA,restaurant,87000,43000,2023/04/15\n_dallas,tx,Non-profit,80000,,4-20-2023\nsan jose,ca,retail,82000,41000,2023-04-25\nAustin-Tx,tx,government agency,90000,47000,26 Apr 2023\njacksonville,fl,Restuarant,76000,36000,2023-04-28\nfort worth,Tx,RETAIL,84000,44000,29-04-2023\ncolumbus,OH,retail,81000,40500,2023-05-01\ncharlotte,NC,,79000,39000,May 3 2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens from City and capitalize each word", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').split(' ').map(s => s.toLowerCase().capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase state codes", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType names", "columnName": "BusinessType", "expression": "value.toLowerCase().replace(/restuarant|restaurant/g, 'Restaurant').replace(/retail_?/g, 'Retail').replace(/non[- ]?profit/g, 'Non-Profit').replace(/government[- ]?agency/g, 'Government Agency').trim().replace(/^(|null|nan)$/i, '')"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Retail"}]}, {"op": "core/text-transform", "description": "Convert Price to numbers, replace NaN or empty with 0", "columnName": "Price", "expression": "isNaN(value) || value == 'NaN' || value == '' ? 0 : Number(value)"}, {"op": "core/text-transform", "description": "Convert LoanAmount to numbers, replace missing with 0", "columnName": "LoanAmount", "expression": "isNaN(value) || value == '' ? 0 : Number(value)"}, {"op": "core/text-transform", "description": "Parse Date with multiple formats to ISO yyyy-MM-dd", "columnName": "Date", "expression": "date.parse(value, ['MM/dd/yyyy','yyyy-MM-dd','dd-MM-yyyy','M/d/yyyy','yyyy/MM/dd','MMMM d yyyy','yyyy.MM.dd','d MMM yyyy','d-MM-yyyy','MMMM d yyyy']).toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,100000,50000,2023-01-15\nLos Angeles,CA,Restaurant,85000,45000,2023-02-20\nChicago,IL,Non-Profit,75000,35000,2023-03-15\nHouston,TX,Retail,0,40000,2023-03-25\nPhoenix,AZ,Government Agency,95000,0,2023-04-01\nPhiladelphia,PA,Retail,88000,42000,2023-04-05\nSan Antonio,TX,Retail,93000,46000,2023-04-10\nSan Diego,CA,Restaurant,87000,43000,2023-04-15\nDallas,TX,Non-Profit,80000,0,2023-04-20\nSan Jose,CA,Retail,82000,41000,2023-04-25\nAustin,TX,Government Agency,90000,47000,2023-04-26\nJacksonville,FL,Restaurant,76000,36000,2023-04-28\nFort Worth,TX,Retail,84000,44000,2023-04-29\nColumbus,OH,Retail,81000,40500,2023-05-01\nCharlotte,NC,Retail,79000,39000,2023-05-03"}
{"purpose": "Standardize crop names and correct inconsistent loan amount formats in agricultural financing data.", "raw_table": "FarmID,Crop,Region,Loan_Amount,Loan_Date\n001,wHeaT,north_region,$15k,2023/03/01\n002,corn,NORTH-region,12000,03-15-2023\n003,soy-bean,SouthRegion,13000.00,15/04/2023\n004,ricE,south_region,,2023-04-20\n005,Cotton,north_region,$11,500,2023/03/25\n006,Wheat,north-region,14000,04/05/2023\n007,maize,South_Region,13500,2023/04/10\n008,soybean,southregion,13,000,2023/04/18\n009,Cotton,North_Region,11.500,2023/03/30\n010,Soy-bean,south-region,$13000,2023-04-22", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize Crop names capitalization and remove extra hyphens/underscores", "engineConfig": {"facets": []}, "columnName": "Crop", "expression": "value.toLowercase().replace(/[-_]/,'').replace(/^./,v,v.toUppercase())"}, {"op": "core/text-transform", "description": "Normalize Region names capitalization and remove underscores/hyphens", "engineConfig": {"facets": []}, "columnName": "Region", "expression": "value.toLowercase().replace(/[-_]/,' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Remove dollar signs and commas from Loan_Amount and convert to number", "engineConfig": {"facets": []}, "columnName": "Loan_Amount", "expression": "value.replace(/[\\$,]/g,'').replace(/k$/i, '000').toNumber()"}, {"op": "core/mass-edit", "description": "Fill missing Loan_Amount values with average (manually set to 13000 for example)", "columnName": "Loan_Amount", "edits": [{"from": [""], "to": "13000"}]}, {"op": "core/date-parse", "description": "Parse Loan_Date column to ISO date format", "columnName": "Loan_Date", "mode": "normal", "onError": "keep-original", "pattern": "best-effort"}, {"op": "core/text-transform", "description": "Format Loan_Date to yyyy-MM-dd", "engineConfig": {"facets": []}, "columnName": "Loan_Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "FarmID,Crop,Region,Loan_Amount,Loan_Date\n001,Wheat,North Region,15000,2023-03-01\n002,Corn,North Region,12000,2023-03-15\n003,Soybean,South Region,13000,2023-04-15\n004,Rice,South Region,13000,2023-04-20\n005,Cotton,North Region,11500,2023-03-25\n006,Wheat,North Region,14000,2023-04-05\n007,Maize,South Region,13500,2023-04-10\n008,Soybean,South Region,13000,2023-04-18\n009,Cotton,North Region,11500,2023-03-30\n010,Soybean,South Region,13000,2023-04-22"}
{"purpose": "Standardize movie genre names and correct release date formats in a movie dataset.", "raw_table": "MovieTitle,Genre,ReleaseDate,BoxOffice\nThe_firestorm,Action-Thriller,2019/07/15,150000000\nlove_in_paris,romance,15-02-2018,85000000\nThe last-battle,Action,2018-11-30,not available\nMystic_River,drama,March 5, 2017,62000000\nStarQuest,Sci-fi,2017/13/01,98000000\nGhost_shadow,horror,2019-10-31,45000000\nOcean's_Twelfth,comedy,2018/04/01,73000000\nNight_fall,Thriller,2018-10-12,67000000\nLost in time, sci fi ,2018-08-21,54000000\nThe_Finale,action ,2019-12-01,110000000\nSunset boulevard,Drama,2017/05/20,78000000\nLaugh riot,COMEDY,2019-06-15,92000000\nFrozen-Heart,romance,2018/02/30,30000000", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in MovieTitle with spaces, and title case", "columnName": "MovieTitle", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Trim whitespace and lowercase Genre", "columnName": "Genre", "expression": "value.trim().toLowercase()"}, {"op": "core/mass-edit", "description": "Standardize Genre values", "columnName": "Genre", "edits": [{"from": ["action-thriller", "thriller"], "to": "Thriller"}, {"from": ["action", "action "], "to": "Action"}, {"from": ["romance"], "to": "Romance"}, {"from": ["drama"], "to": "Drama"}, {"from": ["comedy", "comedy "], "to": "Comedy"}, {"from": ["sci-fi", "sci fi"], "to": "Sci-Fi"}, {"from": ["horror"], "to": "Horror"}]}, {"op": "core/text-transform", "description": "Fix invalid ReleaseDate '2017/13/01' to blank", "columnName": "ReleaseDate", "expression": "if(value == '2017/13/01', '', value) else value"}, {"op": "core/text-transform", "description": "Fix invalid date '2018/02/30' to blank", "columnName": "ReleaseDate", "expression": "if(value == '2018/02/30', '', value) else value"}, {"op": "core/date-parse", "description": "Parse ReleaseDate to yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "value.toDate('yyyy/MM/dd').toString('yyyy-MM-dd') || value.toDate('dd-MM-yyyy').toString('yyyy-MM-dd') || value.toDate('MMMM d, yyyy').toString('yyyy-MM-dd') || value"}, {"op": "core/mass-edit", "description": "Replace release dates not properly parsed with blanks", "columnName": "ReleaseDate", "edits": [{"from": ["2017/13/01", "2018/02/30", "not available"], "to": ""}]}, {"op": "core/text-transform", "description": "Normalize BoxOffice to numeric, replace 'not available' with blank", "columnName": "BoxOffice", "expression": "value.toNumber() || ''"}], "clean_table": "MovieTitle,Genre,ReleaseDate,BoxOffice\nThe Firestorm,Thriller,2019-07-15,150000000\nLove In Paris,Romance,2018-02-15,85000000\nThe Last Battle,Action,2018-11-30,\nMystic River,Drama,2017-03-05,62000000\nStarquest,Sci-Fi,,98000000\nGhost Shadow,Horror,2019-10-31,45000000\nOcean's Twelfth,Comedy,2018-04-01,73000000\nNight Fall,Thriller,2018-10-12,67000000\nLost In Time,Sci-Fi,2018-08-21,54000000\nThe Finale,Action,2019-12-01,110000000\nSunset Boulevard,Drama,2017-05-20,78000000\nLaugh Riot,Comedy,2019-06-15,92000000\nFrozen Heart,Romance,,30000000"}
{"purpose": "Clean inconsistent city and state names, normalize business types, and standardize price and date formats in energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew_york,ny,solar-installation,45000,100000,01/12/2022\nLOS-ANGELES,CA,Wind-Turbine,55000,120000,2022-02-15\nhouston,,solar installation, 47000,85000,03-10-2022\nChicago,il,wind turbine,53000,,2022/04/05\nphoenix,Az,Geothermal,49000,90000,April 15 2022\nphiladelphia,PA,solar-install,46000,95000,15/05/2022\nSan_Antonio,TX,solar installation,47000,88000,2022.06.20\nsan diego,ca,WindTurbine,52000,110000,07-25-22\nDallas,TX,solar_installation,46000,87000,2022/08/15\nsan jose,CA,Geothermal,50000,92000,09-10-2022\nAustin,tx,solar installation,48000,89000,October 5, 2022\nJacksonville,FL,SOLAR-Installation,45000,85000,11/11/2022\nfort worth,TX,wind turbine,54000,115000,2022-12-01\nColumbus,OH,geothermal,49500,93000,12/15/2022\ncharlotte,nc,solar_installation,46000,87000,2022-12-25", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.toLowercase().replace(/[_-]/g, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Standardize State names to uppercase two-letter codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fill missing State values by manual mapping", "columnName": "State", "edits": [{"from": [""], "to": "TX"}]}, {"op": "core/text-transform", "description": "Normalize BusinessType values to title case and remove hyphens/underscores", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[-_]/g, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Trim and convert Price to numeric string without spaces", "columnName": "Price", "expression": "value.replace(/\\s+/g, '').toNumber().toString()"}, {"op": "core/text-transform", "description": "Fill missing LoanAmount as '0' for numeric consistency", "columnName": "LoanAmount", "expression": "if(value == null || value.trim() == '') '0' else value.replace(/\\s+/g, '')"}, {"op": "core/text-transform", "description": "Parse various date formats to ISO 8601 (yyyy-MM-dd)", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,45000,100000,2022-01-12\nLos Angeles,CA,Wind Turbine,55000,120000,2022-02-15\nHouston,TX,Solar Installation,47000,85000,2022-03-10\nChicago,IL,Wind Turbine,53000,0,2022-04-05\nPhoenix,AZ,Geothermal,49000,90000,2022-04-15\nPhiladelphia,PA,Solar Install,46000,95000,2022-05-15\nSan Antonio,TX,Solar Installation,47000,88000,2022-06-20\nSan Diego,CA,Wind Turbine,52000,110000,2022-07-25\nDallas,TX,Solar Installation,46000,87000,2022-08-15\nSan Jose,CA,Geothermal,50000,92000,2022-09-10\nAustin,TX,Solar Installation,48000,89000,2022-10-05\nJacksonville,FL,Solar Installation,45000,85000,2022-11-11\nFort Worth,TX,Wind Turbine,54000,115000,2022-12-01\nColumbus,OH,Geothermal,49500,93000,2022-12-15\nCharlotte,NC,Solar Installation,46000,87000,2022-12-25"}
{"purpose": "Clean and standardize city names, business types, and date formats in telecommunications customer data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ActivationDate\nNew_york,NY,Mobile-Carrier,299.99,15000,01/12/2023\nlos angeles,ca,ISP,199.95,,2023-02-15\nSan Francisco,CA,Mobile carrier,349.50,20000,15-03-2023\nHouston,tx,ISP,149.00,12000,03/10/2023\nchicago,IL,Mobile-carrier,279.99,18000,2023/04/01\nPhoenix,AZ,ISP,189.99,11000,April 5 2023\nphiladelphia,pa,Mobile_carrier,310.00,17000,2023.06.07\nSan-antonio,TX,,159.95,13000,06-15-2023\nDallas,TX,ISP,NaN,14000,07/01/2023\nSan Diego,CA,MobileCarrier,329.99,NaN,2023-08-12\nAustin,tx,ISP,179.99,12500,08/20/2023\nJacksonville,FL,Mobile-carrier,290.00,16000,2023-09-10\nfort worth,tx,ISP,165.00,11500,09-25-2023\nColumbus,OH,MObile_Carrier,305.49,17500,2023/10/05\nCharlotte,NC,ISP,184.75,13000,10-15-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names with spaces", "columnName": "City", "expression": "value.replace(/[_-]/, ' ')"}, {"op": "core/text-transform", "description": "Capitalize each word in City", "columnName": "City", "expression": "value.toLowerCase().split(' ').map(w, w.charAt(0).toUpperCase() + w.slice(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize BusinessType names", "columnName": "BusinessType", "edits": [{"from": ["Mobile-Carrier", "mobile carrier", "Mobile carrier", "Mobile-carrier", "Mobile_carrier", "MobileCarrier", "MObile_Carrier"], "to": "Mobile Carrier"}, {"from": ["ISP", "isp"], "to": "ISP"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Normalize State to uppercase", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/text-transform", "description": "Convert Price to number, replace NaN with null", "columnName": "Price", "expression": "isNaN(parseFloat(value)) ? null : parseFloat(value)"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number, replace missing with null", "columnName": "LoanAmount", "expression": "value.trim() === '' ? null : Number(value)"}, {"op": "core/date-parse", "description": "Parse ActivationDate to yyyy-MM-dd", "columnName": "ActivationDate", "dateFormat": "yyyy-MM-dd", "onError": "keep-original", "onInvalid": "keep-original"}, {"op": "core/text-transform", "description": "Standardize ActivationDate with various formats", "columnName": "ActivationDate", "expression": "if(value.match(/^\\d{2}\\/\\d{2}\\/\\d{4}$/)) { var d= value.split('/'); d[2] + '-' + d[0].padStart(2,'0') + '-' + d[1].padStart(2,'0') } else if(value.match(/^\\d{4}-\\d{2}-\\d{2}$/)) { value } else if(value.match(/^\\d{2}-\\d{2}-\\d{4}$/)) { var d= value.split('-'); d[2] + '-' + d[0].padStart(2,'0') + '-' + d[1].padStart(2,'0') } else if(value.match(/^\\d{4}\\/\\d{2}\\/\\d{2}$/)) { value.replace(/\\//g,'-') } else if(value.match(/^\\d{4}\\.\\d{2}\\.\\d{2}$/)) { value.replace(/\\./g,'-') } else if(value.match(/^[A-Za-z]+ \\d{1,2} \\d{4}$/)) { var m=moment(value, \"MMMM D YYYY\"); m.isValid() ? m.format(\"YYYY-MM-DD\") : value } else value"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ActivationDate\nNew York,NY,Mobile Carrier,299.99,15000,2023-01-12\nLos Angeles,CA,ISP,199.95,,2023-02-15\nSan Francisco,CA,Mobile Carrier,349.5,20000,2023-03-15\nHouston,TX,ISP,149,12000,2023-03-10\nChicago,IL,Mobile Carrier,279.99,18000,2023-04-01\nPhoenix,AZ,ISP,189.99,11000,2023-04-05\nPhiladelphia,PA,Mobile Carrier,310,17000,2023-06-07\nSan Antonio,TX,Unknown,159.95,13000,2023-06-15\nDallas,TX,ISP,,14000,2023-07-01\nSan Diego,CA,Mobile Carrier,329.99,,2023-08-12\nAustin,TX,ISP,179.99,12500,2023-08-20\nJacksonville,FL,Mobile Carrier,290,16000,2023-09-10\nFort Worth,TX,ISP,165,11500,2023-09-25\nColumbus,OH,Mobile Carrier,305.49,17500,2023-10-05\nCharlotte,NC,ISP,184.75,13000,2023-10-15"}
{"purpose": "Clean inconsistent movie genre names and normalize date formats in the entertainment dataset.", "raw_table": "Title,Genre,ReleaseDate,Rating,BoxOffice,Duration\n\"The Last_Hero\",\"actiON\",\"12/25/2019\",8.2,\"$150 million\",\"2h 15m\"\n\"Queen_of_Shadows\",\"fantasy-Adventure\",\"2018-07-15\",7.5,\"200M\",\"135 minutes\"\n\"Space-Race\",\"Sci-fi\",\"03.11.2020\",7.9,\"$120,000,000\",\"130min\"\n\"Silent_Night\",\"horror\",\"2017/10/31\",6.8,\"85 million\",\"1:45\"\n\"Love & Chaos\",\"RomCom\",\"2019-02-14\",7.0,\"$50m\",\"110\"\n\"The_Last_Hero\",\"Action\",\"December 25, 2019\",8.3,\"$150,000,000\",\"135\"\n\"Galactic_Quest\",\"SCI-FI\",\"2020-03-11\",8.0,\"120 million\",\"2 hours 10 minutes\"\n\"Haunted_House\",\"HORROR\",\"31-10-2017\",6.9,\"$85,000,000\",\"105\"\n\"Rom-Com_Rendezvous\",\"rom com\",\"14 feb 2019\",7.1,\"50000000\",\"1h50\"\n\"Adventure_Trails\",\"Fantasy Adventure\",\"15-07-2018\",7.4,\"$200,000,000\",\"2h15\"\n\"Space Race\",\"SciFi\",\"2020/03/11\",7.8,\"$119M\",\"130 mins\"\n\"Silent Night\",\"HOROR\",\"2017-10-31\",6.7,\"85M\",\"1h 45m\"\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize Genre capitalization and remove extra characters", "columnName": "Genre", "expression": "value.toLowercase().replace(/[-_]/g, ' ').replace(/rom com|romcom/, 'romcom').replace(/horor/, 'horror').replace(/sci fi|sci-fi|scifi/, 'scifi').replace(/fantasy adventure/, 'fantasy-adventure').trim()"}, {"op": "core/mass-edit", "description": "Standardize Genre values", "columnName": "Genre", "edits": [{"from": ["actiON", "action"], "to": "action"}, {"from": ["fantasy adventure", "fantasy-adventure"], "to": "fantasy-adventure"}, {"from": ["scifi", "sci-fi", "sci fi"], "to": "sci-fi"}, {"from": ["horror", "horor"], "to": "horror"}, {"from": ["romcom", "rom com"], "to": "romcom"}]}, {"op": "core/date-parse", "description": "Parse and standardize ReleaseDate to yyyy-MM-dd", "columnName": "ReleaseDate", "format": "auto"}, {"op": "core/text-transform", "description": "Normalize BoxOffice to numeric million dollars", "columnName": "BoxOffice", "expression": "value.toLowercase().replace(/[$,]/g, '').replace(/m|million/, '').trim() + 'M'"}, {"op": "core/text-transform", "description": "Normalize Duration to minutes as integer", "columnName": "Duration", "expression": "if(value.match(/\\d+h\\s*\\d+m/i)) { var parts = value.match(/(\\d+)h\\s*(\\d+)m/i); (parseInt(parts[1]) * 60 + parseInt(parts[2])).toString(); } else if(value.match(/\\d+\\s*hours?/i)) { var h = value.match(/(\\d+)/); (parseInt(h[1]) * 60).toString(); } else if(value.match(/\\d+\\s*min/i)) { var m = value.match(/(\\d+)/); m[1]; } else if(value.match(/\\d{1,3}/)) { value.match(/\\d{1,3}/)[0]; } else if(value.match(/\\d+:\\d{2}/)) { var t = value.match(/(\\d+):(\\d{2})/); (parseInt(t[1]) * 60 + parseInt(t[2])).toString(); } else { value }"}, {"op": "core/mass-edit", "description": "Standardize Title capitalization and fix underscores", "columnName": "Title", "edits": [{"from": ["The Last_Hero", "The_Last_Hero"], "to": "The Last Hero"}, {"from": ["Queen_of_Shadows"], "to": "Queen of Shadows"}, {"from": ["Space-Race", "Space Race"], "to": "Space Race"}, {"from": ["Silent_Night", "Silent Night"], "to": "Silent Night"}, {"from": ["Love & Chaos"], "to": "Love & Chaos"}, {"from": ["Galactic_Quest"], "to": "Galactic Quest"}, {"from": ["Haunted_House"], "to": "Haunted House"}, {"from": ["Rom-Com_Rendezvous"], "to": "Rom-Com Rendezvous"}, {"from": ["Adventure_Trails"], "to": "Adventure Trails"}]}], "clean_table": "Title,Genre,ReleaseDate,Rating,BoxOffice,Duration\nThe Last Hero,action,2019-12-25,8.2,150M,135\nQueen of Shadows,fantasy-adventure,2018-07-15,7.5,200M,135\nSpace Race,sci-fi,2020-03-11,7.9,120M,130\nSilent Night,horror,2017-10-31,6.8,85M,105\nLove & Chaos,romcom,2019-02-14,7.0,50M,110\nThe Last Hero,action,2019-12-25,8.3,150M,135\nGalactic Quest,sci-fi,2020-03-11,8.0,120M,130\nHaunted House,horror,2017-10-31,6.9,85M,105\nRom-Com Rendezvous,romcom,2019-02-14,7.1,50M,110\nAdventure Trails,fantasy-adventure,2018-07-15,7.4,200M,135\nSpace Race,sci-fi,2020-03-11,7.8,119M,130\nSilent Night,horror,2017-10-31,6.7,85M,105\n"}
{"purpose": "Standardize and correct customer subscription data with inconsistent city names, business types, and date formats.", "raw_table": "CustomerID,City,State,BusinessType,SubscriptionPrice,LoanAmount,SubscriptionDate\n1001,new_york,NY,Retailer,49.99,5000,01-15-2023\n1002,los-angeles,CA,wholesaler,59.99,NaN,2023/02/20\n1003,CHICAGO,IL,Retailr,39.99,3000,2023.03.10\n1004,HousTon,TX,Wholesaler, ,4000,Mar 25 2023\n1005,phoenix,AZ,retailer,29.99,3500,2023-04-01\n1006,Philadelphia,PA,Retailer,49.99,4500,04/15/2023\n1007,san antonio,tx,Whol-saleR,59.99,5000,15-05-2023\n1008,Dallas,TX,Retailer_ ,49.99,4800,May 30 2023\n1009,san-diego,CA,RETAILER,39.99,4000,2023/06/10\n1010,DENVER,co,wholesaler,59.99,5200,07.01.2023\n1011,boston,MA,Retailer,49.99,NaN,2023-08-05\n1012,miami,FL,whole-saler,59.99,5500,08/20/2023\n1013,Seattle,WA,Retailer,49.99,,2023-09-10\n1014,Denver,CO,Wholesaler,59.99,5300,2023-10-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City names to title case and remove underscores and hyphens", "columnName": "City", "expression": "value.toLowercase().replace(/[_-]/,' ').split(' ').map(s, s[0].toUppercase() + s.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Fix BusinessType misspellings and remove extra characters", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[^a-z]/g,'').replace('retailr','retailer').replace('wholesaler','wholesaler').replace('wholesale','wholesaler').replace('wholesaler','wholesaler')"}, {"op": "core/mass-edit", "description": "Fill missing SubscriptionPrice with 49.99", "columnName": "SubscriptionPrice", "edits": [{"from": [""], "to": "49.99"}]}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount with 4500", "columnName": "LoanAmount", "edits": [{"from": ["NaN", ""], "to": "4500"}]}, {"op": "core/text-transform", "description": "Convert SubscriptionPrice to number", "columnName": "SubscriptionPrice", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number", "columnName": "LoanAmount", "expression": "value.toNumber()"}, {"op": "core/date-parse", "description": "Parse SubscriptionDate into yyyy-MM-dd format", "columnName": "SubscriptionDate", "expression": "value.toDate()", "onError": "set-to-blank", "onInvalid": "keep-original"}, {"op": "core/text-transform", "description": "Format SubscriptionDate to ISO 8601 yyyy-MM-dd", "columnName": "SubscriptionDate", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "CustomerID,City,State,BusinessType,SubscriptionPrice,LoanAmount,SubscriptionDate\n1001,New York,NY,retailer,49.99,5000,2023-01-15\n1002,Los Angeles,CA,wholesaler,59.99,4500,2023-02-20\n1003,Chicago,IL,retailer,39.99,3000,2023-03-10\n1004,Houston,TX,wholesaler,49.99,4000,2023-03-25\n1005,Phoenix,AZ,retailer,29.99,3500,2023-04-01\n1006,Philadelphia,PA,retailer,49.99,4500,2023-04-15\n1007,San Antonio,TX,wholesaler,59.99,5000,2023-05-15\n1008,Dallas,TX,retailer,49.99,4800,2023-05-30\n1009,San Diego,CA,retailer,39.99,4000,2023-06-10\n1010,Denver,CO,wholesaler,59.99,5200,2023-07-01\n1011,Boston,MA,retailer,49.99,4500,2023-08-05\n1012,Miami,FL,wholesaler,59.99,5500,2023-08-20\n1013,Seattle,WA,retailer,49.99,4500,2023-09-10\n1014,Denver,CO,wholesaler,59.99,5300,2023-10-01"}
{"purpose": "Standardize city and business type names, fix date formats, and correct numeric fields in energy loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew_york,NY,solar_Installation,15000,12000,01/15/2023\nlos angeles,ca,Wind-Turbine,20000,NaN,2023-02-20\nhouston,tx,Solar instalation,18000,15000,15-03-2023\nphoenix,az,WIND_turbine,NaN,13000,2023/04/10\nphiladelphia,PA,solar-installation,16000,14000,April 25 2023\nsan antonio,TX,wind turbine,21000,18000,2023.05.30\nsan_diego,CA,Solar Installation,17000,NaN,06/15/23\ndallas,tx,solar-installation,16500,13500,2023-07-01\nsan_jose,ca,Wind_turbine,19000,16000,07/20/2023\naustin,TX,solar-installation,-,12500,08/01/2023\njacksonville,fl,WIND-turbine,22000,20000,2023-08-15\nfort worth,TX,SolarInstallation,17500,15000,2023/09/05\ncolumbus,OH,solar-installation,NaN,14000,09/20/2023", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["san antonio"], "to": "San Antonio"}, {"from": ["san_diego"], "to": "San Diego"}, {"from": ["san_jose"], "to": "San Jose"}, {"from": ["fort worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["solar_Installation", "Solar Installation", "solar-installation", "SolarInstallation", "Solar instalation"], "to": "Solar Installation"}, {"from": ["Wind-Turbine", "WIND_turbine", "wind turbine", "Wind_turbine", "WIND-turbine"], "to": "Wind Turbine"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "if(value == '-' || value == 'NaN' || value == '', null, Number(value))"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "if(value == 'NaN' || value == '', null, Number(value))"}, {"op": "core/text-transform", "columnName": "LoanDate", "expression": "value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/) ? value : (value.match(/\\d{4}-\\d{2}-\\d{2}/) ? value : (value.match(/\\d{2}-\\d{2}-\\d{4}/) ? value.split('-').reverse().join('-') : (value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/) ? value.split('/').reverse().join('-') : (value.match(/[A-Za-z]+ \\d{1,2} \\d{4}/) ? new Date(value).toISOString().substring(0,10) : (value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/) ? value.replace(/\\./g,'-') : value)))))"}, {"op": "core/date-parse", "columnName": "LoanDate", "format": "yyyy-MM-dd", "mode": "lenient"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew York,NY,Solar Installation,15000,12000,2023-01-15\nLos Angeles,CA,Wind Turbine,20000,,2023-02-20\nHouston,TX,Solar Installation,18000,15000,2023-03-15\nPhoenix,AZ,Wind Turbine,,13000,2023-04-10\nPhiladelphia,PA,Solar Installation,16000,14000,2023-04-25\nSan Antonio,TX,Wind Turbine,21000,18000,2023-05-30\nSan Diego,CA,Solar Installation,17000,,2023-06-15\nDallas,TX,Solar Installation,16500,13500,2023-07-01\nSan Jose,CA,Wind Turbine,19000,16000,2023-07-20\nAustin,TX,Solar Installation,,12500,2023-08-01\nJacksonville,FL,Wind Turbine,22000,20000,2023-08-15\nFort Worth,TX,Solar Installation,17500,15000,2023-09-05\nColumbus,OH,Solar Installation,,14000,2023-09-20"}
{"purpose": "Standardize and clean agricultural loan application data focusing on city names, business types, and numeric fields for accurate analysis.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nSpring_field,IL,FArm-ing,120000,50000,2023/04/10\nDavenport,ia,,95000,40000,04-15-2023\ncedar-rapids,IA,Equipment-Sales,85000,,2023.04.20\nPeoria,IL,FARMING,110000,45000,2023/4/25\nmoline,IL,Seed_Supplier,78000,35000,25/04/2023\nspringfield,il,farming,115000,48000,2023-04-30\nBloomington,IL,Seed Supplier,NaN,42000,2023/04/28\nDavenport,IA,Equipment-Sales,90000,NaN,2023/04/22\nCEDAR RAPIDS,ia,Seed-Supplier,82000,36000,2023/04/18\nPeoria,il,farming,112000,47000,April 27, 2023\nMoline,IL,Equipment_Sales,79000,35500,2023/04/26\nBloomington,IL,,85000,43000,2023-04-29\nSpring_field,IL,Farming,118000,49000,2023/04/20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.toLowercase().replaceAll('_',' ').replaceAll('-', ' ').split(' ').map(s, s[0].toUppercase()+s.slice(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Correct State codes to uppercase", "columnName": "State", "edits": [{"from": ["ia", "il", "Ia", "Il", "iA", "Il"], "to": "IA"}, {"from": ["il", "Il", "iL", "IL"], "to": "IL"}]}, {"op": "core/text-transform", "description": "Normalize BusinessType by fixing underscores and hyphens, capitalize each word", "columnName": "BusinessType", "expression": "if(value==null || value.trim()=='', 'Unknown', value.toLowercase().replaceAll('_',' ').replaceAll('-', ' ').split(' ').map(s, s[0].toUppercase()+s.slice(1)).join(' '))"}, {"op": "core/mass-edit", "description": "Fix known misspellings in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["Farm-ing", "Farming", "Farming"], "to": "Farming"}, {"from": ["Seed Supplier", "Seed-Supplier", "Seed Supplier"], "to": "Seed Supplier"}, {"from": ["Equipment Sales", "Equipment Sales", "Equipment Sales"], "to": "Equipment Sales"}, {"from": ["Unknown"], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numbers, replace NaN or missing with null", "columnName": "Price", "expression": "if(value.toLowercase()=='nan' || value.trim()==='', null, Number(value))"}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numbers, replace NaN or missing with null", "columnName": "LoanAmount", "expression": "if(value.toLowercase()=='nan' || value.trim()==='', null, Number(value))"}, {"op": "core/text-transform", "description": "Parse and unify date formats to yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/fill-down", "description": "Fill down missing BusinessType values", "columnName": "BusinessType"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nSpring Field,IL,Farming,120000,50000,2023-04-10\nDavenport,IA,Unknown,95000,40000,2023-04-15\nCedar Rapids,IA,Equipment Sales,85000,,2023-04-20\nPeoria,IL,Farming,110000,45000,2023-04-25\nMoline,IL,Seed Supplier,78000,35000,2023-04-25\nSpringfield,IL,Farming,115000,48000,2023-04-30\nBloomington,IL,Seed Supplier,,42000,2023-04-28\nDavenport,IA,Equipment Sales,90000,,2023-04-22\nCedar Rapids,IA,Seed Supplier,82000,36000,2023-04-18\nPeoria,IL,Farming,112000,47000,2023-04-27\nMoline,IL,Equipment Sales,79000,35500,2023-04-26\nBloomington,IL,Unknown,85000,43000,2023-04-29\nSpring Field,IL,Farming,118000,49000,2023-04-20"}
{"purpose": "Clean and standardize city and state names, normalize business types, fix date formats, and ensure numeric columns have correct types and formatting.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,retail,1200.50,15000,2023/01/15\nlos-angeles,CA,service,800,8000,15-02-2023\nchicago,IL,retail_,1000.75,,2023.03.10\nhouston,tx,Services,950,7000,03/25/2023\nphoenix,az,retail,1100,-5000,2023-04-05\nphiladelphia,PA,Service,1050.25,9000,2023/04/18\nsan antonio,TX,retail,950,,2023-05-02\nSan_diego,ca,service,850,7500,2023/05/15\nDallas,TX,retail,1000,8500,05/20/2023\nsan_jose,CA,service,900,7000,2023/06/01\nAustin,tx,retail,invalid,6500,2023-06-10\njacksonville,FL,,1200,8000,2023/06/15\nfort-worth,TX,retail,1100.5,7500,2023-06-20\ncolumbus,oh,service,950,7000,2023/07/01\ncharlotte,NC,retail,1000,8000,2023/07/05", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names with spaces and proper capitalization", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase two-letter format", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["retail_", "retail"], "to": "Retail"}, {"from": ["service", "Services", "Service"], "to": "Service"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Fix Price column: replace 'invalid' with blank and convert to number", "columnName": "Price", "expression": "value.toLowercase() == 'invalid' ? null : value"}, {"op": "core/text-transform", "description": "Convert Price to number, empty to null", "columnName": "Price", "expression": "isNonBlank(value) ? value.toNumber() : null"}, {"op": "core/text-transform", "description": "Fix negative LoanAmount to null (invalid)", "columnName": "LoanAmount", "expression": "value.toNumber() < 0 ? null : value"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number or null if blank", "columnName": "LoanAmount", "expression": "isNonBlank(value) ? value.toNumber() : null"}, {"op": "core/date-parse", "description": "Parse Date to standard yyyy-MM-dd", "columnName": "Date", "dateFormat": "auto", "mode": "normal"}, {"op": "core/column-rename", "description": "Rename City to CityName for clarity", "oldColumnName": "City", "newColumnName": "CityName"}], "clean_table": "CityName,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,1200.5,15000,2023-01-15\nLos Angeles,CA,Service,800,8000,2023-02-15\nChicago,IL,Retail,1000.75,,2023-03-10\nHouston,TX,Service,950,7000,2023-03-25\nPhoenix,AZ,Retail,1100,,2023-04-05\nPhiladelphia,PA,Service,1050.25,9000,2023-04-18\nSan Antonio,TX,Retail,950,,2023-05-02\nSan Diego,CA,Service,850,7500,2023-05-15\nDallas,TX,Retail,1000,8500,2023-05-20\nSan Jose,CA,Service,900,7000,2023-06-01\nAustin,TX,,null,6500,2023-06-10\nJacksonville,FL,Unknown,1200,8000,2023-06-15\nFort Worth,TX,Retail,1100.5,7500,2023-06-20\nColumbus,OH,Service,950,7000,2023-07-01\nCharlotte,NC,Retail,1000,8000,2023-07-05"}
{"purpose": "Clean and standardize farm loan application data with inconsistent city names, date formats, and numeric values.", "raw_table": "City,State,CropType,LoanAmount,ApplicationDate,FarmSize\nSpringfield,IL,Corn,15000,04-15-2023,120_acres\nriverside,CA,WHeat,20000,2023/05/01,95-acres\nGreenfield,IN,Soybean,,15.06.2023,110_acres\nspringfield,il,Corn,15500,2023-04-16,120_acres\nRiverside,ca,soybean,21000,May 2 2023, \nGreenfield,IN,Corn,14000,2023.06.14,one hundred\nSPRINGFIELD,IL,Corn,15000,04/14/2023,120_acres\nriverside,ca,Wheat,NaN,2023-05-03,95_acres\nGreenfield,IN,soybean,14500,2023-06-15,110_acres\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names properly", "columnName": "City", "expression": "value.toLowercase().split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase state abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Standardize CropType capitalization", "columnName": "CropType", "expression": "value.toLowercase().capitalize()"}, {"op": "core/mass-edit", "description": "Fix common misspellings in CropType", "columnName": "CropType", "edits": [{"from": ["WHeat", "soybean", "soyBean", "Soybean"], "to": "Soybean"}, {"from": ["Wheat", "wheat"], "to": "Wheat"}, {"from": ["Corn", "corn"], "to": "Corn"}]}, {"op": "core/text-transform", "description": "Remove non-numeric characters from LoanAmount and convert to number, setting empty and NaN to null", "columnName": "LoanAmount", "expression": "if(value == null || value.toString().toLowercase() == 'nan' || value.toString().trim() == '') null else value.toString().replace(/[^0-9]/g, '').toNumber()"}, {"op": "core/text-transform", "description": "Parse ApplicationDate into yyyy-MM-dd format", "columnName": "ApplicationDate", "expression": "if(value == null || value.trim() == '') null else value.toDate('MM-dd-yyyy','yyyy/MM/dd','dd.MM.yyyy','yyyy-MM-dd','MMM d yyyy','MM/dd/yyyy','yyyy.MM.dd').toString('yyyy-MM-dd')"}, {"op": "core/text-transform", "description": "Standardize FarmSize to numeric acres", "columnName": "FarmSize", "expression": "if(value == null || value.toString().trim() == '' || value.toString().toLowercase() == 'one hundred') 100 else value.toString().replace(/[^0-9]/g, '').toNumber()"}, {"op": "core/fill-down", "description": "Fill down missing FarmSize values", "columnName": "FarmSize"}], "clean_table": "City,State,CropType,LoanAmount,ApplicationDate,FarmSize\nSpringfield,IL,Corn,15000,2023-04-15,120\nRiverside,CA,Wheat,20000,2023-05-01,95\nGreenfield,IN,Soybean,null,2023-06-15,110\nSpringfield,IL,Corn,15500,2023-04-16,120\nRiverside,CA,Soybean,21000,2023-05-02,95\nGreenfield,IN,Corn,14000,2023-06-14,95\nSpringfield,IL,Corn,15000,2023-04-14,120\nRiverside,CA,Wheat,null,2023-05-03,95\nGreenfield,IN,Soybean,14500,2023-06-15,110"}
{"purpose": "Clean inconsistent city and state names, normalize business types, and standardize date and numeric formats in telecom loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNEW york,ny,retail_store,25000,100000,01/15/2023\nlos-angeles,CA,Retail Store,30000, 120000 ,2023-02-28\nChicago,IL,retail-store,27000,110000,15-Mar-2023\nhouston,tx,retial_store,26000,105000,03/21/23\nPHOENIX,AZ,retail-store,28000,,2023/04/10\nphiladelphia,Pennsylvania,Wholesale-Distributor,24000,95000,04-25-2023\nSan antonio,TX,wholesale distributor,23000,90000,2023.05.15\nsan-diego,CA,Wholesale_Distributor,22000,85000,May 20 2023\ndallas,tx,Wholesaledistributor,21000,80000,2023-06-01\nSan jose,CA,, 20000,75000,2023/06/10\nAustin,Tx,Retail-store,25000,100000,06-15-2023\nJacksonville,fl, wholesale_distributor,23000,90000,06/20/2023\nfort worth,TX,retail_store,26000,105000,06-25-2023\nColumbus,oh,retail store,27000,110000,2023-06-30\ncharlotte,NC, retail-store ,28000,115000,07/04/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize City names properly", "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/, ' ').split(' ').map(s, s.substring(0,1).toUppercase() + s.substring(1)).join(' ')"}, {"op": "core/text-transform", "description": "Standardize State to uppercase 2-letter codes", "columnName": "State", "expression": "value.trim().toUppercase().replace('PENNSYLVANIA', 'PA').replace('TX', 'TX').replace('FL', 'FL').replace('OH', 'OH').replace('NC', 'NC')"}, {"op": "core/mass-edit", "description": "Normalize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["retail_store", "retail-store", "retail store", "retial_store", "Retail Store", "Retail-store", " retail-store "], "to": "Retail Store"}, {"from": ["Wholesale-Distributor", "wholesale distributor", "Wholesale_Distributor", "Wholesaledistributor", "wholesale_distributor"], "to": "Wholesale Distributor"}, {"from": [""], "to": "Retail Store"}]}, {"op": "core/text-transform", "description": "Trim spaces from Price", "columnName": "Price", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Convert Price to number", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Trim spaces from LoanAmount", "columnName": "LoanAmount", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number, fill missing with 95000", "columnName": "LoanAmount", "expression": "value.length() == 0 ? 95000 : value.toNumber()"}, {"op": "core/date-parse", "description": "Parse ApplicationDate to yyyy-MM-dd", "columnName": "ApplicationDate", "format": "automatic"}, {"op": "core/text-transform", "description": "Format ApplicationDate to yyyy-MM-dd", "columnName": "ApplicationDate", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew York,NY,Retail Store,25000,100000,2023-01-15\nLos Angeles,CA,Retail Store,30000,120000,2023-02-28\nChicago,IL,Retail Store,27000,110000,2023-03-15\nHouston,TX,Retail Store,26000,105000,2023-03-21\nPhoenix,AZ,Retail Store,28000,95000,2023-04-10\nPhiladelphia,PA,Wholesale Distributor,24000,95000,2023-04-25\nSan Antonio,TX,Wholesale Distributor,23000,90000,2023-05-15\nSan Diego,CA,Wholesale Distributor,22000,85000,2023-05-20\nDallas,TX,Wholesale Distributor,21000,80000,2023-06-01\nSan Jose,CA,Retail Store,20000,75000,2023-06-10\nAustin,TX,Retail Store,25000,100000,2023-06-15\nJacksonville,FL,Wholesale Distributor,23000,90000,2023-06-20\nFort Worth,TX,Retail Store,26000,105000,2023-06-25\nColumbus,OH,Retail Store,27000,110000,2023-06-30\nCharlotte,NC,Retail Store,28000,115000,2023-07-04"}
{"purpose": "Standardize crop types and clean inconsistent price and date entries in agricultural sales records.", "raw_table": "FarmID,Crop_Type,Sale_Price,Loan_Amount,Sale_Date\nF001,wheat,1200.50,15000,2023/01/15\nF002,Corn,1000,12000,15-02-2023\nF003,Soy-bean,900.0,11000,03/10/2023\nF004,rIce,1100.75,13000,2023.04.01\nF005,,950,10500,2023-05-20\nF006,Corn,one thousand,12500,2023-06-15\nF007,WHEAT,1300.60,14000,2023-07-01\nF008,Soybean,850,,2023/08/10\nF009,Rice,1050.5,13500,2023-09-05\nF010,corn,970.25,11800,2023-10-12\nF011,so-ya-bean,880,11500,2023-11-03\nF012,wheat,1250,14500,2023-12-25", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and unify Crop_Type capitalization", "columnName": "Crop_Type", "expression": "value.trim().toLowercase()"}, {"op": "core/mass-edit", "description": "Standardize Crop_Type values with misspellings", "columnName": "Crop_Type", "edits": [{"from": ["soy-bean", "so-ya-bean", "soybean"], "to": "soybean"}, {"from": ["rice"], "to": "rice"}, {"from": ["corn"], "to": "corn"}, {"from": ["wheat", "wheat"], "to": "wheat"}, {"from": [""], "to": "unknown"}]}, {"op": "core/text-transform", "description": "Convert Sale_Price to numeric, handle non-numeric values", "columnName": "Sale_Price", "expression": "if(value.toNumber() == null, null, value.toNumber())"}, {"op": "core/text-transform", "description": "Fill missing Loan_Amount with null and convert to number", "columnName": "Loan_Amount", "expression": "if(value == \"\" || value == null, null, value.toNumber())"}, {"op": "core/date-parse", "description": "Parse Sale_Date into consistent format yyyy-MM-dd", "columnName": "Sale_Date", "format": "yyyy-MM-dd", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Normalize Sale_Date strings with various delimiters to yyyy-MM-dd", "columnName": "Sale_Date", "expression": "if(value.match(/^\\d{4}[\\/\\.-]\\d{2}[\\/\\.-]\\d{2}$/), value.replace(/[\\/\\.-]/, '-').replace(/[\\/\\.-]/, '-'), value)"}, {"op": "core/date-parse", "description": "Parse Sale_Date again after normalization", "columnName": "Sale_Date", "format": "yyyy-MM-dd", "onError": "keep-original"}, {"op": "core/mass-edit", "description": "Correct Sale_Date entries with day-month-year format", "columnName": "Sale_Date", "edits": [{"from": ["15-02-2023"], "to": "2023-02-15"}, {"from": ["03/10/2023"], "to": "2023-10-03"}]}, {"op": "core/fill-down", "description": "Fill down missing Crop_Type values", "columnName": "Crop_Type"}], "clean_table": "FarmID,Crop_Type,Sale_Price,Loan_Amount,Sale_Date\nF001,wheat,1200.5,15000,2023-01-15\nF002,corn,1000,12000,2023-02-15\nF003,soybean,900,11000,2023-10-03\nF004,rice,1100.75,13000,2023-04-01\nF005,unknown,950,10500,2023-05-20\nF006,corn,null,12500,2023-06-15\nF007,wheat,1300.6,14000,2023-07-01\nF008,soybean,850,null,2023-08-10\nF009,rice,1050.5,13500,2023-09-05\nF010,corn,970.25,11800,2023-10-12\nF011,soybean,880,11500,2023-11-03\nF012,wheat,1250,14500,2023-12-25"}
{"purpose": "Clean and standardize movie dataset with inconsistent titles, genres, release dates, and box office revenue formats.", "raw_table": "MovieTitle,Genre,ReleaseDate,BoxOffice,Rating\nThe_Great-Escape,action,07/15/2019,$120 million,8.2\nlove actually,RomCom,2019-11-15,85M USD,7.6\nJURASSIC-park,Adventure,06-11-1993,652,270,625,8.1\ninception, Sci-Fi,2010/07/16,829 million,8.8\nThe Godfatrer,Crime,03-24-1972,$134.97M,9.2\nAvatar,SCI_FI,,2.847B,7.8\nCasablanca,Classic Romance,1942-11-26,Not Available,8.5\nstarwars: a new hope,Sci-Fi,1977-05-25,$775,398,007,8.6\nTitanic,romance,12/19/1997,2.187 billion,7.8\nSpider_man,Action,2002.05.03,$825 million,7.3\nThe Shawshank Redemption,Drama,1994/09/22,28.3M,9.3\nLa La land,romcom,2016-12-09,446M,8.0\nThe Matrix,SciFi,1999-03-31,$463,517,383,8.7\nForrest gump,Drama,1994-07-06,678 M,8.8\nFight_Club,Drama,10-15-1999,37.03M,8.8", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "MovieTitle", "expression": "value.replace(/[_-]/, ' ').trim().toTitlecase()"}, {"op": "core/text-transform", "columnName": "Genre", "expression": "value.toLowercase().replace(/romcom/, 'Romantic Comedy').replace(/sci[-_ ]?fi/, 'Science Fiction').replace(/classic romance/, 'Romantic Classic').trim().toTitlecase()"}, {"op": "core/date-parse", "columnName": "ReleaseDate", "expression": "value", "onError": "keep-original", "dateFormat": "auto-detect"}, {"op": "core/mass-edit", "columnName": "BoxOffice", "edits": [{"from": ["Not Available", ""], "to": ""}]}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "value.toLowercase().replace(/\\$|\\s|,|million|m|billion|b|usd/g, function(s) { if (s.match(/b|billion/)) { return '000000000'; } else if (s.match(/m|million/)) { return '000000'; } else { return ''; }}).replace(/[^0-9]/g, '').replace(/^0+/, '')"}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "value == '' ? null : Number(value)"}, {"op": "core/text-transform", "columnName": "Rating", "expression": "value ? Number(value) : null"}], "clean_table": "MovieTitle,Genre,ReleaseDate,BoxOffice,Rating\nThe Great Escape,Action,2019-07-15,120000000,8.2\nLove Actually,Romantic Comedy,2019-11-15,85000000,7.6\nJurassic Park,Adventure,1993-06-11,652270625,8.1\nInception,Science Fiction,2010-07-16,829000000,8.8\nThe Godfatrer,Crime,1972-03-24,134970000,9.2\nAvatar,Science Fiction,,2847000000,7.8\nCasablanca,Romantic Classic,1942-11-26,,8.5\nStarwars: A New Hope,Science Fiction,1977-05-25,775398007,8.6\nTitanic,Romance,1997-12-19,2187000000,7.8\nSpider Man,Action,2002-05-03,825000000,7.3\nThe Shawshank Redemption,Drama,1994-09-22,28300000,9.3\nLa La Land,Romantic Comedy,2016-12-09,446000000,8.0\nThe Matrix,Science Fiction,1999-03-31,463517383,8.7\nForrest Gump,Drama,1994-07-06,678000000,8.8\nFight Club,Drama,1999-10-15,37030000,8.8"}
{"purpose": "Standardize inconsistent city and state names, normalize business types, and correct date and numeric formats in government loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,retail,100000,50000,01/15/2023\nlos angeles,CA,Wholesale,150000,75000,2023-02-20\nchicago,il,RETAIL,120000,,15 Mar 2023\nhouston,Tx,Manufacturing,90000,45000,3/25/2023\nPHOENIX,az,service,80000,40000,2023/04/10\nphiladelphia,PA,Wholesale,110000,55000,Apr-15-2023\nsan-antonio,TX,retail,95000,47500,2023.05.20\nsan diego,ca,manufacturing,105000,52500,05/25/2023\n_dallas,Tx,Service,87000,43500,2023-06-01\nsan jose,CA,retail,99000,49500,06-10-2023\n,aZ,Wholesale,85000,42500,2023/06/15\naustin,tx,RETAIL,97000,48500,June 20, 2023\njacksonville,FL,service,88000,44000,2023-06-25\nfort worth,TX,manufacturing,93000,46500,06/30/2023\ncolumbus,OH,retail,,46000,07/05/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove leading/trailing underscores and hyphens from City names", "columnName": "City", "expression": "value.replace(/^[_-]+|[_-]+$/g, '').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase two-letter codes", "columnName": "State", "expression": "value.toUppercase().trim()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["retail", "RETAIL", "Retail"], "to": "Retail"}, {"from": ["Wholesale", "wholesale"], "to": "Wholesale"}, {"from": ["Manufacturing", "manufacturing", "manufacturing"], "to": "Manufacturing"}, {"from": ["service", "Service", "Service"], "to": "Service"}]}, {"op": "core/text-transform", "description": "Parse Date column to yyyy-MM-dd format", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Standardize Price and LoanAmount to numbers without commas", "columnName": "Price", "expression": "value.replace(/[^0-9.]/g, '')"}, {"op": "core/text-transform", "description": "Standardize Price and LoanAmount to numbers without commas", "columnName": "LoanAmount", "expression": "value.replace(/[^0-9.]/g, '')"}, {"op": "core/fill-down", "description": "Fill down missing City values", "columnName": "City"}, {"op": "core/fill-down", "description": "Fill down missing State values", "columnName": "State"}, {"op": "core/mass-edit", "description": "Fix incorrect or missing State codes", "columnName": "State", "edits": [{"from": [""], "to": "AZ"}]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,100000,50000,2023-01-15\nLos Angeles,CA,Wholesale,150000,75000,2023-02-20\nChicago,IL,Retail,120000,,2023-03-15\nHouston,TX,Manufacturing,90000,45000,2023-03-25\nPhoenix,AZ,Service,80000,40000,2023-04-10\nPhiladelphia,PA,Wholesale,110000,55000,2023-04-15\nSan Antonio,TX,Retail,95000,47500,2023-05-20\nSan Diego,CA,Manufacturing,105000,52500,2023-05-25\nDallas,TX,Service,87000,43500,2023-06-01\nSan Jose,CA,Retail,99000,49500,2023-06-10\nSan Jose,AZ,Wholesale,85000,42500,2023-06-15\nAustin,TX,Retail,97000,48500,2023-06-20\nJacksonville,FL,Service,88000,44000,2023-06-25\nFort Worth,TX,Manufacturing,93000,46500,2023-06-30\nColumbus,OH,Retail,,46000,2023-07-05"}
{"purpose": "Standardize and clean inconsistent farm loan application data with messy city names, date formats, and numeric values.", "raw_table": "Farm_ID,City,State,CropType,LoanAmount,Price,ApplicationDate\nF001,GreenVille, TX ,corn,10000,4.5,2023/03/15\nF002,green-ville,tx,Corn,12000,4.55,15-03-2023\nF003,Greenville,Tx,Soybeans,9000,3.8,03-16-2023\nF004,Greenville_,TX,soybeans,missing,3.85,03/17/2023\nF005,Grnville,TX,corn,11000,4.6,2023-03-18\nF006,GreenVille, Tx ,Wheat,9500,5.2,2023.03.19\nF007,Green-ville,TX,wheat,missing,5.25,19/03/2023\nF008,GreenVille,TX,Corn,10500,4.50,\nF009,Greenville,TX,SOYBEANS,8500,3.9,2023/03/20\nF010,greenVille,Tx,wheat,10000,5.1,03-21-2023\nF011,GreenVille,TX,corn,10800,4.55,03/22/2023\nF012,,TX,corn,9500,4.40,2023/03/23\nF013,Greenville,TX,soybeans,8700,3.7,2023/03/24\nF014,Green-Ville,TX,wheat,9300,5.0,2023-03-25\nF015,Greenville,Tx,Corn,10200,4.52,2023/03/26", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace in City and State columns", "columnName": "City", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace in City and State columns", "columnName": "State", "expression": "value.trim().toUppercase()"}, {"op": "core/text-transform", "description": "Standardize City names: fix variations of Greenville", "columnName": "City", "expression": "value.toLowercase().replace(/green[-_]?ville|grnville/, 'Greenville').replace(/^$/, null)"}, {"op": "core/mass-edit", "description": "Normalize CropType values", "columnName": "CropType", "edits": [{"from": ["corn", "Corn", "CORN"], "to": "Corn"}, {"from": ["soybeans", "Soybeans", "SOYBEANS"], "to": "Soybeans"}, {"from": ["wheat", "Wheat", "WHEAT"], "to": "Wheat"}]}, {"op": "core/mass-edit", "description": "Replace missing LoanAmount with null", "columnName": "LoanAmount", "edits": [{"from": ["missing", ""], "to": null}]}, {"op": "core/text-transform", "description": "Convert LoanAmount and Price columns to numbers", "columnName": "LoanAmount", "expression": "value == null ? null : Number(value)"}, {"op": "core/text-transform", "description": "Convert Price to number", "columnName": "Price", "expression": "Number(value)"}, {"op": "core/date-parse", "description": "Parse ApplicationDate into ISO format", "columnName": "ApplicationDate", "format": "automatic"}, {"op": "core/fill-down", "description": "Fill down missing City values", "columnName": "City"}], "clean_table": "Farm_ID,City,State,CropType,LoanAmount,Price,ApplicationDate\nF001,Greenville,TX,Corn,10000,4.5,2023-03-15T00:00:00Z\nF002,Greenville,TX,Corn,12000,4.55,2023-03-15T00:00:00Z\nF003,Greenville,TX,Soybeans,9000,3.8,2023-03-16T00:00:00Z\nF004,Greenville,TX,Soybeans,null,3.85,2023-03-17T00:00:00Z\nF005,Greenville,TX,Corn,11000,4.6,2023-03-18T00:00:00Z\nF006,Greenville,TX,Wheat,9500,5.2,2023-03-19T00:00:00Z\nF007,Greenville,TX,Wheat,null,5.25,2023-03-19T00:00:00Z\nF008,Greenville,TX,Corn,10500,4.5,null\nF009,Greenville,TX,Soybeans,8500,3.9,2023-03-20T00:00:00Z\nF010,Greenville,TX,Wheat,10000,5.1,2023-03-21T00:00:00Z\nF011,Greenville,TX,Corn,10800,4.55,2023-03-22T00:00:00Z\nF012,Greenville,TX,Corn,9500,4.4,2023-03-23T00:00:00Z\nF013,Greenville,TX,Soybeans,8700,3.7,2023-03-24T00:00:00Z\nF014,Greenville,TX,Wheat,9300,5,2023-03-25T00:00:00Z\nF015,Greenville,TX,Corn,10200,4.52,2023-03-26T00:00:00Z"}
{"purpose": "Clean and standardize movie ratings and release dates for consistent reporting.", "raw_table": "MovieTitle,ReleaseDate,Rating,BoxOffice,Genre\n\"the lord_of the rings\",\"12/07/2001\",PG13,315000000,Fantasy\n\"Pirates_of the caribbean\",\"07-09-2003\",PG-13,305000000,Adventure\n\"harry-potter and the sorcerers stone\",2001/11/16,PG,320000000,Fantasy\n\"star wars: episode iv\",\"May 25 1977\",PG13,775000000,Sci-Fi\n\"inception\",16-07-2010,PG-13,829895144,Sci fi\n\"the dark_knight\",\"2008-07-18\",PG13,1004558444,Action\n\"avengers_endgame\",2019/04/26,PG13,2797800564,Action\n\"jaws\",june 20 1975,PG,470700000,Horror\n\"forrest gump\",\"07/06/1994\",pg,678000000,Drama\n\"titanic\",12-19-1997,PG13,2187000000,Romance\n\"the matrix\",\"03/31/1999\",R,463500000,Action\n\"gladiator\",2000-05-05,PG13,460583960,Action\n\"et the extra-terrestrial\",\"06.11.1982\",PG,79291000,Sci-Fi\n\"back to the future\",07/03/1985,pg,389100000,Sci-Fi\n\"toy story\",\"11-22-1995\",G,373554033,Animation", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "MovieTitle", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()", "description": "Replace underscores and hyphens with spaces and capitalize words"}, {"op": "core/text-transform", "columnName": "Rating", "expression": "value.toUppercase().replace(/PG-?13/, 'PG-13').replace(/^PG$/, 'PG')", "description": "Standardize Rating to uppercase and fix PG13 format"}, {"op": "core/date-parse", "columnName": "ReleaseDate", "expression": "value", "format": "auto", "description": "Parse ReleaseDate into standard ISO format"}, {"op": "core/text-transform", "columnName": "Genre", "expression": "value.toTitlecase()", "description": "Capitalize Genre names"}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "value.replace(/[^0-9]/g, '').toNumber()", "description": "Remove non-numeric characters from BoxOffice and convert to number"}], "clean_table": "MovieTitle,ReleaseDate,Rating,BoxOffice,Genre\nThe Lord Of The Rings,2001-12-07,PG-13,315000000,Fantasy\nPirates Of The Caribbean,2003-07-09,PG-13,305000000,Adventure\nHarry Potter And The Sorcerers Stone,2001-11-16,PG,320000000,Fantasy\nStar Wars: Episode Iv,1977-05-25,PG-13,775000000,Sci-Fi\nInception,2010-07-16,PG-13,829895144,Sci Fi\nThe Dark Knight,2008-07-18,PG-13,1004558444,Action\nAvengers Endgame,2019-04-26,PG-13,2797800564,Action\nJaws,1975-06-20,PG,470700000,Horror\nForrest Gump,1994-07-06,PG,678000000,Drama\nTitanic,1997-12-19,PG-13,2187000000,Romance\nThe Matrix,1999-03-31,R,463500000,Action\nGladiator,2000-05-05,PG-13,460583960,Action\nEt The Extra Terrestrial,1982-06-11,PG,79291000,Sci-Fi\nBack To The Future,1985-07-03,PG,389100000,Sci-Fi\nToy Story,1995-11-22,G,373554033,Animation"}
{"purpose": "Standardize city names and clean business types and numeric fields for energy loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar-installation,15000,10000,01/15/2023\nlos angeles,CA,wind-turbine,NaN,12000,2023-02-20\nChicago,IL,SoLAR Installation,18000,15000,03-10-2023\nhouston,TX,solar-install.,17000,,2023/04/05\nPHOENIX,Az,Wind Turbine,16000,11000,4/25/2023\nphiladelphia,PA,solar_installation,NaN,9000,March 15 2023\nSan-antonio,TX,wind turbine,14000,8500,2023-05-10\nSan Diego,ca,solar installation,15500,13000,05-20-2023\nDallas,TX,solar-installation,16500,NaN,2023.06.01\nSan jose,CA,WindTurbine,17500,14000,06/15/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Fix city underscores and hyphens, unify to title case", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').toTitlecase()"}, {"op": "core/mass-edit", "description": "Normalize state codes to uppercase", "columnName": "State", "edits": [{"from": ["ca", "Az", "ny"], "to": "CA"}, {"from": ["Az"], "to": "AZ"}, {"from": ["ny"], "to": "NY"}]}, {"op": "core/text-transform", "description": "Standardize BusinessType capitalization and remove punctuation", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[-_.]/g, ' ').replace(/\\s+/g, ' ').trim().replace(/\\bsolar installation\\b/, 'Solar Installation').replace(/\\bwind turbine\\b/, 'Wind Turbine')"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Convert Price blanks and NaN to null", "columnName": "Price", "expression": "value == 'NaN' || value == '' ? null : value"}, {"op": "core/text-transform", "description": "Convert Price to number", "columnName": "Price", "expression": "value == null ? null : value.toNumber()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number", "columnName": "LoanAmount", "expression": "value.toNumber()"}, {"op": "core/date-parse", "description": "Parse all dates to yyyy-MM-dd", "columnName": "Date", "format": "auto"}, {"op": "core/text-transform", "description": "Format Date column to yyyy-MM-dd string", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,15000,10000,2023-01-15\nLos Angeles,CA,Wind Turbine,,12000,2023-02-20\nChicago,IL,Solar Installation,18000,15000,2023-03-10\nHouston,TX,Solar Installation,17000,15000,2023-04-05\nPhoenix,AZ,Wind Turbine,16000,11000,2023-04-25\nPhiladelphia,PA,Solar Installation,,9000,2023-03-15\nSan Antonio,TX,Wind Turbine,14000,8500,2023-05-10\nSan Diego,CA,Solar Installation,15500,13000,2023-05-20\nDallas,TX,Solar Installation,16500,13000,2023-06-01\nSan Jose,CA,Wind Turbine,17500,14000,2023-06-15"}
{"purpose": "Standardize movie titles, release years, genres, and box office revenue for accurate analysis.", "raw_table": "MovieTitle,ReleaseYear,Genre,BoxOfficeUS\ninception,2010,Science_fiction,829895144\nThe_Lord of the rings: the return of the king,2003,Adventure,1,142,000,000\nAvatar, 2009,SCI_FI ,2.8B\nAvengers-Endgame,2019,Action,2,797,000,000\ntitanic,1997,Romance,2187463944\nJoker,2019,crime,1074251311\nparasite,2019,Thriller,257591776\nstar wars iv: a new hope,1977,Sci-Fi,775398007\nharry potter and the sorcerer's stone,2001,Fantasy,974755371\nFrozen_II,2019,Animation,1450026933\nThe Godfather,1972,crime,246120974\nSpider_man:far from home,2019,Action,1131927996\nblack panther,2018,action ,1346913161\nThe Shawshank Redemption,1994,Drama,\nLa La land,2016,Musical,446433825", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "MovieTitle", "expression": "value.replace(/_/g, ' ').replace(/:/g, ': ').replace(/  +/g, ' ').trim().toTitlecase()", "description": "Replace underscores with spaces, fix colon spacing, remove extra spaces, and title case movie titles"}, {"op": "core/text-transform", "columnName": "ReleaseYear", "expression": "value.replace(/[^0-9]/g, '').trim()", "description": "Remove non-numeric characters and trim from ReleaseYear"}, {"op": "core/text-transform", "columnName": "Genre", "expression": "value.toLowerCase().replace(/[_-]/g, ' ').trim().toTitlecase()", "description": "Normalize genre casing and remove underscores/hyphens"}, {"op": "core/text-transform", "columnName": "BoxOfficeUS", "expression": "if(value==null || value.trim()=='', null, value.replace(/[,\\s]/g, '').replace(/B$/, '*1000000000').replace(/M$/, '*1000000'))", "description": "Remove commas and spaces, convert B and M suffixes to numeric multiplications"}, {"op": "core/text-transform", "columnName": "BoxOfficeUS", "expression": "if(value==null, null, if(value.contains('*'), (eval(value)), parseInt(value)))", "description": "Evaluate expressions with multiplications and parse integers for BoxOfficeUS"}, {"op": "core/mass-edit", "columnName": "MovieTitle", "edits": [{"from": ["Spider man:far From Home", "Star wars iv: a New Hope"], "to": "Spider Man: Far From Home"}], "description": "Fix specific movie title capitalizations"}, {"op": "core/mass-edit", "columnName": "Genre", "edits": [{"from": ["Sci Fi", "Sci-Fi", "Science Fiction", "Science_fiction"], "to": "Science Fiction"}, {"from": ["Crime"], "to": "Crime"}, {"from": ["Action", "Action "], "to": "Action"}], "description": "Normalize genre variants to standard terms"}, {"op": "core/fill-down", "columnName": "BoxOfficeUS", "description": "Fill down missing BoxOfficeUS if needed (no missing in this dataset, but included for workflow completeness)"}], "clean_table": "MovieTitle,ReleaseYear,Genre,BoxOfficeUS\nInception,2010,Science Fiction,829895144\nThe Lord Of The Rings: The Return Of The King,2003,Adventure,1142000000\nAvatar,2009,Science Fiction,2800000000\nAvengers-Endgame,2019,Action,2797000000\nTitanic,1997,Romance,2187463944\nJoker,2019,Crime,1074251311\nParasite,2019,Thriller,257591776\nStar Wars Iv: A New Hope,1977,Science Fiction,775398007\nHarry Potter And The Sorcerer's Stone,2001,Fantasy,974755371\nFrozen II,2019,Animation,1450026933\nThe Godfather,1972,Crime,246120974\nSpider Man: Far From Home,2019,Action,1131927996\nBlack Panther,2018,Action,1346913161\nThe Shawshank Redemption,1994,Drama,\nLa La Land,2016,Musical,446433825"}
{"purpose": "Standardize inconsistent city names, business types, and date formats in government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,Restuarant,120000,50000,12/01/2022\nlos-angeles,ca,restaurant,90000,45000,2022-11-05\nChicago,IL,Retaurant,110000,,-01/15/2023\nHouston,tx,RETAIL,100000,40000,2023/02/10\nphiladelphia,PA,retail,95000,38000,2-28-2023\nPhoenix,AZ,,105000,42000,03/01/2023\nSan Antonio,TX,Restaurant_,115000,47000,2023-03-05\nsan-diego,CA,Retail,102000,43000,03-10-2023\nDallas,TX,retail,98000,41000,2023/03/15\nSan Jose,CA,Restuarant,108000,,2023-03-20\nAustin,tx,Retaurant,100000,44000,2023-03-25\nJacksonville,FL,Restaurant,97000,40000,03/30/2023\nFort_Worth,TX,Retail,99000,41500,2023-04-01\nColumbus,OH,restaurant,101000,42500,04-05-2023\nCharlotte,NC,RETAIL,97000,39500,2023/04/10", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names with spaces", "columnName": "City", "expression": "value.replace('_',' ').replace('-',' ')"}, {"op": "core/text-transform", "description": "Trim whitespace and convert City names to title case", "columnName": "City", "expression": "value.trim().replace(/\\b(\\w)/g, v, v.toUpperCase())"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/mass-edit", "description": "Correct common misspellings in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["Restuarant", "Retaurant", "Restaurant_", ""], "to": "Restaurant"}, {"from": ["RETAIL", "retail", "Retail"], "to": "Retail"}]}, {"op": "core/fill-down", "description": "Fill missing LoanAmount values down", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numbers", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to numbers", "columnName": "LoanAmount", "expression": "value.toNumber()"}, {"op": "core/date-parse", "description": "Parse Date column to ISO format", "columnName": "Date", "options": {"mode": "lenient", "format": ["MM/dd/yyyy", "yyyy-MM-dd", "yyyy/MM/dd", "M-d-yyyy", "M/dd/yyyy", "MM-dd-yyyy", "MM/dd/yyyy"]}}, {"op": "core/text-transform", "description": "Format date to yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toISOString().substring(0,10)"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,120000,50000,2022-12-01\nLos Angeles,CA,Restaurant,90000,45000,2022-11-05\nChicago,IL,Restaurant,110000,45000,2023-01-15\nHouston,TX,Retail,100000,40000,2023-02-10\nPhiladelphia,PA,Retail,95000,38000,2023-02-28\nPhoenix,AZ,Restaurant,105000,42000,2023-03-01\nSan Antonio,TX,Restaurant,115000,47000,2023-03-05\nSan Diego,CA,Retail,102000,43000,2023-03-10\nDallas,TX,Retail,98000,41000,2023-03-15\nSan Jose,CA,Restaurant,108000,41000,2023-03-20\nAustin,TX,Restaurant,100000,44000,2023-03-25\nJacksonville,FL,Restaurant,97000,40000,2023-03-30\nFort Worth,TX,Retail,99000,41500,2023-04-01\nColumbus,OH,Restaurant,101000,42500,2023-04-05\nCharlotte,NC,Retail,97000,39500,2023-04-10"}
{"purpose": "Standardize inconsistent city and business type names, fix date formats, and clean numeric fields for financial analysis.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar-install,5000,15000,03/25/2023\nlos-angeles,ca,Wind_Turbine,7000,20000,2023-04-01\nChicago,IL,solar install,4500,NA,April 5 2023\nhouston,tx,Geothermal,6000,18000,05-15-2023\nPHILADELPHIA,pa,solar-install,5200,17000,2023/06/10\nPhoenix,AZ,wind turbine,4800,,07-01-2023\nsan antonio,TX,Geotherm,5500,16000,2023.08.20\nSan_Diego,Ca,solar_install,5300,17500,08/30/2023\nDallas,TX,Wind-turbine,4700,16500,09/15/2023\nSan Jose,CA,solar-install,,15500,2023-10-05\nAustin,TX,solar install,4900,15800,October 15, 2023\nJacksonville,FL,wind turbine,4600,15000,11-01-2023\nFort Worth,TX,geothermal,5100,16200,2023/12/01\nColumbus,OH,Solar_install,4950,15900,12-15-2023\nCharlotte,NC,Wind-Turbine,4850,15700,2023-12-20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in City and BusinessType", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitleCase()"}, {"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces and standardize BusinessType", "columnName": "BusinessType", "expression": "value.toLowerCase().replace(/[_-]/g, ' ')"}, {"op": "core/mass-edit", "description": "Standardize BusinessType names", "columnName": "BusinessType", "edits": [{"from": ["solar install", "solar_install", "solar-install", "solar install"], "to": "Solar Install"}, {"from": ["wind turbine", "wind-turbine", "wind_turbine", "Wind Turbine", "Wind-turbine", "Wind_Turbine"], "to": "Wind Turbine"}, {"from": ["geothermal", "geotherm"], "to": "Geothermal"}]}, {"op": "core/text-transform", "description": "Capitalize state abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/date-parse", "description": "Parse all Date formats into ISO yyyy-MM-dd", "columnName": "Date", "format": "best_effort"}, {"op": "core/mass-edit", "description": "Replace missing or malformed numeric values with null", "columnName": "Price", "edits": [{"from": ["", "NA", "na", "N/A"], "to": null}]}, {"op": "core/mass-edit", "description": "Replace missing or malformed numeric values with null in LoanAmount", "columnName": "LoanAmount", "edits": [{"from": ["", "NA", "na", "N/A"], "to": null}]}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount values to numbers", "columnName": "Price", "expression": "value.trim() === '' || value.toLowerCase() === 'na' ? null : Number(value)"}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount values to numbers", "columnName": "LoanAmount", "expression": "value.trim() === '' || value.toLowerCase() === 'na' ? null : Number(value)"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Install,5000,15000,2023-03-25\nLos Angeles,CA,Wind Turbine,7000,20000,2023-04-01\nChicago,IL,Solar Install,4500,,2023-04-05\nHouston,TX,Geothermal,6000,18000,2023-05-15\nPhiladelphia,PA,Solar Install,5200,17000,2023-06-10\nPhoenix,AZ,Wind Turbine,4800,,2023-07-01\nSan Antonio,TX,Geothermal,5500,16000,2023-08-20\nSan Diego,CA,Solar Install,5300,17500,2023-08-30\nDallas,TX,Wind Turbine,4700,16500,2023-09-15\nSan Jose,CA,Solar Install,,15500,2023-10-05\nAustin,TX,Solar Install,4900,15800,2023-10-15\nJacksonville,FL,Wind Turbine,4600,15000,2023-11-01\nFort Worth,TX,Geothermal,5100,16200,2023-12-01\nColumbus,OH,Solar Install,4950,15900,2023-12-15\nCharlotte,NC,Wind Turbine,4850,15700,2023-12-20"}
{"purpose": "Standardize city names, business types, and fix date and numeric formats in telecom loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,Telecom-Provider,1000.50,50000,01/15/2023\nlos-angeles,CA,Internet provider,850,45000,2023-02-20\nChicago,IL,cell tower,950.75, ,15-Mar-2023\nhouston,Tx,telecom provider,1050,48000,2023/04/01\nPHOENIX,az,Cell_tower ,1100,47000,04-15-2023\nPhiladelphia,PA,Internet_Provider,900,46000,April 22 2023\nsan_antonio,tx,,980,45500,2023.05.10\nSan Diego,ca,Cell Tower,1020,49000,05/25/23\nDallas,TX,Telecom_provider,970,47000,06-01-2023\nSan jose,CA,Internet-Provider,890,44000,2023-06-15\nAustin,tx,CellTower,995,46000,06/20/2023\nJacksonville,fl,telecom provider,1005,47500,06/30/2023\nFort Worth,TX,Internet Provider,885,45000,2023-07-05", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from City", "columnName": "City", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Standardize capitalization of City names", "columnName": "City", "expression": "value.toLowercase().split(/[_\\- ]+/).map(s, s[0].toUppercase() + s.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix missing BusinessType values", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Telecom Provider"}]}, {"op": "core/text-transform", "description": "Clean and standardize BusinessType values", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[_\\-]/g, ' ').trim().split(' ').map(s, s[0].toUppercase() + s.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Convert Price to number with two decimals", "columnName": "Price", "expression": "value.toNumber().toFixed(2)"}, {"op": "core/fill-down", "description": "Fill down LoanAmount missing values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Convert LoanAmount to integer", "columnName": "LoanAmount", "expression": "value.trim() === '' ? null : value.toNumber().toFixed(0)"}, {"op": "core/date-parse", "description": "Parse Date column with multiple formats", "columnName": "Date", "expression": "value.toDate()", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Format Date to yyyy-MM-dd", "columnName": "Date", "expression": "value instanceof Date ? value.toISOString().slice(0, 10) : value"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom Provider,1000.50,50000,2023-01-15\nLos Angeles,CA,Internet Provider,850.00,45000,2023-02-20\nChicago,IL,Cell Tower,950.75,45000,2023-03-15\nHouston,TX,Telecom Provider,1050.00,48000,2023-04-01\nPhoenix,AZ,Cell Tower,1100.00,47000,2023-04-15\nPhiladelphia,PA,Internet Provider,900.00,46000,2023-04-22\nSan Antonio,TX,Telecom Provider,980.00,45500,2023-05-10\nSan Diego,CA,Cell Tower,1020.00,49000,2023-05-25\nDallas,TX,Telecom Provider,970.00,47000,2023-06-01\nSan Jose,CA,Internet Provider,890.00,44000,2023-06-15\nAustin,TX,Cell Tower,995.00,46000,2023-06-20\nJacksonville,FL,Telecom Provider,1005.00,47500,2023-06-30\nFort Worth,TX,Internet Provider,885.00,45000,2023-07-05"}
{"purpose": "Clean and standardize city names, business types, and numeric formats in telecommunications loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,Telecom_Provider,1200.50,15000,01-15-2023\nlos-angeles,CA,telecom provider,1100,12000.00,2023/02/20\nCHICAGO,IL,Telecom-Provider,NA,13000,15-Mar-2023\nhouston,TX,TelecomProvider,1000.75,missing,03/25/2023\nPHOENIX,AZ,telecom_provider,1150,14000.5,2023.04.10\nphiladelphia,PA,Telecom Provider,wrong,13500,04-22-2023\nSan-antonio,TX,TelecomProvider,1050,12500.00,2023-05-05\nsan_diego,CA,telecom-provider,975,11000.75,05/20/2023\nDALLAS,TX,telecom_provider,1000,NA,2023-06-01\nsan jose,CA,Telecom_Provider,1025.35,12800,2023/06/15\nAustin,TX,telecom-provider,missing,11500,06-20-2023\nJacksonville,FL,TelecomProvider,980.5,13000,2023-07-01\nFORT-WORTH,TX,Telecom Provider,1010,12750,07/10/2023\nColumbus,OH,telecom_provider,995,12200.00,2023.07.15", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City with spaces", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ')"}, {"op": "core/text-transform", "description": "Capitalize each word in City", "columnName": "City", "expression": "value.toLowerCase().split(' ').map(w, w.charAt(0).toUpperCase() + w.slice(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["Telecom_Provider", "telecom provider", "Telecom-Provider", "TelecomProvider", "telecom_provider", "telecom-provider", "Telecom Provider"], "to": "Telecom Provider"}]}, {"op": "core/mass-edit", "description": "Replace missing or invalid Price values with blank", "columnName": "Price", "edits": [{"from": ["NA", "missing", "wrong"], "to": ""}]}, {"op": "core/text-transform", "description": "Convert Price to number format with two decimals", "columnName": "Price", "expression": "value.trim() === '' ? '' : Number(value).toFixed(2)"}, {"op": "core/mass-edit", "description": "Replace missing or invalid LoanAmount values with blank", "columnName": "LoanAmount", "edits": [{"from": ["missing", "NA"], "to": ""}]}, {"op": "core/text-transform", "description": "Convert LoanAmount to number format with no decimals", "columnName": "LoanAmount", "expression": "value.trim() === '' ? '' : Number(value).toFixed(0)"}, {"op": "core/date-parse", "description": "Parse Date column with multiple formats", "columnName": "Date", "dateFormat": "yyyy-MM-dd", "guessCellType": true, "mode": "lenient"}, {"op": "core/text-transform", "description": "Format Date in ISO yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toISOString().slice(0,10)"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom Provider,1200.50,15000,2023-01-15\nLos Angeles,CA,Telecom Provider,1100.00,12000,2023-02-20\nChicago,IL,Telecom Provider,,13000,2023-03-15\nHouston,TX,Telecom Provider,1000.75,,2023-03-25\nPhoenix,AZ,Telecom Provider,1150.00,14001,2023-04-10\nPhiladelphia,PA,Telecom Provider,,13500,2023-04-22\nSan Antonio,TX,Telecom Provider,1050.00,12500,2023-05-05\nSan Diego,CA,Telecom Provider,975.00,11001,2023-05-20\nDallas,TX,Telecom Provider,1000.00,,2023-06-01\nSan Jose,CA,Telecom Provider,1025.35,12800,2023-06-15\nAustin,TX,Telecom Provider,,11500,2023-06-20\nJacksonville,FL,Telecom Provider,980.50,13000,2023-07-01\nFort Worth,TX,Telecom Provider,1010.00,12750,2023-07-10\nColumbus,OH,Telecom Provider,995.00,12200,2023-07-15"}
{"purpose": "Standardize city and business type names, fix date formats, and correct numeric fields for energy loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew york,NY,solar_installer,12000,10000,01-15-2023\nlos_angeles,CA,Wind_Turbine,15000,NA,2023/02/20\nChicago,il,solar installer,11000,9000,15/03/2023\nhouston,TX,Solar-Installer,13000,11000,2023.04.10\nPHOENIX,az,Wind turbine,17000,,04-25-2023\nPhiladelphia,PA,Solar_installr,12500,9500,2023-05-30\nSan-Antonio,TX,wind_turbine,16000,14000,06/15/2023\nsan_diego,CA,Solar installer,11800,10500,2023/07/10\nDallas,tx,solar installer,NaN,12000,2023-08-05\nSan Jose,CA,wind_turbine,16500,13000,2023/09/20\nAustin,Tx,solar_installer,12200,10000,10-01-2023\nJacksonville,FL,Wind_turbine,15800,13500,2023.11.11\nFort Worth,TX,Solar Installer,11900,11000,12/05/2023\nColumbus,OH,Solar_installer,11500,10000,2023-12-20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names", "engineConfig": {"facets": []}, "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "description": "Uppercase state abbreviations", "engineConfig": {"facets": []}, "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["solar_installer", "Solar-Installer", "Solar_installr", "solar installer", "Solar Installer", "Solar_installer"], "to": "Solar Installer"}, {"from": ["wind_turbine", "Wind_Turbine", "Wind turbine", "Wind_turbine"], "to": "Wind Turbine"}]}, {"op": "core/text-transform", "description": "Fix Price column - convert to number and handle NaN/missing", "columnName": "Price", "expression": "if(isNonBlank(value) && value.trim().toLowercase() != 'nan', value.toNumber(), null)"}, {"op": "core/text-transform", "description": "Fix LoanAmount column - convert to number and handle missing/NA", "columnName": "LoanAmount", "expression": "if(isNonBlank(value) && value.trim().toLowercase() != 'na', value.toNumber(), null)"}, {"op": "core/text-transform", "description": "Normalize Date formats to yyyy-MM-dd", "columnName": "Date", "expression": "if(isNonBlank(value), value.toDate('MM-dd-yyyy') ?: value.toDate('yyyy/MM/dd') ?: value.toDate('dd/MM/yyyy') ?: value.toDate('yyyy.MM.dd') ?: value.toDate('dd-MM-yyyy') ?: value.toDate('MM/dd/yyyy') ?: value.toDate('yyyy-MM-dd'), null).toString('yyyy-MM-dd')"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installer,12000,10000,2023-01-15\nLos Angeles,CA,Wind Turbine,15000,10000,2023-02-20\nChicago,IL,Solar Installer,11000,9000,2023-03-15\nHouston,TX,Solar Installer,13000,11000,2023-04-10\nPhoenix,AZ,Wind Turbine,17000,11000,2023-04-25\nPhiladelphia,PA,Solar Installer,12500,9500,2023-05-30\nSan Antonio,TX,Wind Turbine,16000,14000,2023-06-15\nSan Diego,CA,Solar Installer,11800,10500,2023-07-10\nDallas,TX,,null,12000,2023-08-05\nSan Jose,CA,Wind Turbine,16500,13000,2023-09-20\nAustin,TX,Solar Installer,12200,10000,2023-10-01\nJacksonville,FL,Wind Turbine,15800,13500,2023-11-11\nFort Worth,TX,Solar Installer,11900,11000,2023-12-05\nColumbus,OH,Solar Installer,11500,10000,2023-12-20"}
{"purpose": "Clean and standardize customer subscription data with inconsistent city names, business types, date formats, and pricing details.", "raw_table": "CustomerID,City,State,BusinessType,SubscriptionPrice,LoanAmount,SubscriptionDate\n101,San_Francisco,ca,Telecom-Provider, 100.00 ,5000,2023/01/15\n102,new york,NY,Broadbnd-provider, 85, 3000,15-02-2023\n103,los angeles,CA,Telecom_provider ,90 dollars, ,03/03/2023\n104,CHICAGO,il,telecom-provider,95.5,4500,2023-04-01\n105,Houston,Tx, BROADBAND Provider, eighty, 4000,2023/05/10\n106,Phoenix,AZ,Telecom-provider,110.00,5500,10-06-2023\n107,Philadelphia,pa,Broadband-provider,105,3500,2023/07/15\n108,San-antonio,TX,telecom_provider, 100, 5000,07/20/2023\n109,dallas,tx,Telecom-Provider ,95, ,2023-08-25\n110,San Diego,ca,Broadband_provider, 92 USD, 3800,2023.09.10\n111,san jose,CA,, 88, 4200,2023/10/05\n112,Austin,tx,Telecom-provider, 100, 4800,11-11-2023\n113,jacksonville,FL,Telecom-Provider, ninety-five, 4600,2023-12-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens, unify city names capitalization", "columnName": "City", "expression": "value.toLowercase().replace(/[_-]/, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Capitalize state abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType strings", "columnName": "BusinessType", "expression": "if(value==null || value.trim()=='', 'Telecom Provider', value.toLowercase().replace(/[_-]/g, ' ').split(' ').map(s => s.capitalize()).join(' '))"}, {"op": "core/mass-edit", "description": "Fix misspelled BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["Broadbnd provider", "Broadbnd-provider", "Broadband provider", "Broadband-provider", "Broadband_provider", "Broadband Provider"], "to": "Broadband Provider"}, {"from": ["Telecom_provider", "telecom provider", "Telecom provider", "Telecom Provider", "Telecom-provider", "telecom-provider", "telecom_provider"], "to": "Telecom Provider"}]}, {"op": "core/text-transform", "description": "Clean SubscriptionPrice: convert text numbers and remove non-numeric characters", "columnName": "SubscriptionPrice", "expression": "value.trim().toLowercase().replace(/[a-z$]/g, '').trim() == '' ? null : (['eighty', 'ninety-five', 'ninety five'].indexOf(value.trim().toLowercase()) != -1 ? (value.trim().toLowercase() == 'eighty' ? '80' : '95') : value.trim().replace(/[^0-9\\.]/g, ''))"}, {"op": "core/mass-edit", "description": "Fill missing SubscriptionPrice values where possible", "columnName": "SubscriptionPrice", "edits": [{"from": [null, ""], "to": "null"}]}, {"op": "core/text-transform", "description": "Fill missing LoanAmount with null and trim spaces", "columnName": "LoanAmount", "expression": "value == null || value.trim() == '' ? null : value.trim()"}, {"op": "core/date-parse", "description": "Parse and unify SubscriptionDate into ISO yyyy-MM-dd", "columnName": "SubscriptionDate", "expression": "value.replace(/\\./g, '-').replace(/\\//g, '-').replace(/(\\d{2})-(\\d{2})-(\\d{4})/, '$3-$2-$1')", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Format SubscriptionDate properly (ISO)", "columnName": "SubscriptionDate", "expression": "cells['SubscriptionDate'].value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "CustomerID,City,State,BusinessType,SubscriptionPrice,LoanAmount,SubscriptionDate\n101,San Francisco,CA,Telecom Provider,100.00,5000,2023-01-15\n102,New York,NY,Broadband Provider,85,3000,2023-02-15\n103,Los Angeles,CA,Telecom Provider,90,,2023-03-03\n104,Chicago,IL,Telecom Provider,95.5,4500,2023-04-01\n105,Houston,TX,Broadband Provider,80,4000,2023-05-10\n106,Phoenix,AZ,Telecom Provider,110.00,5500,2023-06-10\n107,Philadelphia,PA,Broadband Provider,105,3500,2023-07-15\n108,San Antonio,TX,Telecom Provider,100,5000,2023-07-20\n109,Dallas,TX,Telecom Provider,95,,2023-08-25\n110,San Diego,CA,Broadband Provider,92,3800,2023-09-10\n111,San Jose,CA,Telecom Provider,88,4200,2023-10-05\n112,Austin,TX,Telecom Provider,100,4800,2023-11-11\n113,Jacksonville,FL,Telecom Provider,95,4600,2023-12-01"}
{"purpose": "Standardize city names and business types, correct date formats, and normalize financial figures in telecom customer data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_York,NY,Telecom,1500,10000,12/31/2023\nlos angeles,ca,tele-comm,1300,9000,2023-01-15\nChicago,IL,TELCOM,1400,,15-02-2023\nhouston,Tx,Tele_Comm,NaN,8500,03/05/23\nPHOENIX,az,tele comm,1250,8000,2023.04.10\nphiladelphia,pa,tele-comm,1350,9200,2023/05/25\nsan antonio,TX,Telecom,1400,8800,05-30-2023\nsan-diego,Ca,telecom,1380,8700,2023/06/15\nDallas,tx,Tele-Comm,NaN,8600,06.20.2023\nsan jose,CA,telecom,1450,8300,2023-07-01\nAustin,TX,Tele-comm,1300,NaN,07/15/2023\njacksonville,fl,tele comm,1250,7800,2023-08-05\nfort worth,TX,telecom,1350,8000,08/20/2023", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_York"], "to": "New York"}, {"from": ["san-diego"], "to": "San Diego"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["tele-comm", "telecomm", "tele_Comm", "tele comm", "Tele-Comm", "TELCOM", "Tele_Comm"], "to": "Telecom"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "if(value=='NaN' || value=='',null,value.toNumber())"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "if(value=='NaN' || value=='',null,value.toNumber())"}, {"op": "core/text-transform", "columnName": "Date", "expression": "if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/),\n  value.parseDate('MM/dd/yyyy').toString('yyyy-MM-dd'),\n  if(value.match(/\\d{4}-\\d{2}-\\d{2}/),\n    value,\n    if(value.match(/\\d{2}-\\d{2}-\\d{4}/),\n      value.parseDate('dd-MM-yyyy').toString('yyyy-MM-dd'),\n      if(value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/),\n        value.parseDate('yyyy.MM.dd').toString('yyyy-MM-dd'),\n        if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/),\n          value.parseDate('yyyy/MM/dd').toString('yyyy-MM-dd'),\n          if(value.match(/\\d{2}\\.\\d{2}\\.\\d{4}/),\n            value.parseDate('MM.dd.yyyy').toString('yyyy-MM-dd'),\n            null\n          )\n        )\n      )\n    )\n  )\n)"}, {"op": "core/fill-down", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom,1500,10000,2023-12-31\nLos Angeles,CA,Telecom,1300,9000,2023-01-15\nChicago,IL,Telecom,1400,9000,2023-02-15\nHouston,TX,Telecom,null,8500,2023-03-05\nPhoenix,AZ,Telecom,1250,8000,2023-04-10\nPhiladelphia,PA,Telecom,1350,9200,2023-05-25\nSan Antonio,TX,Telecom,1400,8800,2023-05-30\nSan Diego,CA,Telecom,1380,8700,2023-06-15\nDallas,TX,Telecom,null,8600,2023-06-20\nSan Jose,CA,Telecom,1450,8300,2023-07-01\nAustin,TX,Telecom,1300,8300,2023-07-15\nJacksonville,FL,Telecom,1250,7800,2023-08-05\nFort Worth,TX,Telecom,1350,8000,2023-08-20"}
{"purpose": "Clean and standardize farm equipment sales data including inconsistent crop types, pricing formats, and date entries.", "raw_table": "FarmID,Crop,Equipment,Price,LoanAmount,SaleDate\n001,wheat,TRACTOR-XL,15000,10000,2023/01/15\n002,corn,plow_pro,8000,6000,15-02-2023\n003,,harvester-202,25000,15000,2023.03.10\n004,Rice,SeederX,5000,4000,2023/4/05\n005,Barley,TRACTOR xl,16000,11000,2023-05-20\n006,Corn,Plow-Pro,8500,,2023/06/01\n007,wheaT,harvester_202,26000,15500,20230615\n008,Rice,Seeder-X,5200,4500,2023/07/10\n009,barley,Tractor_XL,15800,10500,2023/08/01\n010,corn,,9000,7000,08/15/2023\n011,Wheat,Harvester_202,24500,14800,2023-09-05\n012,rice,seeder-x,5100,4200,2023-09-20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and remove underscores/hyphens from Equipment", "columnName": "Equipment", "expression": "value.toLowercase().replace(/[_-]/g, ' ').trim()"}, {"op": "core/text-transform", "description": "Standardize Crop names capitalization", "columnName": "Crop", "expression": "value.toLowercase().replace(/^(wheat|corn|rice|barley)$/i, v => v.toLowercase()).trim().replace(/^(\\w)(\\w*)/, (m, c1, c2) => c1.toUppercase() + c2.toLowercase())"}, {"op": "core/mass-edit", "description": "Fill missing Crop values", "columnName": "Crop", "edits": [{"from": [""], "to": "Wheat"}]}, {"op": "core/text-transform", "description": "Normalize Price and LoanAmount to numeric values", "columnName": "Price", "expression": "value.replace(/[^\\d]/g, '').length > 0 ? Number(value.replace(/[^\\d]/g, '')) : null"}, {"op": "core/text-transform", "description": "Normalize LoanAmount to numeric values", "columnName": "LoanAmount", "expression": "value && value.trim() !== '' ? Number(value.replace(/[^\\d]/g, '')) : null"}, {"op": "core/date-parse", "description": "Parse SaleDate to ISO format", "columnName": "SaleDate", "expression": "value", "onError": "keep-original", "dateFormat": "auto-detect"}, {"op": "core/text-transform", "description": "Format SaleDate as yyyy-MM-dd", "columnName": "SaleDate", "expression": "value ? value.toDate().toString('yyyy-MM-dd') : ''"}, {"op": "core/mass-edit", "description": "Standardize Equipment names", "columnName": "Equipment", "edits": [{"from": ["tractor xl", "tractor_xl", "tractor-xl"], "to": "Tractor XL"}, {"from": ["plow pro", "plow_pro", "plow-pro"], "to": "Plow Pro"}, {"from": ["harvester 202", "harvester_202", "harvester-202"], "to": "Harvester 202"}, {"from": ["seeder x", "seeder_x", "seeder-x"], "to": "Seeder X"}]}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount", "columnName": "LoanAmount"}], "clean_table": "FarmID,Crop,Equipment,Price,LoanAmount,SaleDate\n001,Wheat,Tractor XL,15000,10000,2023-01-15\n002,Corn,Plow Pro,8000,6000,2023-02-15\n003,Wheat,Harvester 202,25000,15000,2023-03-10\n004,Rice,Seeder X,5000,4000,2023-04-05\n005,Barley,Tractor XL,16000,11000,2023-05-20\n006,Corn,Plow Pro,8500,4000,2023-06-01\n007,Wheat,Harvester 202,26000,15500,2023-06-15\n008,Rice,Seeder X,5200,4500,2023-07-10\n009,Barley,Tractor XL,15800,10500,2023-08-01\n010,Corn,,9000,7000,2023-08-15\n011,Wheat,Harvester 202,24500,14800,2023-09-05\n012,Rice,Seeder X,5100,4200,2023-09-20"}
{"purpose": "Clean inconsistent crop names, normalize price formats, and standardize loan amount entries in agricultural sales data.", "raw_table": "FarmID,CropName,State,PricePerTon,LoanAmount,HarvestDate\n101,wheat,KS,1500.00,10000,03/15/2023\n102,Corn,mo,1,2000,2023-04-01\n103,Soy_beans,IL,$1300,5000,15-05-2023\n104,RyE,IA,1250.5,7000,2023/06/20\n105,Barley,KS,1,10000,2023-07-10\n106,,MO,1100,8000,2023-08-01\n107,Wheat,IL,1500,,07/25/2023\n108, Corn,IA,1400.00,9500,2023-09-05\n109,Rye,ks,1350,9000,2023-10-15\n110,SOYBEANS,MO,$1,2500,2023-11-10\n111,Corn,IL,NaN,4000,11-25-2023\n112,barley_IA,IA,1200,8500,2023-12-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from CropName", "columnName": "CropName", "expression": "value.trim()", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Replace underscores and hyphens in CropName with spaces", "columnName": "CropName", "expression": "value.replace(/[_-]/, ' ')", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Normalize CropName capitalization", "columnName": "CropName", "expression": "value.toLowercase().split(' ').map(v, v.substring(0,1).toUppercase() + v.substring(1)).join(' ')", "onError": "keep-original"}, {"op": "core/mass-edit", "description": "Fix missing or incorrect CropName entries", "columnName": "CropName", "edits": [{"from": [""], "to": "Unknown"}, {"from": ["Barley IA"], "to": "Barley"}]}, {"op": "core/text-transform", "description": "Standardize PricePerTon to numeric string without $ or commas", "columnName": "PricePerTon", "expression": "value.replace(/[^0-9\\.]/g, '').length > 0 ? Number(value.replace(/[^0-9\\.]/g, '')).toFixed(2) : \"\"", "onError": "\"\""}, {"op": "core/mass-edit", "description": "Correct wrong PricePerTon values '1' to proper numeric", "columnName": "PricePerTon", "edits": [{"from": ["1"], "to": "1000.00"}]}, {"op": "core/text-transform", "description": "Fill missing LoanAmount with '0' and convert to integer string", "columnName": "LoanAmount", "expression": "value.trim() === '' || value.toLowercase() === 'nan' ? '0' : String(Math.round(Number(value)))", "onError": "\"0\""}, {"op": "core/text-transform", "description": "Capitalize state abbreviations", "columnName": "State", "expression": "value.toUppercase()", "onError": "keep-original"}, {"op": "core/date-parse", "description": "Parse HarvestDate in various formats", "columnName": "HarvestDate", "dateFormat": "yyyy-MM-dd", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Format HarvestDate as ISO yyyy-MM-dd", "columnName": "HarvestDate", "expression": "value instanceof Date ? value.toISOString().substring(0,10) : value", "onError": "keep-original"}], "clean_table": "FarmID,CropName,State,PricePerTon,LoanAmount,HarvestDate\n101,Wheat,KS,1500.00,10000,2023-03-15\n102,Corn,MO,1000.00,2000,2023-04-01\n103,Soy Beans,IL,1300.00,5000,2023-05-15\n104,Rye,IA,1250.50,7000,2023-06-20\n105,Barley,KS,1000.00,10000,2023-07-10\n106,Unknown,MO,1100.00,8000,2023-08-01\n107,Wheat,IL,1500.00,0,2023-07-25\n108,Corn,IA,1400.00,9500,2023-09-05\n109,Rye,KS,1350.00,9000,2023-10-15\n110,Soybeans,MO,1.00,2500,2023-11-10\n111,Corn,IL,0.00,4000,2023-11-25\n112,Barley,IA,1200.00,8500,2023-12-01"}
{"purpose": "Standardize and clean city and state names, normalize business types, and fix date formats in government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew york,NY,retail,10000,50000,01/15/2023\nlos-angeles,ca,RETAIL,12000,55000,15-02-2023\nChicago,IL,Manufacturing,15000,60000,2023/03/10\nhouston,tx,,13000,52000,2023-04-05\nPhoenix,AZ,manufacturing_,11000,48000,04/12/23\nphiladelphia,pa,retail,9000,47000,2023-05-20\nsan-antonio,TX,Manufacturing,14000,,2023-06-18\nSan Diego,CA,retail,11500,53000,06/25/2023\nDALLAS,TX,manufacturing,12500,61000,07-01-2023\nSan jose,ca,retail,10500,49000,2023/08/05\nAustin,Tx,manufacturing,13500,58000,08-15-2023\njacksonville,fl,retail,9500,46000,2023-09-10\nFORT-WORTH,TX,manufacturing,-,62000,09/20/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names properly", "columnName": "City", "expression": "value.toLowercase().split(/[-_ ]+/).map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Capitalize state abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["retail", "RETAIL", "retail_"], "to": "Retail"}, {"from": ["manufacturing", "Manufacturing", "manufacturing_"], "to": "Manufacturing"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Fix Price column: replace invalid or missing with empty string", "columnName": "Price", "expression": "isNonBlank(value) && value.match(/^-?\\d+(\\.\\d+)?$/) && Number(value) > 0 ? value : ''"}, {"op": "core/text-transform", "description": "Fix LoanAmount column: replace missing with empty string", "columnName": "LoanAmount", "expression": "isNonBlank(value) && value.match(/^\\d+(\\.\\d+)?$/) ? value : ''"}, {"op": "core/text-transform", "description": "Normalize Date format to yyyy-MM-dd", "columnName": "Date", "expression": "value.match(/\\d{4}-\\d{2}-\\d{2}/) ? value : (value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/) ? value.replace(/(\\d{2})\\/(\\d{2})\\/(\\d{4})/, '$3-$1-$2') : (value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/) ? value.replace(/\\//g, '-') : (value.match(/\\d{2}-\\d{2}-\\d{4}/) ? value.replace(/(\\d{2})-(\\d{2})-(\\d{4})/, '$3-$1-$2') : (value.match(/\\d{2}\\/\\d{2}\\/\\d{2}/) ? '20' + value.slice(6,8) + '-' + value.slice(0,2) + '-' + value.slice(3,5) : value)))) )"}, {"op": "core/fill-down", "description": "Fill missing LoanAmount values down", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,10000,50000,2023-01-15\nLos Angeles,CA,Retail,12000,55000,2023-02-15\nChicago,IL,Manufacturing,15000,60000,2023-03-10\nHouston,TX,Unknown,13000,52000,2023-04-05\nPhoenix,AZ,Manufacturing,11000,48000,2023-04-12\nPhiladelphia,PA,Retail,9000,47000,2023-05-20\nSan Antonio,TX,Manufacturing,14000,47000,2023-06-18\nSan Diego,CA,Retail,11500,53000,2023-06-25\nDallas,TX,Manufacturing,12500,61000,2023-07-01\nSan Jose,CA,Retail,10500,49000,2023-08-05\nAustin,TX,Manufacturing,13500,58000,2023-08-15\nJacksonville,FL,Retail,9500,46000,2023-09-10\nFort Worth,TX,Manufacturing,,62000,2023-09-20"}
{"purpose": "Standardize movie genre names and correct inconsistent release date formats in the dataset.", "raw_table": "Title,Genre,ReleaseDate,Rating\nInception,SCI-FI,2010/07/16,8.8\nThe_godFather,crime,03-24-1972,9.2\nparasite,Thriller,2019.05.30,8.6\nAvengers-Endgame,action,04/26/2019,8.4\nJoker,Drama,10-02-2019,8.5\nLa La Land,musical,2016/12/09,8.0\nThe Matrix,Sci_fi,31-03-1999,8.7\nInterstellar,sci-fi,2014-11-07,8.6\nGladiator,Action_,2000/05/05,8.5\nTitanic,Romance,12.19.1997,7.8\nUp,Animation,2009/05/29,8.2\nThe Shawshank Redemption,drama,14-10-1994,9.3", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim titles and replace underscores with spaces", "columnName": "Title", "expression": "value.replace(\"_\", \" \").trim()"}, {"op": "core/text-transform", "description": "Standardize Genre capitalization and correct variants", "columnName": "Genre", "expression": "value.toLowercase().replace(\"sci_fi\", \"sci-fi\").replace(\"action_\", \"action\").replace(\"crime\", \"Crime\").replace(\"thriller\", \"Thriller\").replace(\"musical\", \"Musical\").replace(\"romance\", \"Romance\").replace(\"animation\", \"Animation\").replace(\"drama\", \"Drama\").replace(\"sci-fi\", \"Sci-Fi\")"}, {"op": "core/text-transform", "description": "Parse ReleaseDate into uniform yyyy-MM-dd format", "columnName": "ReleaseDate", "expression": "if(value.match(/\\d{4}[\\/\\-.]\\d{2}[\\/\\-.]\\d{2}/)) value.replace(/\\//g,'-').replace(/\\./g,'-') else if(value.match(/\\d{2}-\\d{2}-\\d{4}/)) {let parts = value.split('-'); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0')} else if(value.match(/\\d{2}\\.\\d{2}\\.\\d{4}/)) {let parts = value.split('.'); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0')} else value"}, {"op": "core/text-transform", "description": "Correct ReleaseDate format for dd-MM-yyyy inputs", "columnName": "ReleaseDate", "expression": "if(value.match(/\\d{2}-\\d{2}-\\d{4}/)) {let parts = value.split('-'); parts[2] + '-' + parts[1].padStart(2,'0') + '-' + parts[0].padStart(2,'0')} else value"}, {"op": "core/text-transform", "description": "Ensure Rating is a number rounded to one decimal place", "columnName": "Rating", "expression": "value.toNumber().toFixed(1)"}], "clean_table": "Title,Genre,ReleaseDate,Rating\nInception,Sci-Fi,2010-07-16,8.8\nThe godFather,Crime,1972-03-24,9.2\nparasite,Thriller,2019-05-30,8.6\nAvengers-Endgame,Action,2019-04-26,8.4\nJoker,Drama,2019-10-02,8.5\nLa La Land,Musical,2016-12-09,8.0\nThe Matrix,Sci-Fi,1999-03-31,8.7\nInterstellar,Sci-Fi,2014-11-07,8.6\nGladiator,Action,2000-05-05,8.5\nTitanic,Romance,1997-12-19,7.8\nUp,Animation,2009-05-29,8.2\nThe Shawshank Redemption,Drama,1994-10-14,9.3"}
{"purpose": "Standardize movie genres and clean release date and rating fields for accurate analysis.", "raw_table": "MovieTitle,Genre,ReleaseDate,Rating,BoxOffice\n\"the_great ESCAPE\",Action/Adventure,07-15-2019,8.5,350000000\n\"Romance_in_paris\",rom-com,2018/06/21,seven point eight,125000000\n\"space_odyssey\",SciFi,03-12-20,9,450M\n\"Mystery Manor\",mystery,2019-11-30,8.2,98000000\n\"laugh_out_loud\",Comedy!,Nov 05 2017,6.9,43000000\n\"HorrorNight\",HORROR,10/31/2018,,52000000\n\"The_Drama_Queen\",Drama,2017-02-29,7.3,51000000\n\"Animated_Fun\",Animation,13-01-2019,7.0,68000000\n\"Epic Tale\",action,2019/07/04,8.1,290000000\n\"The_last_Stand\",Thriller,2018-08-25,8.0,120000000\n\"Silent Whispers\",Drama,2017-13-01,7.5,34000000\n\"Family_Ties\",Family,2019-04-12,7.2,87000000\n\"Action Blast\",Action-Adventure,07/17/2019,8.4,310000000\n\"Romance_in_paris\",RomCom,06-21-2018,7.8,125000000\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize Genre values to consistent capitalization and naming", "columnName": "Genre", "expression": "value.toLowercase().replace(/rom[-_]com|romcom/, 'Romantic Comedy').replace(/action[ -]?adventure/, 'Action & Adventure').replace(/scifi/, 'Sci-Fi').replace(/comedy!/, 'Comedy').replace(/horror/, 'Horror').replace(/mystery/, 'Mystery').replace(/drama/, 'Drama').replace(/animation/, 'Animation').replace(/thriller/, 'Thriller').replace(/family/, 'Family')"}, {"op": "core/text-transform", "description": "Fix ReleaseDate format to yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "if(value.match(/\\d{4}[\\/\\-]\\d{2}[\\/\\-]\\d{2}/)) value.replace('/','-').replace('/','-'); else if(value.match(/\\d{2}[\\/\\-]\\d{2}[\\/\\-]\\d{4}/)) { var parts = value.split(/[\\/\\-]/); parts[2] + '-' + (parts[0].length==1 ? '0'+parts[0] : parts[0]) + '-' + (parts[1].length==1 ? '0'+parts[1] : parts[1]); } else if(value.match(/[a-zA-Z]{3} \\d{2} \\d{4}/)) { var d = new Date(value); d.getFullYear() + '-' + (d.getMonth()+1<10 ? '0'+(d.getMonth()+1) : (d.getMonth()+1)) + '-' + (d.getDate()<10 ? '0'+d.getDate() : d.getDate()); } else { value }"}, {"op": "core/text-transform", "description": "Convert Rating to numeric values, fix 'seven point eight' to 7.8", "columnName": "Rating", "expression": "if(value == 'seven point eight') '7.8' else if(value == '') null else value"}, {"op": "core/text-transform", "description": "Convert BoxOffice to numeric without suffixes", "columnName": "BoxOffice", "expression": "value.toLowercase().replace(/m$/, '*1000000').replace(/k$/, '*1000').replace(/[^0-9*]/g, '').eval()"}, {"op": "core/mass-edit", "description": "Fix invalid ReleaseDate entries", "columnName": "ReleaseDate", "edits": [{"from": ["2017-13-01", "13-01-2019", "2017-02-29"], "to": ["2017-01-13", "2019-01-13", "2017-02-28"]}]}, {"op": "core/mass-edit", "description": "Fill missing Ratings with average 7.75", "columnName": "Rating", "edits": [{"from": [null, ""], "to": "7.75"}]}, {"op": "core/column-rename", "description": "Rename MovieTitle to Title", "oldColumnName": "MovieTitle", "newColumnName": "Title"}], "clean_table": "Title,Genre,ReleaseDate,Rating,BoxOffice\nThe Great Escape,Action & Adventure,2019-07-15,8.5,350000000\nRomance_in_paris,Romantic Comedy,2018-06-21,7.8,125000000\nSpace_odyssey,Sci-Fi,2020-03-12,9,450000000\nMystery Manor,Mystery,2019-11-30,8.2,98000000\nLaugh_out_loud,Comedy,2017-11-05,6.9,43000000\nHorrorNight,Horror,2018-10-31,7.75,52000000\nThe_Drama_Queen,Drama,2017-02-28,7.3,51000000\nAnimated_Fun,Animation,2019-01-13,7,68000000\nEpic Tale,Action & Adventure,2019-07-04,8.1,290000000\nThe_last_Stand,Thriller,2018-08-25,8,120000000\nSilent Whispers,Drama,2017-01-13,7.5,34000000\nFamily_Ties,Family,2019-04-12,7.2,87000000\nAction Blast,Action & Adventure,2019-07-17,8.4,310000000\nRomance_in_paris,Romantic Comedy,2018-06-21,7.8,125000000\n"}
{"purpose": "Standardize energy provider names, fix pricing formats, and unify date representations for accurate billing analysis.", "raw_table": "City,State,EnergyProvider,PricePerKWh,ContractStartDate,Loan_Amount\nSeattle,wa,green-power,0.12,2023/02/15,10000\nPortland,OR,GREEN_power,0.1200,15-03-2023,$15,000\nsan francisco,CA,Green-Power,0,11/25/2022,12000\nBoise,Id,GreanPower,0.11,2023.01.10,11000\nEugene,OR,green_power,0.13,2023-03-01,9000\nTacoma,WA,green-power,12 cents,03/15/2023,8500\nSalem,OR,GREENpower,,2023/04/01,7500\nSpokane,WA,green power,0.115,April 5, 2023,8000\nPortland,OR,Green-power,0.12,2023-03-10,8500\nSeattle,WA,green-power,0.12,2023/02/28,10000\nSan Jose,CA,green_power,0.125,02-15-2023,9500\nMedford,OR,GreenPower,0.130,2023-03-05,8800\nYakima,WA,green-power,0.11,March 01 2023,\n", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "EnergyProvider", "edits": [{"from": ["green-power", "GREEN_power", "Green-Power", "green_power", "GREENpower", "green power", "GreenPower", "GreanPower"], "to": "GreenPower"}]}, {"op": "core/text-transform", "columnName": "PricePerKWh", "expression": "if(value==null || value.trim()===\"\" || value.toLowerCase().indexOf('cent')>-1, cell.recon.match==null ? null : \n  value.toLowerCase().indexOf('cent')>-1 ? value.replace(/[^0-9\\.]/g, '')/100 : null, \n  value.toNumber())", "onError": "keep-original", "repeat": false}, {"op": "core/mass-edit", "columnName": "PricePerKWh", "edits": [{"from": [null, ""], "to": "0.12"}]}, {"op": "core/text-transform", "columnName": "ContractStartDate", "expression": "value.toDate()", "onError": "keep-original", "repeat": false}, {"op": "core/text-transform", "columnName": "ContractStartDate", "expression": "if(value instanceof Date, value.toISOString().substring(0,10), value)", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "Loan_Amount", "expression": "if(value == null || value.trim() == '', null, value.replace(/[^0-9]/g, '').toNumber())", "onError": "keep-original"}, {"op": "core/mass-edit", "columnName": "Loan_Amount", "edits": [{"from": [null], "to": "0"}]}, {"op": "core/column-rename", "oldColumnName": "Loan_Amount", "newColumnName": "LoanAmount"}], "clean_table": "City,State,EnergyProvider,PricePerKWh,ContractStartDate,LoanAmount\nSeattle,WA,GreenPower,0.12,2023-02-15,10000\nPortland,OR,GreenPower,0.12,2023-03-15,15000\nSan Francisco,CA,GreenPower,0.12,2022-11-25,12000\nBoise,ID,GreenPower,0.11,2023-01-10,11000\nEugene,OR,GreenPower,0.13,2023-03-01,9000\nTacoma,WA,GreenPower,0.12,2023-03-15,8500\nSalem,OR,GreenPower,0.12,2023-04-01,7500\nSpokane,WA,GreenPower,0.115,2023-04-05,8000\nPortland,OR,GreenPower,0.12,2023-03-10,8500\nSeattle,WA,GreenPower,0.12,2023-02-28,10000\nSan Jose,CA,GreenPower,0.125,2023-02-15,9500\nMedford,OR,GreenPower,0.13,2023-03-05,8800\nYakima,WA,GreenPower,0.11,2023-03-01,0\n"}
{"purpose": "Clean and standardize farm loan data including city names, business types, and date formats.", "raw_table": "FarmID,City,State,BusinessType,LoanAmount,PricePerAcre,Date\n101,GreenVIlle,NC,farm-ing,50000,2500,03/15/2022\n102,Rose-town,TX,cattle_rearing,75000,,15-Mar-2022\n103,bluefield,VA,Grain_Farming,62000,1800,2022/03/16\n104,,GA,Vegetable growing,45000,2200,03-17-2022\n105,Springfield,IL,Orchards,58000,2100,March 18 2022\n106,Riverton,MO,FarmIng, ,2000,2022.03.19\n107,Maple_city,NY,livestock,67000,1950,20220320\n108,Hill-valley,PA,cattle_rearing,73000,2050,03/21/22\n109,oakridge,oh,Fruit_farming,49000,2150,Mar 22, 2022\n110,Brighton,mi,grain_farming,66000,1850,22nd March 2022\n", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["GreenVIlle"], "to": "Greenville"}, {"from": ["Rose-town"], "to": "Rosetown"}, {"from": ["bluefield"], "to": "Bluefield"}, {"from": ["Maple_city"], "to": "Maple City"}, {"from": ["Hill-valley"], "to": "Hill Valley"}, {"from": ["oakridge"], "to": "Oakridge"}, {"from": ["Brighton"], "to": "Brighton"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["farm-ing", "FarmIng"], "to": "Farming"}, {"from": ["cattle_rearing"], "to": "Cattle Rearing"}, {"from": ["Grain_Farming", "grain_farming"], "to": "Grain Farming"}, {"from": ["Vegetable growing"], "to": "Vegetable Growing"}, {"from": ["Orchards"], "to": "Orchards"}, {"from": ["livestock"], "to": "Livestock"}, {"from": ["Fruit_farming"], "to": "Fruit Farming"}]}, {"op": "core/fill-down", "columnName": "City"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value.trim() == '' ? null : value"}, {"op": "core/text-transform", "columnName": "PricePerAcre", "expression": "value.trim() == '' ? null : value"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value", "onError": "keep-original", "pattern": "MM/dd/yyyy"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value", "onError": "keep-original", "pattern": "dd-MMM-yyyy"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value", "onError": "keep-original", "pattern": "yyyy/MM/dd"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value", "onError": "keep-original", "pattern": "MM-dd-yyyy"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value", "onError": "keep-original", "pattern": "MMMM dd yyyy"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value", "onError": "keep-original", "pattern": "yyyy.MM.dd"}, {"op": "core/date-format", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "FarmID,City,State,BusinessType,LoanAmount,PricePerAcre,Date\n101,Greenville,NC,Farming,50000,2500,2022-03-15\n102,Rosetown,TX,Cattle Rearing,75000,,2022-03-15\n103,Bluefield,VA,Grain Farming,62000,1800,2022-03-16\n104,Bluefield,GA,Vegetable Growing,45000,2200,2022-03-17\n105,Springfield,IL,Orchards,58000,2100,2022-03-18\n106,Riverton,MO,Farming,,2000,2022-03-19\n107,Maple City,NY,Livestock,67000,1950,2022-03-20\n108,Hill Valley,PA,Cattle Rearing,73000,2050,2022-03-21\n109,Oakridge,OH,Fruit Farming,49000,2150,2022-03-22\n110,Brighton,MI,Grain Farming,66000,1850,2022-03-22\n"}
{"purpose": "Standardize inconsistent city names, formats, and data types in a telecommunications customer dataset.", "raw_table": "CustomerID,City,State,BusinessType,Price,LoanAmount,SubscriptionDate\n1001,new_york,ny,Small-Business,200.5,15000,2023/01/15\n1002,LOS ANGELES,CA,Enterprise,300.00,35000,01-20-2023\n1003,Chicago,il,smallbusiness,199.99,NaN,2023-02-10\n1004,Houston,Tx,SMALL_business,,12000,2023/03/05\n1005,Phoenix,AZ,enterprise,250.0,25000,03-15-2023\n1006,philadelphia,pa,Small_business,210.75,16000,2023/02/30\n1007,San_Antonio,tx,Enterprise,NaN,30000,2023/04/01\n1008,san diego,CA,small-business,190.5,14000,2023-03-25\n1009,Dallas,Tx,ENTERPRISE,275.0,28000,2023/04/12\n1010,san_jose,ca,small_business,205,15000,2023-02-28\n1011,,TX,small-business,195,15500,2023/02/20\n1012,Austin,tx,SmallBusiness,NaN,18000,2023-02-18\n1013,Jacksonville,Fl,Enterprise,310.25,,2023-01-30\n1014,fort worth,TX,small-business,199.5,17000,2023-13-01\n", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["new_york", "new york"], "to": "New York"}, {"from": ["LOS ANGELES", "los angeles"], "to": "Los Angeles"}, {"from": ["San_Antonio", "san antonio"], "to": "San Antonio"}, {"from": ["san diego", "San Diego"], "to": "San Diego"}, {"from": ["san_jose", "San Jose"], "to": "San Jose"}, {"from": ["fort worth", "Fort Worth"], "to": "Fort Worth"}, {"from": ["philadelphia"], "to": "Philadelphia"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["smallbusiness", "SmallBusiness", "SMALL_business", "small_business", "small-business", "Small-Business"], "to": "Small Business"}, {"from": ["enterprise", "Enterprise", "ENTERPRISE"], "to": "Enterprise"}]}, {"op": "core/column-rename", "oldColumnName": "SubscriptionDate", "newColumnName": "Date"}, {"op": "core/text-transform", "columnName": "Date", "expression": "if(isNonBlank(value),\n  try(value.toDate('yyyy/MM/dd'),\n      try(value.toDate('MM-dd-yyyy'),\n          try(value.toDate('yyyy-MM-dd'),\n              null\n          )\n      )\n  ),\n  null\n).toString('yyyy-MM-dd')"}, {"op": "core/mass-edit", "columnName": "Date", "edits": [{"from": ["2023-02-30", "2023-13-01"], "to": ""}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "if(value == null || value.trim() == '' || value == 'NaN', null, Number(value))"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "if(value == null || value.trim() == '' || value == 'NaN', null, Number(value))"}, {"op": "core/fill-down", "columnName": "City"}], "clean_table": "CustomerID,City,State,BusinessType,Price,LoanAmount,Date\n1001,New York,NY,Small Business,200.5,15000,2023-01-15\n1002,Los Angeles,CA,Enterprise,300,35000,2023-01-20\n1003,Chicago,IL,Small Business,199.99,,2023-02-10\n1004,Houston,TX,Small Business,,12000,2023-03-05\n1005,Phoenix,AZ,Enterprise,250,25000,2023-03-15\n1006,Philadelphia,PA,Small Business,210.75,16000,\n1007,San Antonio,TX,Enterprise,,30000,2023-04-01\n1008,San Diego,CA,Small Business,190.5,14000,2023-03-25\n1009,Dallas,TX,Enterprise,275,28000,2023-04-12\n1010,San Jose,CA,Small Business,205,15000,2023-02-28\n1011,San Jose,TX,Small Business,195,15500,2023-02-20\n1012,Austin,TX,Small Business,,18000,2023-02-18\n1013,Jacksonville,FL,Enterprise,310.25,,2023-01-30\n1014,Fort Worth,TX,Small Business,199.5,17000,\n"}
{"purpose": "Clean inconsistent crop names, standardize date formats, and fix numeric price and loan amounts.", "raw_table": "FarmID,Crop,PricePerTon,Loan_Amount,PlantingDate,State\n101,wheat,1500,50000,03-15-2023,ca\n102,Corn, 1200 ,45000,2023/04/01,TX\n103,Soy-bean,1300,NaN,15-05-2023,il\n104,Rice,One Thousand Six Hundred,52000,2023-06-10,Ny\n105,Maize,1250,48000,06/20/23,tx\n106,WHEAT,1550,51000,2023.07.05,CA\n107,corn, 1175 ,Na,07-15-2023,Il\n108,,1400,47000,2023-08-01,ny\n109,Soybean,1350,50000,2023-08-15,TX\n110,Rice_,1600,53000,20-08-2023,ca", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "Crop", "edits": [{"from": ["Soy-bean", "Soybean"], "to": "Soybean"}, {"from": ["Maize"], "to": "Corn"}, {"from": ["Rice_"], "to": "Rice"}]}, {"op": "core/text-transform", "columnName": "Crop", "expression": "value.toLowercase().trim().replace(/^./, value.charAt(0).toUpperCase())", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "PricePerTon", "expression": "value.replace(/[^0-9\\.]/g, '').length > 0 ? Number(value.replace(/[^0-9\\.]/g, '')) : null", "onError": "keep-original"}, {"op": "core/mass-edit", "columnName": "Loan_Amount", "edits": [{"from": ["NaN", "Na"], "to": ""}]}, {"op": "core/text-transform", "columnName": "Loan_Amount", "expression": "value.trim() === '' ? null : Number(value)", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "PlantingDate", "expression": "value.match(/\\d{4}[-/.]\\d{2}[-/.]\\d{2}/) ? value : (value.match(/\\d{2}[-/]\\d{2}[-/]\\d{4}/) ? value.split(/[-/]/).reverse().join('-') : (value.match(/\\d{2}[-/]\\d{2}[-/]\\d{2}/) ? '20'+value.split(/[-/]/)[2]+'-'+value.split(/[-/]/)[0]+'-'+value.split(/[-/]/)[1] : null))", "onError": "keep-original"}, {"op": "core/date-parse", "columnName": "PlantingDate", "format": "yyyy-MM-dd", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase().trim()", "onError": "keep-original"}, {"op": "core/column-rename", "oldColumnName": "Loan_Amount", "newColumnName": "LoanAmount"}, {"op": "core/column-rename", "oldColumnName": "PricePerTon", "newColumnName": "PricePerTonUSD"}], "clean_table": "FarmID,Crop,PricePerTonUSD,LoanAmount,PlantingDate,State\n101,Wheat,1500,50000,2023-03-15,CA\n102,Corn,1200,45000,2023-04-01,TX\n103,Soybean,1300,,2023-05-15,IL\n104,Rice,1600,52000,2023-06-10,NY\n105,Corn,1250,48000,2023-06-20,TX\n106,Wheat,1550,51000,2023-07-05,CA\n107,Corn,1175,,2023-07-15,IL\n108,,1400,47000,2023-08-01,NY\n109,Soybean,1350,50000,2023-08-15,TX\n110,Rice,1600,53000,2023-08-20,CA"}
{"purpose": "Standardize crop names and correct pricing and date formats in agricultural sales data.", "raw_table": "FarmID,Crop_Name,Quantity_tonnes,Price_per_tonne,Sale_Date\nF001,Wheat,10,250-00,2023/05/12\nF002,maize,15,200.5,12-06-2023\nF003,Rice_,12,,2023.07.01\nF004,Soybean,8,300,07-15-2023\nF005,Barley,NaN,275.00,2023_08_10\nF006,wheat,5,260,15/09/2023\nF007,maize,20,210.0,2023-10-05\nF008,RICE,18,220-00,2023/11/20\nF009,soybean,7,,2023/12/01\nF010,barley,14,280,01-01-2024", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove trailing underscores from Crop_Name", "columnName": "Crop_Name", "expression": "value.replace(/_+$/, '')"}, {"op": "core/text-transform", "description": "Capitalize Crop_Name consistently", "columnName": "Crop_Name", "expression": "value.toLowerCase().replace(/^(.)/, s => s.toUpperCase())"}, {"op": "core/mass-edit", "description": "Fix crop name misspellings to standard terms", "columnName": "Crop_Name", "edits": [{"from": ["Maize", "maize"], "to": "Maize"}, {"from": ["Wheat", "wheat"], "to": "Wheat"}, {"from": ["Rice", "rice", "RICE"], "to": "Rice"}, {"from": ["Soybean", "soybean"], "to": "Soybean"}, {"from": ["Barley", "barley"], "to": "Barley"}]}, {"op": "core/text-transform", "description": "Fix Price_per_tonne format: replace dashes with dots", "columnName": "Price_per_tonne", "expression": "value ? value.replace(/-/g, '.') : value"}, {"op": "core/text-transform", "description": "Convert Price_per_tonne to number format", "columnName": "Price_per_tonne", "expression": "value ? Number(value) : null"}, {"op": "core/fill-down", "description": "Fill down missing Quantity_tonnes values", "columnName": "Quantity_tonnes"}, {"op": "core/text-transform", "description": "Convert Quantity_tonnes NaN strings to null", "columnName": "Quantity_tonnes", "expression": "value == 'NaN' ? null : value"}, {"op": "core/date-parse", "description": "Parse Sale_Date into ISO format", "columnName": "Sale_Date", "dateFormat": "yyyy-MM-dd"}, {"op": "core/text-transform", "description": "Normalize Sale_Date to yyyy-MM-dd", "columnName": "Sale_Date", "expression": "value.toString().replace(/[\\/._]/g, '-').replace(/(\\d{2})-(\\d{2})-(\\d{4})/, '$3-$2-$1')"}, {"op": "core/text-transform", "description": "Convert Sale_Date to ISO string", "columnName": "Sale_Date", "expression": "value instanceof Date ? value.toISOString().substring(0,10) : value"}], "clean_table": "FarmID,Crop_Name,Quantity_tonnes,Price_per_tonne,Sale_Date\nF001,Wheat,10,250,2023-05-12\nF002,Maize,15,200.5,2023-06-12\nF003,Rice,12,,2023-07-01\nF004,Soybean,8,300,2023-07-15\nF005,Barley,12,275,2023-08-10\nF006,Wheat,5,260,2023-09-15\nF007,Maize,20,210,2023-10-05\nF008,Rice,18,220,2023-11-20\nF009,Soybean,7,,2023-12-01\nF010,Barley,14,280,2024-01-01"}
{"purpose": "Clean and standardize movie titles, release dates, genres, and box office revenue data.", "raw_table": "MovieID,Title,ReleaseDate,Genre,BoxOffice\n1,The Shawshank Redemption,09/22/1994,Drama,28341469\n2,Forrest_Gump,7-06-1994,drama,330455270\n3,The Matrix,03/31/1999,Science-fiction,463517383\n4,Inception,2010/07/16,Action,829895144\n5,interstellar,11/7/2014, sci-Fi,677471339\n6,The Godfather,03-24-1972,Drama,246120974\n7,Avengers-Endgame,2019-04-26,action,2797800564\n8,Pulp Fiction,10_14_1994,Crime,213928762\n9,The Dark Knight,07/18/2008,Action,1004558444\n10,Fight Club,,drAMA,100853753\n11,The Lion King,06-15-1994,Animation,968483777\n12,Gladiator,05/01/2000,Action-,457640427\n13,Back to the Future,07/03/1985,Science Fiction,381109762\n14,Jumanji,12-15-1995,Adventure,262797249", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "Genre", "edits": [{"from": ["drama", "drAMA"], "to": "Drama"}, {"from": ["Science-fiction", "Science Fiction"], "to": "Science Fiction"}, {"from": ["sci-Fi"], "to": "Science Fiction"}, {"from": ["Action-"], "to": "Action"}]}, {"op": "core/text-transform", "columnName": "Title", "expression": "value.replace(/[_-]/g, ' ').titlecase()", "onError": "keep-original", "repeat": false}, {"op": "core/date-parse", "columnName": "ReleaseDate", "dateFormat": "MM/dd/yyyy", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "ReleaseDate", "expression": "value.match(/\\d{4}-\\d{2}-\\d{2}/) ? value : (value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/) ? value.replace(/\\//g, '-') : value)", "repeat": false}, {"op": "core/date-parse", "columnName": "ReleaseDate", "dateFormat": "yyyy-MM-dd", "onError": "keep-original"}, {"op": "core/date-parse", "columnName": "ReleaseDate", "dateFormat": "MM-dd-yyyy", "onError": "keep-original"}, {"op": "core/mass-edit", "columnName": "ReleaseDate", "edits": [{"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "value.replace(/[^0-9]/g, '').toNumber()", "repeat": false}], "clean_table": "MovieID,Title,ReleaseDate,Genre,BoxOffice\n1,The Shawshank Redemption,1994-09-22,Drama,28341469\n2,Forrest Gump,1994-07-06,Drama,330455270\n3,The Matrix,1999-03-31,Science Fiction,463517383\n4,Inception,2010-07-16,Action,829895144\n5,Interstellar,2014-11-07,Science Fiction,677471339\n6,The Godfather,1972-03-24,Drama,246120974\n7,Avengers Endgame,2019-04-26,Action,2797800564\n8,Pulp Fiction,1994-10-14,Crime,213928762\n9,The Dark Knight,2008-07-18,Action,1004558444\n10,Fight Club,Unknown,Drama,100853753\n11,The Lion King,1994-06-15,Animation,968483777\n12,Gladiator,2000-05-01,Action,457640427\n13,Back To The Future,1985-07-03,Science Fiction,381109762\n14,Jumanji,1995-12-15,Adventure,262797249"}
{"purpose": "Standardize city and state names, fix business types, and normalize date and numeric formats in government grant application data.", "raw_table": "City,State,BusinessType,GrantAmount,ApplicationDate\nNew_York,ny,non-profit,10000,12/01/2022\nLos-angeles,CA,for profit,5000,2022-11-15\nChicago,IL,NonProfit,7500,15-10-2022\nhouston,Tx,,12000,2022/09/30\nPHOENIX,az,for-profit,NaN,10-01-2022\nphiladelphia,PA,non_profit,8000,2022.08.25\nSan Antonio,tx,for_profit,7000,08/20/2022\nsan_diego,CA,non profit,6500,2022-07-10\nDallas,tx,For-Profit,9000,July 5, 2022\nsan jose,CA,Non-Profit,11000,2022/06/30\nAUSTIN,TX,for profit,NaN,2022-06-15\njacksonville,fl,non-profit,5500,06-10-2022\nfort worth,TX,for-profit,6000,2022-05-20\ncolumbus,OH,non_profit,7200,2022/04/25\ncharlotte,NC,for profit,8000,April 15 2022", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_York"], "to": "New York"}, {"from": ["Los-angeles"], "to": "Los Angeles"}, {"from": ["san_diego"], "to": "San Diego"}, {"from": ["san jose"], "to": "San Jose"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()", "description": "Capitalize city names properly"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()", "description": "Uppercase state codes"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["non-profit", "NonProfit", "non_profit", "non profit"], "to": "Non-Profit"}, {"from": ["for profit", "for-profit", "for_profit", "For-Profit", "For-Profit"], "to": "For-Profit"}]}, {"op": "core/mass-edit", "columnName": "GrantAmount", "edits": [{"from": ["NaN", ""], "to": "0"}]}, {"op": "core/text-transform", "columnName": "GrantAmount", "expression": "value.toNumber()", "description": "Convert GrantAmount to number"}, {"op": "core/text-transform", "columnName": "ApplicationDate", "expression": "value.toDate(\"yyyy-MM-dd\") || value.toDate(\"MM/dd/yyyy\") || value.toDate(\"dd-MM-yyyy\") || value.toDate(\"yyyy/MM/dd\") || value.toDate(\"dd-MM-yyyy\") || value.toDate(\"yyyy.MM.dd\") || value.toDate(\"MMMM d, yyyy\") || value.toDate(\"MMMM dd yyyy\")", "description": "Parse multiple date formats"}, {"op": "core/text-transform", "columnName": "ApplicationDate", "expression": "value.toString(\"yyyy-MM-dd\")", "description": "Format all dates as ISO yyyy-MM-dd"}, {"op": "core/fill-down", "columnName": "BusinessType"}], "clean_table": "City,State,BusinessType,GrantAmount,ApplicationDate\nNew York,NY,Non-Profit,10000,2022-12-01\nLos Angeles,CA,For-Profit,5000,2022-11-15\nChicago,IL,Non-Profit,7500,2022-10-15\nHouston,TX,Non-Profit,12000,2022-09-30\nPhoenix,AZ,For-Profit,0,2022-10-01\nPhiladelphia,PA,Non-Profit,8000,2022-08-25\nSan Antonio,TX,For-Profit,7000,2022-08-20\nSan Diego,CA,Non-Profit,6500,2022-07-10\nDallas,TX,For-Profit,9000,2022-07-05\nSan Jose,CA,Non-Profit,11000,2022-06-30\nAustin,TX,For-Profit,0,2022-06-15\nJacksonville,FL,Non-Profit,5500,2022-06-10\nFort Worth,TX,For-Profit,6000,2022-05-20\nColumbus,OH,Non-Profit,7200,2022-04-25\nCharlotte,NC,For-Profit,8000,2022-04-15"}
{"purpose": "Clean and standardize farm loan application data with inconsistent capitalization, misspellings, and date formats.", "raw_table": "FarmName,State,LoanAmount,ApplicationDate,CropType,PricePerUnit\nGreen_valley farm,tx,15000,2023/04/12,Wheat,5.5\nsunshine-farms,CA,20000,04-15-2023,Corn,4.75\nBlueHill Farm,fl,,2023.04.20,RICE,6.0\nGoldenField,Tx,12000,2023/4/18,sOya, ,\nriver_side,ca,18000,15/04/2023,Corn,4.8\nSunrise_farm,TX,17000,2023-04-14,soyA,5\nGreen Valley Farm,TX,15000,2023-04-12, wheat,5.5\nSunny-farms,CA,20000,2023/04/15,CORN,4.75\nBluehill farm,FL,16000,2023-04-22,Rice,6\ngoldenfield,TX,12000,2023-04-18,SoyA,5.2\nriverside,CA,18000,2023-04-15,CoRN,4.8\nSunrise Farm,tx,17000,2023/04/14,SOYA,5\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim and normalize capitalization for FarmName", "columnName": "FarmName", "expression": "value.toLowercase().replace(/[-_]/g, ' ').replace(/\\s+/g, ' ').trim().split(' ').map(w, i, a, w[0].toUppercase() + w.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase State codes", "columnName": "State", "expression": "value.toUppercase().trim()"}, {"op": "core/mass-edit", "description": "Standardize CropType values", "columnName": "CropType", "edits": [{"from": ["wheat", " wheat", "Wheat"], "to": "Wheat"}, {"from": ["corn", "Corn", "CORN", "CoRN"], "to": "Corn"}, {"from": ["soya", "soyA", "SOYA", "SoyA"], "to": "Soya"}, {"from": ["rice", "Rice", "RICE"], "to": "Rice"}]}, {"op": "core/text-transform", "description": "Parse and standardize ApplicationDate to yyyy-MM-dd", "columnName": "ApplicationDate", "expression": "if(value.match(/^\\d{4}\\/\\d{2}\\/\\d{2}$/)) value.replace(/\\//g, '-') else if(value.match(/^\\d{2}-\\d{2}-\\d{4}$/)) value.split('-')[2] + '-' + value.split('-')[0].padStart(2,'0') + '-' + value.split('-')[1].padStart(2,'0') else if(value.match(/^\\d{4}\\.\\d{2}\\.\\d{2}$/)) value.replace(/\\./g, '-') else if(value.match(/^\\d{2}\\/\\d{2}\\/\\d{4}$/)) { var parts = value.split('/'); parts[2] + '-' + parts[1].padStart(2,'0') + '-' + parts[0].padStart(2,'0')} else value"}, {"op": "core/mass-edit", "description": "Fill missing PricePerUnit values based on CropType average", "columnName": "PricePerUnit", "edits": [{"from": [""], "to": "5.2"}]}, {"op": "core/text-transform", "description": "Convert LoanAmount to number and fill missing with 16000", "columnName": "LoanAmount", "expression": "if(value.trim() == '') '16000' else value"}, {"op": "core/text-transform", "description": "Trim PricePerUnit and convert to number format", "columnName": "PricePerUnit", "expression": "value.trim()"}], "clean_table": "FarmName,State,LoanAmount,ApplicationDate,CropType,PricePerUnit\nGreen Valley Farm,TX,15000,2023-04-12,Wheat,5.5\nSunshine Farms,CA,20000,2023-04-15,Corn,4.75\nBluehill Farm,FL,16000,2023-04-20,Rice,6.0\nGoldenfield,TX,12000,2023-04-18,Soya,5.2\nRiverside,CA,18000,2023-04-15,Corn,4.8\nSunrise Farm,TX,17000,2023-04-14,Soya,5\nGreen Valley Farm,TX,15000,2023-04-12,Wheat,5.5\nSunny Farms,CA,20000,2023-04-15,Corn,4.75\nBluehill Farm,FL,16000,2023-04-22,Rice,6\nGoldenfield,TX,12000,2023-04-18,Soya,5.2\nRiverside,CA,18000,2023-04-15,Corn,4.8\nSunrise Farm,TX,17000,2023-04-14,Soya,5\n"}
{"purpose": "Normalize city names and business types, fix date formats, and correct numeric fields in telecommunications customer records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,SignupDate\nnew_york,ny,Mobile-Provider,299.99,$5000,01-15-2023\nLOS ANGELES,CA,INTERNET_provider, 399.50,4500,2023/02/20\nChicago,IL,Broadband_provider,,3500,03-01-23\nhouston,Tx,Mobile Provider,250 USD,4000,2023-04-05\nPhila_delphia,pa,Mobile-provider,199.99,three thousand,2023/05/10\nPhoenix,AZ,Internet_provider,349.99,4200,May 15 2023\nsan antonio,tx,Mobile-provider,279.00,3800,2023.06.20\ndallas,Tx,broadband_provider,310,3900,2023-07-01\nsan_diego,ca,mobile-provider,260,NaN,07/15/2023\nsan jose,CA,Internet_provider,320.0,4100,2023-08-01\nAustin,TX,broadband_provider,280,3700,08/10/23\njacksonville,fl,mobile_provider,250,3600,2023-09-05\nfort worth,tx,internet-provider,300,4000,09-15-2023\ncolumbus,oh,mobile-provider,,3400,2023/10/01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize city names by replacing underscores and hyphens with spaces and capitalize each word", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').split(' ').map(v, v[0].toUppercase() + v.substring(1).toLowercase()).join(' ')"}, {"op": "core/mass-edit", "description": "Fix inconsistent state abbreviations capitalization", "columnName": "State", "edits": [{"from": ["ny", "Ny", "nY"], "to": "NY"}, {"from": ["ca", "Ca", "cA"], "to": "CA"}, {"from": ["tx", "Tx", "tX"], "to": "TX"}, {"from": ["pa", "Pa", "pA"], "to": "PA"}, {"from": ["il", "Il", "iL"], "to": "IL"}, {"from": ["fl", "Fl", "fL"], "to": "FL"}, {"from": ["oh", "Oh", "oH"], "to": "OH"}, {"from": ["az", "Az", "aZ"], "to": "AZ"}]}, {"op": "core/mass-edit", "description": "Normalize BusinessType naming", "columnName": "BusinessType", "edits": [{"from": ["Mobile-Provider", "mobile-provider", "Mobile Provider", "mobile_provider", "Mobile-provider", "mobile_provider"], "to": "Mobile Provider"}, {"from": ["Internet_provider", "internet-provider", "Internet-Provider", "internet_provider"], "to": "Internet Provider"}, {"from": ["Broadband_provider", "broadband_provider", "broadband-provider"], "to": "Broadband Provider"}]}, {"op": "core/text-transform", "description": "Clean Price column to remove extra characters and parse as number", "columnName": "Price", "expression": "value.toString().replace(/[^0-9\\.]/g, '').length > 0 ? Number(value.toString().replace(/[^0-9\\.]/g, '')) : null"}, {"op": "core/text-transform", "description": "Clean LoanAmount column to ensure numeric values", "columnName": "LoanAmount", "expression": "value.toLowerCase() == 'nan' || value.toLowerCase() == 'three thousand' ? (value.toLowerCase() == 'three thousand' ? 3000 : null) : Number(value.replace(/[^0-9]/g, ''))"}, {"op": "core/date-parse", "description": "Parse SignupDate to standard yyyy-MM-dd format", "columnName": "SignupDate", "dateFormat": "yyyy-MM-dd"}, {"op": "core/fill-down", "description": "Fill down any missing Price values", "columnName": "Price"}, {"op": "core/fill-down", "description": "Fill down any missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,SignupDate\nNew York,NY,Mobile Provider,299.99,5000,2023-01-15\nLos Angeles,CA,Internet Provider,399.5,4500,2023-02-20\nChicago,IL,Broadband Provider,399.5,3500,2023-03-01\nHouston,TX,Mobile Provider,250,4000,2023-04-05\nPhila Delphia,PA,Mobile Provider,199.99,3000,2023-05-10\nPhoenix,AZ,Internet Provider,349.99,4200,2023-05-15\nSan Antonio,TX,Mobile Provider,279,3800,2023-06-20\nDallas,TX,Broadband Provider,310,3900,2023-07-01\nSan Diego,CA,Mobile Provider,260,3900,2023-07-15\nSan Jose,CA,Internet Provider,320,4100,2023-08-01\nAustin,TX,Broadband Provider,280,3700,2023-08-10\nJacksonville,FL,Mobile Provider,250,3600,2023-09-05\nFort Worth,TX,Internet Provider,300,4000,2023-09-15\nColumbus,OH,Mobile Provider,300,3400,2023-10-01"}
{"purpose": "Clean and standardize farm produce sales data with inconsistent crop names and formatting issues.", "raw_table": "FarmID,Crop,Quantity,UnitPrice,SaleDate,Buyer\n001,Tomato ,100,2.5,2023/07/15,Green_farm\n002,poTato,200,1.8,15-07-2023,Fresh-Market\n003,corn, ,3.0,07/16/2023,green_farm\n004,Wheat,150,2,2023.07.17,FRESH-market\n005,Rice,120,xyz,17/07/2023,Local-Market\n006,tomato,130,2.6,2023/7/18,Green_farm\n007,Potato,250,1.7,2023-07-18,Fresh-market\n008,Corn,180,3.1,18/07/2023,local-market\n009,wheat, ,2.1,2023/07/19,green_farm\n010,rIce,115,2.0,19-07-2023,Local-market", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from Crop names", "columnName": "Crop", "expression": "value.trim()"}, {"op": "core/mass-edit", "description": "Standardize Crop names capitalization", "columnName": "Crop", "edits": [{"from": ["Tomato", "tomato", "Tomato "], "to": "Tomato"}, {"from": ["poTato", "Potato"], "to": "Potato"}, {"from": ["corn", "Corn"], "to": "Corn"}, {"from": ["Wheat", "wheat"], "to": "Wheat"}, {"from": ["Rice", "rIce"], "to": "Rice"}]}, {"op": "core/text-transform", "description": "Fix Buyer names capitalization and replace underscores/hyphens with space", "columnName": "Buyer", "expression": "value.toLowercase().replaceAll(/[_-]/, ' ').split(' ').map(s, s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Convert UnitPrice to numeric, replace invalid with null", "columnName": "UnitPrice", "expression": "if(value.toNumber() > 0, value.toNumber(), null)"}, {"op": "core/fill-down", "description": "Fill down missing Quantity values", "columnName": "Quantity"}, {"op": "core/text-transform", "description": "Convert Quantity to number, null if not numeric", "columnName": "Quantity", "expression": "if(value.toNumber() > 0, value.toNumber(), null)"}, {"op": "core/date-parse", "description": "Parse SaleDate to yyyy-MM-dd", "columnName": "SaleDate", "format": "auto", "newColumnName": "SaleDate_parsed", "onError": "keep-original"}, {"op": "core/mass-edit", "description": "Rename SaleDate_parsed to SaleDate", "columnName": "SaleDate_parsed", "edits": [{"from": [""], "to": ""}]}, {"op": "core/column-rename", "description": "Rename SaleDate_parsed back to SaleDate", "oldColumnName": "SaleDate_parsed", "newColumnName": "SaleDate"}], "clean_table": "FarmID,Crop,Quantity,UnitPrice,SaleDate,Buyer\n001,Tomato,100,2.5,2023-07-15,Green Farm\n002,Potato,200,1.8,2023-07-15,Fresh Market\n003,Corn,200,3.0,2023-07-16,Green Farm\n004,Wheat,150,2.0,2023-07-17,Fresh Market\n005,Rice,120,,2023-07-17,Local Market\n006,Tomato,130,2.6,2023-07-18,Green Farm\n007,Potato,250,1.7,2023-07-18,Fresh Market\n008,Corn,180,3.1,2023-07-18,Local Market\n009,Wheat,150,2.1,2023-07-19,Green Farm\n010,Rice,115,2.0,2023-07-19,Local Market"}
{"purpose": "Standardize inconsistent city names and formats, correct business type entries, and normalize price and date fields in government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew_york,NY,cafe,25000,100000,01/15/2023\nLos-angeles,CA,Restuarant,45000,200000,2023-02-28\nCHICAGO,IL,Cafe,30000,150000,15-Mar-2023\nhouston,Tx,restaurant,not available,120000,3/20/23\nphiladelphia,PA,cafe_,28000,130000,2023/04/10\nPhoenix,AZ,Restaurent,35000,missing,04-25-2023\nsan antonio,TX,,40000,140000,2023.05.05\nSan-Diego,ca,Cafe,27000,125000,2023-06-01\nDALLAS,tx,restaurant,31000,110000,06/15/23\nSan_jose,CA,Cafe,29000,115000,2023/07/10\nAustin,TX,restuarant,33000,,07-20-2023\nJacksonville,fl,Cafe,26000,105000,2023-08-05\nfort-worth,Tx,restaurant,30000,135000,08/15/2023\nColumbus,OH,cafe,28000,120000,2023-09-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces and capitalize city names", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').toTitlecase()"}, {"op": "core/mass-edit", "description": "Standardize state abbreviations to uppercase two-letter codes", "columnName": "State", "edits": [{"from": ["Tx", "tx", "fl", "ca"], "to": ["TX", "TX", "FL", "CA"]}]}, {"op": "core/text-transform", "description": "Fix common misspellings and standardize BusinessType to first letter uppercase", "columnName": "BusinessType", "expression": "if(isBlank(value), 'Cafe', value.toLowercase().replace('restuarant', 'restaurant').replace('restaurent', 'restaurant').replace('cafe_', 'cafe').toTitlecase(), '')"}, {"op": "core/mass-edit", "description": "Replace textual or missing values in Price with null", "columnName": "Price", "edits": [{"from": ["not available", "missing", ""], "to": ""}]}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numbers, replace blanks with null", "columnName": "Price", "expression": "if(value.trim() === '', null, Number(value))"}, {"op": "core/text-transform", "description": "Convert LoanAmount blanks to null and ensure numeric type", "columnName": "LoanAmount", "expression": "if(value.trim() === 'missing' || value.trim() === '', null, Number(value))"}, {"op": "core/date-parse", "description": "Parse various date formats into ISO format yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate('MM/dd/yyyy') || value.toDate('yyyy-MM-dd') || value.toDate('dd-MMM-yyyy') || value.toDate('M/d/yy') || value.toDate('yyyy/MM/dd') || value.toDate('MM-dd-yyyy') || value.toDate('yyyy.MM.dd') || value.toDate('M/d/yyyy') || value.toDate('yyyy/MM/dd') || value.toDate('MM/dd/yy')", "onError": "set-to-blank"}, {"op": "core/text-transform", "description": "Format all dates to yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Cafe,25000,100000,2023-01-15\nLos Angeles,CA,Restaurant,45000,200000,2023-02-28\nChicago,IL,Cafe,30000,150000,2023-03-15\nHouston,TX,Restaurant,,120000,2023-03-20\nPhiladelphia,PA,Cafe,28000,130000,2023-04-10\nPhoenix,AZ,Restaurant,35000,,2023-04-25\nSan Antonio,TX,Cafe,40000,140000,2023-05-05\nSan Diego,CA,Cafe,27000,125000,2023-06-01\nDallas,TX,Restaurant,31000,110000,2023-06-15\nSan Jose,CA,Cafe,29000,115000,2023-07-10\nAustin,TX,Restaurant,33000,,2023-07-20\nJacksonville,FL,Cafe,26000,105000,2023-08-05\nFort Worth,TX,Restaurant,30000,135000,2023-08-15\nColumbus,OH,Cafe,28000,120000,2023-09-01"}
{"purpose": "Standardize city and energy provider names and fix inconsistent date and numeric formats.", "raw_table": "City,State,EnergyProvider,PricePerKwh,LoanAmount,ContractDate\nNew_york,NY,GreenEnergy,0.12,10000,2021-13-01\nlos-angeles,CA,SunPower,0.150,8500,01/15/2021\nChicago,IL,green energy,0.11,9500,2021/02/20\nhouston,tx,Solar-Gen,0.14,,2021-03-10\nPhoenix,AZ,SunPower,0.13,9000,2021-04-31\nPhiladelphia,PA,GreenEnergy,0.12,10500,2021-05-15\nsan antonio,TX,solar gen,0.135,8700,15/06/2021\nSan Diego,ca,SunPower,0.14,8900,2021/07/10\nDallas,TX,GreenEnergy,,9200,2021-08-20\nSan Jose,CA,Sun power,0.13,8800,2021-09-15\nAustin,tx,GreenEnergy,0.11,9100,2021-10-05\nJacksonville,FL,Solar-Gen,0.12,8900,2021-11-25\nFort Worth,tx,SunPower,0.14,9300,\nColumbus,OH,green_energy,0.12,8700,2021-12-10", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names and capitalize properly", "columnName": "City", "expression": "value.replace('_',' ').replace('-',' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize EnergyProvider names with consistent capitalization and no spaces or hyphens", "columnName": "EnergyProvider", "expression": "value.toLowercase().replace(/[-_ ]+/,'').replace('greenenergy','GreenEnergy').replace('solar gen','SolarGen').replace('green energy','GreenEnergy').replace('green_energy','GreenEnergy').replace('sunpower','SunPower').replace('sun power','SunPower')"}, {"op": "core/mass-edit", "description": "Fix misspelled State abbreviations to uppercase two-letter codes", "columnName": "State", "edits": [{"from": ["tx"], "to": "TX"}, {"from": ["ca"], "to": "CA"}]}, {"op": "core/date-parse", "description": "Parse ContractDate to ISO format where possible", "columnName": "ContractDate", "expression": "value.parseDate()"}, {"op": "core/text-transform", "description": "Fix invalid dates by removing invalid day/month combinations", "columnName": "ContractDate", "expression": "if(value==null, '', value.toString()).replace(/2021-13-01/, '2021-01-13').replace(/2021-04-31/, '2021-04-30')"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Standardize PricePerKwh to two decimals", "columnName": "PricePerKwh", "expression": "if(value == null || value == '', '', Number(value).toFixed(3).replace(/0+$/, ''))"}, {"op": "core/mass-edit", "description": "Fill missing PricePerKwh with average value", "columnName": "PricePerKwh", "edits": [{"from": [""], "to": "0.125"}]}, {"op": "core/mass-edit", "description": "Fill missing ContractDate with last available date", "columnName": "ContractDate", "edits": [{"from": [""], "to": "2021-11-25"}]}], "clean_table": "City,State,EnergyProvider,PricePerKwh,LoanAmount,ContractDate\nNew York,NY,GreenEnergy,0.12,10000,2021-01-13\nLos Angeles,CA,SunPower,0.150,8500,2021-01-15\nChicago,IL,GreenEnergy,0.11,9500,2021-02-20\nHouston,TX,SolarGen,0.140,9500,2021-03-10\nPhoenix,AZ,SunPower,0.13,9000,2021-04-30\nPhiladelphia,PA,GreenEnergy,0.12,10500,2021-05-15\nSan Antonio,TX,SolarGen,0.135,8700,2021-06-15\nSan Diego,CA,SunPower,0.14,8900,2021-07-10\nDallas,TX,GreenEnergy,0.125,9200,2021-08-20\nSan Jose,CA,SunPower,0.13,8800,2021-09-15\nAustin,TX,GreenEnergy,0.11,9100,2021-10-05\nJacksonville,FL,SolarGen,0.12,8900,2021-11-25\nFort Worth,TX,SunPower,0.14,9300,2021-11-25\nColumbus,OH,GreenEnergy,0.12,8700,2021-12-10"}
{"purpose": "Standardize energy provider names and correct inconsistent date formats in transaction records.", "raw_table": "City,State,Provider,PricePerKWh,LoanAmount,TransactionDate\nSpringfield,IL,Green-Energy,0.12,15000,2023/04/15\nshelbyville,il,green_energy,12cents,12000,15-04-2023\nCapital City,IL,Grean Energy,0.11,13000,April 16 2023\nOgdenville,Il,Green-Energy,0.13,missing,2023.04.17\nNorth Haverbrook,IL,greenenergy,0.14,16000,17/04/2023\nspringfield,IL,Green-Energy,0.12,15000,2023-4-18\nShelbyville,IL,Green Energy,0.12,14000,2023-04-19\nCapital City,IL,,0.11,12500,04/20/2023\nOgdenville,IL,Green-Energy,0.13,13500,2023/04/21\nNorth haverbrook,IL,green-energy,0.14,16000,2023/04/22\nSpringfield,IL,green_energy,,15000,April 23, 2023\nShelbyville,IL,Green-Energy,0.12,missing,2023-04-24", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize Provider names by removing underscores and hyphens and converting to title case", "columnName": "Provider", "expression": "value.toLowercase().replaceAll('_', ' ').replaceAll('-', ' ').replace(/ +/g, ' ').trim().split(' ').map(w, w.substring(0,1).toUppercase() + w.substring(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Correct common misspelling of Provider", "columnName": "Provider", "edits": [{"from": ["Grean Energy"], "to": "Green Energy"}]}, {"op": "core/mass-edit", "description": "Replace missing LoanAmount and PricePerKWh placeholders with blank for parsing", "columnName": "LoanAmount", "edits": [{"from": ["missing"], "to": ""}]}, {"op": "core/mass-edit", "description": "Replace PricePerKWh '12cents' with numeric 0.12", "columnName": "PricePerKWh", "edits": [{"from": ["12cents"], "to": "0.12"}]}, {"op": "core/text-transform", "description": "Convert PricePerKWh to numeric (force decimal)", "columnName": "PricePerKWh", "expression": "value ? Number(value) : null"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number", "columnName": "LoanAmount", "expression": "value ? Number(value) : null"}, {"op": "core/text-transform", "description": "Normalize TransactionDate to yyyy-MM-dd", "columnName": "TransactionDate", "expression": "value.trim().replace(/,/g,'')"}, {"op": "core/date-parse", "description": "Parse dates in various formats", "columnName": "TransactionDate", "spec": {"mode": "lenient"}}, {"op": "core/text-transform", "description": "Format TransactionDate uniformly", "columnName": "TransactionDate", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/mass-edit", "description": "Standardize City capitalization", "columnName": "City", "edits": [{"from": ["shelbyville"], "to": "Shelbyville"}, {"from": ["springfield"], "to": "Springfield"}, {"from": ["North haverbrook"], "to": "North Haverbrook"}]}, {"op": "core/text-transform", "description": "Standardize State code to uppercase", "columnName": "State", "expression": "value.toUppercase()"}], "clean_table": "City,State,Provider,PricePerKWh,LoanAmount,TransactionDate\nSpringfield,IL,Green Energy,0.12,15000,2023-04-15\nShelbyville,IL,Green Energy,0.12,12000,2023-04-15\nCapital City,IL,Green Energy,0.11,13000,2023-04-16\nOgdenville,IL,Green Energy,0.13,,2023-04-17\nNorth Haverbrook,IL,Green Energy,0.14,16000,2023-04-17\nSpringfield,IL,Green Energy,0.12,15000,2023-04-18\nShelbyville,IL,Green Energy,0.12,14000,2023-04-19\nCapital City,IL,,0.11,12500,2023-04-20\nOgdenville,IL,Green Energy,0.13,13500,2023-04-21\nNorth Haverbrook,IL,Green Energy,0.14,16000,2023-04-22\nSpringfield,IL,Green Energy,,15000,2023-04-23\nShelbyville,IL,Green Energy,0.12,,2023-04-24"}
{"purpose": "Clean inconsistent city and business type names, standardize date format, and fix numeric fields for loan and price.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,Tele-Com,1200,10000,03/15/21\nlos angeles,CA,telecom,900,8500,15-04-2021\nCHICAGO,IL,TEL-COM,1100, 9000 ,2021/04/20\nhouston,TX,Tele_com,1000,,2021-05-01\nphoenix,Az,telecom,950,8750,05.15.2021\nphiladelphia,PA,tele-com,NaN,9200,2021/05/20\nsan antonio,TX,tele_com,1050,9100,05/25/21\nsan_diego,CA,tele-com,1150,9300,2021/06/01\ndallas,TX,telecom,1000,9000,6/3/2021\nsan jose,CA,TELCOM,980,8900,2021-06-05\nAUSTIN,TX,tele-com,970,8850,06-10-2021\njacksonville,fl,telecom,,8700,2021/06/15\nfort-worth,TX,tele-com,1020,8950,2021.06.20\ncolumbus,OH,telecom,990,8800,06/25/2021", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with space in City", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State to uppercase two-letter codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType to 'Telecom'", "columnName": "BusinessType", "expression": "if(value.toLowercase().match(/tele[\\-_ ]?com/), 'Telecom', value.toTitlecase())"}, {"op": "core/mass-edit", "columnName": "Price", "edits": [{"from": [""], "to": "0"}, {"from": ["NaN"], "to": "0"}]}, {"op": "core/text-transform", "description": "Trim spaces and convert Price to number", "columnName": "Price", "expression": "value.trim().replace(/[^0-9.]/g, '').length > 0 ? Number(value.trim().replace(/[^0-9.]/g, '')) : 0"}, {"op": "core/text-transform", "description": "Trim spaces and convert LoanAmount to number, replace missing with 0", "columnName": "LoanAmount", "expression": "value == null || value.trim() == '' ? 0 : Number(value.trim())"}, {"op": "core/date-parse", "description": "Parse Date to yyyy-MM-dd", "columnName": "Date", "format": "MM/dd/yyyy", "guessCellValue": true, "mode": "lenient"}, {"op": "core/text-transform", "description": "Format all dates to yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom,1200,10000,2021-03-15\nLos Angeles,CA,Telecom,900,8500,2021-04-15\nChicago,IL,Telecom,1100,9000,2021-04-20\nHouston,TX,Telecom,1000,0,2021-05-01\nPhoenix,AZ,Telecom,950,8750,2021-05-15\nPhiladelphia,PA,Telecom,0,9200,2021-05-20\nSan Antonio,TX,Telecom,1050,9100,2021-05-25\nSan Diego,CA,Telecom,1150,9300,2021-06-01\nDallas,TX,Telecom,1000,9000,2021-06-03\nSan Jose,CA,Telecom,980,8900,2021-06-05\nAustin,TX,Telecom,970,8850,2021-06-10\nJacksonville,FL,Telecom,0,8700,2021-06-15\nFort Worth,TX,Telecom,1020,8950,2021-06-20\nColumbus,OH,Telecom,990,8800,2021-06-25"}
{"purpose": "Standardize city names, correct business types, and normalize price and date formats in energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew_york,NY,solar-installation,12000,10000,2023/01/15\nLos-Angeles,ca,Wind Farm,15000,13000,15-02-2023\nchicago,IL,solar Install,NaN,9000,2023-03-10\nhouston,TX,windfarm,14000,missing,2023.04.12\nphoenix,Az,solar-installation,11000,8500,04/20/2023\nphiladelphia,pa,solar_install,11500,9200,20230425\nsan antonio,TX,Wind_Farm,13500,12000,2023-05-05\nsan-diego,CA,Solar installation,missing,11000,05-06-2023\ndallas,tx,wind farm,12500,10500,2023/07/15\nsan jose,ca,SolarInstall,13000,11500,2023-08-01\nAustin,TX,solar-installation,11200,8800,2023/08/20\nJacksonville,FL,WindFarm,14000,13000,08/25/2023\nfort worth,TX,solar_install,10800,8000,2023-09-10\nColumbus,OH,wind_farm,NaN,9500,2023.09.15\nSan Francisco,CA,SOLAR INSTALLATION,12500,11500,09-20-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize first letter of each word in City", "columnName": "City", "expression": "value.toLowercase().split(/[_\\- ]+/).map(s, s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize State abbreviations to uppercase", "columnName": "State", "edits": [{"from": ["ca", "Az", "pa", "tx", "fl", "oh"], "to": "CA"}, {"from": ["Az"], "to": "AZ"}, {"from": ["pa"], "to": "PA"}, {"from": ["tx"], "to": "TX"}, {"from": ["fl"], "to": "FL"}, {"from": ["oh"], "to": "OH"}]}, {"op": "core/mass-edit", "description": "Normalize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["solar-installation", "Solar installation", "solar_install", "SolarInstall", "SOLAR INSTALLATION", "solar Install"], "to": "Solar Installation"}, {"from": ["windfarm", "Wind Farm", "Wind_Farm", "wind_farm", "WindFarm", "wind farm"], "to": "Wind Farm"}]}, {"op": "core/text-transform", "description": "Transform Price to number and fill missing with 0", "columnName": "Price", "expression": "if(isNull(value) || value.toLowercase() == 'missing' || value.toLowercase() == 'nan', 0, value.toNumber())"}, {"op": "core/text-transform", "description": "Transform LoanAmount to number and fill missing with 0", "columnName": "LoanAmount", "expression": "if(isNull(value) || value.toLowercase() == 'missing' || value.toLowercase() == 'nan', 0, value.toNumber())"}, {"op": "core/text-transform", "description": "Standardize Date to yyyy-MM-dd", "columnName": "Date", "expression": "value.match(/\\d{4}[-\\/.]\\d{2}[-\\/.]\\d{2}/) ? value.replace(/[\\/\\.]/g, '-').slice(0,10) : (value.match(/\\d{2}[-\\/]\\d{2}[-\\/]\\d{4}/) ? value.split(/[-\\/]/).reverse().join('-') : value)"}, {"op": "core/date-parse", "description": "Parse dates with multiple formats", "columnName": "Date", "expression": "value", "dateFormat": "yyyy-MM-dd"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,12000,10000,2023-01-15\nLos Angeles,CA,Wind Farm,15000,13000,2023-02-15\nChicago,IL,Solar Installation,0,9000,2023-03-10\nHouston,TX,Wind Farm,14000,0,2023-04-12\nPhoenix,AZ,Solar Installation,11000,8500,2023-04-20\nPhiladelphia,PA,Solar Installation,11500,9200,2023-04-25\nSan Antonio,TX,Wind Farm,13500,12000,2023-05-05\nSan Diego,CA,Solar Installation,0,11000,2023-05-06\nDallas,TX,Wind Farm,12500,10500,2023-07-15\nSan Jose,CA,Solar Installation,13000,11500,2023-08-01\nAustin,TX,Solar Installation,11200,8800,2023-08-20\nJacksonville,FL,Wind Farm,14000,13000,2023-08-25\nFort Worth,TX,Solar Installation,10800,8000,2023-09-10\nColumbus,OH,Wind Farm,0,9500,2023-09-15\nSan Francisco,CA,Solar Installation,12500,11500,2023-09-20"}
{"purpose": "Standardize and clean inconsistent city names, business types, and date formats in government loan application records.", "raw_table": "ApplicantID,City,State,BusinessType,LoanAmount,ApplicationDate\n1,New_york,ny,restauraNt,250000,$10,000,01-15-2023\n2,los-angeles,CA,RETAIL,150000,15000,2023/02/20\n3,Chicago,il,ManufacTuring,,12000.50,03.12.2023\n4,HousTon,tx,retail,75000,8500,April 5 2023\n5,Phoenix,Az,restaurant,100000,ten thousand,2023-05-10\n6,philadelphia,PA,manufacturing,180000,18000,15/06/2023\n7,San-antonio,TX,Retail,95000,9500,2023.07.01\n8,San diego,CA,Restaurant,125000,12500,07-25-23\n9,Dallas,TX,manufacturing,200000,20000,08/15/2023\n10,San_jose,CA,restAurant,110000,eleven thousand,2023/09/05\n11,Austin,Tx,RETAIL,85000,8500,September 18, 2023\n12,Jacksonville,fl,Manufacturing,90000,,2023-10-10\n13,Fort-worth,TX,retail,70000,7000,10-25-2023\n14,Columbus,OH,resturant,130000,13000,11/30/2023\n15,Charlotte,NC,Manufacturing,160000,16000,12.15.2023", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["los-angeles"], "to": "Los Angeles"}, {"from": ["HousTon"], "to": "Houston"}, {"from": ["San-antonio"], "to": "San Antonio"}, {"from": ["San_jose"], "to": "San Jose"}, {"from": ["Fort-worth"], "to": "Fort Worth"}, {"from": ["San diego"], "to": "San Diego"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()", "onError": "keepOriginal"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()", "onError": "keepOriginal"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["restauraNt", "restaurant", "restAurant", "resturant"], "to": "Restaurant"}, {"from": ["RETAIL", "retail"], "to": "Retail"}, {"from": ["ManufacTuring", "manufacturing", "Manufacturing"], "to": "Manufacturing"}]}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value.toString().replace(/[^0-9\\.]/g, '').trim()", "onError": "keepOriginal"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value == '' || value == 'null' ? null : Number(value)", "onError": "keepOriginal"}, {"op": "core/text-transform", "columnName": "ApplicationDate", "expression": "value.replace(/^(\\$|ten\\s*thousand|eleven\\s*thousand)$/, v => v == 'ten thousand' ? '10000' : (v == 'eleven thousand' ? '11000' : v))", "onError": "keepOriginal"}, {"op": "core/date-parse", "columnName": "ApplicationDate", "dateFormat": "yyyy-MM-dd'T'HH:mm:ss'Z'", "onError": "keepOriginal", "guessCellType": false, "mode": "lenient", "customDateFormat": true, "dateFormatString": "MM-dd-yyyy"}, {"op": "core/text-transform", "columnName": "ApplicationDate", "expression": "value.match(/^\\d{4}-\\d{2}-\\d{2}/) ? value.substring(0,10) : (\n    value.match(/^\\d{2}\\/\\d{2}\\/\\d{4}/) ? value.split('/').reverse().join('-') :\n    value.match(/^\\d{2}\\.\\d{2}\\.\\d{4}/) ? value.split('.').reverse().join('-') :\n    value.match(/^\\d{2}-\\d{2}-\\d{4}/) ? value.split('-').reverse().join('-') : value\n)", "onError": "keepOriginal"}, {"op": "core/text-transform", "columnName": "ApplicationDate", "expression": "value.replace(/\\.(\\d{2})\\.(\\d{4})$/, '$2-$1-01')", "onError": "keepOriginal"}], "clean_table": "ApplicantID,City,State,BusinessType,LoanAmount,ApplicationDate\n1,New York,NY,Restaurant,250000,2023-01-15\n2,Los Angeles,CA,Retail,150000,2023-02-20\n3,Chicago,IL,Manufacturing,null,2023-03-12\n4,Houston,TX,Retail,75000,2023-04-05\n5,Phoenix,AZ,Restaurant,100000,2023-05-10\n6,Philadelphia,PA,Manufacturing,18000.5,2023-06-15\n7,San Antonio,TX,Retail,95000,2023-07-01\n8,San Diego,CA,Restaurant,125000,2023-07-25\n9,Dallas,TX,Manufacturing,200000,2023-08-15\n10,San Jose,CA,Restaurant,11000,2023-09-05\n11,Austin,TX,Retail,85000,2023-09-18\n12,Jacksonville,FL,Manufacturing,90000,2023-10-10\n13,Fort Worth,TX,Retail,70000,2023-10-25\n14,Columbus,OH,Restaurant,130000,2023-11-30\n15,Charlotte,NC,Manufacturing,160000,2023-12-15"}
{"purpose": "Standardize city names, business types, and date formats; correct numeric fields and fill missing values in government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,retail,10000,50000,01/15/2023\nlos-angeles,CA,Restauraunt,15000,,2023-02-30\nChicago,IL,Health_care,twenty thousand,30000,03/10/2023\nhouston,TX,retail,12000,45000,2023/04/05\nPhoenix,AZ,,13000,40000,04-25-2023\nPhiladelphia,PA,Manufacturing,14000,35000,2023-05-15\nSan Antonio,TX,Retail,11000,not available,06/20/2023\nsan-diego,CA,Manufacturing,9000,25000,2023/13/01\nDallas,texas,healthcare,8000,20000,07/01/2023\nSan Jose,CA,restaurant,10000,30000,08/15/2023\nAustin,TX,Retail,missing,15000,09/05/2023\nJacksonville,FL,Manufacturing,11000,5000,2023-10-10\nFort Worth,TX,RETAIL,10500,27000,11/11/2023\nColumbus,OH,health-care,9500,22000,12/01/2023\nCharlotte,NC,Restaurant,9700,23000,2023-12-15", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in City", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State abbreviations to uppercase and fix 'texas' to 'TX'", "columnName": "State", "expression": "value.toUppercase() == 'TEXAS' ? 'TX' : value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix common BusinessType misspellings and variants", "columnName": "BusinessType", "edits": [{"from": ["Restauraunt", "restaurant", "Restaurant"], "to": "Restaurant"}, {"from": ["retail", "Retail", "RETAIL"], "to": "Retail"}, {"from": ["Health_care", "healthcare", "health-care"], "to": "Healthcare"}, {"from": ["Manufacturing"], "to": "Manufacturing"}]}, {"op": "core/text-transform", "description": "Parse Price to numeric; replace 'missing' and textual numbers with null or numeric", "columnName": "Price", "expression": "value.toLowercase() == 'missing' ? null : (value.toLowercase().match('twenty thousand') ? 20000 : value.toNumber())"}, {"op": "core/text-transform", "description": "Replace 'not available' and blanks in LoanAmount with null", "columnName": "LoanAmount", "expression": "value.toLowercase() == 'not available' || value == '' ? null : value.toNumber()"}, {"op": "core/date-parse", "description": "Parse Date column with multiple date formats", "columnName": "Date", "expression": "value.toDate()", "projectName": "Government Loan Records", "onError": "set-to-null"}, {"op": "core/mass-edit", "description": "Fix invalid dates (e.g. Feb 30) by setting to null", "columnName": "Date", "edits": [{"from": ["2023-02-30T00:00:00Z"], "to": null}, {"from": ["2023-13-01T00:00:00Z"], "to": null}]}, {"op": "core/fill-down", "description": "Fill down missing BusinessType values", "columnName": "BusinessType"}, {"op": "core/text-transform", "description": "Format Date column uniformly as yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,10000,50000,2023-01-15\nLos Angeles,CA,Restaurant,15000,,\nChicago,IL,Healthcare,20000,30000,2023-03-10\nHouston,TX,Retail,12000,45000,2023-04-05\nPhoenix,AZ,Manufacturing,13000,40000,2023-04-25\nPhiladelphia,PA,Manufacturing,14000,35000,2023-05-15\nSan Antonio,TX,Retail,11000,,2023-06-20\nSan Diego,CA,Manufacturing,9000,25000,\nDallas,TX,Healthcare,8000,20000,2023-07-01\nSan Jose,CA,Restaurant,10000,30000,2023-08-15\nAustin,TX,Retail,,15000,2023-09-05\nJacksonville,FL,Manufacturing,11000,5000,2023-10-10\nFort Worth,TX,Retail,10500,27000,2023-11-11\nColumbus,OH,Healthcare,9500,22000,2023-12-01\nCharlotte,NC,Restaurant,9700,23000,2023-12-15"}
{"purpose": "Standardize movie genre names and release dates for an entertainment dataset.", "raw_table": "MovieTitle,Genre,ReleaseDate,BoxOffice,Rating\nThe_Great_adventure,Action,2020/12/15,1000000,8.2\nLove_in_Paris,romance,15-02-2019,850000,7.5\nZombie-Nation,Horror,2018.10.31,620000,6.9\nStar Quest,Sci-Fi,March 5 2021,1300000,8.7\nHidden truths,Documentary,,400000,7.0\nLaugh_out_Loud,comedy,2019/07/20,770000,7.8\nSunshine_Day,drama,2017-08-01,500000,7.1\nNightmare___Street,Horror,2018/13/01,680000,6.5\nForever_and_After,Romance,2016-02-30,900000,7.9\nAlien_Worlds,SCI-FI,2021/04/25,1500000,8.4\nComedy_Carnival,Comedy,12-12-2019,730000,7.6\nDeep_Secrets,documentary,2020-11-10,410000,7.2\nCity_Lights,Drama,2017-08-01,520000,7.3\nFinal_Battle,Action,2020-15-10,1100000,8.0", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "MovieTitle", "expression": "value.replace(/[_-]+/g, ' ').toTitlecase()", "description": "Replace underscores and hyphens with spaces and capitalize words in MovieTitle"}, {"op": "core/mass-edit", "columnName": "Genre", "edits": [{"from": ["romance", "Romance"], "to": "Romance"}, {"from": ["sci-fi", "Sci-Fi", "SCI-FI"], "to": "Sci-Fi"}, {"from": ["comedy", "Comedy"], "to": "Comedy"}, {"from": ["documentary", "Documentary"], "to": "Documentary"}, {"from": ["horror", "Horror"], "to": "Horror"}, {"from": ["drama", "Drama"], "to": "Drama"}, {"from": ["action", "Action"], "to": "Action"}], "description": "Normalize genre capitalization"}, {"op": "core/text-transform", "columnName": "ReleaseDate", "expression": "if(value == null || value.trim() == '') null else \n  if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/)) value.replace(/\\//g, '-')\n  else if(value.match(/\\d{2}-\\d{2}-\\d{4}/)) {\n    var parts = value.split('-'); parts[2] + '-' + parts[1] + '-' + parts[0]\n  } else if(value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/)) value.replace(/\\./g, '-')\n  else if(value.match(/[A-Za-z]+ \\d{1,2} \\d{4}/)) {\n    var dt = new Date(value);\n    dt.getFullYear() + '-' + ('0' + (dt.getMonth()+1)).slice(-2) + '-' + ('0' + dt.getDate()).slice(-2)\n  } else value", "description": "Convert ReleaseDate to ISO format yyyy-MM-dd"}, {"op": "core/mass-edit", "columnName": "ReleaseDate", "edits": [{"from": ["2018-13-01"], "to": "2018-12-01"}, {"from": ["2016-02-30"], "to": "2016-02-29"}, {"from": ["2020-15-10"], "to": "2020-10-15"}], "description": "Fix invalid dates"}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "value.toNumber()", "description": "Convert BoxOffice to numeric"}, {"op": "core/text-transform", "columnName": "Rating", "expression": "value.toNumber()", "description": "Convert Rating to numeric"}, {"op": "core/fill-down", "columnName": "ReleaseDate", "description": "Fill down missing ReleaseDate values"}], "clean_table": "MovieTitle,Genre,ReleaseDate,BoxOffice,Rating\nThe Great Adventure,Action,2020-12-15,1000000,8.2\nLove In Paris,Romance,2019-02-15,850000,7.5\nZombie Nation,Horror,2018-10-31,620000,6.9\nStar Quest,Sci-Fi,2021-03-05,1300000,8.7\nHidden Truths,Documentary,2021-03-05,400000,7.0\nLaugh Out Loud,Comedy,2019-07-20,770000,7.8\nSunshine Day,Drama,2017-08-01,500000,7.1\nNightmare Street,Horror,2018-12-01,680000,6.5\nForever And After,Romance,2016-02-29,900000,7.9\nAlien Worlds,Sci-Fi,2021-04-25,1500000,8.4\nComedy Carnival,Comedy,2019-12-12,730000,7.6\nDeep Secrets,Documentary,2020-11-10,410000,7.2\nCity Lights,Drama,2017-08-01,520000,7.3\nFinal Battle,Action,2020-10-15,1100000,8.0"}
{"purpose": "Standardize and clean customer subscription data with inconsistent city names, business types, and numeric formats for accurate telecom billing analysis.", "raw_table": "City,State,BusinessType,Price,LoanAmount,SubscriptionDate\nnew york,NY,Telecom,49.99,10000,2023-01-15\nLos_Angeles,CA,tele-com, 59.99 ,15000,01/20/2023\nCHicago,IL,Telecom,49,10000,2023/01/25\nhouston,TX,,55.00,12000,2023-02-01\nPhoenix,AZ,Telecom,,13000,2023-2-5\nphiladelphia,PA,telecom,60.00,abc,2023-02-10\nSan-Antonio,TX,tele-com,65.00,14000,2023-02-15\nSan diego,CA,Telecom,55.50,13500,15-02-2023\nDallas,TX,Telecom,,12000,2023-02-20\nsan jose,CA,Telecom,58.00,14500,2023-02-25\nAustin,TX,TeleCom,62.00,12500,02/28/2023\nJacksonville,FL,telecom,59.00,,2023-03-01\nfort worth,TX,Telecom,57.00,12500,2023/03/05\nColumbus,OH,tele-com,60.00,13000,2023-03-10", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize capitalization of City names", "columnName": "City", "expression": "value.toTitlecase().replace('_', ' ').replace('-', ' ')"}, {"op": "core/mass-edit", "description": "Standardize BusinessType entries", "columnName": "BusinessType", "edits": [{"from": ["tele-com", "telecom", "TeleCom", "Telecom"], "to": "Telecom"}]}, {"op": "core/fill-down", "description": "Fill down missing BusinessType values", "columnName": "BusinessType"}, {"op": "core/text-transform", "description": "Trim whitespace from Price and convert to number", "columnName": "Price", "expression": "if(value==null || value.trim()==='', null, Number(value.trim()))"}, {"op": "core/text-transform", "description": "Clean LoanAmount to numbers, replace non-numeric with null", "columnName": "LoanAmount", "expression": "if(value.toString().match(/^[0-9]+$/), Number(value), null)"}, {"op": "core/date-parse", "description": "Parse SubscriptionDate to yyyy-MM-dd format", "columnName": "SubscriptionDate", "format": "yyyy-MM-dd"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,SubscriptionDate\nNew York,NY,Telecom,49.99,10000,2023-01-15\nLos Angeles,CA,Telecom,59.99,15000,2023-01-20\nChicago,IL,Telecom,49,10000,2023-01-25\nHouston,TX,Telecom,55,12000,2023-02-01\nPhoenix,AZ,Telecom,,13000,2023-02-05\nPhiladelphia,PA,Telecom,60,0,2023-02-10\nSan Antonio,TX,Telecom,65,14000,2023-02-15\nSan Diego,CA,Telecom,55.5,13500,2023-02-15\nDallas,TX,Telecom,,12000,2023-02-20\nSan Jose,CA,Telecom,58,14500,2023-02-25\nAustin,TX,Telecom,62,12500,2023-02-28\nJacksonville,FL,Telecom,59,,2023-03-01\nFort Worth,TX,Telecom,57,12500,2023-03-05\nColumbus,OH,Telecom,60,13000,2023-03-10"}
{"purpose": "Clean and standardize farm produce sales data including city names, product types, prices, loan amounts, and dates.", "raw_table": "City,State,ProduceType,Price,LoanAmount,SaleDate\nGreen-ville,TX,Tomat0,1.2,1000,12/01/2023\ngreenville,TX,Tomato,1.20,1,000,2023-01-12\nSpring_field,CA,Carrot,0.8,500,2023/02/15\nSpringfield,CA,Carrot,0.80,500,15-02-2023\nOak-Town,NY,Cabbage,1.5,750,03-10-2023\nOak Town,NY,Kabage,1.50,,2023.10.03\nMapleCity,WA,Potato,0.5,300,07/20/2023\nmaplecity,WA,Potato,0.50,300,20-07-2023\nPine_hill,OR,,0.9,400,2023/08/05\nPinehill,OR,Spinach,0.85,400,08-05-2023\nRiverdale,IL,Onion,1.1,600,2023-09-11\nriverdale,IL,Onion,1.10,600,11/09/2023\nHill-valley,CO,Lettuce,1.3,450,10-15-2023\nHill Valley,CO,Lettuse,1.30,450,2023.10.15\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.replace(/[-_]/g, ' ').toTitlecase()"}, {"op": "core/mass-edit", "description": "Correct misspelled ProduceType entries", "columnName": "ProduceType", "edits": [{"from": ["Tomat0"], "to": "Tomato"}, {"from": ["Kabage"], "to": "Cabbage"}, {"from": ["Lettuse"], "to": "Lettuce"}, {"from": [null, ""], "to": "Spinach"}]}, {"op": "core/text-transform", "description": "Remove commas from LoanAmount and convert to number", "columnName": "LoanAmount", "expression": "value.replace(/,/g, '').trim()"}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numbers", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number", "columnName": "LoanAmount", "expression": "isNaN(value.toNumber()) ? null : value.toNumber()"}, {"op": "core/date-parse", "description": "Parse SaleDate into ISO format yyyy-MM-dd", "columnName": "SaleDate", "expression": "value.toDate()", "onError": "set-to-blank"}, {"op": "core/text-transform", "description": "Format SaleDate as yyyy-MM-dd string", "columnName": "SaleDate", "expression": "value.toDate().toISOString().slice(0,10)"}], "clean_table": "City,State,ProduceType,Price,LoanAmount,SaleDate\nGreenville,TX,Tomato,1.2,1000,2023-12-01\nGreenville,TX,Tomato,1.2,1000,2023-01-12\nSpringfield,CA,Carrot,0.8,500,2023-02-15\nSpringfield,CA,Carrot,0.8,500,2023-02-15\nOak Town,NY,Cabbage,1.5,750,2023-03-10\nOak Town,NY,Cabbage,1.5,null,2023-10-03\nMaplecity,WA,Potato,0.5,300,2023-07-20\nMaplecity,WA,Potato,0.5,300,2023-07-20\nPinehill,OR,Spinach,0.9,400,2023-08-05\nPinehill,OR,Spinach,0.85,400,2023-08-05\nRiverdale,IL,Onion,1.1,600,2023-09-11\nRiverdale,IL,Onion,1.1,600,2023-09-11\nHill Valley,CO,Lettuce,1.3,450,2023-10-15\nHill Valley,CO,Lettuce,1.3,450,2023-10-15\n"}
{"purpose": "Standardize city and business type names, fix date formats, and clean numeric fields in energy loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew-york,Ny,solar_Installer,12000,50000,2022/03/15\nlos angeles,CA,Wind-Turbine,15000,45000,15-04-2022\nCHICAGO,il,Solar installer,13000,,2022-05-01\nhouston,TX,,14000,60000,2022.06.10\nphoenix,az,wind_turbine,12500,55000,2022/07/20\nphiladelphia,Pennsylvnia,Solar_Installer,13500,47000,2022-08-05\nsan antonio,TX,solar-installr,11000,49000,2022/09/15\nSan Diego,CA,Wind turbine,NaN,53000,2022-10-01\nDALLAS,tx,SOLAR_INSTALLER,14000,51000,10/11/2022\nsan_jose,CA,wind-turbine,12800,52000,2022-11-20\nAustin,tx,Solar Installer,NaN,49500,2022/12/25\njacksonville,fl,Wind_Turbine,13500,NaN,2023-01-15\nfort worth,TX,Solar Installr,13000,48000,2023-02-10\ncolumbus,OH,solar_installer,12500,46000,2023/03/05\ncharlotte,NC,wind_turbine,14000,50000,03-04-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize City names properly and remove underscores/hyphens", "columnName": "City", "expression": "value.replace(/[-_]/,' ').toLowercase().split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize State abbreviations to uppercase two-letter codes", "columnName": "State", "edits": [{"from": ["ny", "Ny", "NY"], "to": "NY"}, {"from": ["ca", "CA", "Ca"], "to": "CA"}, {"from": ["il", "IL", "Il"], "to": "IL"}, {"from": ["tx", "TX", "Tx"], "to": "TX"}, {"from": ["az", "Az", "AZ"], "to": "AZ"}, {"from": ["pennsylvnia", "Pennsylvnia"], "to": "PA"}, {"from": ["fl"], "to": "FL"}, {"from": ["oh"], "to": "OH"}, {"from": ["nc"], "to": "NC"}]}, {"op": "core/mass-edit", "description": "Normalize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["solar_installer", "Solar_Installer", "solar_Installer", "SOLAR_INSTALLER", "Solar Installer", "Solar Installr", "solar_installr", "solar-installr"], "to": "Solar Installer"}, {"from": ["wind_turbine", "Wind_Turbine", "Wind turbine", "Wind-Turbine", "wind-turbine"], "to": "Wind Turbine"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Fix LoanDate formats to yyyy-MM-dd", "columnName": "LoanDate", "expression": "if(value==null || value=='' || value=='NaN', null, \n  if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/), value.replace('/', '-').replace('/', '-'),\n    if(value.match(/\\d{2}-\\d{2}-\\d{4}/), value.split('-')[2] + '-' + value.split('-')[1] + '-' + value.split('-')[0],\n      if(value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/), value.replace('.', '-').replace('.', '-'),\n        if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/), value.split('/')[2] + '-' + value.split('/')[0] + '-' + value.split('/')[1],\n          value\n        )\n      )\n    )\n  )\n)"}, {"op": "core/mass-edit", "description": "Replace NaN and empty Price and LoanAmount with null", "columnName": "Price", "edits": [{"from": ["NaN", ""], "to": ""}]}, {"op": "core/mass-edit", "description": "Replace NaN and empty LoanAmount with null", "columnName": "LoanAmount", "edits": [{"from": ["NaN", ""], "to": ""}]}, {"op": "core/fill-down", "description": "Fill down missing BusinessType Unknown", "columnName": "BusinessType"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew York,NY,Solar Installer,12000,50000,2022-03-15\nLos Angeles,CA,Wind Turbine,15000,45000,2022-04-15\nChicago,IL,Solar Installer,13000,,2022-05-01\nHouston,TX,Unknown,14000,60000,2022-06-10\nPhoenix,AZ,Wind Turbine,12500,55000,2022-07-20\nPhiladelphia,PA,Solar Installer,13500,47000,2022-08-05\nSan Antonio,TX,Solar Installer,11000,49000,2022-09-15\nSan Diego,CA,Wind Turbine,,53000,2022-10-01\nDallas,TX,Solar Installer,14000,51000,2022-11-10\nSan Jose,CA,Wind Turbine,12800,52000,2022-11-20\nAustin,TX,Solar Installer,,49500,2022-12-25\nJacksonville,FL,Wind Turbine,13500,,2023-01-15\nFort Worth,TX,Solar Installer,13000,48000,2023-02-10\nColumbus,OH,Solar Installer,12500,46000,2023-03-05\nCharlotte,NC,Wind Turbine,14000,50000,2023-04-03"}
{"purpose": "Standardize city names, fix date formats, and normalize loan amount and price fields for energy business analysis.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar_Installer,12000,100000,01-15-2023\nlos-angeles,ca,Wind_Turbine,15000,85000,2023/02/20\nChicago,IL,solar installer,13500,,03-10-23\nhouston,TX,geothermal,11000,90000,2023-04-01\nPHOENIX,az,Wind_turbine,NaN,72000,04/15/2023\nPhiladelphia,PA,solar-Installer,12500,95000,May-05-2023\nSan Antonio,TX,geothermal,11700,93000,2023.06.10\nSan Diego,ca,wind turbine,14000,87000,07-25-2023\nDallas,tx,solar installer,13000,91000,2023/08/15\nsan_jose,CA,Geothermal,11500,89000,09-05-2023\nAustin,TX,solar_Installer,12800,92000,2023-10-01\nJacksonville,FL,wind-turbine,14200,86000,11/20/2023\nfort_worth,TX,geothermal,11300,91000,12-15-2023\nColumbus,OH,solar installer,12900,94000,2023-13-01\nCharlotte,NC,Wind_Turbine,13800,88000,13/30/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Clean City names: replace underscores and hyphens with spaces, trim, and capitalize each word", "columnName": "City", "expression": "value.replace('_',' ').replace('-',' ').trim().split(' ').map(s, s.toLowercase().capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Normalize State names to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType to consistent naming and capitalization", "columnName": "BusinessType", "expression": "value.toLowercase().replace('_',' ').replace('-',' ').trim().split(' ').map(s, s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Replace 'NaN' and empty strings in Price with empty to handle later", "columnName": "Price", "edits": [{"from": ["NaN", ""], "to": ""}]}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount with empty string", "columnName": "LoanAmount", "edits": [{"from": [""], "to": ""}]}, {"op": "core/text-transform", "description": "Parse and normalize Date formats to ISO yyyy-MM-dd", "columnName": "Date", "expression": "cells.Date.value.match(/\\d{4}[-\\/]\\d{2}[-\\/]\\d{2}/) ? value.replace(/\\//g, '-').replace(/\\./g,'-') : (value.match(/\\d{2}[-\\/]\\d{2}[-\\/]\\d{4}/) ? (value.split(/[-\\/]/).reverse().join('-')) : (value.match(/^[A-Za-z]{3,}-\\d{2}-\\d{4}$/) ? new Date(value).toISOString().substring(0,10) : (value.match(/^\\d{4}-\\d{2}-\\d{2}$/) ? value : '')))"}, {"op": "core/text-transform", "description": "Fix invalid dates by setting empty if date parsing failed", "columnName": "Date", "expression": "(/^(\\d{4})-(\\d{2})-(\\d{2})$/.test(value) && (parseInt(RegExp.$2) <= 12 && parseInt(RegExp.$3) <= 31)) ? value : ''"}, {"op": "core/text-transform", "description": "Convert Price to numeric with no decimals, empty to null", "columnName": "Price", "expression": "value.trim() == '' ? null : Number(value).round()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to numeric, empty to null", "columnName": "LoanAmount", "expression": "value.trim() == '' ? null : Number(value)"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installer,12000,100000,2023-01-15\nLos Angeles,CA,Wind Turbine,15000,85000,2023-02-20\nChicago,IL,Solar Installer,13500,,2023-03-10\nHouston,TX,Geothermal,11000,90000,2023-04-01\nPhoenix,AZ,Wind Turbine,,72000,2023-04-15\nPhiladelphia,PA,Solar Installer,12500,95000,2023-05-05\nSan Antonio,TX,Geothermal,11700,93000,2023-06-10\nSan Diego,CA,Wind Turbine,14000,87000,2023-07-25\nDallas,TX,Solar Installer,13000,91000,2023-08-15\nSan Jose,CA,Geothermal,11500,89000,2023-09-05\nAustin,TX,Solar Installer,12800,92000,2023-10-01\nJacksonville,FL,Wind Turbine,14200,86000,2023-11-20\nFort Worth,TX,Geothermal,11300,91000,2023-12-15\nColumbus,OH,Solar Installer,12900,94000,\nCharlotte,NC,Wind Turbine,13800,88000,"}
{"purpose": "Clean inconsistent city and state names, normalize business types, and standardize dates and financial figures in telecommunications loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew-york,ny,telecom_Corp,1200.50,50000,2023/01/15\nLos_Angeles,CA,Telecom-corp,1300,45000,15-02-2023\nchicago,IL,,1100.75,40000,2023-03-10\nHouston,Tx,Telecom_CORP,1250,NaN,2023/04/05\nphoenix,az,telecom-corp,NaN,38000,2023.05.20\nphiladelphia,PA,Telecom_Corp,1400,42000,2023/06/25\nSan Antonio,TX,Telecom_corp,1350,41000,2023-07-30\nsan-diego,ca,telecom-corp,1300,43000,08/15/2023\nDallas,Tx,telecom_corp,NaN,44000,2023-09-10\nSan Jose,CA,telecom-corp,1280,NaN,20231001\nAustin,TX,Telecom_Corp,1250,46000,2023-11-05\njacksonville,fl,telecom-corp,1200,39000,2023/12/10\nfort Worth,TX,Telecom_corp,1150,40000,2023-13-01\nColumbus,OH,telecom_corp,1210,41000,2023-10-15\ncharlotte,nc,telecom-corp,1190,43000,2023-11-20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names and replace hyphens/underscores with spaces", "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/g, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase state codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix known misspellings and inconsistent capitalizations in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["telecom_corp", "Telecom_corp", "telecom-corp", "Telecom-corP", "Telecom_CORP", "telecom_Corp", "Telecom-corp"], "to": "Telecom Corp"}, {"from": [null, ""], "to": "Telecom Corp"}]}, {"op": "core/text-transform", "description": "Standardize Price to numeric string with two decimals, replace NaN or missing with blank", "columnName": "Price", "expression": "isNonBlank(value) && value.toString().replace(/[^0-9.]/g,'') != '' ? Number(value).toFixed(2) : ''"}, {"op": "core/text-transform", "description": "Standardize LoanAmount to numeric string with no decimals, replace NaN or missing with blank", "columnName": "LoanAmount", "expression": "isNonBlank(value) && value.toString().replace(/[^0-9]/g,'') != '' ? Number(value).toFixed(0) : ''"}, {"op": "core/text-transform", "description": "Fix dates by replacing various separators with '-', fix wrong formats", "columnName": "Date", "expression": "value.replace(/[./]/g, '-').replace(/(\\d{2})-(\\d{2})-(\\d{4})/, '$3-$1-$2')"}, {"op": "core/date-parse", "description": "Parse dates into ISO format yyyy-MM-dd", "columnName": "Date", "format": "yyyy-MM-dd", "onError": "keep-original", "onNull": "keep-original"}, {"op": "core/mass-edit", "description": "Correct invalid date with month 13 to empty", "columnName": "Date", "edits": [{"from": ["2023-13-01"], "to": ""}]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom Corp,1200.50,50000,2023-01-15\nLos Angeles,CA,Telecom Corp,1300.00,45000,2023-02-15\nChicago,IL,Telecom Corp,1100.75,40000,2023-03-10\nHouston,TX,Telecom Corp,1250.00,,2023-04-05\nPhoenix,AZ,Telecom Corp,,38000,2023-05-20\nPhiladelphia,PA,Telecom Corp,1400.00,42000,2023-06-25\nSan Antonio,TX,Telecom Corp,1350.00,41000,2023-07-30\nSan Diego,CA,Telecom Corp,1300.00,43000,2023-08-15\nDallas,TX,Telecom Corp,,44000,2023-09-10\nSan Jose,CA,Telecom Corp,1280.00,,2023-10-01\nAustin,TX,Telecom Corp,1250.00,46000,2023-11-05\nJacksonville,FL,Telecom Corp,1200.00,39000,2023-12-10\nFort Worth,TX,Telecom Corp,1150.00,40000,\nColumbus,OH,Telecom Corp,1210.00,41000,2023-10-15\nCharlotte,NC,Telecom Corp,1190.00,43000,2023-11-20"}
{"purpose": "Clean inconsistent crop names and standardize date formats in agricultural loan records.", "raw_table": "FarmID,Crop,State,LoanAmount,PlantingDate,PricePerTon\n001,wheat,ka,10000,2023/03/15,250\n002,CoRn,Karnataka,15000,15-03-2023,300\n003,Rice--,KA,12000,03/16/2023,280\n004,sorghum,Kar-NA,8000,2023.03.14,220\n005,millet,,7000,2023/03/15,200\n006,Wheat,KA,11000,March 17, 2023,255\n007,Corn,Karnataka,13000,2023-3-18,310\n008,rice,KA,11500,18/03/2023,275\n009,sorghum,Karnataka,8500,03-19-2023,225\n010,millet,karnataka,7300,2023/03/20,210\n011,Corn_,ka,14000,2023/03/15,305\n012,wheat,KARNATAKA,10500,2023-03-16,260", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and remove trailing non-alphabetic characters from Crop", "columnName": "Crop", "expression": "value.trim().replace(/[^a-zA-Z]+$/,'')"}, {"op": "core/mass-edit", "description": "Standardize crop names capitalization", "columnName": "Crop", "edits": [{"from": ["corn", "CoRn", "Corn", "Corn_"], "to": "Corn"}, {"from": ["wheat", "Wheat", "WHEAT"], "to": "Wheat"}, {"from": ["rice", "Rice"], "to": "Rice"}, {"from": ["sorghum", "Sorghum"], "to": "Sorghum"}, {"from": ["millet", "Millet"], "to": "Millet"}]}, {"op": "core/text-transform", "description": "Standardize State names to 'Karnataka'", "columnName": "State", "expression": "value.toLowerCase().match(/ka|karnataka/) ? 'Karnataka' : value"}, {"op": "core/fill-down", "description": "Fill down missing State values", "columnName": "State"}, {"op": "core/text-transform", "description": "Normalize PlantingDate to ISO yyyy-MM-dd", "columnName": "PlantingDate", "expression": "value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/) ? value.replace(/\\//g,'-') : (value.match(/\\d{2}-\\d{2}-\\d{4}/) ? value.split('-').reverse().join('-') : (value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/) ? value.split('/').reverse().join('-') : (value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/) ? value.replace(/\\./g,'-') : (value.match(/March\\s+\\d{1,2},\\s+\\d{4}/) ? '2023-03-'+ (value.match(/March\\s+(\\d{1,2}),\\s+\\d{4}/)[1].padStart(2, '0')) : (value.match(/\\d{4}-\\d{1,2}-\\d{1,2}/) ? value.split('-')[0] + '-' + value.split('-')[1].padStart(2,'0') + '-' + value.split('-')[2].padStart(2,'0') : value))))))"}, {"op": "core/text-transform", "description": "Ensure PricePerTon is numeric string without extra spaces", "columnName": "PricePerTon", "expression": "value.trim()"}], "clean_table": "FarmID,Crop,State,LoanAmount,PlantingDate,PricePerTon\n001,Wheat,Karnataka,10000,2023-03-15,250\n002,Corn,Karnataka,15000,2023-03-15,300\n003,Rice,Karnataka,12000,2023-03-16,280\n004,Sorghum,Karnataka,8000,2023-03-14,220\n005,Millet,Karnataka,7000,2023-03-15,200\n006,Wheat,Karnataka,11000,2023-03-17,255\n007,Corn,Karnataka,13000,2023-03-18,310\n008,Rice,Karnataka,11500,2023-03-18,275\n009,Sorghum,Karnataka,8500,2023-03-19,225\n010,Millet,Karnataka,7300,2023-03-20,210\n011,Corn,Karnataka,14000,2023-03-15,305\n012,Wheat,Karnataka,10500,2023-03-16,260"}
{"purpose": "Standardize movie genre names and normalize release dates in a film dataset.", "raw_table": "MovieTitle,Genre,ReleaseDate,BoxOffice,Rating\nThe_Great Adventure,Action-Adventure,12/31/2018,500000000,8.5\nlove in Paris,romance,2017-07-15,120000000,7.8\nSky High,action,March 05 2019,300000000,7.2\nMystery Island,MYSTERY,2018/11/20,85000000,6.9\nComedy Night,comedy_,04-25-2017,45000000,7.0\nhorror Tales,Horror,Oct 31 2016,30000000,6.5\nUnder_the_Sea,Adventure,2015-06-15,150000000,7.9\nSilent Shadows,mysterY-,2019/10/10,40000000,7.1\nRomantic_Stories,Romance,2018.02.14,90000000,7.4\nThe Last Hero,ACTION,07/04/2017,,8.0\nLaugh Riot,COMEDY,2016-08-20,35000000,6.8\nDark Nights,Horror,2017/10/31,28000000,\nSunset Boulevard,adventure,2015/09/30,130000000,7.6", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from all cells", "columnName": "MovieTitle", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace from Genre", "columnName": "Genre", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Remove underscores and hyphens from Genre and convert to lowercase", "columnName": "Genre", "expression": "value.replaceAll(/[_-]/, '').toLowercase()"}, {"op": "core/mass-edit", "description": "Normalize genre names", "columnName": "Genre", "edits": [{"from": ["actionadventure", "action"], "to": "Action"}, {"from": ["romance"], "to": "Romance"}, {"from": ["mystery"], "to": "Mystery"}, {"from": ["comedy"], "to": "Comedy"}, {"from": ["horror"], "to": "Horror"}, {"from": ["adventure"], "to": "Adventure"}]}, {"op": "core/text-transform", "description": "Parse ReleaseDate into ISO 8601 format yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/fill-down", "description": "Fill down missing BoxOffice values", "columnName": "BoxOffice"}, {"op": "core/text-transform", "description": "Convert BoxOffice to integer, remove commas", "columnName": "BoxOffice", "expression": "value.replaceAll(',', '').toNumber()"}, {"op": "core/text-transform", "description": "Convert Rating to number; fill missing with 0", "columnName": "Rating", "expression": "value.length() > 0 ? value.toNumber() : 0"}, {"op": "core/text-transform", "description": "Replace underscores in MovieTitle with spaces", "columnName": "MovieTitle", "expression": "value.replaceAll('_', ' ')"}], "clean_table": "MovieTitle,Genre,ReleaseDate,BoxOffice,Rating\nThe Great Adventure,Action,2018-12-31,500000000,8.5\nlove in Paris,Romance,2017-07-15,120000000,7.8\nSky High,Action,2019-03-05,300000000,7.2\nMystery Island,Mystery,2018-11-20,85000000,6.9\nComedy Night,Comedy,2017-04-25,45000000,7.0\nhorror Tales,Horror,2016-10-31,30000000,6.5\nUnder the Sea,Adventure,2015-06-15,150000000,7.9\nSilent Shadows,Mystery,2019-10-10,40000000,7.1\nRomantic Stories,Romance,2018-02-14,90000000,7.4\nThe Last Hero,Action,2017-07-04,130000000,8.0\nLaugh Riot,Comedy,2016-08-20,35000000,6.8\nDark Nights,Horror,2017-10-31,28000000,0\nSunset Boulevard,Adventure,2015-09-30,130000000,7.6"}
{"purpose": "Standardize and clean agricultural loan application data including location names, business types, pricing, and date formats.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nGreenVille,SC,vegetable-farm,15000,30000,03/15/2023\ngreenville,sc,VegetableFarm, 15,000 ,30000,2023.03.15\nGreenville-,SC,Vegetable_Farm,15000,30000,15-03-2023\nLakeview,TX,crop_farm,20000, ,2023/04/10\nLakeView,TX,cropFarm,20,000,40000,10-04-2023\nLake-view,TX,crop-farm,20000,40000,4/10/2023\nSunnytown,ca,fruit_farm,18000,35000,May 5 2023\nSunnyTown,CA,Fruitfarm,18000,35000,2023-05-05\nsunnytown,CA,fruit-farm,18,000,35000,05/05/2023\nMaplewood,OR,livestock_farm,25000,45000,2023-06-20\nmaplewood,or,LivestockFarm,25000,45000,20/06/2023\nMaplewood,OR,livestock-farm,25,000,45000,06-20-2023\nRiverside,FL,,22000,42000,2023-07-15\nriverside,fl,Greenhouse_farm,22000,42000,15/07/2023\nRiverside,FL,greenhouse-farm,22000,42000,07-15-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from Price and LoanAmount", "columnName": "Price", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Remove commas from Price and convert to number", "columnName": "Price", "expression": "value.replace(/[,]/, '').toNumber()"}, {"op": "core/text-transform", "description": "Trim whitespace from LoanAmount", "columnName": "LoanAmount", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Remove commas from LoanAmount and convert to number, empty strings to null", "columnName": "LoanAmount", "expression": "value == '' ? null : value.replace(/[,]/, '').toNumber()"}, {"op": "core/text-transform", "description": "Standardize City names by removing trailing hyphens and applying title case", "columnName": "City", "expression": "value.replace(/[-_]$/, '').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State names to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Standardize BusinessType names by replacing underscores and hyphens with space, then applying title case and removing spaces", "columnName": "BusinessType", "expression": "value == null || value.trim() == '' ? null : value.replace(/[_-]/g, ' ').toLowercase().split(' ').map(s, i, a, s.substring(0,1).toUppercase() + s.substring(1)).join('')"}, {"op": "core/mass-edit", "description": "Fill missing BusinessType in row 13 with 'GreenhouseFarm'", "columnName": "BusinessType", "edits": [{"from": [""], "to": "GreenhouseFarm"}]}, {"op": "core/date-parse", "description": "Parse ApplicationDate into ISO format", "columnName": "ApplicationDate", "dateFormat": "auto", "onError": "keepOriginal"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nGreenville,SC,VegetableFarm,15000,30000,2023-03-15\nGreenville,SC,VegetableFarm,15000,30000,2023-03-15\nGreenville,SC,VegetableFarm,15000,30000,2023-03-15\nLakeview,TX,CropFarm,20000,null,2023-04-10\nLakeview,TX,CropFarm,20000,40000,2023-04-10\nLakeview,TX,CropFarm,20000,40000,2023-04-10\nSunnytown,CA,FruitFarm,18000,35000,2023-05-05\nSunnytown,CA,FruitFarm,18000,35000,2023-05-05\nSunnytown,CA,FruitFarm,18000,35000,2023-05-05\nMaplewood,OR,LivestockFarm,25000,45000,2023-06-20\nMaplewood,OR,LivestockFarm,25000,45000,2023-06-20\nMaplewood,OR,LivestockFarm,25000,45000,2023-06-20\nRiverside,FL,GreenhouseFarm,22000,42000,2023-07-15\nRiverside,FL,GreenhouseFarm,22000,42000,2023-07-15\nRiverside,FL,GreenhouseFarm,22000,42000,2023-07-15"}
{"purpose": "Standardize city names and business types, correct date formats, and normalize price and loan amount fields for accurate telecom billing analysis.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew-york,NY,Telecom_corp,1200.5,15000,01/12/2023\nlos angeles,ca,telecom-corp,1100,NaN,2023-13-01\nChicago,IL,Tele_corp,900.75,8000,2023/02/28\nhouston,tx,Telecom_corp,800.00,9000,28-02-2023\nPhoenix,AZ,telecom_CORP,850.5,7500,2023-02-30\nphiladelphia,pa,,950,7000,2023-02-15\nSan Antonio,TX,Telecom_corp,1050,abc,02/20/2023\nsan diego,ca,Telecom Corp,1000,6800,2023/02/21\nDALLAS,TX,telecom_corp,980,7200,20-02-2023\nSan_jose,CA,Telecom_corp,NaN,7000,2023-02-19\nAustin,TX,telecom_corp,870,7300,2023-2-18\nJacksonville,FL,telecom_corp,930,7100,02/17/2023\nfort worth,TX,Telecom_corp,890,6900,2023-02-16", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names by removing underscores/hyphens and capitalize each word", "columnName": "City", "expression": "value.replaceAll(/[-_]/, ' ').split(' ').map(s => s.toLowerCase().capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize BusinessType variations to 'Telecom Corp'", "columnName": "BusinessType", "edits": [{"from": ["Telecom_corp", "telecom-corp", "Tele_corp", "telecom_CORP", "Telecom Corp", "telecom_corp"], "to": "Telecom Corp"}, {"from": [""], "to": "Telecom Corp"}]}, {"op": "core/text-transform", "description": "Normalize Price and LoanAmount to numbers, replace invalid or missing with null", "columnName": "Price", "expression": "value && value.match(/^[0-9]+(\\.[0-9]+)?$/) ? Number(value) : null"}, {"op": "core/text-transform", "description": "Normalize LoanAmount to numeric, replace invalid or missing with null", "columnName": "LoanAmount", "expression": "value && value.match(/^[0-9]+$/) ? Number(value) : null"}, {"op": "core/text-transform", "description": "Correct malformed dates to yyyy-MM-dd or null if invalid", "columnName": "Date", "expression": "var d = value.match(/(\\d{4})[- \\/](\\d{1,2})[- \\/](\\d{1,2})/); if(d){var y=Number(d[1]); var m=Number(d[2]); var day=Number(d[3]); var validDate = new Date(y,m-1,day); if(validDate.getFullYear()==y && validDate.getMonth()==m-1 && validDate.getDate()==day) { return y + '-' + (m<10?'0'+m:m) + '-' + (day<10?'0'+day:day) } else { return null }} else { var d2 = value.match(/(\\d{1,2})[- \\/](\\d{1,2})[- \\/](\\d{4})/); if(d2){var day2=Number(d2[1]); var mon2=Number(d2[2]); var year2=Number(d2[3]); var valDate = new Date(year2,mon2-1,day2); if(valDate.getFullYear()==year2 && valDate.getMonth()==mon2-1 && valDate.getDate()==day2){ return year2 + '-' + (mon2<10?'0'+mon2:mon2) + '-' + (day2<10?'0'+day2:day2) } else { return null } } else { return null } }"}, {"op": "core/fill-down", "description": "Fill down any missing State values", "columnName": "State"}, {"op": "core/column-rename", "description": "Rename 'Price' to 'MonthlyCharge'", "oldColumnName": "Price", "newColumnName": "MonthlyCharge"}], "clean_table": "City,State,BusinessType,MonthlyCharge,LoanAmount,Date\nNew York,NY,Telecom Corp,1200.5,15000,2023-01-12\nLos Angeles,CA,Telecom Corp,1100,null,null\nChicago,IL,Telecom Corp,900.75,8000,2023-02-28\nHouston,TX,Telecom Corp,800,9000,2023-02-28\nPhoenix,AZ,Telecom Corp,850.5,7500,null\nPhiladelphia,PA,Telecom Corp,950,7000,2023-02-15\nSan Antonio,TX,Telecom Corp,1050,null,2023-02-20\nSan Diego,CA,Telecom Corp,1000,6800,2023-02-21\nDallas,TX,Telecom Corp,980,7200,2023-02-20\nSan Jose,CA,Telecom Corp,null,7000,2023-02-19\nAustin,TX,Telecom Corp,870,7300,2023-02-18\nJacksonville,FL,Telecom Corp,930,7100,2023-02-17\nFort Worth,TX,Telecom Corp,890,6900,2023-02-16"}
{"purpose": "Clean and standardize city names, business types, and date formats; correct numeric values and remove extraneous characters.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,telecom,1000,50,01/12/2023\nLos-Angeles,ca,Tele-Com,850,1000,2023-13-01\nChicago,IL,Telecom,1200,,15-02-2023\nhouston,TX,tele-communication,NaN,500,03/05/2023\nPhoenix,Az,TeleComm,950,700,2023/04/15\nphiladelphia,PA,,1100,650,April 20, 2023\nSan Antonio,TX,telecom,900,800,2023-05-32\nSan_diego,CA,Telecom,850,550,05-25-2023\nDallas,TX,Telecom,not available,600,2023-06-10\nSan Jose,,Tele-com,920,700,2023/06/11\nAustin,tx,TELECOM,930,750,6/15/2023\nJacksonville,FL,telecom,880,800,15/06/2023\nFort Worth,TX,Telecom,900,NA,2023-06-17", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in City", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Uppercase State abbreviations", "columnName": "State", "expression": "isNull(value) || value.trim() === '' ? null : value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["telecom", "Tele-Com", "tele-communication", "TeleComm", "Tele-com", "TELECOM", "telecom"], "to": "Telecom"}, {"from": [null, ""], "to": "Telecom"}]}, {"op": "core/text-transform", "description": "Clean Price column: replace non-numeric and NaN with empty", "columnName": "Price", "expression": "value.match(/^[0-9]+$/) ? value : null"}, {"op": "core/text-transform", "description": "Clean LoanAmount column: replace NA, not available, empty with null", "columnName": "LoanAmount", "expression": "value.toLowercase() === 'na' || value.toLowercase() === 'not available' || value.trim() === '' ? null : value"}, {"op": "core/text-transform", "description": "Convert Price to number", "columnName": "Price", "expression": "value === null ? null : Number(value)"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number", "columnName": "LoanAmount", "expression": "value === null ? null : Number(value)"}, {"op": "core/date-parse", "description": "Parse and normalize Date to yyyy-MM-dd", "columnName": "Date", "expression": "value", "format": "best-effort", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Format Date column to ISO format yyyy-MM-dd", "columnName": "Date", "expression": "value instanceof Date ? value.toISOString().substring(0,10) : value"}, {"op": "core/fill-down", "description": "Fill down missing State values", "columnName": "State"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom,1000,50,2023-01-12\nLos Angeles,CA,Telecom,850,1000,2023-01-13\nChicago,IL,Telecom,1200,,2023-02-15\nHouston,TX,Telecom,,500,2023-03-05\nPhoenix,AZ,Telecom,950,700,2023-04-15\nPhiladelphia,PA,Telecom,1100,650,2023-04-20\nSan Antonio,TX,Telecom,900,800,\nSan Diego,CA,Telecom,850,550,2023-05-25\nDallas,TX,Telecom,,600,2023-06-10\nSan Jose,TX,Telecom,920,700,2023-06-11\nAustin,TX,Telecom,930,750,2023-06-15\nJacksonville,FL,Telecom,880,800,2023-06-15\nFort Worth,TX,Telecom,900,,2023-06-17"}
{"purpose": "Standardize and clean inconsistent city names, business types, and date formats in telecom customer data.", "raw_table": "CustomerID,City,State,BusinessType,MonthlyCharge,LoanAmount,ActivationDate\n001,new-york,ny,corporate,120.50,15000,2023/02/15\n002,Los Angeles,CA,Individual,85.75,8000,15-03-2023\n003,CHicagO,il,Corp,110.00,12000,2023.04.01\n004,Houston,Tx,residential,75.00,,2023-04-22\n005,Phoenix,az,Individual,90.25,9000,04/20/2023\n006,philadelphia,PA,corporate,130.00,16000,2023-03-05\n007,San-Antonio,tx,residentail,70.00,7000,2023/02/28\n008,San Diego,CA,Individual,95.50,9500,Mar 17, 2023\n009,Dallas,TX,corp,115.00,14000,2023-03-10\n010,san jose,CA,Individual,88.00,8500,2023-03-25\n011,Austin,tx,Corporate,125.00,15500,2023-02-30\n012,Jacksonville,FL,residential,72.00,6800,03/15/2023\n013,Fort worth,TX,individual,89.90,8800,2023-04-10\n014,Columbus,OH,corporate,121.00,15000,2023-03-15\n", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["new-york"], "to": "New York"}, {"from": ["San-Antonio"], "to": "San Antonio"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()", "description": "Capitalize city names properly"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()", "description": "Convert state abbreviations to uppercase"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["corp", "corporate", "Corp", "Corporate"], "to": "Corporate"}, {"from": ["individual", "Individual", "individual"], "to": "Individual"}, {"from": ["residential", "residentail", "Residential"], "to": "Residential"}]}, {"op": "core/text-transform", "columnName": "MonthlyCharge", "expression": "if(isNumber(value), value, Number(value))", "description": "Ensure MonthlyCharge is numeric"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "if(value == null || value.trim() == '', '', Number(value))", "description": "Convert LoanAmount to number or empty if missing"}, {"op": "core/text-transform", "columnName": "ActivationDate", "expression": "if(value.match(/^\\d{4}\\/\\d{2}\\/\\d{2}$/), value.replace(/\\//g, '-'), value)", "description": "Replace slashes with dashes for yyyy/mm/dd"}, {"op": "core/text-transform", "columnName": "ActivationDate", "expression": "value.trim()", "description": "Trim whitespace from date"}, {"op": "core/date-parse", "columnName": "ActivationDate", "pattern": "yyyy-MM-dd", "description": "Parse dates in yyyy-MM-dd format"}, {"op": "core/date-parse", "columnName": "ActivationDate", "pattern": "dd-MM-yyyy", "description": "Parse dates in dd-MM-yyyy format"}, {"op": "core/date-parse", "columnName": "ActivationDate", "pattern": "MM/dd/yyyy", "description": "Parse dates in MM/dd/yyyy format"}, {"op": "core/date-parse", "columnName": "ActivationDate", "pattern": "MMM dd, yyyy", "description": "Parse dates like Mar 17, 2023"}, {"op": "core/mass-edit", "columnName": "ActivationDate", "edits": [{"from": ["2023-02-30"], "to": "2023-02-28"}], "description": "Fix invalid date by replacing Feb 30 with Feb 28"}, {"op": "core/column-rename", "oldColumnName": "MonthlyCharge", "newColumnName": "Monthly_Charge"}], "clean_table": "CustomerID,City,State,BusinessType,Monthly_Charge,LoanAmount,ActivationDate\n001,New York,NY,Corporate,120.50,15000,2023-02-15\n002,Los Angeles,CA,Individual,85.75,8000,2023-03-15\n003,Chicago,IL,Corporate,110.00,12000,2023-04-01\n004,Houston,TX,Residential,75.00,,2023-04-22\n005,Phoenix,AZ,Individual,90.25,9000,2023-04-20\n006,Philadelphia,PA,Corporate,130.00,16000,2023-03-05\n007,San Antonio,TX,Residential,70.00,7000,2023-02-28\n008,San Diego,CA,Individual,95.50,9500,2023-03-17\n009,Dallas,TX,Corporate,115.00,14000,2023-03-10\n010,San Jose,CA,Individual,88.00,8500,2023-03-25\n011,Austin,TX,Corporate,125.00,15500,2023-02-28\n012,Jacksonville,FL,Residential,72.00,6800,2023-03-15\n013,Fort Worth,TX,Individual,89.90,8800,2023-04-10\n014,Columbus,OH,Corporate,121.00,15000,2023-03-15"}
{"purpose": "Standardize inconsistent city names and business types, and correct date and numeric formats in government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew-york,ny,Restuarant,120000,$50000,03/15/2022\nlos-angeles,CA,retail,75000,40000,2022-04-01\nCHICAGO,il,RETAIL,60000,$35000,4/12/22\nhouston,TX,Farm-ing,85000,$45000,2022/05/14\nphiladelphia,Pa,,45000,30000,May 20 2022\nphoenix,az,restaurant,90000,not disclosed,06-10-2022\nsan-antonio,TX,retail,70000,25000,07/01/2022\nsan diego,ca,Restuarant,67000,27000,2022.08.05\ndallas,TX,Restaurant,82000,$40000,08-15-2022\nsan_jose,CA,Farming,78000,38000,2022-09-01\nAustin,tx,retail,69000,33000,9/15/2022\njacksonville,FL,Retail,73000,,10/02/2022\nfort-worth,TX,restaurant,64000,$29000,11/12/22\ncolumbus,oh,Farming,50000,22000,2022-11-30\ncharlotte,nc,REtail,$58000,28000,12/05/2022", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City names by replacing hyphens and underscores with spaces and capitalizing each word", "columnName": "City", "expression": "value.replace(/[-_]/, ' ').split(' ').map(s, s.toLowerCase().capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/mass-edit", "description": "Correct common misspellings and variants in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["Restuarant", "restaurant", "Restaurant"], "to": "Restaurant"}, {"from": ["retail", "RETAIL", "REtail", "Retail"], "to": "Retail"}, {"from": ["Farm-ing", "Farming", "Farming"], "to": "Farming"}]}, {"op": "core/text-transform", "description": "Clean Price by removing $ and converting to number", "columnName": "Price", "expression": "value.replace(/\\$/, '').toNumber()"}, {"op": "core/text-transform", "description": "Clean LoanAmount by removing $ and 'not disclosed', convert to number or blank", "columnName": "LoanAmount", "expression": "if(value.toLowerCase() == 'not disclosed' || value == '', null, value.replace(/\\$/, '').toNumber())"}, {"op": "core/date-parse", "description": "Parse LoanDate into ISO format yyyy-MM-dd", "columnName": "LoanDate", "format": "auto", "newColumnName": "LoanDate", "ignoreError": false}, {"op": "core/mass-edit", "description": "Fill missing BusinessType with 'Unknown'", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Unknown"}]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew York,NY,Restaurant,120000,50000,2022-03-15\nLos Angeles,CA,Retail,75000,40000,2022-04-01\nChicago,IL,Retail,60000,35000,2022-04-12\nHouston,TX,Farming,85000,45000,2022-05-14\nPhiladelphia,PA,Unknown,45000,30000,2022-05-20\nPhoenix,AZ,Restaurant,90000,,2022-06-10\nSan Antonio,TX,Retail,70000,25000,2022-07-01\nSan Diego,CA,Restaurant,67000,27000,2022-08-05\nDallas,TX,Restaurant,82000,40000,2022-08-15\nSan Jose,CA,Farming,78000,38000,2022-09-01\nAustin,TX,Retail,69000,33000,2022-09-15\nJacksonville,FL,Retail,73000,,2022-10-02\nFort Worth,TX,Restaurant,64000,29000,2022-11-12\nColumbus,OH,Farming,50000,22000,2022-11-30\nCharlotte,NC,Retail,58000,28000,2022-12-05"}
{"purpose": "Clean inconsistent city and state names, normalize business types, and standardize date and numeric formats in government loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,ny,retail,-5000,10000,01/15/2023\nlos-angeles,CA,Manufacturing,7500,,2023-02-20\nChicago,IL,retail_,,15000,03-10-2023\nhouston,Tx,service,4000,12000,April 5 2023\nphoenix,az,Service,3500,-11000,2023/05/12\nphiladelphia,PA,manufacturing,abc,20000,06-18-23\nsan antonio,TX,Retail,5000,15000,07/01/2023\nsan_diego,ca,Manufacturing,6000,17000,8/15/2023\n,Dc,retail,4500,13000,09-10-2023\nDallas,TX,service,5200,14000,2023-10-25\nsan jose,CA,,7000,16000,11-30-2023\nAustin,tx,Retail,4800,11000,12/05/2023\njacksonville,fl,service,3000,9000,2023-01-07\nfort worth,TX,manufacturing,5500,15500,2023-02-14\ncolumbus,OH,Retail,,-12000,03/22/2023", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["new york"], "to": "New York"}, {"from": ["los-angeles"], "to": "Los Angeles"}, {"from": ["houston"], "to": "Houston"}, {"from": ["phoenix"], "to": "Phoenix"}, {"from": ["philadelphia"], "to": "Philadelphia"}, {"from": ["san antonio"], "to": "San Antonio"}, {"from": ["san_diego"], "to": "San Diego"}, {"from": ["jacksonville"], "to": "Jacksonville"}, {"from": ["fort worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value ? value.replace(/_/g, ' ').replace(/-/g, ' ').split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1).toLowerCase()).join(' ') : ''"}, {"op": "core/text-transform", "columnName": "State", "expression": "value ? value.toUpperCase() : ''"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["retail_"], "to": "Retail"}, {"from": ["retail"], "to": "Retail"}, {"from": ["Manufacturing"], "to": "Manufacturing"}, {"from": ["manufacturing"], "to": "Manufacturing"}, {"from": ["service"], "to": "Service"}, {"from": ["Service"], "to": "Service"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "isNaN(parseFloat(value)) ? '' : (parseFloat(value) < 0 ? '' : parseFloat(value))"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "isNaN(parseFloat(value)) ? '' : (parseFloat(value) < 0 ? '' : parseFloat(value))"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value", "mode": "lenient", "format": "yyyy-MM-dd", "toColumn": "Date", "onError": "set-to-blank"}, {"op": "core/fill-down", "columnName": "City"}, {"op": "core/mass-edit", "columnName": "City", "edits": [{"from": [""], "to": "Unknown"}]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,5000,10000,2023-01-15\nLos Angeles,CA,Manufacturing,7500,,2023-02-20\nChicago,IL,Retail,,15000,2023-03-10\nHouston,TX,Service,4000,12000,2023-04-05\nPhoenix,AZ,Service,3500,11000,2023-05-12\nPhiladelphia,PA,Manufacturing,,20000,2023-06-18\nSan Antonio,TX,Retail,5000,15000,2023-07-01\nSan Diego,CA,Manufacturing,6000,17000,2023-08-15\nUnknown,DC,Retail,4500,13000,2023-09-10\nDallas,TX,Service,5200,14000,2023-10-25\nSan Jose,CA,Unknown,7000,16000,2023-11-30\nAustin,TX,Retail,4800,11000,2023-12-05\nJacksonville,FL,Service,3000,9000,2023-01-07\nFort Worth,TX,Manufacturing,5500,15500,2023-02-14\nColumbus,OH,Retail,,12000,2023-03-22"}
{"purpose": "Clean and standardize city names, business types, and date formats in government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,resturant,125000,50000,01/12/2023\nlos-angeles,CA,Auto_Repair,98000,40000,2023-02-15\nchicago,IL,Health Care,150000,75000,15-03-2023\nhouston,tx,restuarant,135000,60000,2023/04/10\nphoenix,AZ,auto repair,110000,35000,2023-5-20\nphiladelphia,PA,healthcare,145000,70000,May 25 2023\nsan-antonio,TX,,120000,45000,2023.06.30\nsan diego,ca,Auto-Repair,105000,,07-07-2023\ndallas,TX,health-care,130000,55000,2023/08/15\nsan_jose,CA,restaurant,125000,50000,2023-09-10\nAustin,TX,Resturant,115000,48000,10/10/2023\njacksonville,FL,Restuarant,100000,42000,2023-11-05\nfort-worth,TX,Health care,140000,68000,12-12-2023\ncolumbus,oh,auto_repair,95000,40000,2023/12/20\ncharlotte,NC,restaurant,130000,60000,2023-13-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names and remove underscores/hyphens", "columnName": "City", "expression": "value.replace(/[_-]/,' ').split(' ').map(s => s.toLowerCase().capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Capitalize state abbreviations", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["resturant", "Resturant", "Restuarant"], "to": "Restaurant"}, {"from": ["auto repair", "Auto_Repair", "Auto-Repair", "auto_repair"], "to": "Auto Repair"}, {"from": ["healthcare", "Health Care", "health-care", "Health care"], "to": "Healthcare"}]}, {"op": "core/mass-edit", "description": "Fill missing BusinessType with 'Unknown'", "columnName": "BusinessType", "edits": [{"from": [null, ""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Fill missing LoanAmount with 0", "columnName": "LoanAmount", "expression": "value.trim() === '' ? '0' : value"}, {"op": "core/text-transform", "description": "Remove commas if any from Price and LoanAmount", "columnName": "Price", "expression": "value.replace(/,/g, '')"}, {"op": "core/text-transform", "description": "Remove commas if any from LoanAmount", "columnName": "LoanAmount", "expression": "value.replace(/,/g, '')"}, {"op": "core/date-parse", "description": "Parse and normalize Date column to yyyy-MM-dd", "columnName": "Date", "format": "auto", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Correct invalid dates (e.g. 2023-13-01) to null", "columnName": "Date", "expression": "try(value.toDate()) != null ? value : ''"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,125000,50000,2023-01-12\nLos Angeles,CA,Auto Repair,98000,40000,2023-02-15\nChicago,IL,Healthcare,150000,75000,2023-03-15\nHouston,TX,Restaurant,135000,60000,2023-04-10\nPhoenix,AZ,Auto Repair,110000,35000,2023-05-20\nPhiladelphia,PA,Healthcare,145000,70000,2023-05-25\nSan Antonio,TX,Unknown,120000,45000,2023-06-30\nSan Diego,CA,Auto Repair,105000,0,2023-07-07\nDallas,TX,Healthcare,130000,55000,2023-08-15\nSan Jose,CA,Restaurant,125000,50000,2023-09-10\nAustin,TX,Restaurant,115000,48000,2023-10-10\nJacksonville,FL,Restaurant,100000,42000,2023-11-05\nFort Worth,TX,Healthcare,140000,68000,2023-12-12\nColumbus,OH,Auto Repair,95000,40000,2023-12-20\nCharlotte,NC,Restaurant,130000,60000,"}
{"purpose": "Standardize inconsistent city names and correct formatting errors in loan and price data for energy sector clients.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar_farm,5000,10000,01-12-2023\nlos-angeles,CA,Wind_Turbine,7500,15000,2023/01/15\nCHICAGO,IL,Hydropower, ,12000,12/30/2022\nhouston,TX,solar farm,4500, ,2023.02.01\nphoenix,AZ,Wind turbine,7000,13000,2023-02-15\nphiladelphia,PA,hydropower,6500,11000,02-20-2023\nsan_antonio,TX,Solar_farm,4800,9000,2023-03-01\nSan Diego,CA,Wind-Turbine,7200,14000,03/05/2023\nDALLAS,TX,Hydropower,6700,11500,2023/03/10\nsan jose,CA,solar_farm,5000,10000,15-03-2023\nAustin,TX,Wind turbine,6800, ,2023-03-20\nJacksonville,FL,hydropower,6400,10000,2023/03/25\nfort-worth,TX,Solar farm,4600,9500,2023/03/30", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["los-angeles"], "to": "Los Angeles"}, {"from": ["san_antonio"], "to": "San Antonio"}, {"from": ["fort-worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["solar_farm", "Solar_farm", "Solar farm"], "to": "Solar Farm"}, {"from": ["Wind_Turbine", "Wind turbine", "Wind-Turbine", "Wind turbine"], "to": "Wind Turbine"}, {"from": ["Hydropower", "hydropower"], "to": "Hydropower"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.trim() == '' ? null : Number(value)"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value.trim() == '' ? null : Number(value)"}, {"op": "core/date-parse", "columnName": "Date", "pattern": "yyyy-MM-dd", "onError": "keep-original"}, {"op": "core/date-parse", "columnName": "Date", "pattern": "MM-dd-yyyy", "onError": "keep-original"}, {"op": "core/date-parse", "columnName": "Date", "pattern": "MM/dd/yyyy", "onError": "keep-original"}, {"op": "core/date-parse", "columnName": "Date", "pattern": "yyyy/MM/dd", "onError": "keep-original"}, {"op": "core/date-parse", "columnName": "Date", "pattern": "yyyy.MM.dd", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value instanceof Date ? value.toISOString().slice(0,10) : value"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Farm,5000,10000,2023-01-12\nLos Angeles,CA,Wind Turbine,7500,15000,2023-01-15\nChicago,IL,Hydropower,,12000,2022-12-30\nHouston,TX,Solar Farm,4500,,2023-02-01\nPhoenix,AZ,Wind Turbine,7000,13000,2023-02-15\nPhiladelphia,PA,Hydropower,6500,11000,2023-02-20\nSan Antonio,TX,Solar Farm,4800,9000,2023-03-01\nSan Diego,CA,Wind Turbine,7200,14000,2023-03-05\nDallas,TX,Hydropower,6700,11500,2023-03-10\nSan Jose,CA,Solar Farm,5000,10000,2023-03-15\nAustin,TX,Wind Turbine,6800,,2023-03-20\nJacksonville,FL,Hydropower,6400,10000,2023-03-25\nFort Worth,TX,Solar Farm,4600,9500,2023-03-30"}
{"purpose": "Clean inconsistent farm names and normalize date and numeric formats in agricultural loan data.", "raw_table": "FarmID,Farm_Name,State,Loan_Amount,Loan_Date,Crop_Type,Price_per_Ton\n1,Sunny-farm,ca,100000,2021/07/15,Wheat,250.5\n2,Green_valley,CA,85000,15-08-2021,barley,230\n3,old oak farm,ca,NA,2021-09-01,Corn,190.75\n4,RiverSide-Farm,TX,120000,09/20/21,Soybean,210\n5,Blue_Hill,tx,95000,,wheat,220.00\n6,Willow farm,Tx,105000,2021.10.05,Corn,198\n7,Maplewood,NY,115000,2021-11-10,Oats,210_5\n8,red hill,ny,90000,2021-12-01,oats,205.75\n9,Hilltop-Farm,NY,97000,12/15/2021,Rye,215.00\n10,Lakeview_farm,TX,110000,2021-11-30,Corn,200.0", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize Farm_Name capitalization and replace underscores and hyphens with spaces", "columnName": "Farm_Name", "expression": "value.replace(/[-_]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fill missing Loan_Amount with median (assumed 100000 for example)", "columnName": "Loan_Amount", "edits": [{"from": [""], "to": "100000"}, {"from": ["NA", "NaN", "null"], "to": "100000"}]}, {"op": "core/date-parse", "description": "Parse and standardize Loan_Date to ISO format yyyy-MM-dd", "columnName": "Loan_Date", "format": "smart"}, {"op": "core/text-transform", "description": "Normalize Crop_Type capitalization", "columnName": "Crop_Type", "expression": "value.toLowercase().toTitlecase()"}, {"op": "core/text-transform", "description": "Fix Price_per_Ton formats and replace underscores with decimals", "columnName": "Price_per_Ton", "expression": "value.replace('_', '.').toNumber()"}], "clean_table": "FarmID,Farm_Name,State,Loan_Amount,Loan_Date,Crop_Type,Price_per_Ton\n1,Sunny Farm,CA,100000,2021-07-15,Wheat,250.5\n2,Green Valley,CA,85000,2021-08-15,Barley,230.0\n3,Old Oak Farm,CA,100000,2021-09-01,Corn,190.75\n4,Riverside Farm,TX,120000,2021-09-20,Soybean,210.0\n5,Blue Hill,TX,95000,100000,Wheat,220.0\n6,Willow Farm,TX,105000,2021-10-05,Corn,198.0\n7,Maplewood,NY,115000,2021-11-10,Oats,210.5\n8,Red Hill,NY,90000,2021-12-01,Oats,205.75\n9,Hilltop Farm,NY,97000,2021-12-15,Rye,215.0\n10,Lakeview Farm,TX,110000,2021-11-30,Corn,200.0"}
{"purpose": "Clean and normalize movie theater dataset with inconsistent theater names, show dates, and ticket prices.", "raw_table": "TheaterName,Location,ShowDate,TicketPrice,SeatsAvailable\nCineMax_1,New york,2023/07/15,12.5,100\ncineMAX 2,los Angeles,15-07-2023,15,85\nGrand-Cinema,Chicago,07/16/2023,ten,120\ngrand cinema,Chicago,,$11.00,115\nMovieworld,San_Francisco,2023.07.17,13,90\nmovieWorld,San Francisco,17/07/2023,thirteen,95\nSTARplex,Miami,2023-07-15,14.00,80\nStarplex,miami,July 15 2023,14,82\nFilmHouse,,2023/07/18,12,100\nFilm House,Seattle,2023-07-18,,98\nCineMax_1,New York,07/15/2023,12.50,100\ncineMAX 2,Los Angeles,2023-07-15,15.00,85", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and replace underscores and hyphens with spaces in TheaterName", "columnName": "TheaterName", "expression": "value.trim().replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Capitalize Location names properly and replace underscores with spaces", "columnName": "Location", "expression": "value.trim().replace(/_/g, ' ').toTitlecase()"}, {"op": "core/mass-edit", "description": "Standardize TheaterName variations", "columnName": "TheaterName", "edits": [{"from": ["Cinemax 1", "Cinemax_1", "Cinemax 1"], "to": "Cinemax 1"}, {"from": ["Cinemax 2", "Cinemax 2", "Cinemax 2"], "to": "Cinemax 2"}, {"from": ["Grand Cinema", "Grand-Cinema", "Grand Cinema"], "to": "Grand Cinema"}, {"from": ["Movieworld", "Movieworld", "Movieworld"], "to": "Movieworld"}, {"from": ["Starplex", "Starplex", "Starplex"], "to": "Starplex"}, {"from": ["Filmhouse", "Film House"], "to": "Filmhouse"}]}, {"op": "core/text-transform", "description": "Parse various ShowDate formats into ISO format yyyy-MM-dd", "columnName": "ShowDate", "expression": "if(value==null || value.trim()==='', '',\n  if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/),\n    value.replace(/\\//g,'-'),\n  if(value.match(/\\d{2}-\\d{2}-\\d{4}/),\n    value.split('-').reverse().join('-'),\n  if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/),\n    value.split('/').reverse().join('-'),\n  if(value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/),\n    value.replace(/\\./g,'-'),\n  if(value.match(/[A-Za-z]+ \\d{1,2} \\d{4}/),\n    date.parse(value).toISOString().substring(0,10),\n    value))))))"}, {"op": "core/text-transform", "description": "Normalize TicketPrice to numeric format", "columnName": "TicketPrice", "expression": "if(value==null || value.trim()==='', null, \n  if(value.toLowercase().match(/ten|thirteen/),\n    if(value.toLowercase()=='ten', 10, 13),\n  if(value.match(/\\$/),\n    parseFloat(value.replace('$','')), \n  parseFloat(value))))"}, {"op": "core/fill-down", "description": "Fill down missing Location values", "columnName": "Location"}, {"op": "core/mass-edit", "description": "Fill missing TicketPrice with average price 13", "columnName": "TicketPrice", "edits": [{"from": [""], "to": "13"}]}], "clean_table": "TheaterName,Location,ShowDate,TicketPrice,SeatsAvailable\nCinemax 1,New York,2023-07-15,12.5,100\nCinemax 2,Los Angeles,2023-07-15,15,85\nGrand Cinema,Chicago,2023-07-16,10,120\nGrand Cinema,Chicago,,11,115\nMovieworld,San Francisco,2023-07-17,13,90\nMovieworld,San Francisco,2023-07-17,13,95\nStarplex,Miami,2023-07-15,14,80\nStarplex,Miami,2023-07-15,14,82\nFilmhouse,Seattle,2023-07-18,12,100\nFilmhouse,Seattle,2023-07-18,13,98\nCinemax 1,New York,2023-07-15,12.5,100\nCinemax 2,Los Angeles,2023-07-15,15,85"}
{"purpose": "Standardize movie titles, release dates, and box office revenue formats in a movie dataset.", "raw_table": "Movie_Title,Release_Date,Genre,Box_Office_Million,Rating\nThe_godfather,1972-03-24,Crime,134.97,9.2\nstar wars: a new hope,05/25/1977,Science Fiction,775-4,8.6\nPulp-Fiction,10-14-1994,crime,107.9,8.9\nForrest gump,,Drama,6O7.2,8.8\nThe Shawshank Redemption,1994/09/23,Drama,28O.3,9.3\ninception,July 16 2010,Science Fiction,829.89,8.8\nfight_club,1999-10-15,Drama,100.9,8.8\nThe Dark Knight,2008-07-18,Action,1,005.0,9.0\nThe matrix,03-31-1999,Science fiction,4OO.2,8.7\nGladiator,2000_05_05,Action,187.7,8.5\nTitanic,12/19/1997,Drama,,7.8\nAvengers: Endgame,2019-04-26,Action,2,797.5,8.4\nJurassic_Park,1993/06/11,Science Fiction,1_029.2,8.1\nThe Lion King,06-15-1994,Animation,968.5,8.5\nToy Story ,1995-11-22,Animation,373.6,8.3", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in Movie_Title with spaces, then title case", "columnName": "Movie_Title", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Fix capitalization in Genre column", "columnName": "Genre", "expression": "value.toTitlecase()"}, {"op": "core/mass-edit", "description": "Correct known misspellings in Genre", "columnName": "Genre", "edits": [{"from": ["Science fiction", "Crime"], "to": "Science Fiction"}, {"from": ["Crime"], "to": "Crime"}]}, {"op": "core/text-transform", "description": "Clean Box_Office_Million values by removing commas, hyphens, letters and underscores; fix common OCR errors", "columnName": "Box_Office_Million", "expression": "value.replace(/[,\\-_Oo]/g, '').replace(/l/g,'1').replace(/I/g,'1').replace(/l/g,'1')"}, {"op": "core/text-transform", "description": "Convert Box_Office_Million to number", "columnName": "Box_Office_Million", "expression": "value.toNumber()"}, {"op": "core/date-parse", "description": "Parse Release_Date to ISO format", "columnName": "Release_Date", "options": {"pattern": ["yyyy-MM-dd", "MM/dd/yyyy", "MM-dd-yyyy", "yyyy/MM/dd", "MMMM dd yyyy", "yyyy_MM_dd", "MM-dd-yy"], "onError": "keep-original"}}, {"op": "core/fill-down", "description": "Fill down missing Release_Date values", "columnName": "Release_Date"}, {"op": "core/text-transform", "description": "Standardize Release_Date format to yyyy-MM-dd", "columnName": "Release_Date", "expression": "value.toDate().toISOString().substring(0, 10)"}, {"op": "core/mass-edit", "description": "Fix missing or empty Box_Office_Million values to 0", "columnName": "Box_Office_Million", "edits": [{"from": [null, ""], "to": "0"}]}, {"op": "core/text-transform", "description": "Convert Rating to number", "columnName": "Rating", "expression": "value.toNumber()"}], "clean_table": "Movie_Title,Release_Date,Genre,Box_Office_Million,Rating\nThe Godfather,1972-03-24,Crime,134.97,9.2\nStar Wars: A New Hope,1977-05-25,Science Fiction,775.4,8.6\nPulp Fiction,1994-10-14,Crime,107.9,8.9\nForrest Gump,1994-10-14,Drama,607.2,8.8\nThe Shawshank Redemption,1994-09-23,Drama,280.3,9.3\nInception,2010-07-16,Science Fiction,829.89,8.8\nFight Club,1999-10-15,Drama,100.9,8.8\nThe Dark Knight,2008-07-18,Action,1005.0,9.0\nThe Matrix,1999-03-31,Science Fiction,400.2,8.7\nGladiator,2000-05-05,Action,187.7,8.5\nTitanic,1997-12-19,Drama,0,7.8\nAvengers: Endgame,2019-04-26,Action,2797.5,8.4\nJurassic Park,1993-06-11,Science Fiction,1029.2,8.1\nThe Lion King,1994-06-15,Animation,968.5,8.5\nToy Story,1995-11-22,Animation,373.6,8.3"}
{"purpose": "Standardize city names, fix date formats, and normalize business types for government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew-york,ny,Restuarant,120000,50000,2023/01/15\nlos angeles,ca,Retail_store,85000,30000,15-02-2023\nCHICAGO,IL,resturant,95000,40000,2023-03-01\nhouston,tx,RETAIL store,78000,25000,03/15/2023\nPhoenix,az,restaurant,67000,,2023.04.01\nphiladelphia,pa,,56000,20000,2023-05-05\nsan_antonio,Tx,retail-store,72000,27000,2023/06/10\nsan diego,CA,Restaurant,88000,32000,2023-07-20\nDallas,TX,retail_store,79000,29000,07-25-2023\nSan jose,ca,restarant,61000,23000,2023/08/15\nAUSTIN,Tx,RETAIL STORE,84000,31000,2023.09.01\njacksonville,fl,Retaill Store,73000,26000,2023/10/05\nfort-worth,tx,restaurant,67000,21000,2023-11-15\ncolumbus,oh,retailstore,69000,24000,2023/12/01\ncharlotte,nc,resturant,65000,22000,2023-12-15", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New-york"], "to": "New York"}, {"from": ["san_antonio"], "to": "San Antonio"}, {"from": ["fort-worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/mass-edit", "columnName": "State", "edits": [{"from": ["ny"], "to": "NY"}, {"from": ["ca"], "to": "CA"}, {"from": ["tx"], "to": "TX"}, {"from": ["az"], "to": "AZ"}, {"from": ["pa"], "to": "PA"}, {"from": ["fl"], "to": "FL"}, {"from": ["oh"], "to": "OH"}, {"from": ["nc"], "to": "NC"}]}, {"op": "core/text-transform", "columnName": "BusinessType", "expression": "if(value==null || value.trim()=='', 'Unknown', value.replace(/[-_]/g, ' ').toLowercase().replace(/\\brestuarant\\b|\\bresturant\\b|\\brestarant\\b|\\bresturant\\b/, 'restaurant').replace(/\\bretail store\\b|\\bretail_store\\b|\\bretail-store\\b|\\bretailstore\\b|\\bretaill store\\b/, 'retail store').replace(/\\s+/g, ' ').trim()).toTitlecase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["Unknown"], "to": "Unknown"}]}, {"op": "core/fill-down", "columnName": "BusinessType"}, {"op": "core/text-transform", "columnName": "Date", "expression": "date.parse(value)"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/mass-edit", "columnName": "LoanAmount", "edits": [{"from": [""], "to": "0"}]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,120000,50000,2023-01-15\nLos Angeles,CA,Retail Store,85000,30000,2023-02-15\nChicago,IL,Restaurant,95000,40000,2023-03-01\nHouston,TX,Retail Store,78000,25000,2023-03-15\nPhoenix,AZ,Restaurant,67000,0,2023-04-01\nPhiladelphia,PA,Unknown,56000,20000,2023-05-05\nSan Antonio,TX,Retail Store,72000,27000,2023-06-10\nSan Diego,CA,Restaurant,88000,32000,2023-07-20\nDallas,TX,Retail Store,79000,29000,2023-07-25\nSan Jose,CA,Restaurant,61000,23000,2023-08-15\nAustin,TX,Retail Store,84000,31000,2023-09-01\nJacksonville,FL,Retail Store,73000,26000,2023-10-05\nFort Worth,TX,Restaurant,67000,21000,2023-11-15\nColumbus,OH,Retail Store,69000,24000,2023-12-01\nCharlotte,NC,Restaurant,65000,22000,2023-12-15"}
{"purpose": "Clean and standardize city names, business types, and date formats in an energy loan dataset.", "raw_table": "City,State,BusinessType,LoanAmount,Price,Date\nnew york,NY,solar-installation,50000,1200.5,12/01/2021\nLos_Angeles,CA,wind-farm,75000,1500,2021-11-15\nchicago,il,Solar Panels,60000,1300,11-30-2021\nHouston,TX,,55000,1100.75,2021/12/05\nPhoenix,az,wind farm,70000,1400,Dec 7 2021\nphiladelphia,pa,solarInstallation,58000,1250,2021.12.02\nsan antonio,tx,Wind-Farm,72000,1450,12_03_2021\nsan_diego,CA,solar-installation,53000,1150,2021/12/04\nDallas,TX,solar_installation,61000,1350,12-06-2021\nsan jose,CA,WindFarm,68000,1380,20211208\nAustin,TX,solar-installation,59000,1275,12/09/21\nJacksonville,fl,Wind-farm,71000,1420,2021.12.10\nfort worth,tx,Solar_Installation,62000,1325,Dec 11 2021\nColumbus,OH,wind_farm,73000,1470,12/12/2021", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and remove extra underscores/hyphens from City", "columnName": "City", "expression": "value.trim().replaceAll(\"[_-]\", \" \").toTitlecase()"}, {"op": "core/text-transform", "description": "Uppercase State codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType entries", "columnName": "BusinessType", "edits": [{"from": ["solar-installation", "Solar Panels", "solarInstallation", "solar_installation", "Solar_Installation"], "to": "Solar Installation"}, {"from": ["wind-farm", "wind farm", "Wind-Farm", "WindFarm", "wind_farm", "Wind-farm"], "to": "Wind Farm"}]}, {"op": "core/fill-down", "description": "Fill missing BusinessType values", "columnName": "BusinessType"}, {"op": "core/text-transform", "description": "Convert Price to number with two decimals", "columnName": "Price", "expression": "value.toNumber().round(2)"}, {"op": "core/text-transform", "description": "Convert LoanAmount to integer", "columnName": "LoanAmount", "expression": "value.toNumber().round()"}, {"op": "core/text-transform", "description": "Parse Date with multiple formats to yyyy-MM-dd", "columnName": "Date", "expression": "if(value.match(/\\d{4}-\\d{2}-\\d{2}/)) {value} else if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/)) {value.toDate('MM/dd/yyyy').toString('yyyy-MM-dd')} else if(value.match(/\\d{2}-\\d{2}-\\d{4}/)) {value.toDate('MM-dd-yyyy').toString('yyyy-MM-dd')} else if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/)) {value.toDate('yyyy/MM/dd').toString('yyyy-MM-dd')} else if(value.match(/\\w{3} \\d{1,2} \\d{4}/)) {value.toDate('MMM d yyyy').toString('yyyy-MM-dd')} else if(value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/)) {value.toDate('yyyy.MM.dd').toString('yyyy-MM-dd')} else if(value.match(/\\d{8}/)) {value.toDate('yyyyMMdd').toString('yyyy-MM-dd')} else if(value.match(/\\d{2}_\\d{2}_\\d{4}/)) {value.toDate('MM_dd_yyyy').toString('yyyy-MM-dd')} else if(value.match(/\\d{2}\\/\\d{2}\\/\\d{2}/)) {value.toDate('MM/dd/yy').toString('yyyy-MM-dd')} else {\"\"}"}], "clean_table": "City,State,BusinessType,LoanAmount,Price,Date\nNew York,NY,Solar Installation,50000,1200.50,2021-12-01\nLos Angeles,CA,Wind Farm,75000,1500.00,2021-11-15\nChicago,IL,Solar Installation,60000,1300.00,2021-11-30\nHouston,TX,Solar Installation,55000,1100.75,2021-12-05\nPhoenix,AZ,Wind Farm,70000,1400.00,2021-12-07\nPhiladelphia,PA,Solar Installation,58000,1250.00,2021-12-02\nSan Antonio,TX,Wind Farm,72000,1450.00,2021-12-03\nSan Diego,CA,Solar Installation,53000,1150.00,2021-12-04\nDallas,TX,Solar Installation,61000,1350.00,2021-12-06\nSan Jose,CA,Wind Farm,68000,1380.00,2021-12-08\nAustin,TX,Solar Installation,59000,1275.00,2021-12-09\nJacksonville,FL,Wind Farm,71000,1420.00,2021-12-10\nFort Worth,TX,Solar Installation,62000,1325.00,2021-12-11\nColumbus,OH,Wind Farm,73000,1470.00,2021-12-12"}
{"purpose": "Standardize inconsistent farm product names and correct pricing and date formats.", "raw_table": "Farm,State,Product,Price_per_kg,Loan_Amount,Harvest_Date\nGreenValley,california,Tomato ,$2.50,15000.00,2023/06/15\nsunrise_farms,Texas,pOtato,$1.8,12000,15-07-2023\nHillTop,-New York,Tomatoes,$2,10000.0,2023-08-01\nRiverSide,texas,Potato,$1.75,NaN,2023/07/20\nOld_mill,California,tomato,$2.60,18000,07/25/2023\nSunnySide,Florida,potato,$1.9,14000.00,2023-07-30\nGreenValley,california,Tomato-$2.55,16000,2023-06-18\nHilltop,New-york,Tomato,$2.1,10500,2023/08/05\nsunrise_farms,texas,,1.85,12500,2023/07/16\nOld_Mill,california,Tomato,$2.5a0,17500,2023-07-24\nRiverSide,Texas,Potato,$1.80,13000,July 22, 2023\nSunnySide,Florida,potato,1.95,14500,2023/07/31\nGreenValley,California,Tomato,$2.50,15500,2023-06-20\nHillTop,New York,tOMato,$2.05,11000,2023/08/02", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace in all text columns", "columnName": "Farm", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace in State", "columnName": "State", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace in Product", "columnName": "Product", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Fix inconsistent capitalization in Farm and State", "columnName": "Farm", "expression": "value.toTitlecase().replace(/[-_]/g, '')"}, {"op": "core/text-transform", "description": "Fix inconsistent capitalization and remove special chars in State", "columnName": "State", "expression": "value.toTitlecase().replace(/[-_]/g, '')"}, {"op": "core/mass-edit", "description": "Standardize Product names", "columnName": "Product", "edits": [{"from": ["Tomato ", "Tomatoes", "Tomato-$2.55", "tOMato", "tomato", "Tomato", ""], "to": "Tomato"}, {"from": ["pOtato", "potato", "Potato"], "to": "Potato"}]}, {"op": "core/text-transform", "description": "Clean Price_per_kg column: remove $ and letters, convert to number string", "columnName": "Price_per_kg", "expression": "value.replace(/[a-zA-Z$\\-]/g, '').trim()"}, {"op": "core/text-transform", "description": "Convert Price_per_kg to number with 2 decimals", "columnName": "Price_per_kg", "expression": "if(isNonBlank(value) && !isNaN(Number(value)), Number(value).toFixed(2), '')"}, {"op": "core/mass-edit", "description": "Fix missing Loan Amounts", "columnName": "Loan_Amount", "edits": [{"from": ["NaN"], "to": "13000"}]}, {"op": "core/text-transform", "description": "Convert Loan_Amount to number string with 2 decimals", "columnName": "Loan_Amount", "expression": "if(isNonBlank(value), Number(value).toFixed(2), '')"}, {"op": "core/text-transform", "description": "Parse Harvest_Date to yyyy-MM-dd format", "columnName": "Harvest_Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "Farm,State,Product,Price_per_kg,Loan_Amount,Harvest_Date\nGreenvalley,California,Tomato,2.50,15000.00,2023-06-15\nSunrisefarms,Texas,Potato,1.80,12000.00,2023-07-15\nHilltop,Newyork,Tomato,2.00,10000.00,2023-08-01\nRiverside,Texas,Potato,1.75,13000.00,2023-07-20\nOldmill,California,Tomato,2.60,18000.00,2023-07-25\nSunnyside,Florida,Potato,1.90,14000.00,2023-07-30\nGreenvalley,California,Tomato,2.55,16000.00,2023-06-18\nHilltop,Newyork,Tomato,2.10,10500.00,2023-08-05\nSunrisefarms,Texas,Tomato,1.85,12500.00,2023-07-16\nOldmill,California,Tomato,2.50,17500.00,2023-07-24\nRiverside,Texas,Potato,1.80,13000.00,2023-07-22\nSunnyside,Florida,Potato,1.95,14500.00,2023-07-31\nGreenvalley,California,Tomato,2.50,15500.00,2023-06-20\nHilltop,Newyork,Tomato,2.05,11000.00,2023-08-02"}
{"purpose": "Standardize movie titles, release dates, and box office revenue data for accurate analysis.", "raw_table": "MovieTitle,ReleaseDate,BoxOffice,Genre,Rating\nThe_godfather,03-24-1972,134_966_411,Crime,9.2\nStar Wars,May 25 1977,775_398_007,Sci-Fi,8.6\ninception,07/16/2010,$829895144,SciFi,8.8\nPulp_fiction,10-14-1994,213.9M,Crime,8.9\nThe Shawshank Redemption,,28341469,Drama,9.3\nAvengers-Endgame,04/26/2019,$2,797,501,328,Action,8.4\nTitanic,12-19-1997,2,187,463,944,Romance,7.8\nThe Dark Knight,07/18/2008,$1,005,973,645,Action,9.0\nforrest gump,07-06-1994,67822149,Drama,8.8\njoker,10_04_2019,$1,074,251,311,Crime,8.5\nFight Club,1999-10-15,100_853_753,Drama,8.8\nLa La Land,December 9 2016,446_081_765,Musical,8.0\nSpider-Man,2002/05/03,821_708_551,Action,7.3", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in MovieTitle", "columnName": "MovieTitle", "expression": "value.replace(/[_-]/g, ' ')"}, {"op": "core/text-transform", "description": "Capitalize each word in MovieTitle", "columnName": "MovieTitle", "expression": "value.toLowercase().split(' ').map(w, w.substr(0,1).toUppercase()+w.substr(1)).join(' ')"}, {"op": "core/date-parse", "description": "Parse ReleaseDate into consistent yyyy-MM-dd format", "columnName": "ReleaseDate", "valueType": "date", "dateFormat": "yyyy-MM-dd", "expression": "value.trim() == '' ? null : value.toDate()"}, {"op": "core/text-transform", "description": "Normalize BoxOffice by removing commas, dollar signs, underscores, and letters then convert to number", "columnName": "BoxOffice", "expression": "value.replace(/[$,_M]/g, '').replace(/\\s/g, '').replace(/[a-zA-Z]/g, '')"}, {"op": "core/text-transform", "description": "Convert BoxOffice to numeric type", "columnName": "BoxOffice", "expression": "value == null || value.trim() == '' ? null : Number(value)"}, {"op": "core/mass-edit", "description": "Standardize Genre values", "columnName": "Genre", "edits": [{"from": ["SciFi", "Sci-Fi"], "to": "Science Fiction"}, {"from": ["Action", "action"], "to": "Action"}, {"from": ["Musical"], "to": "Musical"}, {"from": ["Crime", "crime"], "to": "Crime"}, {"from": ["Drama", "drama"], "to": "Drama"}, {"from": ["Romance"], "to": "Romance"}]}, {"op": "core/text-transform", "description": "Capitalize Genre values", "columnName": "Genre", "expression": "value.toLowercase().split(' ').map(w, w.substr(0,1).toUppercase()+w.substr(1)).join(' ')"}, {"op": "core/text-transform", "description": "Fill missing ReleaseDate with null", "columnName": "ReleaseDate", "expression": "value == null ? null : value"}, {"op": "core/text-transform", "description": "Convert Rating to number", "columnName": "Rating", "expression": "Number(value)"}], "clean_table": "MovieTitle,ReleaseDate,BoxOffice,Genre,Rating\nThe Godfather,1972-03-24,134966411,Crime,9.2\nStar Wars,1977-05-25,775398007,Science Fiction,8.6\nInception,2010-07-16,829895144,Science Fiction,8.8\nPulp Fiction,1994-10-14,213900000,Crime,8.9\nThe Shawshank Redemption,,28341469,Drama,9.3\nAvengers Endgame,2019-04-26,2797501328,Action,8.4\nTitanic,1997-12-19,2187463944,Romance,7.8\nThe Dark Knight,2008-07-18,1005973645,Action,9.0\nForrest Gump,1994-07-06,67822149,Drama,8.8\nJoker,2019-10-04,1074251311,Crime,8.5\nFight Club,1999-10-15,100853753,Drama,8.8\nLa La Land,2016-12-09,446081765,Musical,8.0\nSpider Man,2002-05-03,821708551,Action,7.3"}
{"purpose": "Standardize city names and business types, fix date formats and numeric fields for energy loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew-york,NY,solar_Installation,12000,10000,2023/02/15\nlos angeles,CA,Wind-turbine,15000,13500,15-03-2023\nCHICAGO,IL,solar installation,11000,9000,2023-04-01\nHouston,TX,Solar_Installation,12500,,2023.05.10\nphoenix,AZ,wind turbine,14000,13000,May 20 2023\nphiladelphia,PA,solar Instalation,11500,9500,2023/06/01\nsan antonio,TX,solar_installation,11800,9800,06-15-2023\nSan Diego,CA,Wind_turbine,14500,13500,2023/07/05\nDallas,TX,solar Installation,11900,10000,2023-07-20\nSan jose,CA,wind turbine,14800,14000,2023/08/01\nAustin,TX,solar-installation,12100,10500,2023/08/10\nJacksonville,FL,Wind_Turbine,13800,13000,08/20/2023\nfort worth,TX,solar installation,11750,9500,2023/09/01\nColumbus,OH,Solar Installation,11300,9200,2023-09-15\nCharlotte,NC,wind-turbine,14200,13500,2023.10.01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize all city names to title case", "engineConfig": {"mode": "row-based"}, "columnName": "City", "expression": "value.toLowercase().split(' ').map(s, s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Replace hyphens and underscores with spaces in City", "engineConfig": {"mode": "row-based"}, "columnName": "City", "expression": "value.replaceAll('-', ' ').replaceAll('_', ' ')"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["solar_Installation", "solar installation", "Solar_Installation", "solar Instalation", "solar_installation", "solar Installation", "solar-installation"], "to": "Solar Installation"}, {"from": ["Wind-turbine", "wind turbine", "Wind_turbine", "wind-turbine", "Wind_Turbine"], "to": "Wind Turbine"}]}, {"op": "core/text-transform", "description": "Fix LoanDate formats to yyyy-MM-dd", "engineConfig": {"mode": "row-based"}, "columnName": "LoanDate", "expression": "if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/), value.replaceAll('/', '-'), if(value.match(/\\d{2}-\\d{2}-\\d{4}/), value.split('-')[2] + '-' + value.split('-')[0].padLeft(2, '0') + '-' + value.split('-')[1].padLeft(2, '0'), if(value.match(/[A-Za-z]+ \\d{1,2} \\d{4}/), (date.parse(value).toDate().toString('yyyy-MM-dd')), if(value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/), value.replaceAll('.', '-'), if(value.match(/\\d{4}-\\d{2}-\\d{2}/), value, if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/), {let parts = value.split('/'); parts[2] + '-' + parts[0].padLeft(2,'0') + '-' + parts[1].padLeft(2,'0')}, value)))))"}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount with Price minus 2000", "columnName": "LoanAmount", "edits": []}, {"op": "core/text-transform", "description": "Fill missing LoanAmount where empty with Price - 2000", "engineConfig": {"mode": "row-based"}, "columnName": "LoanAmount", "expression": "if(isBlank(value), cells['Price'].value - 2000, value)"}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numeric", "engineConfig": {"mode": "row-based"}, "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to numeric", "engineConfig": {"mode": "row-based"}, "columnName": "LoanAmount", "expression": "value.toNumber()"}, {"op": "core/column-rename", "description": "Rename LoanDate to Date", "oldColumnName": "LoanDate", "newColumnName": "Date"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,12000,10000,2023-02-15\nLos Angeles,CA,Wind Turbine,15000,13500,2023-03-15\nChicago,IL,Solar Installation,11000,9000,2023-04-01\nHouston,TX,Solar Installation,12500,10500,2023-05-10\nPhoenix,AZ,Wind Turbine,14000,13000,2023-05-20\nPhiladelphia,PA,Solar Installation,11500,9500,2023-06-01\nSan Antonio,TX,Solar Installation,11800,9800,2023-06-15\nSan Diego,CA,Wind Turbine,14500,13500,2023-07-05\nDallas,TX,Solar Installation,11900,10000,2023-07-20\nSan Jose,CA,Wind Turbine,14800,14000,2023-08-01\nAustin,TX,Solar Installation,12100,10500,2023-08-10\nJacksonville,FL,Wind Turbine,13800,13000,2023-08-20\nFort Worth,TX,Solar Installation,11750,9500,2023-09-01\nColumbus,OH,Solar Installation,11300,9200,2023-09-15\nCharlotte,NC,Wind Turbine,14200,13500,2023-10-01"}
{"purpose": "Standardize city and date formats, fix business type inconsistencies, and normalize numeric fields for telecom loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,Mobile Provider,1200,50000,01-15-2023\nlos angeles,CA,Internet-Supplier,1500,75000,2023/02/20\nCHICAGO,IL,mobile_provider,1100,55000,15/03/2023\nhouston,TX,Internet Supplier,1300,,03-25-2023\nPhoenix,AZ,,1250,60000,2023-04-10\nphiladelphia,pa,Mobile Provider,1100,58000,April 15, 2023\nSan-antonio,TX,Internet_supplier,1400,73000,2023.05.01\nDALLAS,TX,Mobile provider,1150,52000,2023/06/12\nsan jose,ca,Internet Supplier,1350,70000,06-15-2023\nAustin,TX,Mobile Provider,abc,54000,2023-07-01\nJacksonville,FL,Internet_Supplier,1450,68000,07/10/2023\nFort Worth,TX,mobile provider,1200,51000,2023-08-05\nColumbus,OH,Internet Supplier,1300,72000,August 12 2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.replace(/[-_]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["Mobile Provider", "mobile_provider", "mobile provider", "Mobile provider"], "to": "Mobile Provider"}, {"from": ["Internet Supplier", "Internet-Supplier", "Internet_supplier", "internet Supplier"], "to": "Internet Supplier"}, {"from": [null, ""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Fix Price column to numeric, replace non-numeric with null", "columnName": "Price", "expression": "isNaN(value) ? null : Number(value)"}, {"op": "core/fill-down", "description": "Fill missing LoanAmount with previous value", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Parse Date field into ISO format yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Mobile Provider,1200,50000,2023-01-15\nLos Angeles,CA,Internet Supplier,1500,75000,2023-02-20\nChicago,IL,Mobile Provider,1100,55000,2023-03-15\nHouston,TX,Internet Supplier,1300,55000,2023-03-25\nPhoenix,AZ,Unknown,1250,60000,2023-04-10\nPhiladelphia,PA,Mobile Provider,1100,58000,2023-04-15\nSan Antonio,TX,Internet Supplier,1400,73000,2023-05-01\nDallas,TX,Mobile Provider,1150,52000,2023-06-12\nSan Jose,CA,Internet Supplier,1350,70000,2023-06-15\nAustin,TX,Mobile Provider,null,54000,2023-07-01\nJacksonville,FL,Internet Supplier,1450,68000,2023-07-10\nFort Worth,TX,Mobile Provider,1200,51000,2023-08-05\nColumbus,OH,Internet Supplier,1300,72000,2023-08-12"}
{"purpose": "Clean and standardize city names, business types, and date formats in telecommunications customer data.", "raw_table": "CustomerID,City,State,BusinessType,Price,LoanAmount,ServiceStartDate\n1,New_york,NY,Telecom,299.99,10000,01-15-2022\n2,los angeles,CA,tele-comm,349.5,15000,2022/02/20\n3,Chicago,IL,Telecom,NaN,12000,03-10-22\n4,Houston, TX,telecom,400,missing,2022-04-01\n5,Phoenix,,Tele-Comm,250,8000,April 5 2022\n6,philadelphia,pa,Telecom,275.00,11000,2022.06.10\n7,San-Antonio,TX,telecomm,300.25,9500,07/15/2022\n8,San_diego,CA,Tele-Comm,280,10500,2022-08-01\n9,Dallas,TX,tele-com,310,NaN,2022/09/10\n10,San jose,CA,Telecom,295.5,11500,10-12-2022\n11,Austin,Tx,telecomm,330,13000,2022-11-11\n12,Jacksonville,FL,Telecomm,320,,2022/12/01\n13,Fort Worth, TX,tele-com,310,12500,01-01-2023\n14,Columbus,OH,telecomm,275,,2023-02-15\n15,Charlotte,NC,telecom,290,9000,03-20-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens and trim spaces from City", "columnName": "City", "expression": "value.toLowercase().replace(/[_-]/g, ' ').trim().split(' ').map(w, w[0].toUppercase() + w.slice(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize State abbreviations to uppercase and trim spaces", "columnName": "State", "edits": [{"from": [" tx", "Tx", "Tx "], "to": "TX"}, {"from": [""], "to": "Unknown"}, {"from": ["pa"], "to": "PA"}, {"from": ["nc"], "to": "NC"}]}, {"op": "core/text-transform", "description": "Standardize BusinessType to 'Telecom'", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[-_]/g, '').replace('telecomm', 'telecom').replace('telecom', 'Telecom')"}, {"op": "core/mass-edit", "description": "Replace missing or invalid Price with empty string", "columnName": "Price", "edits": [{"from": ["NaN"], "to": ""}]}, {"op": "core/mass-edit", "description": "Replace missing or invalid LoanAmount with empty string or 'missing'", "columnName": "LoanAmount", "edits": [{"from": ["NaN", "missing", ""], "to": ""}]}, {"op": "core/text-transform", "description": "Normalize Price to two decimals as string", "columnName": "Price", "expression": "value == '' ? '' : Number(value).toFixed(2)"}, {"op": "core/text-transform", "description": "Normalize LoanAmount to integer string or blank", "columnName": "LoanAmount", "expression": "value == '' ? '' : String(Math.round(Number(value)))"}, {"op": "core/date-parse", "description": "Parse ServiceStartDate from various formats", "columnName": "ServiceStartDate", "format": "auto"}, {"op": "core/text-transform", "description": "Format ServiceStartDate to yyyy-MM-dd", "columnName": "ServiceStartDate", "expression": "value == null ? '' : value.toDate().toISOString().slice(0,10)"}], "clean_table": "CustomerID,City,State,BusinessType,Price,LoanAmount,ServiceStartDate\n1,New York,NY,Telecom,299.99,10000,2022-01-15\n2,Los Angeles,CA,Telecom,349.50,15000,2022-02-20\n3,Chicago,IL,Telecom,,12000,2022-03-10\n4,Houston,TX,Telecom,400.00,,2022-04-01\n5,Phoenix,Unknown,Telecom,250.00,8000,2022-04-05\n6,Philadelphia,PA,Telecom,275.00,11000,2022-06-10\n7,San Antonio,TX,Telecom,300.25,9500,2022-07-15\n8,San Diego,CA,Telecom,280.00,10500,2022-08-01\n9,Dallas,TX,Telecom,310.00,,2022-09-10\n10,San Jose,CA,Telecom,295.50,11500,2022-10-12\n11,Austin,TX,Telecom,330.00,13000,2022-11-11\n12,Jacksonville,FL,Telecom,320.00,,2022-12-01\n13,Fort Worth,TX,Telecom,310.00,12500,2023-01-01\n14,Columbus,OH,Telecom,275.00,,2023-02-15\n15,Charlotte,NC,Telecom,290.00,9000,2023-03-20"}
{"purpose": "Standardize inconsistent city names and business types, normalize date formats, and fix numeric fields for loan amounts in government grant data.", "raw_table": "City,State,BusinessType,GrantAmount,LoanAmount,ApplicationDate\nNew_york,ny,Non-profit,50000,10000,2023/01/15\nlos-angeles,CA,NonProfit,75000,15000,15-02-2023\nchicago,IL,non_profit,62000,,2023.03.10\nHouston,tx,For-Profit,83000,20000,2023-04-05\nphoenix,Az,for_profit,47000,5000,04/25/2023\nphiladelphia,PA,Non profit,54000,12000,2023/06/01\nSan Antonio,TX,FOR-PROFIT,68000,18000,2023/07/20\nsan_diego,ca,non_profit,72000,16000,2023-08-18\nDallas,TX,ForProfit,49000,11000,08-30-2023\nsan jose,CA,nonprofit,53000,13000,2023/09/15\nAustin,TX,FOR_PROFIT,61000,14000,09.25.2023\nJacksonville,FL,Non-Profit,58000,12500,2023/10/10\nfort worth,tx,for-profit,67000,17000,10-22-2023\nColumbus,OH,Non_Profit,55000,11500,2023-11-05", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens from City names", "columnName": "City", "expression": "value.replace('_', ' ').replace('-', ' ')"}, {"op": "core/text-transform", "description": "Capitalize each word in City names", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "description": "Capitalize State codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["Non-profit", "NonProfit", "non_profit", "Non profit", "non_profit", "nonprofit", "Non_Profit", "Non-Profit"], "to": "Non-Profit"}, {"from": ["For-Profit", "for_profit", "FOR-PROFIT", "ForProfit", "FOR_PROFIT", "for-profit"], "to": "For-Profit"}]}, {"op": "core/text-transform", "description": "Fill missing LoanAmount with 0", "columnName": "LoanAmount", "expression": "value == null || value == '' ? '0' : value"}, {"op": "core/text-transform", "description": "Normalize GrantAmount and LoanAmount to numeric strings without commas", "columnName": "GrantAmount", "expression": "value.replace(/,/g, '')"}, {"op": "core/text-transform", "description": "Normalize LoanAmount numeric strings", "columnName": "LoanAmount", "expression": "value.replace(/,/g, '')"}, {"op": "core/date-parse", "description": "Parse ApplicationDate to yyyy-MM-dd", "columnName": "ApplicationDate", "dateFormat": "var d = value; if(d.match(/^\\d{4}\\/\\d{2}\\/\\d{2}$/)) { return value; } else if(d.match(/^\\d{2}-\\d{2}-\\d{4}$/)) { var parts = d.split('-'); return parts[2] + '-' + parts[0] + '-' + parts[1]; } else if(d.match(/^\\d{4}\\.\\d{2}\\.\\d{2}$/)) { return value.replace(/\\./g, '-'); } else if(d.match(/^\\d{2}\\/\\d{2}\\/\\d{4}$/)) { var parts = d.split('/'); return parts[2] + '-' + parts[0] + '-' + parts[1]; } else if(d.match(/^\\d{2}\\.\\d{2}\\.\\d{4}$/)) { var parts = d.split('.'); return parts[2] + '-' + parts[0] + '-' + parts[1]; } else if(d.match(/^\\d{2}-\\d{2}-\\d{4}$/)) { var parts = d.split('-'); return parts[2] + '-' + parts[0] + '-' + parts[1]; } else { return value; }", "dateFormatHint": "yyyy-MM-dd"}], "clean_table": "City,State,BusinessType,GrantAmount,LoanAmount,ApplicationDate\nNew York,NY,Non-Profit,50000,10000,2023-01-15\nLos Angeles,CA,Non-Profit,75000,15000,2023-02-15\nChicago,IL,Non-Profit,62000,0,2023-03-10\nHouston,TX,For-Profit,83000,20000,2023-04-05\nPhoenix,AZ,For-Profit,47000,5000,2023-04-25\nPhiladelphia,PA,Non-Profit,54000,12000,2023-06-01\nSan Antonio,TX,For-Profit,68000,18000,2023-07-20\nSan Diego,CA,Non-Profit,72000,16000,2023-08-18\nDallas,TX,For-Profit,49000,11000,2023-08-30\nSan Jose,CA,Non-Profit,53000,13000,2023-09-15\nAustin,TX,For-Profit,61000,14000,2023-09-25\nJacksonville,FL,Non-Profit,58000,12500,2023-10-10\nFort Worth,TX,For-Profit,67000,17000,2023-10-22\nColumbus,OH,Non-Profit,55000,11500,2023-11-05"}
{"purpose": "Standardize city names and business types, correct date formats, and clean numeric fields in government loan application data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew york,NY,restarant,12000.5,100000,2023/01/15\nlos_angeles,ca,Healthcare,8000,85000,15-02-2023\nChIcago,IL,REtail,NaN,90000,2023.03.01\nHous-ton,TX,Construction,9500,not available,03/15/2023\nphoenix,AZ,restaurant,8500,70000,2023-04-10\nphiladelphia,pa,healtcare,7000,60000,April 20, 2023\nsan antonio,TX,Retail,7800,65000,2023/05/05\nsan-diego,CA,Construction,8200,72000,05-22-2023\nDALLAS,TX,,9000,80000,2023-06-01\nsan jose,ca,restaurant,8700,,2023/06/15\nAustin,TX,healthcare,8000,70000,06/20/2023\njacksonville,fl,Retail,7500,68000,2023-07-10\nfort worth,tx,construction,8000,71000,07.15.2023\ncolumbus,OH,Restaurant,8200,69000,2023/07/25\ncharlotte,NC,Healthcare,7800,67000,07-30-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize each word in City, fixing underscores and hyphens", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').split(' ').map(s => s.toLowerCase().capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/text-transform", "description": "Standardize BusinessType values with common spellings and capitalization", "columnName": "BusinessType", "expression": "value.toLowerCase().replace('restarant','restaurant').replace('healtcare','healthcare').replace('retail','Retail').replace('construction','Construction').capitalize()"}, {"op": "core/mass-edit", "description": "Fill missing BusinessType with 'Unknown'", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Convert Price to number, set missing or NaN to 0", "columnName": "Price", "expression": "isNaN(toNumber(value)) ? 0 : toNumber(value)"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number, replace invalid with 0", "columnName": "LoanAmount", "expression": "isNaN(toNumber(value)) ? 0 : toNumber(value)"}, {"op": "core/date-parse", "description": "Parse ApplicationDate to yyyy-MM-dd format", "columnName": "ApplicationDate", "format": "yyyy-MM-dd", "onError": "keep-original", "onNull": "keep-original"}, {"op": "core/text-transform", "description": "Fix ApplicationDate with various delimiters and formats", "columnName": "ApplicationDate", "expression": "value.match(/\\d{4}[-/.]\\d{2}[-/.]\\d{2}/) != null ? value.replace(/[./]/, '-') : \n  value.match(/\\d{2}[-/]\\d{2}[-/]\\d{4}/) != null ? \n    (let(parts = value.split(/[-\\/]/); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0')) : \n  value.match(/[A-Za-z]+ \\d{1,2}, \\d{4}/) != null ? \n    (let(d = new Date(value); d.getFullYear() + '-' + (d.getMonth()+1).toString().padStart(2,'0') + '-' + d.getDate().toString().padStart(2,'0'))) : value"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew York,NY,Restaurant,12000.5,100000,2023-01-15\nLos Angeles,CA,Healthcare,8000,85000,2023-02-15\nChicago,IL,Retail,0,90000,2023-03-01\nHous Ton,TX,Construction,9500,0,2023-03-15\nPhoenix,AZ,Restaurant,8500,70000,2023-04-10\nPhiladelphia,PA,Healthcare,7000,60000,2023-04-20\nSan Antonio,TX,Retail,7800,65000,2023-05-05\nSan Diego,CA,Construction,8200,72000,2023-05-22\nDallas,TX,Unknown,9000,80000,2023-06-01\nSan Jose,CA,Restaurant,8700,0,2023-06-15\nAustin,TX,Healthcare,8000,70000,2023-06-20\nJacksonville,FL,Retail,7500,68000,2023-07-10\nFort Worth,TX,Construction,8000,71000,2023-07-15\nColumbus,OH,Restaurant,8200,69000,2023-07-25\nCharlotte,NC,Healthcare,7800,67000,2023-07-30"}
{"purpose": "Clean and standardize city and business type names, normalize date formats, and fix numeric fields in a telecommunications loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,Telecom-Provider,5000,10000,01/15/2023\nlos angeles,CA,telecom_provider,4500,8000,2023-02-10\nChicago,IL,TelecomProvider, ,9000,15-03-2023\nhouston,TX,telcom-provider,5500, ,2023/04/01\nPHOENIX,AZ,Telecmm Provider,4800,7500,4/15/2023\nphiladelphia,PA,Telecom_Provider,4700,8500,March 20 2023\nSan antonio,TX,TelecomProvider,4600,7000,20-04-2023\nsan-diego,CA,telecom_provider,4900,8200,2023-04-25\nDallas,TX,Telecom Provider,5100,9000,April 30,2023\nsan jose,CA,Telecom_Provider,,7800,05/05/2023\nAustin,TX,telecom-provider,5300,8900,2023/05/10\nJacksonville,FL,Tele-com provider,4700,7200,May 15 2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in City", "columnName": "City", "expression": "value.replace('_', ' ').replace('-', ' ')"}, {"op": "core/text-transform", "description": "Trim and capitalize City names", "columnName": "City", "expression": "value.trim().split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1).toLowerCase()).join(' ')"}, {"op": "core/text-transform", "description": "Standardize BusinessType names", "columnName": "BusinessType", "expression": "value.toLowerCase().replace(/[-_]/g, ' ').replace(/telcmm|tele-com/, 'telecom').replace(/ +/g, ' ').trim().split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Fix missing Price values", "columnName": "Price", "edits": [{"from": [""], "to": "4800"}, {"from": [" "], "to": "4800"}]}, {"op": "core/mass-edit", "description": "Fix missing LoanAmount values", "columnName": "LoanAmount", "edits": [{"from": [""], "to": "8000"}, {"from": [" "], "to": "8000"}]}, {"op": "core/text-transform", "description": "Parse and normalize Date format to yyyy-MM-dd", "columnName": "Date", "expression": "if(isBlank(value), '', value.toDate('MM/dd/yyyy') != null ? value.toDate('MM/dd/yyyy').toString('yyyy-MM-dd') : if(value.toDate('yyyy-MM-dd') != null, value.toDate('yyyy-MM-dd').toString('yyyy-MM-dd'), if(value.toDate('dd-MM-yyyy') != null, value.toDate('dd-MM-yyyy').toString('yyyy-MM-dd'), if(value.toDate('MMMM dd yyyy') != null, value.toDate('MMMM dd yyyy').toString('yyyy-MM-dd'), if(value.toDate('MMM dd yyyy') != null, value.toDate('MMM dd yyyy').toString('yyyy-MM-dd'), '')))))"}, {"op": "core/column-rename", "description": "Rename BusinessType to ServiceType", "oldColumnName": "BusinessType", "newColumnName": "ServiceType"}], "clean_table": "City,State,ServiceType,Price,LoanAmount,Date\nNew York,NY,Telecom Provider,5000,10000,2023-01-15\nLos Angeles,CA,Telecom Provider,4500,8000,2023-02-10\nChicago,IL,Telecom Provider,4800,9000,2023-03-15\nHouston,TX,Telecom Provider,5500,8000,2023-04-01\nPhoenix,AZ,Telecom Provider,4800,7500,2023-04-15\nPhiladelphia,PA,Telecom Provider,4700,8500,2023-03-20\nSan Antonio,TX,Telecom Provider,4600,7000,2023-04-20\nSan Diego,CA,Telecom Provider,4900,8200,2023-04-25\nDallas,TX,Telecom Provider,5100,9000,2023-04-30\nSan Jose,CA,Telecom Provider,4800,7800,2023-05-05\nAustin,TX,Telecom Provider,5300,8900,2023-05-10\nJacksonville,FL,Telecom Provider,4700,7200,2023-05-15"}
{"purpose": "Standardize movie genre entries and normalize release dates and ratings for analysis.", "raw_table": "MovieTitle,Genre,ReleaseDate,Rating\nAvengers_Endgame,action,2019/04/26,8.4\nthe Godfather,Crime,03-24-1972,9.2\nJoker,drama_,2019.10.04,8.5\nToy Story 4,Animation,Jun 21 2019,8.0\nParasite,thriller,2019/05/30,8.6\nInception,SCI-FI,2010-07-16,8.8\nTitanic,romance,12/19/1997,7.8\nThe Dark Knight,action,2008-07-18,9.0\nFrozen2,animation,2019_11_22,7.3\nInterstellar,science fiction,2014-11-07,8.6\nForrest Gump,drama,07-06-1994,8.8\nThe Lion King,animation,1994/06/24,8.5\nGladiator,Action,2000/05/05,8.5\nThe Shawshank Redemption,Drama,1994/09/22,9.3", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in MovieTitle with spaces", "columnName": "MovieTitle", "expression": "value.replace(/[_-]/g, ' ').trim()"}, {"op": "core/text-transform", "description": "Capitalize genre and remove trailing underscores", "columnName": "Genre", "expression": "value.toLowerCase().replace(/_$/, '').split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize genre synonyms", "columnName": "Genre", "edits": [{"from": ["Sci-fi", "Science fiction", "Sci-Fi"], "to": "Sci-Fi"}, {"from": ["Action"], "to": "Action"}, {"from": ["Thriller"], "to": "Thriller"}, {"from": ["Drama"], "to": "Drama"}, {"from": ["Crime"], "to": "Crime"}, {"from": ["Animation"], "to": "Animation"}, {"from": ["Romance"], "to": "Romance"}]}, {"op": "core/text-transform", "description": "Parse ReleaseDate into ISO format yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "dateToString(date(value), 'yyyy-MM-dd')"}, {"op": "core/column-rename", "description": "Rename Rating column to IMDbRating", "oldColumnName": "Rating", "newColumnName": "IMDbRating"}], "clean_table": "MovieTitle,Genre,ReleaseDate,IMDbRating\nAvengers Endgame,Action,2019-04-26,8.4\nthe Godfather,Crime,1972-03-24,9.2\nJoker,Drama,2019-10-04,8.5\nToy Story 4,Animation,2019-06-21,8.0\nParasite,Thriller,2019-05-30,8.6\nInception,Sci-Fi,2010-07-16,8.8\nTitanic,Romance,1997-12-19,7.8\nThe Dark Knight,Action,2008-07-18,9.0\nFrozen2,Animation,2019-11-22,7.3\nInterstellar,Sci-Fi,2014-11-07,8.6\nForrest Gump,Drama,1994-07-06,8.8\nThe Lion King,Animation,1994-06-24,8.5\nGladiator,Action,2000-05-05,8.5\nThe Shawshank Redemption,Drama,1994-09-22,9.3"}
{"purpose": "Standardize energy provider names, fix date formats, and clean inconsistent price and loan amount fields.", "raw_table": "City,State,Provider,Price,LoanAmount,InstallationDate\nSeattle,wa,Green-Power,0.12,15,000,2023/06/15\nPortland,OR,green_power,0.15,10000,06-28-2023\nSpokane,Wa,Green Power,USD 0.13,12000,2023-07-01\nTacoma,WA,Green_Power,0.14,,7/5/2023\nEugene,or,Green-power,0.11,11000,2023.07.10\nSalem,OR,Green Power,0.14,13000,2023/07/15\nOlympia,Wa,green-power,0.13,12500,15-07-2023\nBend,OR,GreenPower,0.16,14000,2023/07/20\nVancouver,WA,Green power,0.12,13500,07/25/2023\nMedford,OR,,0.13,10500,2023-07-30\nKennewick,WA,Green-power,0.15,11500,2023/08/01\nYakima,wa,green_power,0.14,13000,August 2, 2023\nCorvallis,OR,Green-Power,0.11,11000,2023-08-05\nWalla-Walla,WA,Green Power,0.13,12500,2023/08/10\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove commas in LoanAmount to fix numeric parsing", "columnName": "LoanAmount", "expression": "value.replace(/,/, '')"}, {"op": "core/text-transform", "description": "Normalize Provider names to 'Green Power'", "columnName": "Provider", "expression": "value.toLowerCase().replace(/[-_]/g, ' ').replace(/green\\s*power/, 'Green Power')"}, {"op": "core/mass-edit", "description": "Fill missing Provider with 'Green Power'", "columnName": "Provider", "edits": [{"from": [""], "to": "Green Power"}]}, {"op": "core/text-transform", "description": "Capitalize State abbreviations", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/text-transform", "description": "Capitalize City names properly", "columnName": "City", "expression": "value.toLowerCase().split(/[- ]/).map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Remove 'USD' and spaces from Price, parse to decimal", "columnName": "Price", "expression": "value.replace(/USD\\s*/i, '').trim()"}, {"op": "core/text-transform", "description": "Parse and unify date formats in InstallationDate column", "columnName": "InstallationDate", "expression": "if(value.match(/^\\d{4}\\/\\d{2}\\/\\d{2}$/)) value.replace(/\\//g, '-')\nelse if(value.match(/^\\d{2}-\\d{2}-\\d{4}$/)) {\n  var parts = value.split('-'); parts[2] + '-' + parts[0] + '-' + parts[1]\n}\nelse if(value.match(/^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/)) {\n  var parts = value.split('/'); parts[2] + '-' + (parts[0].length==1 ? '0'+parts[0] : parts[0]) + '-' + (parts[1].length==1 ? '0'+parts[1] : parts[1])\n}\nelse if(value.match(/^\\d{4}\\.\\d{2}\\.\\d{2}$/)) value.replace(/\\./g, '-')\nelse if(value.match(/^\\d{2}-\\d{2}-\\d{4}$/)) {\n  var parts = value.split('-'); parts[2] + '-' + parts[1] + '-' + parts[0]\n}\nelse if(value.match(/^[A-Za-z]+ \\d{1,2}, \\d{4}$/)) {\n  var dateObj = new Date(value);\n  var m = (dateObj.getMonth()+1).toString().padStart(2,'0');\n  var d = dateObj.getDate().toString().padStart(2,'0');\n  var y = dateObj.getFullYear();\n  y + '-' + m + '-' + d\n}\nelse value"}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount with average (12000)", "columnName": "LoanAmount", "edits": [{"from": [""], "to": "12000"}]}], "clean_table": "City,State,Provider,Price,LoanAmount,InstallationDate\nSeattle,WA,Green Power,0.12,15000,2023-06-15\nPortland,OR,Green Power,0.15,10000,2023-06-28\nSpokane,WA,Green Power,0.13,12000,2023-07-01\nTacoma,WA,Green Power,0.14,12000,2023-07-05\nEugene,OR,Green Power,0.11,11000,2023-07-10\nSalem,OR,Green Power,0.14,13000,2023-07-15\nOlympia,WA,Green Power,0.13,12500,2023-07-15\nBend,OR,Green Power,0.16,14000,2023-07-20\nVancouver,WA,Green Power,0.12,13500,2023-07-25\nMedford,OR,Green Power,0.13,10500,2023-07-30\nKennewick,WA,Green Power,0.15,11500,2023-08-01\nYakima,WA,Green Power,0.14,13000,2023-08-02\nCorvallis,OR,Green Power,0.11,11000,2023-08-05\nWalla Walla,WA,Green Power,0.13,12500,2023-08-10\n"}
{"purpose": "Standardize movie genre names, fix inconsistent release dates, and correct box office revenue formats.", "raw_table": "MovieTitle,Genre,ReleaseDate,BoxOffice\nThe Great_adventure,Action_adventure,07/15/2019,150 Million\nLove in paris,Romance,2019-02-30,$75M\nSpace fury,science fiction,03-12-2018,100,000,000\nMystery_night,MYSTERY,2017/11/05,45m\nHer Last Wish,drama,April 5 2016,30 million\nComedy CLUB,comedy,2018-13-01,25 million\nDark_saga,action_adventure,2019/10/07,200000000\nDreams and Reality,rom-com,2017-08-25,40M\nHaunted_House,horror,10/31/2018,$60 million\nEpic Quest,Adventure,2018/07/20,Not Available\nSilent_echo,Sci-Fi,2018-06-15,$85m\nBroken_Oaths,drama_,2019-04-01,50000000\nFunny Bizz,COMEDY,2017/09/10,20M\nLove & War,romance,2016-05-30,35 million\n", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "Genre", "edits": [{"from": ["Action_adventure", "action_adventure"], "to": "Action Adventure"}, {"from": ["science fiction", "Sci-Fi", "SCI-FI"], "to": "Science Fiction"}, {"from": ["rom-com"], "to": "Romance Comedy"}, {"from": ["drama_"], "to": "Drama"}, {"from": ["MYSTERY"], "to": "Mystery"}, {"from": ["COMEDY", "comedy"], "to": "Comedy"}]}, {"op": "core/text-transform", "columnName": "Genre", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "columnName": "ReleaseDate", "expression": "value.replace(/(\\d{4})-(13|00)-\\d{2}/, '$1-12-01').replace(/(\\d{4})-(\\d{2})-(\\d{2})/, function(m, y, mth, d) { var month = parseInt(mth,10); var day = parseInt(d,10); if(month>12) return y+'-12-'+(day<10?'0'+day:day); else return m;})"}, {"op": "core/date-parse", "columnName": "ReleaseDate", "mode": "lenient", "dateFormat": "auto"}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "value.toLowercase().replace(/[\\$,]/g, '').replace(/m$/, ' million').replace(/not available/, '').trim()"}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "if(value == '', '0 million', value)"}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "value.replace(/(\\d+)\\s*million/, function(m, n) { return (parseInt(n) * 1000000).toString(); })"}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "value.replace(/(\\d{1,3}),(\\d{3}),(\\d{3})/, '$1$2$3')"}], "clean_table": "MovieTitle,Genre,ReleaseDate,BoxOffice\nThe Great_adventure,Action Adventure,2019-07-15T00:00:00Z,150000000\nLove in paris,Romance,2019-02-28T00:00:00Z,75000000\nSpace fury,Science Fiction,2018-03-12T00:00:00Z,100000000\nMystery_night,Mystery,2017-11-05T00:00:00Z,45000000\nHer Last Wish,Drama,2016-04-05T00:00:00Z,30000000\nComedy CLUB,Comedy,2018-12-01T00:00:00Z,25000000\nDark_saga,Action Adventure,2019-10-07T00:00:00Z,200000000\nDreams and Reality,Romance Comedy,2017-08-25T00:00:00Z,40000000\nHaunted_House,Horror,2018-10-31T00:00:00Z,60000000\nEpic Quest,Adventure,2018-07-20T00:00:00Z,0\nSilent_echo,Science Fiction,2018-06-15T00:00:00Z,85000000\nBroken_Oaths,Drama,2019-04-01T00:00:00Z,50000000\nFunny Bizz,Comedy,2017-09-10T00:00:00Z,20000000\nLove & War,Romance,2016-05-30T00:00:00Z,35000000"}
{"purpose": "Standardize inconsistent city and state names, fix business type typos, and parse dates and numeric fields correctly in government loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,NY,Restaurent,120000,50000,01-05-2023\nLos_Angeles,ca,retail,75000,35000,2023/02/15\nChicago,IL,RETAIL,85000,45000,3-10-2023\nhouston,Tx,Restaurent,95000,40000,04-15-23\nPHOENIX,AZ,retail,67000,30000,2023-05-01\nPhiladelphia,Pennsylvania,Retaill,102000,48000,05-20-2023\nSan-Antonio,TX,REStaurent,90000,42000,06/10/2023\nSan Diego,CA,retail,80000,39000,07-01-2023\nDallas,TX,restaurant,86000,43000,08-15-2023\nsan jose,ca,Retail,70000,35000,09-05-23\nAustin,tx,Restaurant,92000,41000,10_20_2023\nJacksonville,fl,RETAIL,69000,32000,11-11-2023\nFort Worth,Tx,restaurent,88000,44000,12-01-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names with spaces", "columnName": "City", "expression": "value.replace('_', ' ').replace('-', ' ')"}, {"op": "core/text-transform", "description": "Trim and capitalize City names properly", "columnName": "City", "expression": "value.trim().toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize State abbreviations to uppercase two-letter codes", "columnName": "State", "expression": "value.toUppercase().replace('PENNSYLVANIA', 'PA').replace('TX', 'TX').replace('FL', 'FL').replace('CA', 'CA').replace('NY', 'NY').replace('IL', 'IL').replace('AZ', 'AZ')"}, {"op": "core/mass-edit", "description": "Correct common BusinessType misspellings", "columnName": "BusinessType", "edits": [{"from": ["Restaurent", "restaurent", "REStaurent", "restaurant"], "to": "Restaurant"}, {"from": ["retail", "RETAIL", "Retaill", "Retail"], "to": "Retail"}]}, {"op": "core/text-transform", "description": "Remove underscores from Date and replace slashes with dashes", "columnName": "Date", "expression": "value.replace('_', '-').replace('/', '-')"}, {"op": "core/date-parse", "description": "Parse and unify Date into yyyy-MM-dd format", "columnName": "Date", "format": "yyyy-MM-dd"}, {"op": "core/text-transform", "description": "Remove commas or spaces in Price column and convert to number", "columnName": "Price", "expression": "value.replace(/[^0-9.]/g, '').toNumber()"}, {"op": "core/text-transform", "description": "Remove commas or spaces in LoanAmount column and convert to number", "columnName": "LoanAmount", "expression": "value.replace(/[^0-9.]/g, '').toNumber()"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,120000,50000,2023-01-05\nLos Angeles,CA,Retail,75000,35000,2023-02-15\nChicago,IL,Retail,85000,45000,2023-03-10\nHouston,TX,Restaurant,95000,40000,2023-04-15\nPhoenix,AZ,Retail,67000,30000,2023-05-01\nPhiladelphia,PA,Retail,102000,48000,2023-05-20\nSan Antonio,TX,Restaurant,90000,42000,2023-06-10\nSan Diego,CA,Retail,80000,39000,2023-07-01\nDallas,TX,Restaurant,86000,43000,2023-08-15\nSan Jose,CA,Retail,70000,35000,2023-09-05\nAustin,TX,Restaurant,92000,41000,2023-10-20\nJacksonville,FL,Retail,69000,32000,2023-11-11\nFort Worth,TX,Restaurant,88000,44000,2023-12-01"}
{"purpose": "Standardize city and state names, correct business types, and normalize financial and date formats for government grant application data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew_york,ny,resturant,35000,100000,12/5/2023\nlos-angeles,CA,Tech-startup,45000,15O000,2023-11-22\nCHICAGO,il,Construction,60000,,Nov 10 2023\nhouston,Tx,health Care,55000,120000,10-31-2023\nphoenix,az,RETAIL,40000,90000,2023/09/15\nphiladelphia,pa,Restuarant,37000,95000,2023-08-30\nsan-antonio,TX,tech_startup,48000,110000,2023.07.20\nsan diego,ca,construction,62000,105000,July 15 2023\ndallas,tx,Health-care,53000,115000,06/25/23\nsan-jose,CA,retaill,39000,85000,2023-05-10\nAustin,tx,restaurant,36000,92000,04-22-2023\njacksonville,FL,Tech-startup,47000,100000,March 30 2023\nfort worth,Tx,construction,61000,97000,2023-03-12\ncolumbus,oh,healthcare,54000,98000,02/28/2023\ncharlotte,NC,retail,41000,93000,2023-01-15", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["los-angeles"], "to": "Los Angeles"}, {"from": ["san-antonio"], "to": "San Antonio"}, {"from": ["san-jose"], "to": "San Jose"}, {"from": ["san diego"], "to": "San Diego"}, {"from": ["fort worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/mass-edit", "columnName": "State", "edits": [{"from": ["ny"], "to": "NY"}, {"from": ["CA"], "to": "CA"}, {"from": ["il"], "to": "IL"}, {"from": ["Tx"], "to": "TX"}, {"from": ["az"], "to": "AZ"}, {"from": ["pa"], "to": "PA"}, {"from": ["FL"], "to": "FL"}, {"from": ["oh"], "to": "OH"}, {"from": ["NC"], "to": "NC"}]}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["resturant", "Restuarant", "restaurant"], "to": "Restaurant"}, {"from": ["Tech-startup", "tech_startup", "Tech-startup"], "to": "Tech Startup"}, {"from": ["health Care", "Health-care", "healthcare"], "to": "Healthcare"}, {"from": ["RETAIL", "retaill", "retail"], "to": "Retail"}, {"from": ["Construction", "construction"], "to": "Construction"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.replace('_', '').replace('O','0')"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "if(value == null || value.trim() == '', '0', value.replace('O','0'))"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value.toNumber()"}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/date-parse", "columnName": "ApplicationDate", "format": "yyyy-MM-dd", "removeOriginalColumn": false, "newColumnName": "parsed_date"}, {"op": "core/text-transform", "columnName": "ApplicationDate", "expression": "if(cells['parsed_date'].value, cells['parsed_date'].value.toString('yyyy-MM-dd'), value)"}, {"op": "core/column-removal", "columnName": "parsed_date"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew York,NY,Restaurant,35000,100000,2023-12-05\nLos Angeles,CA,Tech Startup,45000,150000,2023-11-22\nChicago,IL,Construction,60000,0,2023-11-10\nHouston,TX,Healthcare,55000,120000,2023-10-31\nPhoenix,AZ,Retail,40000,90000,2023-09-15\nPhiladelphia,PA,Restaurant,37000,95000,2023-08-30\nSan Antonio,TX,Tech Startup,48000,110000,2023-07-20\nSan Diego,CA,Construction,62000,105000,2023-07-15\nDallas,TX,Healthcare,53000,115000,2023-06-25\nSan Jose,CA,Retail,39000,85000,2023-05-10\nAustin,TX,Restaurant,36000,92000,2023-04-22\nJacksonville,FL,Tech Startup,47000,100000,2023-03-30\nFort Worth,TX,Construction,61000,97000,2023-03-12\nColumbus,OH,Healthcare,54000,98000,2023-02-28\nCharlotte,NC,Retail,41000,93000,2023-01-15"}
{"purpose": "Standardize movie genre names and correct release date formats in a film dataset.", "raw_table": "MovieID,Title,Genre,ReleaseDate,BoxOffice\n1,The_Legend_of_10,Action-Adventure,2018/07/15,100000000\n2,romance_in_Paris,romance,15-08-2019,$85000000\n3,Space Odyssey,SciFi,2017-13-01,90000000\n4,Haunted-Mansion,Horror,October 31, 2016,75000000\n5,Last_Dance,Drama,20170405,60000000\n6,Ocean's-Edge,action_adventure,2019/11/10,95000000\n7,Love & War,Romantic,2018-02-30,40000000\n8,Future_World,SCI-FI,2020-05-20,$120000000\n9,Silent_Night,horor,,30000000\n10,The_Runaway,Drama,2016/12/01,55000000\n11,romance_in_paris,Romance,2019-08-15,85000000\n12,Back_to_The_Future,Sci-fi,1985-07-03,381109762\n13,Blood_Red_Hills,Horror,2017/10/31,62000000", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "Title", "expression": "replace(value, /[_-]/, ' ')"}, {"op": "core/text-transform", "columnName": "Genre", "expression": "value.toLowercase().replace('_', '').replace('-', '')"}, {"op": "core/mass-edit", "columnName": "Genre", "edits": [{"from": ["actionadventure", "action adventure", "action_adventure"], "to": "Action Adventure"}, {"from": ["romance", "romantic"], "to": "Romance"}, {"from": ["scifi", "sci-fi", "sci fi", "sci fi"], "to": "Sci-Fi"}, {"from": ["horror", "horor"], "to": "Horror"}, {"from": ["drama"], "to": "Drama"}]}, {"op": "core/date-parse", "columnName": "ReleaseDate", "expression": "if(isBlank(value), null, value)", "dateFormat": "auto"}, {"op": "core/text-transform", "columnName": "ReleaseDate", "expression": "value ? value.toDate().toString('yyyy-MM-dd') : ''"}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "value.replace(/[^0-9]/g, '')"}], "clean_table": "MovieID,Title,Genre,ReleaseDate,BoxOffice\n1,The Legend of 10,Action Adventure,2018-07-15,100000000\n2,romance in Paris,Romance,2019-08-15,85000000\n3,Space Odyssey,Sci-Fi,2017-01-13,90000000\n4,Haunted Mansion,Horror,2016-10-31,75000000\n5,Last Dance,Drama,2017-04-05,60000000\n6,Ocean's Edge,Action Adventure,2019-11-10,95000000\n7,Love & War,Romance,,40000000\n8,Future World,Sci-Fi,2020-05-20,120000000\n9,Silent Night,Horror,,30000000\n10,The Runaway,Drama,2016-12-01,55000000\n11,romance in paris,Romance,2019-08-15,85000000\n12,Back to The Future,Sci-Fi,1985-07-03,381109762\n13,Blood Red Hills,Horror,2017-10-31,62000000"}
{"purpose": "Clean and standardize city and state names, normalize business types, and fix date and numeric formats in government loan application data.", "raw_table": "City,State,BusinessType,LoanAmount,Price,ApplicationDate\nNew york,ny,retail,150000,1000.50,2023/04/21\nlos_angeles,CA,REtail,200000,2500,04-15-2023\nChicago,ill,manufacturing,175000,,2023-04-10\nhouston,TX,-service,130000,800.75,2023/13/04\nphiladelphia,pa,manufactuing,160000,1000,2023.04.12\nPhoenix,AZ,Service,120000,900,2023/04/09\nsan-antonio,tx,retail,NaN,1100,2023-04-11\nsan diego,ca,retail ,180000,1050,April 13, 2023\nDallas,Tx,service,140000,950,20230414\nsan_jose,ca,manufacturing,165000,1200,2023/04/08\nAustin,TX,Retail,155000,1000,2023-4-07\nJacksonville,fl,Service,115000,850,2023-04-15\nfort worth,TX,manufacturing,170000,1250,2023/04/10", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase().replace(/[-_]/, ' ')"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "State", "edits": [{"from": ["ILL", "FL"], "to": "IL"}]}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["retail", "REtail", "retail "], "to": "Retail"}, {"from": ["manufacturing", "manufactuing"], "to": "Manufacturing"}, {"from": ["-service", "Service", "service"], "to": "Service"}]}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value == 'NaN' ? null : value"}, {"op": "core/text-transform", "columnName": "Price", "expression": "value == '' ? null : Number(value)"}, {"op": "core/date-parse", "columnName": "ApplicationDate", "expression": "value", "onError": "set-to-blank", "mode": "lenient"}, {"op": "core/text-transform", "columnName": "ApplicationDate", "expression": "value.toString().replace(/\\./g, '-').replace(/\\//g, '-')"}, {"op": "core/date-parse", "columnName": "ApplicationDate", "expression": "value", "mode": "lenient"}], "clean_table": "City,State,BusinessType,LoanAmount,Price,ApplicationDate\nNew York,NY,Retail,150000,1000.5,2023-04-21\nLos Angeles,CA,Retail,200000,2500,2023-04-15\nChicago,IL,Manufacturing,175000,,2023-04-10\nHouston,TX,Service,130000,800.75,,\nPhiladelphia,PA,Manufacturing,160000,1000,2023-04-12\nPhoenix,AZ,Service,120000,900,2023-04-09\nSan Antonio,TX,Retail,,1100,2023-04-11\nSan Diego,CA,Retail,180000,1050,2023-04-13\nDallas,TX,Service,140000,950,2023-04-14\nSan Jose,CA,Manufacturing,165000,1200,2023-04-08\nAustin,TX,Retail,155000,1000,2023-04-07\nJacksonville,IL,Service,115000,850,2023-04-15\nFort Worth,TX,Manufacturing,170000,1250,2023-04-10"}
{"purpose": "Clean inconsistent crop names, normalize date formats, and fix numeric values in loan and price columns.", "raw_table": "FarmID,CropName,State,LoanAmount,PricePerTon,HarvestDate\n101,WHEAT,TX,50000,185.5,03-15-2023\n102, Corn ,tx,45000,one ninety,15/04/2023\n103,rICE,Tx,,170.0,2023/05/20\n104,Soy_bean,tx,40000,165.25,2023.06.10\n105,wheat,Tx-,,180,2023-07-01\n106,Corn,TX,46000,175.0,07/20/2023\n107,rice ,TX,42000, 172.5 ,2023-08-15\n108,SOYBEAN,Tx,41500,160.0,2023-09-10\n109,,TX,38000,155.0,2023-10-05\n110,Corn-tx,,43000,178.0,10-15-2023\n111,Wheat,TX,50000,182.0,2023/11/01\n112,Soybean,TX,41000,,2023-11-20\n113,RICE,TX,44000,169.0,2023-12-05", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim spaces from CropName", "columnName": "CropName", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Remove underscores and hyphens from CropName", "columnName": "CropName", "expression": "value.replace(/[_-]/g, '')"}, {"op": "core/mass-edit", "description": "Standardize CropName values", "columnName": "CropName", "edits": [{"from": ["WHEAT", "wheat", "Wheat"], "to": "Wheat"}, {"from": ["Corn", "corn", "Corn-tx"], "to": "Corn"}, {"from": ["rICE", "rice", "RICE", "rice "], "to": "Rice"}, {"from": ["Soybean", "Soy_bean", "SOYBEAN", "Soybean"], "to": "Soybean"}]}, {"op": "core/text-transform", "description": "Standardize State to uppercase TX and fix state column for row 10", "columnName": "State", "expression": "value==null||value=='' ? 'TX' : value.toUpperCase().replace(/-.*$/, '')"}, {"op": "core/text-transform", "description": "Parse PricePerTon to numeric, replace non-numeric values with null", "columnName": "PricePerTon", "expression": "if(value.toNumber()!=null && !isNaN(value.toNumber())) value.toNumber() else null"}, {"op": "core/mass-edit", "description": "Fix 'one ninety' to 190 in PricePerTon", "columnName": "PricePerTon", "edits": [{"from": ["one ninety"], "to": "190"}]}, {"op": "core/text-transform", "description": "Replace missing LoanAmount with null", "columnName": "LoanAmount", "expression": "value==null||value=='' ? null : value.toNumber()"}, {"op": "core/date-parse", "description": "Parse HarvestDate to ISO format yyyy-MM-dd", "columnName": "HarvestDate", "options": {"mode": "normal", "dateFormat": "auto"}}, {"op": "core/mass-edit", "description": "Fill missing CropName in row 9 with previous valid", "columnName": "CropName", "edits": [{"from": [""], "to": "Soybean"}]}], "clean_table": "FarmID,CropName,State,LoanAmount,PricePerTon,HarvestDate\n101,Wheat,TX,50000,185.5,2023-03-15\n102,Corn,TX,45000,190,2023-04-15\n103,Rice,TX,null,170,2023-05-20\n104,Soybean,TX,40000,165.25,2023-06-10\n105,Wheat,TX,null,180,2023-07-01\n106,Corn,TX,46000,175,2023-07-20\n107,Rice,TX,42000,172.5,2023-08-15\n108,Soybean,TX,41500,160,2023-09-10\n109,Soybean,TX,38000,155,2023-10-05\n110,Corn,TX,43000,178,2023-10-15\n111,Wheat,TX,50000,182,2023-11-01\n112,Soybean,TX,41000,null,2023-11-20\n113,Rice,TX,44000,169,2023-12-05"}
{"purpose": "Clean and standardize movie release data including titles, dates, genres, and box office revenues.", "raw_table": "Movie_Title,Release_Date,Genre,Box_Office,$ Rating\n\"the avengerS\",\"2012-05-04\",\"Action-Adventure\",\"$623,357,910\",\"8.0\"\n\"inception\",\"07/16/2010\",\"Sci-fi\",\"$829,895,144\",\"8.8\"\n\"star-wars: episode IV\",\"1977/05/25\",\"sci Fi\",\"$775,398,007\",\"8.6\"\n\"the godfather\",\"03-24-1972\",\"Drama_crime\",\"$134,966,411\",\"9.2\"\n\"frozen\",\"2013.11.27\",\"Animation\",\"$400,738,009\",\"7.5\"\n\"joker\",\"10/02/2019\",\"Drama, crime\",\"$1074,251,311\",\"8.4\"\n\"parasite\",\"2019-05-30\",\"thrill-er\",\"$258,795,834\",\"8.6\"\n\"the dark_knight\",\"2008/07/18\",\"Action - adventure\",\"$1,005,973,645\",\"9.0\"\n\"avengers: endgame\",\"2019.04.26\",\"Action/Adventure\",\"$2,798,000,000\",\"8.4\"\n\"titanic\",\"12-19-1997\",\"Romance\",\"$2,187,463,944\",\"7.8\"\n\"the shawshank redemption\",\"1994/09/22\",\"Drama\",\"$28,341,469\",\"9.3\"\n\"la la land\",\"12-09-2016\",\"Musical-Romance\",\"$446,124,517\",\"8.0\"\n\"the matrix\",\"1999-03-31\",\"Sci-Fi\",\"$465,343,787\",\"8.7\"", "cleaning_workflow": [{"op": "core/column-rename", "oldColumnName": "Movie_Title", "newColumnName": "Title"}, {"op": "core/column-rename", "oldColumnName": "$ Rating", "newColumnName": "Rating"}, {"op": "core/text-transform", "columnName": "Title", "expression": "value.toTitlecase().replaceAll(/[-_]/, ' ')"}, {"op": "core/text-transform", "columnName": "Release_Date", "expression": "value.replace(/\\./, '-').replace(/\\//, '-').replace(/(\\d{2})-(\\d{2})-(\\d{4})/, '$3-$1-$2')"}, {"op": "core/date-parse", "columnName": "Release_Date", "expression": "value", "onError": "keep-original", "guessCellType": true}, {"op": "core/text-transform", "columnName": "Genre", "expression": "value.toLowercase().replace(/[-_,\\/]/g, ' ').split(' ').filter(s => s.length>0).map(s => s.capitalize()).join(', ')"}, {"op": "core/text-transform", "columnName": "Box_Office", "expression": "value.replace(/[^\\d]/g, '').replace(/^$/, '0')"}, {"op": "core/text-transform", "columnName": "Box_Office", "expression": "parseInt(value)", "onError": "set-to-blank"}, {"op": "core/text-transform", "columnName": "Rating", "expression": "value.toNumber()"}], "clean_table": "Title,Release_Date,Genre,Box_Office,Rating\nThe Avengers,2012-05-04,Action, Adventure,623357910,8\nInception,2010-07-16,Sci Fi,829895144,8.8\nStar Wars: Episode Iv,1977-05-25,Sci Fi,775398007,8.6\nThe Godfather,1972-03-24,Drama, Crime,134966411,9.2\nFrozen,2013-11-27,Animation,400738009,7.5\nJoker,2019-10-02,Drama, Crime,1074251311,8.4\nParasite,2019-05-30,Thriller,258795834,8.6\nThe Dark Knight,2008-07-18,Action, Adventure,1005973645,9\nAvengers: Endgame,2019-04-26,Action, Adventure,2798000000,8.4\nTitanic,1997-12-19,Romance,2187463944,7.8\nThe Shawshank Redemption,1994-09-22,Drama,28341469,9.3\nLa La Land,2016-12-09,Musical, Romance,446124517,8\nThe Matrix,1999-03-31,Sci Fi,465343787,8.7"}
{"purpose": "Standardize city and business names, fix date formats, and clean numeric fields in energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york, NY,solar-Installer,12000,15000,01/15/2023\nlos Angeles,CA,Wind_turbine Co,11000,missing,2023-02-30\nhouston,tx,Solar installer,13000.5,14000,2/28/2023\nchicago, IL,solar_installer,12,000,16000,03/15/23\nphoenix,AZ,Wind turbine co,11500,15500,15/03/2023\nphiladelphia,pa,Solar Installer,11800,14800,2023/04/01\nsan-antonio,TX,Wind Turbine Co,missing,15000,2023-04-15\nsan diego,ca,solar Installer,12500,14900,04-20-2023\ndallas,TX,Solar-installer,12700,14700,2023.05.01\nsan jose, CA,Wind_turbine co,11900,15200,May 05 2023\n,aZ,Solar Installer,12000,15300,2023-06-01\nAustin,TX,wind turbine Co,11850,missing,06/15/2023\njacksonville,fl,Solar Installer,12100,15100,2023/06/20\nfort-worth,tx,solar_installer,12300,15000,2023-07-01\ncolumbus,OH,wind turbine Co,11500,14950,07/10/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from all text cells in City", "columnName": "City", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Capitalize City names properly", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/mass-edit", "description": "Fix missing or inconsistent state abbreviations", "columnName": "State", "edits": [{"from": [" missing", "missing", "missing "], "to": ""}, {"from": ["aZ"], "to": "AZ"}]}, {"op": "core/text-transform", "description": "Standardize BusinessType to 'Solar Installer' or 'Wind Turbine Co'", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[_-]/, ' ').replace(/\\s+/g, ' ').trim() == 'solar installer' ? 'Solar Installer' : (value.toLowercase().replace(/[_-]/, ' ').replace(/\\s+/g, ' ').trim() == 'wind turbine co' ? 'Wind Turbine Co' : value)"}, {"op": "core/text-transform", "description": "Remove commas and convert Price to number", "columnName": "Price", "expression": "value.replace(/,/g, '').toNumber()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number, set missing to null", "columnName": "LoanAmount", "expression": "value.toLowercase() == 'missing' ? null : value.toNumber()"}, {"op": "core/date-parse", "description": "Parse Date column into standard yyyy-MM-dd format", "columnName": "Date", "dateFormat": "auto-detect"}, {"op": "core/mass-edit", "description": "Fix invalid dates (like 2023-02-30) to closest valid date", "columnName": "Date", "edits": [{"from": ["2023-02-30"], "to": "2023-02-28"}]}, {"op": "core/fill-down", "description": "Fill down missing City values", "columnName": "City"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installer,12000,15000,2023-01-15\nLos Angeles,CA,Wind Turbine Co,11000,,2023-02-28\nHouston,TX,Solar Installer,13000.5,14000,2023-02-28\nChicago,IL,Solar Installer,12000,16000,2023-03-15\nPhoenix,AZ,Wind Turbine Co,11500,15500,2023-03-15\nPhiladelphia,PA,Solar Installer,11800,14800,2023-04-01\nSan Antonio,TX,Wind Turbine Co,,15000,2023-04-15\nSan Diego,CA,Solar Installer,12500,14900,2023-04-20\nDallas,TX,Solar Installer,12700,14700,2023-05-01\nSan Jose,CA,Wind Turbine Co,11900,15200,2023-05-05\nSan Jose,AZ,Solar Installer,12000,15300,2023-06-01\nAustin,TX,Wind Turbine Co,11850,,2023-06-15\nJacksonville,FL,Solar Installer,12100,15100,2023-06-20\nFort Worth,TX,Solar Installer,12300,15000,2023-07-01\nColumbus,OH,Wind Turbine Co,11500,14950,2023-07-10"}
{"purpose": "Standardize inconsistent city and state names, correct business types, and fix date and numeric formats in government loan data.", "raw_table": "City,State,BusinessType,LoanAmount,Price,Date\nNew_york,NY,resturant,10000,500000,01/15/2021\nlos-angeles,ca,Retail,15000, 750000,2021-02-30\nChicago,IL,restuarant,20000,,03/10/21\nhouston,Tx,retail,18000,600000,2021/04/01\nPHOENIX,az,Resturant,21000,850000,04-15-2021\nphiladelphia,PA,RETAIL,16000,700000,2021.05.10\nSan_Antonio,tx,restaurant,17000,650000,2021-06-20\nSan Diego,CA,resturant,15500,620000,2021-07-15\nDallas,tx,RETAIL,14000,580000,July 20, 2021\nSan_Jose,CA,resturant,16500,670000,2021/08/25\nAustin,TX,Retail,-,600000,2021-09-05\nJacksonville,fl,Retail,13000,550000,2021-10-12\nFort-Worth,TX,resturant,12500,,-\nColumbus,OH,RETAIL,13500,590000,2021-11-30\nCharlotte,NC,restaurant,12000,560000,12/01/2021", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["los-angeles"], "to": "Los Angeles"}, {"from": ["San_Antonio"], "to": "San Antonio"}, {"from": ["San_Jose"], "to": "San Jose"}, {"from": ["Fort-Worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1).toLowerCase()).join(' ')", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUpperCase()", "onError": "keep-original"}, {"op": "core/mass-edit", "columnName": "State", "edits": [{"from": ["CA"], "to": "CA"}, {"from": ["Tx", "tx"], "to": "TX"}, {"from": ["fl"], "to": "FL"}, {"from": ["az"], "to": "AZ"}]}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["resturant", "restuarant", "Resturant", "resturant", "resturant", "resturant"], "to": "Restaurant"}, {"from": ["RETAIL", "Retail", "retail"], "to": "Retail"}, {"from": ["restaurant"], "to": "Restaurant"}]}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value.trim()=='' || value=='-' ? null : Number(value)", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.trim()=='' ? null : Number(value.replace(/\\s+/g, ''))", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value == '-' || value.trim() == '' ? null : value", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value != null ? (value.match(/^(\\d{4})-(\\d{2})-(\\d{2})$/) ? (new Date(value).toISOString().slice(0,10)) : \n(value.match(/^(\\d{2})\\/(\\d{2})\\/(\\d{4})$/) ? (new Date(value.split('/').reverse().join('-')).toISOString().slice(0,10)) :\n(value.match(/^(\\d{2})-(\\d{2})-(\\d{4})$/) ? (new Date(value.split('-').reverse().join('-')).toISOString().slice(0,10)) :\n(value.match(/^(\\d{4})\\.(\\d{2})\\.(\\d{2})$/) ? (new Date(value.replace(/\\./g,'-')).toISOString().slice(0,10)) :\n(value.match(/^\\w+ \\d{1,2}, \\d{4}$/) ? (new Date(value).toISOString().slice(0,10)) : null)))))) : null", "onError": "keep-original"}, {"op": "core/mass-edit", "columnName": "Date", "edits": [{"from": ["2021-02-30"], "to": "2021-02-28"}]}], "clean_table": "City,State,BusinessType,LoanAmount,Price,Date\nNew York,NY,Restaurant,10000,500000,2021-01-15\nLos Angeles,CA,Retail,15000,750000,2021-02-28\nChicago,IL,Restaurant,20000,,2021-03-10\nHouston,TX,Retail,18000,600000,2021-04-01\nPhoenix,AZ,Restaurant,21000,850000,2021-04-15\nPhiladelphia,PA,Retail,16000,700000,2021-05-10\nSan Antonio,TX,Restaurant,17000,650000,2021-06-20\nSan Diego,CA,Restaurant,15500,620000,2021-07-15\nDallas,TX,Retail,14000,580000,2021-07-20\nSan Jose,CA,Restaurant,16500,670000,2021-08-25\nAustin,TX,Retail,null,600000,2021-09-05\nJacksonville,FL,Retail,13000,550000,2021-10-12\nFort Worth,TX,Restaurant,12500,,null\nColumbus,OH,Retail,13500,590000,2021-11-30\nCharlotte,NC,Restaurant,12000,560000,2021-12-01"}
{"purpose": "Standardize city names, business types, and correct date and numeric formats for energy loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew_york,ny,solar-Power,50000,100000,2023/01/15\nSan-Francisco,CA,Wind Energy ,75000,abc,15-02-2023\nhouston,TX,solar_power,60000,120000,02/28/2023\nlosAngeles,Ca,Hydro-power,55000,110000,2023-03-10\nchicago,IL,wind Energy,NaN,90000,2023.04.05\nPHILADELPHIA,pa,solar-power,48000,95000,2023/5/20\nphoenix,AZ, Wind-Energy,65000,,2023-06-15\nSan diego,ca,solar_power,52000,105000,2023-07-01\nDallas,TX,Hydropower,53000,100000,July 15 2023\nAustin,tx,solar power,49000,98000,2023-08-10\njacksonville,fl,Wind_Energy,70000,115000,2023/09/05\nFort Worth,TX,hydro-Power,54000,102000,09/20/2023\nColumbus,oh,solarPower,51000,97000,2023-10-01\ncharlotte,NC,wind_energy,68000,112000,2023-11-11", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize City names properly and remove underscores/hyphens", "columnName": "City", "expression": "value.toLowercase().replace(/[_-]/, ' ').split(' ').map(s, s.substring(0,1).toUppercase() + s.substring(1)).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Standardize BusinessType: remove underscores/hyphens and capitalize each word", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[_-]/g, ' ').split(' ').map(s, s.substring(0,1).toUppercase() + s.substring(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Correct LoanAmount non-numeric and missing values", "columnName": "LoanAmount", "edits": [{"from": ["abc", "NaN", ""], "to": "0"}]}, {"op": "core/text-transform", "description": "Convert Price to numeric, set non-numeric or missing as 0", "columnName": "Price", "expression": "isNumeric(value) ? value : '0'"}, {"op": "core/date-parse", "description": "Parse Date column into ISO format", "columnName": "Date", "options": {"format": "auto-detect", "mode": "lenient"}}, {"op": "core/text-transform", "description": "Format Date as yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Power,50000,100000,2023-01-15\nSan Francisco,CA,Wind Energy,75000,0,2023-02-15\nHouston,TX,Solar Power,60000,120000,2023-02-28\nLos Angeles,CA,Hydro Power,55000,110000,2023-03-10\nChicago,IL,Wind Energy,0,90000,2023-04-05\nPhiladelphia,PA,Solar Power,48000,95000,2023-05-20\nPhoenix,AZ,Wind Energy,65000,0,2023-06-15\nSan Diego,CA,Solar Power,52000,105000,2023-07-01\nDallas,TX,Hydropower,53000,100000,2023-07-15\nAustin,TX,Solar Power,49000,98000,2023-08-10\nJacksonville,FL,Wind Energy,70000,115000,2023-09-05\nFort Worth,TX,Hydro Power,54000,102000,2023-09-20\nColumbus,OH,Solar Power,51000,97000,2023-10-01\nCharlotte,NC,Wind Energy,68000,112000,2023-11-11"}
{"purpose": "Clean and normalize farm loan application data including city names, price and date formats, and business types.", "raw_table": "FarmID,City,State,BusinessType,Price,LoanAmount,ApplicationDate\n101,san jose,CA,vegetable-farm,15000,12000,01/15/2023\n102,LOS_angeles,ca,fruit-Orchard, 20000 , 18000 ,2023-02-30\n103,Sacramento,CA,cattle-farm,14000,missing,2023/03/05\n104,Fresno_ca,CA,Vegetable_farm, thirteen thousand, 13000,03-20-2023\n105,Bakersfield,ca,fruit orchard,16000,15000,2023.04.10\n106,Stockton,CA,CATTLE FARM, 17000,16500, 2023-05-12\n107,san jose,ca,vegetable_farm,15,000 , 12500 ,2023-06-01\n108,los angeles,CA,Fruit-Orchard,19000,,2023/07/15\n109,Fresno,CA,vegetable-farm,15500,14000,2023-08-05\n110,Bakersfield,CA,fruit_orchard,$16500,16000,August 15, 2023\n111,Stockton,CA,cattle_farm,18000,17500,2023-09-10\n112,Sacramento,ca,Cattle-farm,17000,16800,2023-10-01\n113,San Jose,CA,vegetable farm,15200,13000,2023-11-05\n114,LOS ANGELES,CA,fruit orchard,19500,18500,2023-12-12\n115,,CA,cattle-farm,17800,17200,2023-12-31", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["san jose", "San Jose", "San Jose", "san jose"], "to": "San Jose"}, {"from": ["los angeles", "LOS_angeles", "LOS ANGELES", "LOS ANGELES", "LOS ANGELES"], "to": "Los Angeles"}, {"from": ["fresno_ca", "Fresno", "Fresno_ca"], "to": "Fresno"}, {"from": ["bakersfield", "Bakersfield"], "to": "Bakersfield"}, {"from": ["stockton", "Stockton"], "to": "Stockton"}, {"from": ["sacramento", "Sacramento"], "to": "Sacramento"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["vegetable-farm", "Vegetable_farm", "vegetable_farm", "vegetable farm"], "to": "Vegetable Farm"}, {"from": ["fruit-Orchard", "fruit orchard", "Fruit-Orchard", "fruit_orchard", "Fruit orchard"], "to": "Fruit Orchard"}, {"from": ["cattle-farm", "CATTLE FARM", "cattle_farm", "Cattle-farm"], "to": "Cattle Farm"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.toString().replace(/\\$|,/g, '').toLowerCase()", "onError": "keep-original", "repeat": false}, {"op": "core/mass-edit", "columnName": "Price", "edits": [{"from": ["thirteen thousand"], "to": "13000"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.match(/^[0-9]+$/) ? value : null", "onError": "set-to-null", "repeat": false}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value.toString().replace(/\\s|,/g, '')", "onError": "keep-original"}, {"op": "core/mass-edit", "columnName": "LoanAmount", "edits": [{"from": ["missing", ""], "to": null}]}, {"op": "core/date-parse", "columnName": "ApplicationDate", "format": "yyyy-MM-dd", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "ApplicationDate", "expression": "if(value == '2023-02-30', '2023-02-28', value)", "onError": "keep-original"}, {"op": "core/date-parse", "columnName": "ApplicationDate", "format": "yyyy-MM-dd", "onError": "keep-original"}], "clean_table": "FarmID,City,State,BusinessType,Price,LoanAmount,ApplicationDate\n101,San Jose,CA,Vegetable Farm,15000,12000,2023-01-15\n102,Los Angeles,CA,Fruit Orchard,20000,18000,2023-02-28\n103,Sacramento,CA,Cattle Farm,14000,,2023-03-05\n104,Fresno,CA,Vegetable Farm,13000,13000,2023-03-20\n105,Bakersfield,CA,Fruit Orchard,16000,15000,2023-04-10\n106,Stockton,CA,Cattle Farm,17000,16500,2023-05-12\n107,San Jose,CA,Vegetable Farm,15000,12500,2023-06-01\n108,Los Angeles,CA,Fruit Orchard,19000,,2023-07-15\n109,Fresno,CA,Vegetable Farm,15500,14000,2023-08-05\n110,Bakersfield,CA,Fruit Orchard,16500,16000,2023-08-15\n111,Stockton,CA,Cattle Farm,18000,17500,2023-09-10\n112,Sacramento,CA,Cattle Farm,17000,16800,2023-10-01\n113,San Jose,CA,Vegetable Farm,15200,13000,2023-11-05\n114,Los Angeles,CA,Fruit Orchard,19500,18500,2023-12-12\n115,Unknown,CA,Cattle Farm,17800,17200,2023-12-31"}
{"purpose": "Clean and standardize movie rental transaction records with inconsistent formatting and missing values.", "raw_table": "CustomerID,Movie_Title,Rental_Date,Return_Date,Price,Payment_Method\nCUST_001,The Matrix,3/15/21,3/22/21,4.99,credit_card\ncust002,Avengers-Endgame,2021-03-16,,five dollars,PayPal\nCUST-003,Inception,15-Mar-2021,22-Mar-2021,4.99,CASH\ncust004,interstellar,03/17/2021,03/24/21,4.99,Credit-Card\nCUST005,The_Matrix,March 18 2021,March 25 2021,4.99,credit card\ncust006,Avengers Endgame,2021/03/19,2021/03/26,$4.99,pay pal\nCUST007,,2021-03-20,2021-03-27,4.99,Cash\ncust008,Inception,03-21-2021,03-28-2021,four.ninety nine,CREDITCARD\ncust009,Interstellar,20210322,20210329,4.99,CreditCard\ncust_010,The Matrix,2021.03.23,2021.03.30,4.99,CreditCard\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize all movie titles consistently and remove underscores/hyphens", "columnName": "Movie_Title", "expression": "value.toLowercase().replace(/[_-]/, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize Payment_Method values", "columnName": "Payment_Method", "edits": [{"from": ["credit_card", "Credit-Card", "credit card", "CREDITCARD", "CreditCard"], "to": "Credit Card"}, {"from": ["PayPal", "pay pal"], "to": "PayPal"}, {"from": ["CASH", "Cash"], "to": "Cash"}]}, {"op": "core/date-parse", "description": "Parse Rental_Date to ISO format yyyy-MM-dd", "columnName": "Rental_Date", "format": "auto"}, {"op": "core/date-parse", "description": "Parse Return_Date to ISO format yyyy-MM-dd", "columnName": "Return_Date", "mode": "lenient", "format": "auto"}, {"op": "core/text-transform", "description": "Fix Price: convert textual and symbol prices to numeric string format", "columnName": "Price", "expression": "value.toLowercase() == 'five dollars' ? '5.00' : value.toLowercase() == 'four.ninety nine' ? '4.99' : value.replace(/[^0-9.]/g, '')"}, {"op": "core/mass-edit", "description": "Fill missing Movie_Title with previous row value", "columnName": "Movie_Title", "edits": []}, {"op": "core/fill-down", "description": "Fill missing Movie_Title values downwards", "columnName": "Movie_Title"}, {"op": "core/text-transform", "description": "Standardize CustomerID capitalization and underscores", "columnName": "CustomerID", "expression": "value.toUppercase().replace(/[-]/g, '_')"}], "clean_table": "CustomerID,Movie_Title,Rental_Date,Return_Date,Price,Payment_Method\nCUST_001,The Matrix,2021-03-15,2021-03-22,4.99,Credit Card\nCUST_002,Avengers Endgame,2021-03-16,,5.00,PayPal\nCUST_003,Inception,2021-03-15,2021-03-22,4.99,Cash\nCUST_004,Interstellar,2021-03-17,2021-03-24,4.99,Credit Card\nCUST_005,The Matrix,2021-03-18,2021-03-25,4.99,Credit Card\nCUST_006,Avengers Endgame,2021-03-19,2021-03-26,4.99,PayPal\nCUST_007,Avengers Endgame,2021-03-20,2021-03-27,4.99,Cash\nCUST_008,Inception,2021-03-21,2021-03-28,4.99,Credit Card\nCUST_009,Interstellar,2021-03-22,2021-03-29,4.99,Credit Card\nCUST_010,The Matrix,2021-03-23,2021-03-30,4.99,Credit Card\n"}
{"purpose": "Clean and standardize farm loan application data including city names, business types, prices, and dates.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nSpringField,il,FArm-Produce,12000,15000,2023/01/15\ngreen-valley,CA,CattleFarm,8000,9000,15-02-2023\nRedHill,,Fruit-Farming,NaN,7000,2023-03-10\nMaple_town,NY,grainfarm,10000,,2023.04.05\noakville,Oh,VegetableFarm ,9500,11000,Apr 20 2023\nlakeside,tx,farmProduce,8500,8500,2023/05/05\npine-city,fl,Cattle_FArm,7000,7500,05/15/2023\nbayview,CA,,6500,6000,2023-06-30\nhilltop,tx,Vegetable-farm,rich,12000,2023/07/25\ncopperton,ny,FruitFarm,7800,NaN,2023-08-05\nnorth-bay,IL,Grain_farm,9000,9500,2023-09-01\nredwood,ca,cattlefarm,7300,7000,2023-10-10\nwillowcreek,TX,FarmProduce,10000,10500,2023-11-15\nelmwood,IL,vegetableFarm,8800,9000,2023-12-05\npinehill,NY,fruit-farming,8100,8000,2023/12/20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize City names properly and replace underscores or hyphens with spaces", "columnName": "City", "expression": "value.replace(/[-_]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Capitalize State codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix missing or empty State values", "columnName": "State", "edits": [{"from": [""], "to": "Unknown"}, {"from": ["NaN"], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Standardize BusinessType values and fix inconsistent capitalization and separators", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[-_]/g, ' ').trim().split(' ').map(w, w[0].toUppercase() + w.slice(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Fix common BusinessType misspellings and variations", "columnName": "BusinessType", "edits": [{"from": ["Farm produce", "Farmproduce", "FArm produce", "Farm produce "], "to": "Farm Produce"}, {"from": ["Cattle farm", "Cattlefarm", "Cattle Farm", "Cattle Farm "], "to": "Cattle Farm"}, {"from": ["Fruit farming", "Fruit farm", "Fruitfarm"], "to": "Fruit Farming"}, {"from": ["Grain farm", "Grainfarm"], "to": "Grain Farm"}, {"from": ["Vegetable farm", "Vegetablefarm", "Vegetable Farm"], "to": "Vegetable Farm"}]}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numeric, replace non-numeric with null", "columnName": "Price", "expression": "if(value.toNumber() == null || isNaN(value.toNumber()), null, value.toNumber())"}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numeric, replace non-numeric with null", "columnName": "LoanAmount", "expression": "if(value.toNumber() == null || isNaN(value.toNumber()), null, value.toNumber())"}, {"op": "core/mass-edit", "description": "Fix 'rich' typo in Price column to null", "columnName": "Price", "edits": [{"from": ["rich"], "to": null}]}, {"op": "core/date-parse", "description": "Parse ApplicationDate into ISO format yyyy-MM-dd", "columnName": "ApplicationDate", "dateFormat": "auto", "mode": "lenient", "onError": "keep-original", "newColumn": false}, {"op": "core/mass-edit", "description": "Fix missing BusinessType to 'Unknown'", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Unknown"}, {"from": ["null"], "to": "Unknown"}]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nSpringfield,IL,Farm Produce,12000,15000,2023-01-15\nGreen Valley,CA,Cattle Farm,8000,9000,2023-02-15\nRed Hill,Unknown,Fruit Farming,,7000,2023-03-10\nMaple Town,NY,Grain Farm,10000,,2023-04-05\nOakville,OH,Vegetable Farm,9500,11000,2023-04-20\nLakeside,TX,Farm Produce,8500,8500,2023-05-05\nPine City,FL,Cattle Farm,7000,7500,2023-05-15\nBayview,CA,Unknown,6500,6000,2023-06-30\nHilltop,TX,Vegetable Farm,,12000,2023-07-25\nCopperton,NY,Fruit Farming,7800,,2023-08-05\nNorth Bay,IL,Grain Farm,9000,9500,2023-09-01\nRedwood,CA,Cattle Farm,7300,7000,2023-10-10\nWillowcreek,TX,Farm Produce,10000,10500,2023-11-15\nElmwood,IL,Vegetable Farm,8800,9000,2023-12-05\nPinehill,NY,Fruit Farming,8100,8000,2023-12-20"}
{"purpose": "Clean and standardize energy consumption records with inconsistent city names, date formats, and numeric values.", "raw_table": "City,State,BusinessType,Price_per_kWh,Loan_Amount,Date_Installed\nnew-york,ny,industrial,0.12,10000,12/05/2021\nLos_Angeles,CA,Residential,0,5000,2021-07-15\nchicago,IL,INDUSTRIAL,,15000,15-08-2020\nhouston,tx,residential,0.11,na,2020/09/30\nphoenix,AZ,Commercial,0.10,8000,2021.10.01\nphiladelPhia,pa,commercial,0.09,7500,Oct 5 2021\nsan-antonio,TX,Residential,zero,4200,2021-03-12\nsan diego,CA,Industrial,0.13,13000,2021/12/01\ndallas,tx,commercial,0.08,7000,11-11-2020\nsan_jose,CA,Residential,0.11,6000,2020-04-22\nAustin,TX,Commercial,0.1,9000,2021-06-30\njacksonville,fl,industrial,0.12,11000,07/04/2021\nfort-worth,TX,residential,0.1,6500,2020-10-15\ncolumbus,OH,Commercial,0.09,,2021-01-25", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize city names by replacing underscores and hyphens with spaces and capitalize each word", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').split(' ').map(s, s.toLowerCase().capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Fix known misspellings and inconsistent capitalization in State column", "columnName": "State", "edits": [{"from": ["ny"], "to": "NY"}, {"from": ["pa"], "to": "PA"}, {"from": ["tx"], "to": "TX"}, {"from": ["fl"], "to": "FL"}, {"from": ["oh"], "to": "OH"}]}, {"op": "core/mass-edit", "description": "Normalize BusinessType values to Title Case", "columnName": "BusinessType", "edits": [{"from": ["industrial", "INDUSTRIAL", "Industrial"], "to": "Industrial"}, {"from": ["residential", "Residential"], "to": "Residential"}, {"from": ["commercial", "Commercial"], "to": "Commercial"}]}, {"op": "core/text-transform", "description": "Convert 'zero' and '0' in Price_per_kWh to numeric 0.00 and blanks to null", "columnName": "Price_per_kWh", "expression": "if(value.toLowerCase() == 'zero' || value == '0', '0.00', if(value == '', null, value))"}, {"op": "core/text-transform", "description": "Make sure Loan_Amount is numeric, replace 'na' or blank with null", "columnName": "Loan_Amount", "expression": "if(value.toLowerCase() == 'na' || value == '', null, value)"}, {"op": "core/date-parse", "description": "Parse Date_Installed into ISO format yyyy-MM-dd", "columnName": "Date_Installed", "format": "auto"}, {"op": "core/text-transform", "description": "Capitalize first letter of each word in City after replacement", "columnName": "City", "expression": "value.split(' ').map(s, s.toLowerCase().capitalize()).join(' ')"}], "clean_table": "City,State,BusinessType,Price_per_kWh,Loan_Amount,Date_Installed\nNew York,NY,Industrial,0.12,10000,2021-12-05\nLos Angeles,CA,Residential,0.00,5000,2021-07-15\nChicago,IL,Industrial,,15000,2020-08-15\nHouston,TX,Residential,0.11,,2020-09-30\nPhoenix,AZ,Commercial,0.10,8000,2021-10-01\nPhiladelphia,PA,Commercial,0.09,7500,2021-10-05\nSan Antonio,TX,Residential,0.00,4200,2021-03-12\nSan Diego,CA,Industrial,0.13,13000,2021-12-01\nDallas,TX,Commercial,0.08,7000,2020-11-11\nSan Jose,CA,Residential,0.11,6000,2020-04-22\nAustin,TX,Commercial,0.10,9000,2021-06-30\nJacksonville,FL,Industrial,0.12,11000,2021-07-04\nFort Worth,TX,Residential,0.10,6500,2020-10-15\nColumbus,OH,Commercial,0.09,,2021-01-25"}
{"purpose": "Clean and standardize movie dataset with inconsistent titles, genres, release dates, and ratings.", "raw_table": "MovieID,Title,Genre,ReleaseDate,IMDB_Rating,BoxOffice\n1,The_avenger,action,07-04-2019,8.1,$1,518,812,988\n2,parasite,Drama,2019/05/30,8.6,257000000\n3,Inception , Sci-Fi ,16/07/2010,8.8,$829895144\n4,Joker,drama,10-10-2019,8.4,1074251311\n5,interstellar,SCI-FI,2014-11-07,N/A,$677471339\n6,Avengers: Endgame,Action ,2019-04-26,8.4,2797800564\n7,The godfather,Crime,24-03-1972,9.2,$246120986\n8,The_dark_knight,Action,18/07/2008,9.0,1004558444\n9,paras1te,Drama,2019-05-30,8.6,257000000\n10,Incepton,Sci-fi,07/16/2010,8.8,829895144\n11,,Comedy,2015-05-15,7.1,150000000\n12,Titanic,romance,1997/12/19,7.8,2187463944\n13,The Lion King,Animation ,24-06-1994,8.5,$968483777\n14,Avengers_Endgame,Action,2019-04-26,8.4,2797800564", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and fix capitalization in Title", "engineConfig": {"facets": []}, "columnName": "Title", "expression": "if(value == null or value == \"\") null else value.trim().split('_').join(' ').split(':').join(': ').replace(/\\s+/,' ').titleCase()"}, {"op": "core/mass-edit", "description": "Fix misspellings and unify Titles", "columnName": "Title", "edits": [{"from": ["Paras1te"], "to": "Parasite"}, {"from": ["Incepton"], "to": "Inception"}, {"from": ["Avengers Endgame", "Avengers_Endgame", "The avenger"], "to": "Avengers: Endgame"}, {"from": ["The dark knight"], "to": "The Dark Knight"}, {"from": ["The godfather"], "to": "The Godfather"}]}, {"op": "core/text-transform", "description": "Normalize Genre values with proper capitalization and spelling", "columnName": "Genre", "expression": "value.toLowerCase().replace(/\\s+/,'').replace(/sci-fi|scifi|sci fi/, 'Sci-Fi').replace(/drama/, 'Drama').replace(/romance/, 'Romance').replace(/crime/, 'Crime').replace(/animation/, 'Animation').replace(/comedy/, 'Comedy').replace(/action/, 'Action').replace(/null/, null).titleCase()"}, {"op": "core/date-parse", "description": "Parse ReleaseDate into ISO format yyyy-MM-dd", "columnName": "ReleaseDate", "mode": "cells", "valueType": "date", "dateFormat": "auto", "onError": "keep-original", "onInvalid": "set-to-null", "repeat": false}, {"op": "core/text-transform", "description": "Clean IMDB_Rating, convert 'N/A' or invalid to null", "columnName": "IMDB_Rating", "expression": "value == 'N/A' ? null : (isNumber(value) ? toNumber(value) : (value.toString().match(/\\d+(\\.\\d+)?/) ? toNumber(value) : null))"}, {"op": "core/text-transform", "description": "Clean BoxOffice values, remove $ and commas, convert to number", "columnName": "BoxOffice", "expression": "value.replace(/[^0-9]/g, '') == '' ? null : toNumber(value.replace(/[^0-9]/g, ''))"}, {"op": "core/mass-edit", "description": "Fill missing Titles with 'Unknown'", "columnName": "Title", "edits": [{"from": [null, ""], "to": "Unknown"}]}], "clean_table": "MovieID,Title,Genre,ReleaseDate,IMDB_Rating,BoxOffice\n1,The Avenger,Action,2019-07-04,8.1,1518812988\n2,Parasite,Drama,2019-05-30,8.6,257000000\n3,Inception,Sci-Fi,2010-07-16,8.8,829895144\n4,Joker,Drama,2019-10-10,8.4,1074251311\n5,Interstellar,Sci-Fi,2014-11-07,,677471339\n6,Avengers: Endgame,Action,2019-04-26,8.4,2797800564\n7,The Godfather,Crime,1972-03-24,9.2,246120986\n8,The Dark Knight,Action,2008-07-18,9.0,1004558444\n9,Parasite,Drama,2019-05-30,8.6,257000000\n10,Inception,Sci-Fi,2010-07-16,8.8,829895144\n11,Unknown,Comedy,2015-05-15,7.1,150000000\n12,Titanic,Romance,1997-12-19,7.8,2187463944\n13,The Lion King,Animation,1994-06-24,8.5,968483777\n14,Avengers: Endgame,Action,2019-04-26,8.4,2797800564"}
{"purpose": "Standardize and clean agricultural loan dataset with inconsistent city names, wrong date formats, and irregular numeric values.", "raw_table": "City,State,CropType,LoanAmount,PricePerUnit,LoanDate\nGreen-vale,CA,wheat,10000,5.5,2023/01/15\nGreenvale,ca,WhEAT,9500,5.50,15-01-2023\ngreenvale,CA,wheat,ten thousand,5.5,01/15/2023\nMaple-town,TX,Corn,8000,3.2,2023-03-20\nMapletown,tx, corn ,8000,3.20,03/20/2023\nMaple_town,TX,Corn,8000.00,3.2,20-Mar-2023\nRiver-city,IL,Soybean,12000,$9.00,2023.04.10\nRiver city,IL,soybean,12000,9,10/04/2023\nRiver-city,il,soybeans,12000,9,2023-04-10\nHill-top,WA,Rice,7000,7.5,2023/05/05\nHilltop,WA,Rice,7000,7.50,05-05-2023\nHilltop,wa,Rice,,7.5,2023-05-05\nSun-valley,OR,Barley,5000,4,2023/06/01\nSun_Valley,or,barley,5000,4.00,01-Jun-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names by removing underscores, hyphens, and trimming whitespace, capitalize words", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').trim().toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Standardize CropType names to lowercase then capitalize first letter", "columnName": "CropType", "expression": "value.trim().toLowercase().toTitlecase()"}, {"op": "core/mass-edit", "description": "Fix numeric LoanAmount text entries", "columnName": "LoanAmount", "edits": [{"from": ["ten thousand", " "], "to": "10000"}]}, {"op": "core/text-transform", "description": "Remove currency symbols from PricePerUnit and convert to number format with 2 decimals", "columnName": "PricePerUnit", "expression": "value.replace(/\\$/,'').toNumber().toFixed(2)"}, {"op": "core/date-parse", "description": "Parse LoanDate to ISO format yyyy-MM-dd", "columnName": "LoanDate", "options": {"mode": "cells", "format": "best", "locale": "en", "to": "yyyy-MM-dd"}}, {"op": "core/fill-down", "description": "Fill missing LoanAmount with previous row's value", "columnName": "LoanAmount"}], "clean_table": "City,State,CropType,LoanAmount,PricePerUnit,LoanDate\nGreen Vale,CA,Wheat,10000,5.50,2023-01-15\nGreen Vale,CA,Wheat,9500,5.50,2023-01-15\nGreen Vale,CA,Wheat,10000,5.50,2023-01-15\nMaple Town,TX,Corn,8000,3.20,2023-03-20\nMaple Town,TX,Corn,8000,3.20,2023-03-20\nMaple Town,TX,Corn,8000,3.20,2023-03-20\nRiver City,IL,Soybean,12000,9.00,2023-04-10\nRiver City,IL,Soybean,12000,9.00,2023-04-10\nRiver City,IL,Soybean,12000,9.00,2023-04-10\nHill Top,WA,Rice,7000,7.50,2023-05-05\nHill Top,WA,Rice,7000,7.50,2023-05-05\nHill Top,WA,Rice,7000,7.50,2023-05-05\nSun Valley,OR,Barley,5000,4.00,2023-06-01\nSun Valley,OR,Barley,5000,4.00,2023-06-01"}
{"purpose": "Clean and standardize farm produce sales data including city and produce names, correct price and date formats, and fill missing loan amounts.", "raw_table": "City,State,Produce,Price,LoanAmount,SaleDate\nSpringField,il,Apple,$1.2,5000,2023/01/15\nSPRINGFIELD,IL,apple,$1.20,,15-01-2023\nspring_field,IL,Appel,$1.25,5200,01/17/2023\nDecatur,Il,Corn,$.75,3000,2023-02-01\ndecatur,IL,Corn,$0.75,3000,02/01/2023\nchampaign,Il,SOY-BEAN,$1,4000,2023/03/05\nChampaign,IL,soybean,$1.00,4000,3/6/2023\nPeoria,IL,Tomato,$1.5,,2023-04-10\nPeoria,IL,Tomatos,$1.50,3500,04/12/2023\nBloomington,il,Potato,$0.8,2000,2023/05/01\nbloomington,IL,POTATO,$.80,2000,\nBloomington,IL,,0.85,2100,2023-05-05\nNormal,IL,Carrot,$1.1,2500,2023/06/15\nNormal,IL,Carrot,$1.10,2500,06/16/2023\nnormal,il,carrot,$1.15,,2023-06-17", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize city names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.toLowercase().replace('_','').replace('-','').capitalize()"}, {"op": "core/mass-edit", "description": "Correct state abbreviations to uppercase 'IL'", "columnName": "State", "edits": [{"from": ["il", "Il", "iL", "IL"], "to": "IL"}]}, {"op": "core/mass-edit", "description": "Fix misspellings in Produce names", "columnName": "Produce", "edits": [{"from": ["Appel", "Tomatos", "SOY-BEAN", "soybean", "POTATO", "carrot"], "to": ["Apple", "Tomato", "Soybean", "Soybean", "Potato", "Carrot"]}]}, {"op": "core/text-transform", "description": "Normalize Produce names to capitalize first letter", "columnName": "Produce", "expression": "value.toLowercase().capitalize()"}, {"op": "core/text-transform", "description": "Remove dollar signs and convert Price to numeric string with two decimals", "columnName": "Price", "expression": "value.replace('$','').replace(',','').toNumber().toFixed(2)"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Convert LoanAmount to integer string", "columnName": "LoanAmount", "expression": "value.toNumber().toFixed(0)"}, {"op": "core/date-parse", "description": "Parse SaleDate into yyyy-MM-dd format", "columnName": "SaleDate", "expression": "value.toDate()", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Format SaleDate as yyyy-MM-dd string", "columnName": "SaleDate", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,Produce,Price,LoanAmount,SaleDate\nSpringfield,IL,Apple,1.20,5000,2023-01-15\nSpringfield,IL,Apple,1.20,5000,2023-01-15\nSpringfield,IL,Apple,1.25,5200,2023-01-17\nDecatur,IL,Corn,0.75,3000,2023-02-01\nDecatur,IL,Corn,0.75,3000,2023-02-01\nChampaign,IL,Soybean,1.00,4000,2023-03-05\nChampaign,IL,Soybean,1.00,4000,2023-03-06\nPeoria,IL,Tomato,1.50,3500,2023-04-10\nPeoria,IL,Tomato,1.50,3500,2023-04-12\nBloomington,IL,Potato,0.80,2000,2023-05-01\nBloomington,IL,Potato,0.80,2000,2023-05-01\nBloomington,IL,Potato,0.85,2100,2023-05-05\nNormal,IL,Carrot,1.10,2500,2023-06-15\nNormal,IL,Carrot,1.10,2500,2023-06-16\nNormal,IL,Carrot,1.15,2500,2023-06-17"}
{"purpose": "Clean and standardize movie dataset with inconsistent titles, genres, release dates, and revenue formats.", "raw_table": "Movie_Title,Genre,Release_Date,Box_Office(USD),Rating\n\"the_godfather\",\"drama-crime\",\"03/24/1972\",\"134_966_411\",\"R\"\n\"Star Wars\",\"Sci-Fi\",\"May 25, 1977\",\"775398007\",\"PG\"\n\"PULP FICTION\",\"crime-drama\",\"10-14-1994\",\"107_928_762\",\"R\"\n\"Forrest Gump\",\"Drama\",\"07/06/1994\",\"677_387_716\",\"PG-13\"\n\"The Lion king\",\"Animation Adventure\",\"06/24/1994\",\"968_483_777\",\"G\"\n\"Inception\",\"SCI_FI\",\"2010/07/16\",\"829895144\",\"PG-13\"\n\"The Dark Knight\",\"Action, crime\",\"07-18-2008\",\"1004558444\",\"PG-13\"\n\"Fight Club\",\"Crime-Drama\",\"1999-10-15\",\"100_853_753\",\"R\"\n\"The Matrix\",\"SCI FI\",\"1999/03/31\",\"463517383\",\"R\"\n\"back to the Future\",\"Sci-fi\",\"07/03/1985\",\"388_802_458\",\"PG\"\n\"Gladiator\",\"Action-Drama\",\"2000.05.05\",\"457_640_427\",\"R\"\n\"Jurassic-Park\",\"Sci-fi\",\"1993-06-11\",\"914_691_118\",\"PG-13\"\n\"Titanic\",\"Drama-Romance\",\"12-19-1997\",\"2187463944\",\"PG-13\"\n\"The Avengers\",\"Action, Sci-Fi\",\"04/11/2012\",\"1518812988\",\"PG-13\"", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "Movie_Title", "expression": "value.replace(/[_-]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "columnName": "Genre", "expression": "value.toLowerCase().replace(/[_-]/g, ' ').replace(/,/g, ', ').replace(/\\s+/g, ' ').trim().split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(' ').replace(/ (Drama|Crime|Sci|Fi|Action|Adventure|Animation|Romance|Romance|Sci Fi)/g, function(m) { return m.trim().split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ') })"}, {"op": "core/text-transform", "columnName": "Genre", "expression": "value.replace(/sci fi/gi, 'Sci-Fi').replace(/crime drama/gi, 'Crime-Drama').replace(/crime-crime/gi, 'Crime-Crime').replace(/action crime/gi, 'Action, Crime').replace(/action-drama/gi, 'Action-Drama').replace(/animation adventure/gi, 'Animation Adventure')"}, {"op": "core/date-parse", "columnName": "Release_Date"}, {"op": "core/text-transform", "columnName": "Release_Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/text-transform", "columnName": "Box_Office(USD)", "expression": "value.replace(/_/g, '').replace(/,/g, '')"}, {"op": "core/text-transform", "columnName": "Box_Office(USD)", "expression": "value.toNumber()"}, {"op": "core/mass-edit", "columnName": "Rating", "edits": [{"from": ["PG-13", "pg-13", "Pg-13"], "to": "PG-13"}, {"from": ["PG", "pg", "Pg"], "to": "PG"}, {"from": ["R", "r"], "to": "R"}, {"from": ["G", "g"], "to": "G"}]}], "clean_table": "Movie_Title,Genre,Release_Date,Box_Office(USD),Rating\nThe Godfather,Drama-Crime,1972-03-24,134966411,R\nStar Wars,Sci-Fi,1977-05-25,775398007,PG\nPulp Fiction,Crime-Drama,1994-10-14,107928762,R\nForrest Gump,Drama,1994-07-06,677387716,PG-13\nThe Lion King,Animation Adventure,1994-06-24,968483777,G\nInception,Sci-Fi,2010-07-16,829895144,PG-13\nThe Dark Knight,Action, Crime,2008-07-18,1004558444,PG-13\nFight Club,Crime-Drama,1999-10-15,100853753,R\nThe Matrix,Sci-Fi,1999-03-31,463517383,R\nBack To The Future,Sci-Fi,1985-07-03,388802458,PG\nGladiator,Action-Drama,2000-05-05,457640427,R\nJurassic Park,Sci-Fi,1993-06-11,914691118,PG-13\nTitanic,Drama-Romance,1997-12-19,2187463944,PG-13\nThe Avengers,Action, Sci-Fi,2012-04-11,1518812988,PG-13"}
{"purpose": "Clean and standardize inconsistent city names and business types in government loan data.", "raw_table": "City,State,BusinessType,LoanAmount,Price,Date\nNew_york,NY,restaurant,500000,250000,01-15-2023\nlos angeles,CA,RETAIL,450000,150000,2023/02/20\nchicago,IL,restuarnt,300000,120000,15-Mar-2023\nhouston,TX,Health-care,600000,300000,2023-04-10\nphoenix,AZ,,400000,200000,04/25/2023\nphiladelphia,PA,RETAIL-,350000,175000,2023.05.05\nsan-antonio,TX,Restaurant,NaN,160000,05-15-2023\nsan diego,ca,healthcare,550000,NaN,2023/06/01\ndallas,TX,retail,250000,100000,June 10 2023\nsan jose,CA,Restuarant,450000,210000,2023/07/20\naustin,TX,HEALTH CARE,500000,230000,07-30-2023\njacksonville,FL,retail,300000,,2023-08-15\nfort worth,tx,restaurant,400000,190000,08/25/2023\ncolumbus,OH,Retail,350000,180000,2023-09-05\ncharlotte,NC,Healthcare,450000,220000,09-15-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names by removing underscores and hyphens and capitalizing each word", "columnName": "City", "expression": "value.replace('_',' ').replace('-',' ').split(' ').map(word, word.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Capitalize State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["restaurant", "Restuarant", "restuarnt", "RESTAURANT"], "to": "Restaurant"}, {"from": ["retail", "RETAIL", "RETAIL-", "Retail"], "to": "Retail"}, {"from": ["Health-care", "healthcare", "HEALTH CARE", "Healthcare"], "to": "Healthcare"}]}, {"op": "core/mass-edit", "description": "Fill missing BusinessType with 'Unknown'", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Convert LoanAmount to numeric, set 'NaN' or missing to null", "columnName": "LoanAmount", "expression": "if(value.toLowercase() == 'nan' || value.trim() == '', null, value.toNumber())"}, {"op": "core/text-transform", "description": "Convert Price to numeric, set missing to null", "columnName": "Price", "expression": "if(value.trim() == '' || value.toLowercase() == 'nan', null, value.toNumber())"}, {"op": "core/date-parse", "description": "Parse Date column to ISO format", "columnName": "Date", "expression": "value.toDate()", "onError": "set-to-blank"}], "clean_table": "City,State,BusinessType,LoanAmount,Price,Date\nNew York,NY,Restaurant,500000,250000,2023-01-15T00:00:00Z\nLos Angeles,CA,Retail,450000,150000,2023-02-20T00:00:00Z\nChicago,IL,Restaurant,300000,120000,2023-03-15T00:00:00Z\nHouston,TX,Healthcare,600000,300000,2023-04-10T00:00:00Z\nPhoenix,AZ,Unknown,400000,200000,2023-04-25T00:00:00Z\nPhiladelphia,PA,Retail,350000,175000,2023-05-05T00:00:00Z\nSan Antonio,TX,Restaurant,,160000,2023-05-15T00:00:00Z\nSan Diego,CA,Healthcare,550000,,2023-06-01T00:00:00Z\nDallas,TX,Retail,250000,100000,2023-06-10T00:00:00Z\nSan Jose,CA,Restaurant,450000,210000,2023-07-20T00:00:00Z\nAustin,TX,Healthcare,500000,230000,2023-07-30T00:00:00Z\nJacksonville,FL,Retail,300000,,2023-08-15T00:00:00Z\nFort Worth,TX,Restaurant,400000,190000,2023-08-25T00:00:00Z\nColumbus,OH,Retail,350000,180000,2023-09-05T00:00:00Z\nCharlotte,NC,Healthcare,450000,220000,2023-09-15T00:00:00Z"}
{"purpose": "Clean inconsistent city and state names, correct date formats, and standardize numeric fields in energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,electric-utility,12000,50000,01/15/2023\nlos-angeles,ca,gas utility,15000,NA,2023.02.20\nChicago,IL,Electric Utility,13000,45000,3-10-2023\nHousTon,TX,gas_utility,11000,40000,2023/04/05\nPhoenix,az,electricutility,NaN,42000,05-15-2023\nphiladelphia,PA,Gas Utility,-14000,48000,2023-06-25\nsanantonio,tx,ELECTRIC-UTILITY,12500,47000,2023/07/30\nSan Diego,CA,gas-Utility,13500,,08/20/2023\nDallas,TX,Electric_Utility,14000,46000,2023-09-10\nsan jose,CA,Gas Utility,13000,44000,10/05/2023\nAustin,TX,electric_Utility,14500,43000,11-15-2023\nJacksonville,FL,gas-utility,NA,41000,2023.12.01\nFort Worth,tx,electric-utility,15000,49000,13/01/2023\nColumbus,OH,GAS_UTILITY,13500,45500,2023-14-02", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["los-angeles"], "to": "Los Angeles"}, {"from": ["sanantonio"], "to": "San Antonio"}, {"from": ["san jose"], "to": "San Jose"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()", "onError": "keep-original", "repeat": false}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()", "onError": "keep-original", "repeat": false}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["electric-utility", "Electric Utility", "electricutility", "ELECTRIC-UTILITY", "Electric_Utility", "electric_Utility", "electric-Utility"], "to": "Electric Utility"}, {"from": ["gas utility", "gas_utility", "Gas Utility", "gas-Utility", "gas-utility", "GAS_UTILITY", "gas-Utility"], "to": "Gas Utility"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "if(value.toString().toLowercase() == 'nan' || value.toString() == '' || value.toString().match(/^-\\d+$/), null, value.toNumber())", "onError": "set-to-null", "repeat": false}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "if(value.toString().toLowercase() == 'na' || value.toString() == '', null, value.toNumber())", "onError": "set-to-null", "repeat": false}, {"op": "core/date-parse", "columnName": "Date", "expression": "value.replace(/\\./g,'-')", "onError": "keep-original", "repeat": false}, {"op": "core/text-transform", "columnName": "Date", "expression": "value.toDate('MM/dd/yyyy').toString('yyyy-MM-dd') || \n  value.toDate('yyyy-MM-dd').toString('yyyy-MM-dd') || \n  value.toDate('yyyy-MM-dd').toString('yyyy-MM-dd') || \n  value.toDate('MM-dd-yyyy').toString('yyyy-MM-dd') || \n  value.toDate('yyyy/MM/dd').toString('yyyy-MM-dd') || \n  value.toDate('dd/MM/yyyy').toString('yyyy-MM-dd') || \n  value.toDate('dd-MM-yyyy').toString('yyyy-MM-dd') ||\n  null", "onError": "set-to-null", "repeat": false}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Electric Utility,12000,50000,2023-01-15\nLos Angeles,CA,Gas Utility,15000,null,2023-02-20\nChicago,IL,Electric Utility,13000,45000,2023-03-10\nHouston,TX,Gas Utility,11000,40000,2023-04-05\nPhoenix,AZ,Electric Utility,null,42000,2023-05-15\nPhiladelphia,PA,Gas Utility,null,48000,2023-06-25\nSan Antonio,TX,Electric Utility,12500,47000,2023-07-30\nSan Diego,CA,Gas Utility,13500,null,2023-08-20\nDallas,TX,Electric Utility,14000,46000,2023-09-10\nSan Jose,CA,Gas Utility,13000,44000,2023-10-05\nAustin,TX,Electric Utility,14500,43000,2023-11-15\nJacksonville,FL,Gas Utility,null,41000,2023-12-01\nFort Worth,TX,Electric Utility,15000,49000,null\nColumbus,OH,Gas Utility,13500,45500,null"}
{"purpose": "Standardize city names and correct inconsistent business type entries in telecommunications customer data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,NY,Telecom_Corp,1200,50000,2023/01/15\nLOS ANGELES,ca,telecom-corp,1100,45000,01-20-2023\nChicago,IL,Telecom Corp,1300,,2023-02-05\nhouston,TX,telecom_corp,1250,52000,2023/2/10\nPhoenix,az,,1150,48000,2023-02-15\nphiladelphia,PA,Telecom-Corp,1180,47000,15/02/2023\nSan antonio,TX,telecom corp,1190,49000,2023-02-18\nsan diego,CA,Telecom_Corp,abc,50000,2023/02/20\nDallas,tx,Telecom Corp,1230,51000,2023-02-22\nSan Jose,CA,telecomcorp,1220,50500,2023-02-25\nAustin,TX,telecom corp,1210,49500,2023-02-28\nJacksonville,FL,Telecom-Corp,1175,47000,2023/3/1\nFort Worth,tx,Telecom_Corp,1195,48000,2023-03-05\nColumbus,OH,telecom_corp,1185,47500,2023/03/07", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names properly", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/mass-edit", "description": "Standardize state abbreviations to uppercase", "columnName": "State", "edits": [{"from": ["ca", "tx", "az", "fl", "oh"], "to": ["CA", "TX", "AZ", "FL", "OH"]}]}, {"op": "core/mass-edit", "description": "Normalize BusinessType entries", "columnName": "BusinessType", "edits": [{"from": ["Telecom_Corp", "telecom_corp", "telecom-corp", "Telecom-Corp", "telecom corp", "telecomcorp"], "to": "Telecom Corp"}]}, {"op": "core/mass-edit", "description": "Fill missing BusinessType values", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Telecom Corp"}]}, {"op": "core/text-transform", "description": "Convert Price to numeric, replace invalid with null", "columnName": "Price", "expression": "isNaN(value.toNumber()) ? null : value.toNumber()"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number", "columnName": "LoanAmount", "expression": "value.toNumber()"}, {"op": "core/date-parse", "description": "Parse Date column to yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate(\"yyyy/MM/dd\").toString(\"yyyy-MM-dd\")", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Standardize Date formats with fallback patterns", "columnName": "Date", "expression": "if(value.match(/\\d{4}-\\d{2}-\\d{2}/)) value else if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/)) org.joda.time.format.DateTimeFormat.forPattern(\"dd/MM/yyyy\").parseLocalDate(value).toString() else if(value.match(/\\d{2}-\\d{2}-\\d{4}/)) org.joda.time.format.DateTimeFormat.forPattern(\"MM-dd-yyyy\").parseLocalDate(value).toString() else value"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom Corp,1200,50000,2023-01-15\nLos Angeles,CA,Telecom Corp,1100,45000,2023-01-20\nChicago,IL,Telecom Corp,1300,45000,2023-02-05\nHouston,TX,Telecom Corp,1250,52000,2023-02-10\nPhoenix,AZ,Telecom Corp,1150,48000,2023-02-15\nPhiladelphia,PA,Telecom Corp,1180,47000,2023-02-15\nSan Antonio,TX,Telecom Corp,1190,49000,2023-02-18\nSan Diego,CA,Telecom Corp,,50000,2023-02-20\nDallas,TX,Telecom Corp,1230,51000,2023-02-22\nSan Jose,CA,Telecom Corp,1220,50500,2023-02-25\nAustin,TX,Telecom Corp,1210,49500,2023-02-28\nJacksonville,FL,Telecom Corp,1175,47000,2023-03-01\nFort Worth,TX,Telecom Corp,1195,48000,2023-03-05\nColumbus,OH,Telecom Corp,1185,47500,2023-03-07"}
{"purpose": "Normalize city names and business types, fix date formats, and clean numeric fields in government loan application data.", "raw_table": "ApplicantID,City,State,BusinessType,LoanAmount,ApplicationDate\n101,New_york,NY,Restaurent,50000,$12,000,2023/03/15\n102,los-angeles,CA,retail,45000,15000,15-04-2023\n103,Houston,tx,RETAIL,55000,20000,2023-04-31\n104,Phoenix,AZ,restaurent,na,18000,04/20/2023\n105,philadelphia,PA,RESTAURANT,62000,,2023.05.01\n106,San Antonio,TX,Retail,49000,17000,2023-05-10\n107,San-diego,ca,retail,47000,16000,2023-05-12\n108,Dallas,TX,restaurent,51000,15500,2023/05/15\n109,SanJose,CA,RETAIL,48000,15800,20/05/2023\n110,Austin,tx,Restaurent,53000,,2023-05-18\n111,Jacksonville,FL,Retail,-,14000,2023-05-20\n112,Fort-Worth,TX,Restaurent,50000,15000,2023-05-22\n113,Columbus,OH,retail,49500,14500,2023/05/23\n114,Charlotte,NC,RESTAURANT,52000,15200,2023-05-25", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens and standardize City names capitalization", "columnName": "City", "expression": "value.replace('_', ' ').replace('-', ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Correct common misspellings in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["Restaurent", "restaurent"], "to": "Restaurant"}, {"from": ["RESTAURANT", "RETAIL", "retail", "Retail"], "to": "Retail"}]}, {"op": "core/text-transform", "description": "Clean LoanAmount column: remove commas, dollar signs, convert 'na' and '-' to blank", "columnName": "LoanAmount", "expression": "if(value.toLowercase() in ['na', '-']) null else value.replaceAll('[\\$,]', '')"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number type", "columnName": "LoanAmount", "expression": "if(value == null, null, value.toNumber())"}, {"op": "core/text-transform", "description": "Clean ApplicationDate - fix inconsistent date formats", "columnName": "ApplicationDate", "expression": "value.replaceAll('-', '/').replaceAll('\\.', '/').replaceAll('20/05/2023', '05/20/2023')"}, {"op": "core/date-parse", "description": "Parse ApplicationDate to ISO format", "columnName": "ApplicationDate", "format": "MM/dd/yyyy", "mode": "lenient"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "ApplicantID,City,State,BusinessType,LoanAmount,ApplicationDate\n101,New York,NY,Restaurant,12000,2023-03-15\n102,Los Angeles,CA,Retail,15000,2023-04-15\n103,Houston,TX,Retail,20000,2023-05-01\n104,Phoenix,AZ,Restaurant,18000,2023-04-20\n105,Philadelphia,PA,Restaurant,62000,2023-05-01\n106,San Antonio,TX,Retail,49000,2023-05-10\n107,San Diego,CA,Retail,47000,2023-05-12\n108,Dallas,TX,Restaurant,51000,2023-05-15\n109,San Jose,CA,Retail,48000,2023-05-20\n110,Austin,TX,Restaurant,53000,2023-05-18\n111,Jacksonville,FL,Retail,14000,2023-05-20\n112,Fort Worth,TX,Restaurant,50000,2023-05-22\n113,Columbus,OH,Retail,49500,2023-05-23\n114,Charlotte,NC,Restaurant,52000,2023-05-25"}
{"purpose": "Clean inconsistent city names and standardize business types and date formats in government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,restaurant,100000,50000,01-15-2023\nlos Angeles,CA,restaurant ,95000,45000,2023/02/20\nchicago,illinois,retail-store,110000,,03-05-2023\nHouston,TX,Retail Store,105000,52000,2023.04.10\nphoenix,az,RESTAURANT,98000,48000,4/25/2023\nphiladelphia,PA,retail_store,102000,50000,May 1 2023\nsan antonio,tx,restaurant,97000,49000,2023-06-15\nDallas,tx,Retail-store,101000,51000,2023/07/20\nsan diego,CA,restaurant,96000,47000,07-25-2023\nsan jose,ca,RETAIL STORE,99000,49500,2023.08.05\nAustin,TX,retailstore,103000,53000,08/15/2023\nJacksonville,fl,Restaurant,97000,48000,2023-09-10\nfort worth,Tx,restuarant,94000,46000,2023-10-01\nColumbus,OH,Retail Store,101000,50000,October 5 2023\nCharlotte,NC,restaurant,98000,48500,2023-11-12", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens in City and capitalize properly", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase two-letter abbreviations", "columnName": "State", "expression": "value.toUppercase().trim()"}, {"op": "core/text-transform", "description": "Standardize BusinessType to lowercase and remove extra spaces and underscores/hyphens", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[_-]/g, ' ').replace(/\\s+/g, ' ').trim()"}, {"op": "core/mass-edit", "description": "Correct common misspellings and variants in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["retail store", "retailstore", "retail-store", "retail_store"], "to": "retail store"}, {"from": ["restuarant"], "to": "restaurant"}]}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Normalize Price and LoanAmount to numbers (remove commas if present)", "columnName": "Price", "expression": "value.replace(/,/, '').toNumber()"}, {"op": "core/text-transform", "description": "Normalize LoanAmount to numbers (remove commas if present)", "columnName": "LoanAmount", "expression": "value.replace(/,/, '').toNumber()"}, {"op": "core/date-parse", "description": "Parse Date field to yyyy-MM-dd format", "columnName": "Date", "expression": "value.toDate()", "onError": "keep-original", "dateFormat": "automatic"}, {"op": "core/text-transform", "description": "Format parsed Date to ISO yyyy-MM-dd string", "columnName": "Date", "expression": "if(isDate(value), value.toString('yyyy-MM-dd'), value)"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,restaurant,100000,50000,2023-01-15\nLos Angeles,CA,restaurant,95000,45000,2023-02-20\nChicago,IL,retail store,110000,50000,2023-03-05\nHouston,TX,retail store,105000,52000,2023-04-10\nPhoenix,AZ,restaurant,98000,48000,2023-04-25\nPhiladelphia,PA,retail store,102000,50000,2023-05-01\nSan Antonio,TX,restaurant,97000,49000,2023-06-15\nDallas,TX,retail store,101000,51000,2023-07-20\nSan Diego,CA,restaurant,96000,47000,2023-07-25\nSan Jose,CA,retail store,99000,49500,2023-08-05\nAustin,TX,retail store,103000,53000,2023-08-15\nJacksonville,FL,restaurant,97000,48000,2023-09-10\nFort Worth,TX,restaurant,94000,46000,2023-10-01\nColumbus,OH,retail store,101000,50000,2023-10-05\nCharlotte,NC,restaurant,98000,48500,2023-11-12"}
{"purpose": "Standardize inconsistent city names and normalize business types in government loan grant data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,NY,REtail,12000,150000,01/15/2023\nLos_angeles,CA,restaurant,15000,200000,2023-02-20\nCHICAGO,IL,RETAIL,13000,,15-03-2023\nhouston,Tx,resturant,11000,180000,03/10/2023\nphoenix,AZ,RE-taIL,12500,170000,2023/04/05\nphiladelphia,PA,RETAIL,14000,160000,April 20 2023\nsan-antonio,TX,RETAIL,,175000,2023.05.10\nsan diego,ca,Restaurant,13500,165000,05-25-2023\nDALLAS,TX,Residential,13000,155000,2023-06-01\nsan jose,CA,retail,12000,150000,06/15/2023\nAustin,tx,restaurant,14000,190000,2023-07-01\nJacksonville,FL,,12500,145000,07/20/2023\nfort worth,tx,RETAIL,13000,160000,2023-08-05\nColumbus,OH,restaurnt,11500,150000,08-15-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens from City names, and capitalize properly", "engineConfig": {"facets": []}, "columnName": "City", "expression": "value.replaceAll('[_-]', ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase", "engineConfig": {"facets": []}, "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix common misspellings and inconsistent capitalizations in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["REtail", "RETAIL", "RE-taIL", "retail"], "to": "Retail"}, {"from": ["restaurant", "Restaurant", "resturant", "restaurnt"], "to": "Restaurant"}, {"from": ["Residential"], "to": "Retail"}]}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "engineConfig": {"facets": []}, "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Parse dates into ISO format yyyy-MM-dd", "engineConfig": {"facets": []}, "columnName": "Date", "expression": "value.toDate('MM/dd/yyyy').toString('yyyy-MM-dd') || value.toDate('yyyy-MM-dd').toString('yyyy-MM-dd') || value.toDate('dd-MM-yyyy').toString('yyyy-MM-dd') || value.toDate('yyyy/MM/dd').toString('yyyy-MM-dd') || value.toDate('MMMM dd yyyy').toString('yyyy-MM-dd') || value.toDate('yyyy.MM.dd').toString('yyyy-MM-dd') || value.toDate('MM-dd-yyyy').toString('yyyy-MM-dd') || value.toDate('dd.MM.yyyy').toString('yyyy-MM-dd') || value"}, {"op": "core/mass-edit", "description": "Fill missing Price with average price", "columnName": "Price", "edits": [{"from": [""], "to": "13000"}]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,12000,150000,2023-01-15\nLos Angeles,CA,Restaurant,15000,200000,2023-02-20\nChicago,IL,Retail,13000,200000,2023-03-15\nHouston,TX,Restaurant,11000,180000,2023-03-10\nPhoenix,AZ,Retail,12500,170000,2023-04-05\nPhiladelphia,PA,Retail,14000,160000,2023-04-20\nSan Antonio,TX,Retail,13000,175000,2023-05-10\nSan Diego,CA,Restaurant,13500,165000,2023-05-25\nDallas,TX,Retail,13000,155000,2023-06-01\nSan Jose,CA,Retail,12000,150000,2023-06-15\nAustin,TX,Restaurant,14000,190000,2023-07-01\nJacksonville,FL,Retail,12500,145000,2023-07-20\nFort Worth,TX,Retail,13000,160000,2023-08-05\nColumbus,OH,Restaurant,11500,150000,2023-08-15"}
{"purpose": "Standardize movie titles, release dates, and box office earnings for accurate reporting.", "raw_table": "Movie_Title,Release_Date,Box_Office,Genre\nThe godfather,03-24-1972,$134_966_411,Crime\nstar-wars, MAY 25 1977, $775398007,Sci-fi\nTitanic,12/19/1997, $2,187,463,944,Drama\npulp_fiction,10-14-1994,$213_928_762,crime\nAvatar,12-18-2009,2.847billion,science fiction\nThe Shawshank Redemption,09/22/1994,$28341469,Drama\nforrest gump,07/06/1994,$678222284,Drama\nThe Dark Knight,07-18-2008,$1,005,973,645,Action\nInception,2010-07-16,829895144,Science-Fiction\nfight club,10-15-1999, $100,853,753,drama\nThe Lion King,06-15-1994,$968511805,Animation\nAvengers:Endgame, April 26 2019, $2.798 billion,action\nJurassic_Park,06/11/1993,$1,046,721,911,Adventure\nGladiator,05-05-2000,$460,583,960,Action\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize Movie_Title capitalization and remove underscores/hyphens", "columnName": "Movie_Title", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize Release_Date format to yyyy-MM-dd", "columnName": "Release_Date", "expression": "value.toDate('MM-dd-yyyy') != null ? value.toDate('MM-dd-yyyy').toString('yyyy-MM-dd') : (value.toDate('MMMM dd yyyy') != null ? value.toDate('MMMM dd yyyy').toString('yyyy-MM-dd') : (value.toDate('MM/dd/yyyy') != null ? value.toDate('MM/dd/yyyy').toString('yyyy-MM-dd') : (value.toDate('yyyy-MM-dd') != null ? value : null)))"}, {"op": "core/text-transform", "description": "Remove $ sign, commas, underscores and convert Box_Office to numeric string", "columnName": "Box_Office", "expression": "value.replace(/\\$|,|_/g, '').toLowercase().replace('billion', '000000000').replace(/\\s/g, '')"}, {"op": "core/text-transform", "description": "Convert Box_Office to number (long)", "columnName": "Box_Office", "expression": "if(value.match(/\\d+/), Number(value), null)"}, {"op": "core/text-transform", "description": "Standardize Genre capitalization", "columnName": "Genre", "expression": "value.toLowercase().replace('sci-fi','Science Fiction').replace('science fiction','Science Fiction').replace('crime','Crime').replace('drama','Drama').replace('action','Action').replace('adventure','Adventure').replace('animation','Animation')"}], "clean_table": "Movie_Title,Release_Date,Box_Office,Genre\nThe Godfather,1972-03-24,134966411,Crime\nStar Wars,1977-05-25,775398007,Science Fiction\nTitanic,1997-12-19,2187463944,Drama\nPulp Fiction,1994-10-14,213928762,Crime\nAvatar,2009-12-18,2847000000,Science Fiction\nThe Shawshank Redemption,1994-09-22,28341469,Drama\nForrest Gump,1994-07-06,678222284,Drama\nThe Dark Knight,2008-07-18,1005973645,Action\nInception,2010-07-16,829895144,Science Fiction\nFight Club,1999-10-15,100853753,Drama\nThe Lion King,1994-06-15,968511805,Animation\nAvengers Endgame,2019-04-26,2798000000,Action\nJurassic Park,1993-06-11,1046721911,Adventure\nGladiator,2000-05-05,460583960,Action\n"}
{"purpose": "Clean and normalize telecommunications customer data including city names, business types, and dates for accurate reporting.", "raw_table": "CustomerID,City,State,BusinessType,Price,LoanAmount,SubscriptionDate\n1001,San_francisco,CA,small-biz,120.5,15000,2023/01/15\n1002,los angeles,ca,SMALL Biz,130.75,16000,15-02-2023\n1003,New-York,ny,enterprise,200,25000,2023.03.10\n1004,,NY,Enterprise,210,26000,03/25/2023\n1005,Chicago,IL,small_biz,115,14000,2023-04-05\n1006,Houston,TX,SMALL Biz,NaN,13000,2023-05-20\n1007,Phoenix,az,enterprise,220,27000,May 30 2023\n1008,Dallas,TX,enterprise,215,26500,2023/06/15\n1009,San-antonio,TX,small-biz,110,13500,2023.07.01\n1010,San Diego,Ca,Small Biz,125,15500,07/15/2023\n1011,Austin,TX,enterprise,205,25500,2023-08-10\n1012,Jacksonville,fl,small Biz,NaN,14000,2023-09-05\n1013,Fort-worth,TX,enterprise,230,28000,2023_10_01\n1014,Columbus,OH,small-biz,118,14500,10-15-2023\n", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["San_francisco"], "to": "San Francisco"}, {"from": ["New-York"], "to": "New York"}, {"from": ["San-antonio"], "to": "San Antonio"}, {"from": ["Fort-worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()", "onError": "keep-original", "repeat": false}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()", "onError": "keep-original", "repeat": false}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["small-biz", "small_biz", "SMALL Biz", "Small Biz", "small Biz"], "to": "Small Business"}, {"from": ["enterprise", "Enterprise"], "to": "Enterprise"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "isNonBlank(value) && value != 'NaN' ? Number(value) : null", "onError": "set-to-null", "repeat": false}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "isNonBlank(value) ? Number(value) : null", "onError": "set-to-null", "repeat": false}, {"op": "core/text-transform", "columnName": "SubscriptionDate", "expression": "value.replace(/[-_.]/g,'/').match(/\\d{1,2}\\/\\d{1,2}\\/\\d{4}/) ? value.replace(/[-_.]/g,'/') : value", "onError": "keep-original", "repeat": false}, {"op": "core/date-parse", "columnName": "SubscriptionDate", "mode": "normal", "pattern": "MM/dd/yyyy", "onError": "keep-original"}, {"op": "core/fill-down", "columnName": "City"}], "clean_table": "CustomerID,City,State,BusinessType,Price,LoanAmount,SubscriptionDate\n1001,San Francisco,CA,Small Business,120.5,15000,01/15/2023\n1002,Los Angeles,CA,Small Business,130.75,16000,02/15/2023\n1003,New York,NY,Enterprise,200,25000,03/10/2023\n1004,New York,NY,Enterprise,210,26000,03/25/2023\n1005,Chicago,IL,Small Business,115,14000,04/05/2023\n1006,Houston,TX,Small Business,,13000,05/20/2023\n1007,Phoenix,AZ,Enterprise,220,27000,05/30/2023\n1008,Dallas,TX,Enterprise,215,26500,06/15/2023\n1009,San Antonio,TX,Small Business,110,13500,07/01/2023\n1010,San Diego,CA,Small Business,125,15500,07/15/2023\n1011,Austin,TX,Enterprise,205,25500,08/10/2023\n1012,Jacksonville,FL,Small Business,,14000,09/05/2023\n1013,Fort Worth,TX,Enterprise,230,28000,10/01/2023\n1014,Columbus,OH,Small Business,118,14500,10/15/2023\n"}
{"purpose": "Clean and standardize city names, business types, and date formats in telecommunications loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNeW-york,ny,SMB,10000,5000,2023/01/15\nlos angeles,CA,ENTERPRISE,25000,10000,15-02-2023\nchicago,il,small Business,15000,7000,2023-03-01\nhouston,TX,micro_biz,5000,2500,03/15/23\nPHOENIX,az,MidSize,12000,,2023.04.01\nphiladelphia,PA,enterprise,30000,15000,2023/05/10\nsan-antonio,tx,Small_business,8000,4000,2023/06/05\nsan diego,CA,,9000,4500,06-20-2023\ndallas,TX,SMB,11000,5500,2023/07/01\nsan jose,ca,Micro_Biz,6000,3000,2023/07/15\nAustin,TX,Mid-Size,13000,6500,2023/08/01\njacksonville,fl,SMB,7000,3500,2023/08/10\nfort worth,TX,enterprise,27000,13500,2023/09/01\ncolumbus,oh,small_business,9000,4500,2023/09/15", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City capitalization and remove hyphens/underscores", "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/, ' ').split(' ').map(v, v[0].toUppercase() + v.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["SMB", "small Business", "Small_business", "small_business", "SMB"], "to": "Small Business"}, {"from": ["ENTERPRISE", "enterprise"], "to": "Enterprise"}, {"from": ["micro_biz", "Micro_Biz"], "to": "Micro Biz"}, {"from": ["MidSize", "Mid-Size"], "to": "Mid Size"}]}, {"op": "core/fill-down", "description": "Fill down missing BusinessType", "columnName": "BusinessType"}, {"op": "core/text-transform", "description": "Parse LoanDate to ISO format", "columnName": "LoanDate", "expression": "value.toDate() != null ? value.toDate().toISOString().substring(0,10) : value"}, {"op": "core/mass-edit", "description": "Fix missing LoanAmount by setting to half of Price", "columnName": "LoanAmount", "edits": [{"from": [""], "to": null}]}, {"op": "core/text-transform", "description": "Impute missing LoanAmount with half Price", "columnName": "LoanAmount", "expression": "value == null || value == '' ? cells.Price.value / 2 : value"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew York,NY,Small Business,10000,5000,2023-01-15\nLos Angeles,CA,Enterprise,25000,10000,2023-02-15\nChicago,IL,Small Business,15000,7000,2023-03-01\nHouston,TX,Micro Biz,5000,2500,2023-03-15\nPhoenix,AZ,Mid Size,12000,6000,2023-04-01\nPhiladelphia,PA,Enterprise,30000,15000,2023-05-10\nSan Antonio,TX,Small Business,8000,4000,2023-06-05\nSan Diego,CA,Small Business,9000,4500,2023-06-20\nDallas,TX,Small Business,11000,5500,2023-07-01\nSan Jose,CA,Micro Biz,6000,3000,2023-07-15\nAustin,TX,Mid Size,13000,6500,2023-08-01\nJacksonville,FL,Small Business,7000,3500,2023-08-10\nFort Worth,TX,Enterprise,27000,13500,2023-09-01\nColumbus,OH,Small Business,9000,4500,2023-09-15"}
{"purpose": "Standardize inconsistent city names, correct business type entries, and normalize date and numeric formats for energy loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,solar_installation,15000,50000,$2023-01-15\nlos angeles,CA,SolarInstallation,20000,60000,15/02/2023\nhouston,tx,wind_Turbine,12000,45000,2023/03/10\nChIcago,IL,solar install,18000,,2023-04-05\nPHOENIX,az,solar-installation,17000,52000,2023-05-08\nphiladelphia,pa,wind turbine,11000,43000,2023.06.12\nsan antonio,TX,solar_installation,16000,48000,2023/07/20\nsan_diego,ca,windTurbine,13000,47000,08-08-2023\nDallas,TX,solar_installation,17500,51000,2023/09/15\nsan jose,CA,,14000,46000,2023-10-10\nAustin,Tx,solar_install,16500,49000,11/11/2023\nJacksonville,FL,wind_turbine,12500,44500,2023-12-05\nfort worth,tx,SolarInstall,15500,47500,2023-13-01\nColumbus,OH,solar_installation,14500,46000,2023-02-28", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in City names", "columnName": "City", "expression": "value.replace(/[_-]/, ' ')"}, {"op": "core/text-transform", "description": "Capitalize City names properly", "columnName": "City", "expression": "value.toLowerCase().split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize State abbreviations to uppercase", "columnName": "State", "edits": [{"from": ["ny"], "to": "NY"}, {"from": ["ca"], "to": "CA"}, {"from": ["tx"], "to": "TX"}, {"from": ["az"], "to": "AZ"}, {"from": ["pa"], "to": "PA"}, {"from": ["fl"], "to": "FL"}, {"from": ["oh"], "to": "OH"}]}, {"op": "core/text-transform", "description": "Normalize BusinessType values", "columnName": "BusinessType", "expression": "value.toLowerCase().replace(/[_-]/g, ' ').replace(/solar install(ation)?/, 'Solar Installation').replace(/wind turbine/, 'Wind Turbine').trim()"}, {"op": "core/mass-edit", "description": "Fix missing BusinessType values", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Solar Installation"}]}, {"op": "core/text-transform", "description": "Remove $ from Price and convert to number", "columnName": "Price", "expression": "value.replace(/\\$/g, '').toNumber()"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Remove $ and convert LoanAmount to number", "columnName": "LoanAmount", "expression": "value.replace(/\\$/g, '').toNumber()"}, {"op": "core/text-transform", "description": "Normalize Date formats to ISO yyyy-MM-dd", "columnName": "Date", "expression": "value.match(/\\d{4}[-\\/.]\\d{2}[-\\/.]\\d{2}/) ? value.replace(/[.\\/]/g, '-') : (value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/) ? (tmp = value.split('/'), tmp[2] + '-' + tmp[1].padStart(2,'0') + '-' + tmp[0].padStart(2,'0')) : (value.match(/\\d{2}-\\d{2}-\\d{4}/) ? (tmp = value.split('-'), tmp[2] + '-' + tmp[0].padStart(2,'0') + '-' + tmp[1].padStart(2,'0')) : value))"}, {"op": "core/mass-edit", "description": "Correct invalid date 2023-13-01 to 2024-01-13", "columnName": "Date", "edits": [{"from": ["2023-13-01"], "to": "2024-01-13"}]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,15000,50000,2023-01-15\nLos Angeles,CA,Solar Installation,20000,60000,2023-02-15\nHouston,TX,Wind Turbine,12000,45000,2023-03-10\nChicago,IL,Solar Installation,18000,45000,2023-04-05\nPhoenix,AZ,Solar Installation,17000,52000,2023-05-08\nPhiladelphia,PA,Wind Turbine,11000,43000,2023-06-12\nSan Antonio,TX,Solar Installation,16000,48000,2023-07-20\nSan Diego,CA,Wind Turbine,13000,47000,2023-08-08\nDallas,TX,Solar Installation,17500,51000,2023-09-15\nSan Jose,CA,Solar Installation,14000,46000,2023-10-10\nAustin,TX,Solar Installation,16500,49000,2023-11-11\nJacksonville,FL,Wind Turbine,12500,44500,2023-12-05\nFort Worth,TX,Solar Installation,15500,47500,2024-01-13\nColumbus,OH,Solar Installation,14500,46000,2023-02-28"}
{"purpose": "Standardize inconsistent city and business type names, fix date formats, and clean numeric fields in energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar-Installation, 12000 ,15000, 01/12/2022\nlos-angeles,CA,Wind_Turbine,11000, ,2022-03-15\nChicago,il,SoLAR Installation,11500,13000,15-Apr-2022\nhouston,TX,wind turbine,10500,12500,2022/05/20\nPhoenix,az,solar_instalation,,14000,2022-06-25\nPhiladelphia,PA,wind-turbine,10000,12000,07-15-2022\nsan_antonio,TX,solar installation, 9500 ,11000,2022.08.10\nSan Diego,CA,Wind Turbine,10800,11500,2022/09/05\nDallas,tx,SOLAR Installation,10200,11800,09/20/2022\nSan_jose,CA,wind_turbine, 10700,11900,2022-10-15\nAustin,TX,Solar-Installation, ,12200,11/10/2022\nJacksonville,fl,Wind turbine,9800,11300,2022-12-01\nFort-worth,TX,solar installation, 9300 ,10900,12/15/2022", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces and trim City names", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').trim().toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["solar-Installation", "SoLAR Installation", "solar_instalation", "SOLAR Installation", "Solar-Installation", "solar installation"], "to": "Solar Installation"}, {"from": ["Wind_Turbine", "wind turbine", "wind-turbine", "Wind Turbine", "wind_turbine", "Wind turbine"], "to": "Wind Turbine"}]}, {"op": "core/text-transform", "description": "Trim whitespace and convert Price to integer", "columnName": "Price", "expression": "value.trim() == '' ? null : Number(value.trim())"}, {"op": "core/text-transform", "description": "Trim whitespace and convert LoanAmount to integer", "columnName": "LoanAmount", "expression": "value.trim() == '' ? null : Number(value.trim())"}, {"op": "core/date-parse", "description": "Parse Date column into yyyy-MM-dd", "columnName": "Date", "dateFormat": "auto", "mode": "normal", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Format Date as yyyy-MM-dd", "columnName": "Date", "expression": "value instanceof Date ? value.toISOString().slice(0,10) : value"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,12000,15000,2022-01-12\nLos Angeles,CA,Wind Turbine,11000,15000,2022-03-15\nChicago,IL,Solar Installation,11500,13000,2022-04-15\nHouston,TX,Wind Turbine,10500,12500,2022-05-20\nPhoenix,AZ,Solar Installation,,14000,2022-06-25\nPhiladelphia,PA,Wind Turbine,10000,12000,2022-07-15\nSan Antonio,TX,Solar Installation,9500,11000,2022-08-10\nSan Diego,CA,Wind Turbine,10800,11500,2022-09-05\nDallas,TX,Solar Installation,10200,11800,2022-09-20\nSan Jose,CA,Wind Turbine,10700,11900,2022-10-15\nAustin,TX,Solar Installation,,12200,2022-11-10\nJacksonville,FL,Wind Turbine,9800,11300,2022-12-01\nFort Worth,TX,Solar Installation,9300,10900,2022-12-15"}
{"purpose": "Standardize agricultural farm data including location names, crop types, and financial details for accurate reporting.", "raw_table": "FarmID,City,State,CropType,Yield(tons),LoanAmount,PlantingDate\n001,des moines,Iowa,Corn,150.5,50000,2021/04/15\n002,Sioux_City,iowa,wheat , 120.0 ,45000 ,15-04-2021\n003,Dubuque,Iowa,Soy-bean, ,  52000,04/16/2021\n004,AMES,Ia,Corn,140.3,NaN,2021-04-14\n005,Cedar-rapids,Iowa,Cotton,130.0,48000,2021.04.13\n006,Waterloo,IA,Soybean,125.0,47000,2021/04/15\n007,Clinton,iowa,Corn,135.7,49000,2021/4/12\n008,Des Moines,IA,corn,142,53000,16/04/2021\n009,,IA,Wheat,110.5,46000,2021-04-10\n010,Burlington,ia,soybean,128.4,47500,2021/04/11", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim spaces from CropType", "columnName": "CropType", "expression": "value.trim()"}, {"op": "core/mass-edit", "description": "Standardize State abbreviations", "columnName": "State", "edits": [{"from": ["Iowa", "ia", "Ia", "IA", "iowa", "Ia"], "to": "IA"}]}, {"op": "core/text-transform", "description": "Fix city names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value != null ? value.replace(/[_-]/g, ' ').split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1).toLowerCase()).join(' ') : value"}, {"op": "core/mass-edit", "description": "Correct CropType spellings", "columnName": "CropType", "edits": [{"from": ["Soy-bean"], "to": "Soybean"}, {"from": ["wheat "], "to": "Wheat"}, {"from": ["Corn", "corn"], "to": "Corn"}, {"from": ["Cotton"], "to": "Cotton"}, {"from": ["Soybean"], "to": "Soybean"}]}, {"op": "core/text-transform", "description": "Parse and standardize PlantingDate to yyyy-MM-dd", "columnName": "PlantingDate", "expression": "value.match(/\\d{4}[\\/\\-.]\\d{2}[\\/\\-.]\\d{2}/) ? value.replace(/[\\/\\.]/g,'-') : (value.match(/\\d{2}[\\/\\-.]\\d{2}[\\/\\-.]\\d{4}/) ? value.split(/[\\/\\-.]/).reverse().join('-') : value)"}, {"op": "core/date-parse", "description": "Convert PlantingDate to ISO date format", "columnName": "PlantingDate", "valueType": "date"}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount with median (48500)", "columnName": "LoanAmount", "edits": [{"from": ["NaN", ""], "to": "48500"}]}, {"op": "core/text-transform", "description": "Remove spaces and convert Yield(tons) and LoanAmount to numbers", "columnName": "Yield(tons)", "expression": "Number(value.trim())"}, {"op": "core/text-transform", "description": "Clean LoanAmount spaces and convert to number", "columnName": "LoanAmount", "expression": "Number(value.toString().trim())"}, {"op": "core/fill-down", "description": "Fill down missing City values", "columnName": "City"}], "clean_table": "FarmID,City,State,CropType,Yield(tons),LoanAmount,PlantingDate\n001,Des Moines,IA,Corn,150.5,50000,2021-04-15\n002,Sioux City,IA,Wheat,120,45000,2021-04-15\n003,Dubuque,IA,Soybean,,52000,2021-04-16\n004,Ames,IA,Corn,140.3,48500,2021-04-14\n005,Cedar Rapids,IA,Cotton,130,48000,2021-04-13\n006,Waterloo,IA,Soybean,125,47000,2021-04-15\n007,Clinton,IA,Corn,135.7,49000,2021-04-12\n008,Des Moines,IA,Corn,142,53000,2021-04-16\n009,Des Moines,IA,Wheat,110.5,46000,2021-04-10\n010,Burlington,IA,Soybean,128.4,47500,2021-04-11"}
{"purpose": "Standardize telecom customer data by correcting city names, normalizing business types, fixing date formats, and cleaning numeric fields.", "raw_table": "CustomerID,City,State,BusinessType,MonthlyFee,LoanAmount,ContractDate\n1001,New_york,NY,small-biz,49.99,1500,12/31/2023\n1002,los Angeles,CA,SMALL Biz,59.99,2000,2023-01-15\n1003,Chcago,IL,Enterprise,79.9,missing,15-Jan-2023\n1004,Houston,tx,enterprise ,89.99,2500,2023/02/20\n1005,Phoenix,AZ,Individual,29.99,,02-28-2023\n1006,San_francisco,CA,INDIVIDUAL,25.0,500,2023.03.05\n1007,Dallas,TX,smallbiz,55,1800,3/15/2023\n1008,NEW YORK,ny,Small_Biz,50,1600,31-12-2023\n1009,Los-Angeles,ca,enterprise,80,2100,2023-03-01\n1010,Chicago,IL,Small Biz,60,,2023/03/10\n1011,houston,TX,Individual,30,,March 5, 2023\n1012,Phoenix,az,small biz,45.99,1400,2023-03-15\n1013,San Francisco,Ca,ENTERPRISE,85,2300,2023-03-20", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york", "NEW YORK"], "to": "New York"}, {"from": ["los Angeles", "Los-Angeles"], "to": "Los Angeles"}, {"from": ["Chcago"], "to": "Chicago"}, {"from": ["San_francisco"], "to": "San Francisco"}, {"from": ["houston"], "to": "Houston"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["small-biz", "SMALL Biz", "smallbiz", "Small_Biz", "small biz"], "to": "Small Biz"}, {"from": ["enterprise", "enterprise "], "to": "Enterprise"}, {"from": ["Individual", "INDIVIDUAL", "Individual"], "to": "Individual"}]}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "columnName": "MonthlyFee", "expression": "isNonBlank(value) ? Number(value).toFixed(2) : \"\""}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value == 'missing' || value == '' ? '' : Number(value).toFixed(0)"}, {"op": "core/date-parse", "columnName": "ContractDate", "valueType": "date", "dateFormat": "MM/dd/yyyy|yyyy-MM-dd|dd-MMM-yyyy|yyyy/MM/dd|MM-dd-yyyy|yyyy.MM.dd|dd-MM-yyyy|MMMM d, yyyy"}, {"op": "core/text-transform", "columnName": "ContractDate", "expression": "value.toString().slice(0,10)"}], "clean_table": "CustomerID,City,State,BusinessType,MonthlyFee,LoanAmount,ContractDate\n1001,New York,NY,Small Biz,49.99,1500,2023-12-31\n1002,Los Angeles,CA,Small Biz,59.99,2000,2023-01-15\n1003,Chicago,IL,Enterprise,79.90,,2023-01-15\n1004,Houston,TX,Enterprise,89.99,2500,2023-02-20\n1005,Phoenix,AZ,Individual,29.99,,2023-02-28\n1006,San Francisco,CA,Individual,25.00,500,2023-03-05\n1007,Dallas,TX,Small Biz,55.00,1800,2023-03-15\n1008,New York,NY,Small Biz,50.00,1600,2023-12-31\n1009,Los Angeles,CA,Enterprise,80.00,2100,2023-03-01\n1010,Chicago,IL,Small Biz,60.00,,2023-03-10\n1011,Houston,TX,Individual,30.00,,2023-03-05\n1012,Phoenix,AZ,Small Biz,45.99,1400,2023-03-15\n1013,San Francisco,CA,Enterprise,85.00,2300,2023-03-20"}
{"purpose": "Clean and standardize farm loan application data including city names, loan amounts, and dates.", "raw_table": "ApplicantID,City,State,FarmType,LoanAmount,ApplicationDate,PricePerAcre\n1001,green-Vale,TX,corn, 150000 ,03/15/2023 ,1200\n1002,RedHill,tx,CATTLE,200000,2023-04-01, 1500\n1003,,TX,wheat,-180000,April 10 2023,1100\n1004,Blue-hill,Tx,Soy-bean,abc,4/15/23,1300\n1005,Green-Vale,TX,corn,175000,2023/05/01,1250\n1006,redhill,TX,corn,160000,05-10-2023,NA\n1007,BlueHill,TX,soybean,140000,May 20,2023,1350\n1008,greenvale,TX,Corn,165000,2023-06-01,1275\n1009,Red-hill,TX,Cattle,195000,06/05/2023,1480\n1010,Blue-Hill,TX,wheat,155000,2023-06-10,1150\n1011,Green_vale,TX,corn,,06-15-2023,1225\n1012,redhill,Tx,CATTLE,210000,June 20 2023,1510\n1013,Blue hill,TX,SOYBEAN,145000,2023/06/25,1340\n1014,Green-Vale,TX,Corn,170000,06/30/2023,1290", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names by removing underscores/hyphens and capitalizing properly", "columnName": "City", "expression": "value.toLowercase().replace(/[_-]/g,'').replace(/\\b\\w/g, v, v.toUppercase())"}, {"op": "core/mass-edit", "description": "Fix known City name variants", "columnName": "City", "edits": [{"from": ["Greenvale", "Green vale", "Green-Vale", "Green_vale", "greenvale", "green-vale", "green_vale"], "to": "Greenvale"}, {"from": ["Redhill", "redhill", "Red-hill", "red-hill"], "to": "Redhill"}, {"from": ["Bluehill", "Blue-Hill", "bluehill", "blue-hill", "Blue hill", "blue hill"], "to": "Bluehill"}]}, {"op": "core/text-transform", "description": "Standardize FarmType capitalization and remove hyphens", "columnName": "FarmType", "expression": "value.toLowercase().replace(/-/g, '').replace(/\\b\\w/g, v, v.toUppercase())"}, {"op": "core/mass-edit", "description": "Fix known FarmType variants", "columnName": "FarmType", "edits": [{"from": ["Soybean", "Soybean", "Soy-bean", "soybean", "soy-bean"], "to": "Soybean"}, {"from": ["Cattle", "CATTLE", "cattle"], "to": "Cattle"}, {"from": ["Corn", "corn", "CORN"], "to": "Corn"}, {"from": ["Wheat", "wheat", "WHEAT"], "to": "Wheat"}]}, {"op": "core/text-transform", "description": "Parse ApplicationDate to ISO format yyyy-MM-dd", "columnName": "ApplicationDate", "expression": "value ? date.parse(value).toString('yyyy-MM-dd') : null"}, {"op": "core/text-transform", "description": "Clean LoanAmount: remove spaces, handle non-numeric and missing values", "columnName": "LoanAmount", "expression": "if(value && value.trim().match(/^\\d+$/), value.trim(), null)"}, {"op": "core/text-transform", "description": "Clean PricePerAcre: remove spaces and 'NA' convert to null", "columnName": "PricePerAcre", "expression": "value && (value.toLowercase() == 'na' || value.trim() == '') ? null : value.trim()"}, {"op": "core/column-rename", "description": "Rename ApplicantID to ID for consistency", "oldColumnName": "ApplicantID", "newColumnName": "ID"}, {"op": "core/fill-down", "description": "Fill down missing City values", "columnName": "City"}], "clean_table": "ID,City,State,FarmType,LoanAmount,ApplicationDate,PricePerAcre\n1001,Greenvale,TX,Corn,150000,2023-03-15,1200\n1002,Redhill,TX,Cattle,200000,2023-04-01,1500\n1003,Redhill,TX,Wheat,180000,2023-04-10,1100\n1004,Bluehill,TX,Soybean,null,2023-04-15,1300\n1005,Greenvale,TX,Corn,175000,2023-05-01,1250\n1006,Redhill,TX,Corn,160000,2023-05-10,null\n1007,Bluehill,TX,Soybean,140000,2023-05-20,1350\n1008,Greenvale,TX,Corn,165000,2023-06-01,1275\n1009,Redhill,TX,Cattle,195000,2023-06-05,1480\n1010,Bluehill,TX,Wheat,155000,2023-06-10,1150\n1011,Greenvale,TX,Corn,null,2023-06-15,1225\n1012,Redhill,TX,Cattle,210000,2023-06-20,1510\n1013,Bluehill,TX,Soybean,145000,2023-06-25,1340\n1014,Greenvale,TX,Corn,170000,2023-06-30,1290"}
{"purpose": "Clean and standardize inconsistent city names, business types, and date formats in telecommunications loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,NY,wireless_service,1000,5000,2023/01/15\nLos_Angeles,ca,Cell tower,2000,abc,15-02-2023\nChicago,IL,wireless-service,1500,,2023-03-05\nhouston,Tx,CellTower,NA,7000,03/25/2023\nPHOENIX,AZ,,2500,8000,2023.04.01\nphiladelphia,pa,wireless service,1800,6500,2023/04/15\nsan-antonio,TX,Wireless_Services,1700,6000,Apr 20 2023\nsan diego,CA,cell tower,1300,5500,2023/04/31\nDALLAS,tx,Wireless service,1600,6200,2023-05-05\nsan jose,CA,cell_Tower,1100,4900,2023/05/10\nAUSTIN,TX,wireless_service,1400,5200,2023/05/15\njacksonville,FL,cell tower,1200,5300,May 20, 2023\nFORT worth,tx,Wireless-Service,1250,5800,2023/05/25\ncolumbus,OH,wireless-service,1350,6000,2023-06-01\ncharlotte,NC,cell tower,1150,6100,06/05/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names by proper capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.toLowercase().replace('_',' ').replace('-',' ').split(' ').map(s, s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix BusinessType inconsistencies and missing values", "columnName": "BusinessType", "edits": [{"from": ["wireless_service", "wireless-service", "Wireless-Service", "Wireless_Services", "wireless service", "Wireless service"], "to": "Wireless Service"}, {"from": ["cell tower", "cell_Tower", "CellTower", "Cell tower"], "to": "Cell Tower"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/mass-edit", "description": "Replace non-numeric LoanAmount with blanks", "columnName": "LoanAmount", "edits": [{"from": ["abc", "NA", ""], "to": ""}]}, {"op": "core/text-transform", "description": "Fix Price missing or non-numeric values to blank", "columnName": "Price", "expression": "value.toNumber() == null ? '' : value"}, {"op": "core/date-parse", "description": "Parse inconsistent Date formats into ISO yyyy-MM-dd", "columnName": "Date", "format": "auto", "onError": "keep-original", "onErrorString": ""}, {"op": "core/text-transform", "description": "Fix invalid dates like 2023/04/31 to empty", "columnName": "Date", "expression": "cells['Date'].value && value.match(/^\\d{4}-\\d{2}-\\d{2}$/) ? (new Date(value).toDateString() === 'Invalid Date' ? '' : value) : value"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Wireless Service,1000,5000,2023-01-15\nLos Angeles,CA,Cell Tower,2000,,2023-02-15\nChicago,IL,Wireless Service,1500,,2023-03-05\nHouston,TX,Cell Tower,,7000,2023-03-25\nPhoenix,AZ,Unknown,2500,8000,2023-04-01\nPhiladelphia,PA,Wireless Service,1800,6500,2023-04-15\nSan Antonio,TX,Wireless Service,1700,6000,2023-04-20\nSan Diego,CA,Cell Tower,1300,5500,\nDallas,TX,Wireless Service,1600,6200,2023-05-05\nSan Jose,CA,Cell Tower,1100,4900,2023-05-10\nAustin,TX,Wireless Service,1400,5200,2023-05-15\nJacksonville,FL,Cell Tower,1200,5300,2023-05-20\nFort Worth,TX,Wireless Service,1250,5800,2023-05-25\nColumbus,OH,Wireless Service,1350,6000,2023-06-01\nCharlotte,NC,Cell Tower,1150,6100,2023-06-05"}
{"purpose": "Clean and standardize city and business type fields, normalize price and loan amount formats, and correct date inconsistencies in telecom customer data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,SubscriptionDate\nNew_york,NY,Mobile Service, $99.99 ,10000,01-15-2023\nlos Angeles,CA,Internet-Service,89.9,9500,2023/02/20\nCHICAGO,IL,Cable TV,  120, 11000,03-05-23\nhouston,TX,mobile-service, $85.00, ,2023.04.10\nPHOENIX,az,Internet Service,95,8500,April 15 2023\nphiladelphia,Pa,Cable-tv,110.5,10500,2023-05-01\nsan_antonio,TX,Mobile service,100, 9800,05/20/2023\nSan Diego,ca,Internet_Service,  92.75,9000,2023-06-01\nDALLAS,TX,Cable TV,115,,2023-June-10\nsan jose,CA,mobile-service,  88.8,9700,06/15/2023\nAustin,TX,Internet service,$91.00,9200,2023/07/01\nJacksonville,FL,cable-tv, 105,10300,2023.07.15\nfort-worth,tx,mobile service,  87, 9400,07-20-2023\nColumbus,OH,Internet-Service, 90.5, ,2023-08-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names by replacing underscores and hyphens with spaces, trim, and capitalize properly", "columnName": "City", "expression": "value.replace(/[_-]+/,' ').trim().toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase two-letter codes", "columnName": "State", "expression": "value.trim().toUppercase()"}, {"op": "core/mass-edit", "description": "Fix common BusinessType misspellings and inconsistent punctuation", "columnName": "BusinessType", "edits": [{"from": ["Mobile Service", "mobile-service", "mobile service", "Mobile service", "mobile Service"], "to": "Mobile Service"}, {"from": ["Internet-Service", "Internet Service", "internet-service", "Internet_Service", "internet Service"], "to": "Internet Service"}, {"from": ["Cable TV", "cable-tv", "Cable-tv", "cable-tv", "Cable TV"], "to": "Cable TV"}]}, {"op": "core/text-transform", "description": "Clean Price column by removing $ and spaces, convert to number", "columnName": "Price", "expression": "value.replace(/\\$/,'').trim().toNumber()"}, {"op": "core/text-transform", "description": "Clean LoanAmount column by trimming spaces and converting to number; keep blank as null", "columnName": "LoanAmount", "expression": "value.trim() == '' ? null : value.trim().toNumber()"}, {"op": "core/date-parse", "description": "Parse SubscriptionDate into ISO format yyyy-MM-dd", "columnName": "SubscriptionDate", "expression": "value.toDate('MM-dd-yyyy') || value.toDate('yyyy/MM/dd') || value.toDate('MM/dd/yyyy') || value.toDate('yyyy-MM-dd') || value.toDate('MMM dd yyyy') || value.toDate('yyyy.MM.dd') || value.toDate('yyyy-MMM-dd') || value.toDate('MMM dd, yyyy') || value.toDate('MM-dd-yy')", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Format SubscriptionDate to yyyy-MM-dd string", "columnName": "SubscriptionDate", "expression": "value instanceof Date ? value.toString('yyyy-MM-dd') : value"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,SubscriptionDate\nNew York,NY,Mobile Service,99.99,10000,2023-01-15\nLos Angeles,CA,Internet Service,89.9,9500,2023-02-20\nChicago,IL,Cable TV,120,11000,2023-03-05\nHouston,TX,Mobile Service,85,null,2023-04-10\nPhoenix,AZ,Internet Service,95,8500,2023-04-15\nPhiladelphia,PA,Cable TV,110.5,10500,2023-05-01\nSan Antonio,TX,Mobile Service,100,9800,2023-05-20\nSan Diego,CA,Internet Service,92.75,9000,2023-06-01\nDallas,TX,Cable TV,115,null,2023-06-10\nSan Jose,CA,Mobile Service,88.8,9700,2023-06-15\nAustin,TX,Internet Service,91,9200,2023-07-01\nJacksonville,FL,Cable TV,105,10300,2023-07-15\nFort Worth,TX,Mobile Service,87,9400,2023-07-20\nColumbus,OH,Internet Service,90.5,null,2023-08-01"}
{"purpose": "Clean and standardize farm loan application data with inconsistent formatting and missing values.", "raw_table": "Farm_ID,City,State,Crop_Type,Loan_Amount,Application_Date\nF001,GreenVille,tx,Corn,15000,2023/01/15\nF002,greenville,TX,corn_,16000,15-02-2023\nF003,Greenville,Tx,,14000,2023.03.01\nF004,Rock_Hill,SC,Soybean,NaN,2023-04-10\nF005,rock-hill,SC,Soybeans,17000,\nF006,Charleston,SC,Wheat,15500,2023-05-20\nF007,charleston,sc,wheat,16500,2023/06/25\nF008,CHARLESTON,SC,Corn,15000,06-30-2023\nF009,Austin,TX,CORN,18000,2023-07-15\nF010,austin,tx,soybean,17500,2023/08/01\nF011,Dallas,tx,Wheat,NaN,2023/08/15\nF012,dallas,TX,Wheat,14500,2023-09-05\nF013,Houston,TX,,16000,09/10/2023\nF014,Houston,Tx,soybean,15800,2023-09-15\nF015,Houston,TX,corn,16500,2023-09-20", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.toLowercase().replace(/[_-]/g, ' ').replace(/\\b\\w/g, v, v.toUppercase())", "onError": "keep-original", "repeat": false}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()", "onError": "keep-original", "repeat": false}, {"op": "core/text-transform", "columnName": "Crop_Type", "expression": "value.toLowercase().replace(/s$/, '').trim()", "onError": "keep-original", "repeat": false}, {"op": "core/mass-edit", "columnName": "Crop_Type", "edits": [{"from": [""], "to": "unknown"}, {"from": ["corn_"], "to": "corn"}]}, {"op": "core/mass-edit", "columnName": "Loan_Amount", "edits": [{"from": ["NaN"], "to": ""}]}, {"op": "core/fill-down", "columnName": "Loan_Amount"}, {"op": "core/date-parse", "columnName": "Application_Date", "expression": "value.toString()", "onError": "keep-original", "repeat": false, "guessCellValue": true}, {"op": "core/mass-edit", "columnName": "Application_Date", "edits": [{"from": [""], "to": "2023-01-01"}]}], "clean_table": "Farm_ID,City,State,Crop_Type,Loan_Amount,Application_Date\nF001,Greenville,TX,corn,15000,2023-01-15\nF002,Greenville,TX,corn,16000,2023-02-15\nF003,Greenville,TX,unknown,14000,2023-03-01\nF004,Rock Hill,SC,soybean,14000,2023-04-10\nF005,Rock Hill,SC,soybean,17000,2023-01-01\nF006,Charleston,SC,wheat,15500,2023-05-20\nF007,Charleston,SC,wheat,16500,2023-06-25\nF008,Charleston,SC,corn,15000,2023-06-30\nF009,Austin,TX,corn,18000,2023-07-15\nF010,Austin,TX,soybean,17500,2023-08-01\nF011,Dallas,TX,wheat,17500,2023-08-15\nF012,Dallas,TX,wheat,14500,2023-09-05\nF013,Houston,TX,unknown,16000,2023-09-10\nF014,Houston,TX,soybean,15800,2023-09-15\nF015,Houston,TX,corn,16500,2023-09-20"}
{"purpose": "Standardize city names and business types, correct pricing and date formats in energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,NY,solar-installation,12000,50000,01/15/2023\nLOS-ANGELES,CA,Wind_Turbine,15000,,2023-02-30\nhouston,tx,solar_installation,eleven thousand,45000,03-05-2023\nchicago,IL,wind turbine,13000,40000,2023/04/10\nphoenix,az,Solar-Installation,,35000,04/25/23\nphiladelphia,PA,Wind-Turbine,14000,42000,May 5 2023\nsan antonio,TX,solar Installation,12500,46000,2023-06-15\nSAN DIEGO,CA,,13500,48000,2023.07.20\ndallas,Tx,wind Turbine,13000,43000,2023-07-31\nsan jose,ca,Solar_Installation,12750,47000,08/15/2023\nAustin,tx,wind turbine,NaN,44000,2023-09-01\njacksonville,FL,Solar-Installation,12900,45000,09-10-2023\nfort worth,TX,Wind_Turbine,13100,41500,2023/10/01\ncolumbus,OH,solar-installation,12800,46000,10/15/23\ncharlotte,NC,wind Turbine,13200,42500,2023-11-05", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase().replace(/[-_]/, ' ')"}, {"op": "core/text-transform", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[-_]/g, ' ').trim()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["solar installation", "solar-installation", "solar_installation", "solar Installation", "Solar-Installation", "Solar_Installation"], "to": "Solar Installation"}, {"from": ["wind turbine", "wind-turbine", "wind_turbine", "Wind-Turbine", "Wind_Turbine", "wind Turbine"], "to": "Wind Turbine"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.match(/\\d+/) != null ? Number(value.match(/\\d+/)[0]) : null"}, {"op": "core/mass-edit", "columnName": "Price", "edits": [{"from": [null], "to": ""}]}, {"op": "core/fill-down", "columnName": "LoanAmount"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value.toString()", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value.toDate() != null ? value.toDate().toString('yyyy-MM-dd') : ''"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,12000,50000,2023-01-15\nLos Angeles,CA,Wind Turbine,15000,50000,\nHouston,TX,Solar Installation,11000,45000,2023-03-05\nChicago,IL,Wind Turbine,13000,40000,2023-04-10\nPhoenix,AZ,Solar Installation,,35000,2023-04-25\nPhiladelphia,PA,Wind Turbine,14000,42000,2023-05-05\nSan Antonio,TX,Solar Installation,12500,46000,2023-06-15\nSan Diego,CA,Unknown,13500,48000,2023-07-20\nDallas,TX,Wind Turbine,13000,43000,2023-07-31\nSan Jose,CA,Solar Installation,12750,47000,2023-08-15\nAustin,TX,Wind Turbine,,44000,2023-09-01\nJacksonville,FL,Solar Installation,12900,45000,2023-09-10\nFort Worth,TX,Wind Turbine,13100,41500,2023-10-01\nColumbus,OH,Solar Installation,12800,46000,2023-10-15\nCharlotte,NC,Wind Turbine,13200,42500,2023-11-05"}
{"purpose": "Clean and standardize movie data including titles, genres, release dates, and box office revenue.", "raw_table": "MovieID,Title,Genre,ReleaseDate,BoxOfficeUSD\n1,The_avengers,action,05/04/2012,1.519B\n2,Inception,SCI-FI,16-07-2010,829895144\n3,parasite,drama,30/05/2019,258600000\n4,interstellar,,07-11-2014,677471339\n5,La_la_land,Musical,25/12/2016,446000000\n6,Avengers-Endgame,Action,26-APR-2019,2.798B\n7, joker ,Crime,04/10/2019,1074251311\n8,Frozen II,Animation,22-11-2019,1450026933\n9,The godfather,crime,24/03/1972,246120974\n10,Spider-man_far_from_home,Action,02-07-2019,1131927996\n11,Titanic,Romance,19/12/1997,2.195B\n12,Black_Panther,Action,16-02-2018,1346913161\n13,star wars: the last jedi,Sci-Fi,15/12/2017,1332539889\n14,Avatar,Science Fiction,18-12-2009,2.847B", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize Title capitalization and remove underscores", "columnName": "Title", "expression": "value.replace('_', ' ').trim().toTitlecase()"}, {"op": "core/text-transform", "description": "Fix Genre capitalization and standardize genre names", "columnName": "Genre", "expression": "value.toLowercase().replace('sci-fi','Science Fiction').replace('science fiction','Science Fiction').replace('musical','Musical').replace('crime','Crime').replace('drama','Drama').replace('action','Action').replace('romance','Romance').replace('animation','Animation')"}, {"op": "core/mass-edit", "description": "Fill missing Genre values with 'Unknown'", "columnName": "Genre", "edits": [{"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Parse ReleaseDate to ISO format yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "date.parse(value, ['dd/MM/yyyy','dd-MM-yyyy','dd-MMM-yyyy','dd/MM/yy','dd-MM-yy']).toString('yyyy-MM-dd')"}, {"op": "core/text-transform", "description": "Convert BoxOfficeUSD to numeric value in dollars", "columnName": "BoxOfficeUSD", "expression": "if(value.match(/B$/), value.replace('B','').toNumber()*1000000000, if(value.match(/M$/), value.replace('M','').toNumber()*1000000, value.toNumber()))"}], "clean_table": "MovieID,Title,Genre,ReleaseDate,BoxOfficeUSD\n1,The Avengers,Action,2012-04-05,1519000000\n2,Inception,Science Fiction,2010-07-16,829895144\n3,Parasite,Drama,2019-05-30,258600000\n4,Interstellar,Unknown,2014-11-07,677471339\n5,La La Land,Musical,2016-12-25,446000000\n6,Avengers Endgame,Action,2019-04-26,2798000000\n7,Joker,Crime,2019-10-04,1074251311\n8,Frozen Ii,Animation,2019-11-22,1450026933\n9,The Godfather,Crime,1972-03-24,246120974\n10,Spider Man Far From Home,Action,2019-07-02,1131927996\n11,Titanic,Romance,1997-12-19,2195000000\n12,Black Panther,Action,2018-02-16,1346913161\n13,Star Wars: The Last Jedi,Science Fiction,2017-12-15,1332539889\n14,Avatar,Science Fiction,2009-12-18,2847000000"}
{"purpose": "Standardize movie genres and correct inconsistent date and price formats in the dataset.", "raw_table": "MovieTitle,Genre,ReleaseDate,Rating,Price\n\"The_great Adventure\",adventure,7/15/21,PG-13,$12\n\"Love in paris\",RomCom,2021-02-30,pg,$15.5\n\"Space_quest\",SCI-FI,03-12-2020,PG,$ten\n\"Mystery Manor\",mystrey,2020/07/04,R,$8\n\"Funny Days\",comedy,04/25/19,PG,$7.0\n\"Dark_Night\",thriller,2019-13-01,R,$9.5\n\"Sunshine\",Rom-Com,2018-06-11,PG,$10\n\"Ocean's 11\",action,11/11/18,PG-13,$11\n\"Haunted_House\",HORROR,2017-10-31,R,$8\n\"The Last Dance\",Sport,2016/05/20,PG,$12\n\"Epic Journey\",Adventure,05-05-2015,PG-13,$13\n\"FunnyDays\",comdy,04/25/2019,PG,$7\n\"Romance_123\",romcom,2019-09-09,PG,$14\n\"Ghost Town\",Horror,10/31/2017,R,$8\n\"Space Quest\",sci_fi,2020-03-12,PG,$10\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and replace underscores/hyphens with spaces in MovieTitle", "columnName": "MovieTitle", "expression": "value.trim().replace(/[_-]+/, ' ')"}, {"op": "core/text-transform", "description": "Standardize Genre capitalization and fix common misspellings", "columnName": "Genre", "expression": "value.toLowercase().replace('romcom', 'Rom-Com').replace('rom-com', 'Rom-Com').replace('rom-com', 'Rom-Com').replace('comdy', 'Comedy').replace('mystrey', 'Mystery').replace('sci_fi', 'Sci-Fi').replace('sci-fi', 'Sci-Fi').replace('horrror', 'Horror')"}, {"op": "core/mass-edit", "description": "Correct Genre values with multiple errors", "columnName": "Genre", "edits": [{"from": ["sport"], "to": "Sports"}]}, {"op": "core/date-parse", "description": "Parse ReleaseDate into ISO format", "columnName": "ReleaseDate", "expression": "value.toDate()", "mode": "cells"}, {"op": "core/text-transform", "description": "Replace invalid dates with null", "columnName": "ReleaseDate", "expression": "if(isDate(value), value, null)"}, {"op": "core/text-transform", "description": "Normalize Rating capitalization", "columnName": "Rating", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize Price by removing $ and converting to number", "columnName": "Price", "expression": "value.replace(/\\$/, '').toNumber()"}, {"op": "core/mass-edit", "description": "Replace Price 'ten' with 10", "columnName": "Price", "edits": [{"from": ["ten"], "to": "10"}]}], "clean_table": "MovieTitle,Genre,ReleaseDate,Rating,Price\nThe great Adventure,Adventure,2021-07-15T00:00:00Z,PG-13,12\nLove in paris,Rom-Com,,PG,15.5\nSpace quest,Sci-Fi,2020-03-12T00:00:00Z,PG,10\nMystery Manor,Mystery,2020-07-04T00:00:00Z,R,8\nFunny Days,Comedy,2019-04-25T00:00:00Z,PG,7\nDark Night,Thriller,,R,9.5\nSunshine,Rom-Com,2018-06-11T00:00:00Z,PG,10\nOcean's 11,Action,2018-11-11T00:00:00Z,PG-13,11\nHaunted House,Horror,2017-10-31T00:00:00Z,R,8\nThe Last Dance,Sports,2016-05-20T00:00:00Z,PG,12\nEpic Journey,Adventure,2015-05-05T00:00:00Z,PG-13,13\nFunnyDays,Comedy,2019-04-25T00:00:00Z,PG,7\nRomance 123,Rom-Com,2019-09-09T00:00:00Z,PG,14\nGhost Town,Horror,2017-10-31T00:00:00Z,R,8\nSpace Quest,Sci-Fi,2020-03-12T00:00:00Z,PG,10\n"}
{"purpose": "Standardize movie titles and release dates, and clean up inconsistent genre labels in the entertainment dataset.", "raw_table": "Title,Genre,Release Date,Rating,Budget (M),Box Office (M)\n\"the avengers\",\"action_adventure\",\"05/04/2012\",8.0,\"220M\",\"1.519B\"\n\"inception\",\"SCI-FI\",07-16-2010,8.8,160,829.9M\n\"titanic\",\"Romance, Drama\",12_19_1997,7.8,200M,2.187B\n\"the godfather\",\"Crime-drama\",03/24/1972,9.2,6M,246M\n\"star wars: a new hope\",\"sci-fi\",\"May 25 1977\",8.6,,775.4M\n\"the dark knight\",\"Action\",07-18-2008,9.0,185M,1.005B\n\"forrest gump\",\"Drama\",07/06/1994,8.8,55,678.2M\n\"avatar\",\"sci_fi\",12/18/2009,7.8,237M,2.847B\n\"pirates_of_the_caribbean\",\"action-adventure\",07/09/2003,8.0,140,654.3M\n\"la la land\",\"Musical-Romance\",12-09-2016,8.0,30M,446.1M\n\"joker\",\"crime_drama\",10/04/2019,8.4,55M,1074M\n\"avengers: infinity war\",\"ACTION_ADVENTURE\",04/27/2018,8.5,316M,2048M\n\"black panther\",\"action\",02/16/2018,7.3,200M,1347M\n\"the shawshank redemption\",\"Drama\",09/23/1994,9.3,25,58.3M", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize Title capitalization and remove underscores", "columnName": "Title", "expression": "value.replace(/_/,' ').split(' ').map(word => word.toLowerCase()).map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Clean Genre: replace underscores and hyphens with space, split multiple genres by comma", "columnName": "Genre", "expression": "value.toLowerCase().replace(/[_-]/g,' ').split(',').map(g => g.trim()).map(g => g.charAt(0).toUpperCase() + g.slice(1)).join(', ')"}, {"op": "core/date-parse", "description": "Parse Release Date into ISO format", "columnName": "Release Date", "format": "flexible"}, {"op": "core/text-transform", "description": "Normalize Rating to number type", "columnName": "Rating", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Clean Budget (M): remove 'M', convert to number", "columnName": "Budget (M)", "expression": "value.replace(/[^0-9\\.]/g, '').toNumber()"}, {"op": "core/text-transform", "description": "Clean Box Office (M): convert from strings with B/M suffix to numeric million", "columnName": "Box Office (M)", "expression": "if(value.toLowerCase().endsWith('b')) { return parseFloat(value.replace(/[^0-9\\.]/g, '')) * 1000 } else if(value.toLowerCase().endsWith('m')) { return parseFloat(value.replace(/[^0-9\\.]/g, '')) } else { return value.toNumber() }"}, {"op": "core/mass-edit", "description": "Fix known genre misspellings", "columnName": "Genre", "edits": [{"from": ["Sci Fi", "Sci-fi", "Science Fiction"], "to": "Sci-Fi"}, {"from": ["Action Adventure", "Action-adventure"], "to": "Action-Adventure"}, {"from": ["Crime Drama", "Crime-drama", "Crime Drama"], "to": "Crime-Drama"}, {"from": ["Musical Romance", "Musical-Romance"], "to": "Musical"}]}, {"op": "core/fill-down", "description": "Fill missing Budget values down", "columnName": "Budget (M)"}], "clean_table": "Title,Genre,Release Date,Rating,Budget (M),Box Office (M)\nThe Avengers,Action-Adventure,2012-05-04T00:00:00Z,8,220,1519\nInception,Sci-Fi,2010-07-16T00:00:00Z,8.8,160,829.9\nTitanic,Romance, Drama,1997-12-19T00:00:00Z,7.8,200,2187\nThe Godfather,Crime-Drama,1972-03-24T00:00:00Z,9.2,6,246\nStar Wars: A New Hope,Sci-Fi,1977-05-25T00:00:00Z,8.6,6,775.4\nThe Dark Knight,Action,2008-07-18T00:00:00Z,9,185,1005\nForrest Gump,Drama,1994-07-06T00:00:00Z,8.8,55,678.2\nAvatar,Sci-Fi,2009-12-18T00:00:00Z,7.8,237,2847\nPirates Of The Caribbean,Action-Adventure,2003-07-09T00:00:00Z,8,140,654.3\nLa La Land,Musical,2016-12-09T00:00:00Z,8,30,446.1\nJoker,Crime-Drama,2019-10-04T00:00:00Z,8.4,55,1074\nAvengers: Infinity War,Action-Adventure,2018-04-27T00:00:00Z,8.5,316,2048\nBlack Panther,Action,2018-02-16T00:00:00Z,7.3,200,1347\nThe Shawshank Redemption,Drama,1994-09-23T00:00:00Z,9.3,25,58.3"}
{"purpose": "Clean inconsistent city and business type names, normalize price and date formats, and correct missing loan amounts.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew_york,ny,Mobile_Shop,299.99,15000,01-15-2023\nLOS ANGELES,CA,Internet-provider,199.95,,2023/02/28\nchicago,il,Mobileshop,250,12000,15/03/2023\nHouston,Tx,Mobile Shop,three hundrd,18000,2023-04-10\nphoenix,AZ,Internet Provider,179.9,15000,04-31-2023\nphiladelphia,pa,Mobile_Shop,299.99,missing,2023.05.05\nSan Antonio,TX,Internet-provider,200,13000,May 10 2023\nsan_diego,ca,Mobile Shop,270.00,11000,2023/06/15\nDALLAS,tx,MobileShop,280,14000,2023-07-01\nSan Jose,CA,Internet_provider,195.5,,2023-07-20\nAustin,tx,Mobile Shop,250,12500,07-25-2023\nJacksonville,fl,,199.99,10000,2023/08/05\nfort worth,TX,Mobile_Shop,260,13500,2023-08-15\nColumbus,OH,Internet-Provider,210.00,14500,2023-09-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names and remove underscores/hyphens", "columnName": "City", "expression": "value.toLowercase().replace('_',' ').replace('-',' ').split(' ').map(s, s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase state abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["Mobile_Shop", "Mobileshop", "MobileShop", "Mobile Shop"], "to": "Mobile Shop"}, {"from": ["Internet-provider", "Internet Provider", "Internet_provider", "Internet-Provider"], "to": "Internet Provider"}, {"from": [null, "", "missing"], "to": ""}]}, {"op": "core/text-transform", "description": "Fix Price to numeric string, convert 'three hundrd' to 300", "columnName": "Price", "expression": "value.toLowercase() == 'three hundrd' ? '300' : value.replace(/[^0-9\\.]/g, '')"}, {"op": "core/mass-edit", "description": "Replace missing LoanAmount with blank", "columnName": "LoanAmount", "edits": [{"from": ["missing", ""], "to": ""}]}, {"op": "core/text-transform", "description": "Fix LoanAmount to numeric string or blank", "columnName": "LoanAmount", "expression": "value == null || value.toLowercase() == 'missing' ? '' : value"}, {"op": "core/date-parse", "description": "Normalize Date formats to yyyy-MM-dd", "columnName": "Date", "expression": "value", "dateFormat": "auto-detect"}, {"op": "core/text-transform", "description": "Convert Date column to yyyy-MM-dd format string", "columnName": "Date", "expression": "cells['Date'].value ? cells['Date'].value.toDate().toString('yyyy-MM-dd') : ''"}, {"op": "core/fill-down", "description": "Fill down missing BusinessType values", "columnName": "BusinessType"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Mobile Shop,299.99,15000,2023-01-15\nLos Angeles,CA,Internet Provider,199.95,,2023-02-28\nChicago,IL,Mobile Shop,250,12000,2023-03-15\nHouston,TX,Mobile Shop,300,18000,2023-04-10\nPhoenix,AZ,Internet Provider,179.9,15000,2023-04-30\nPhiladelphia,PA,Mobile Shop,299.99,,2023-05-05\nSan Antonio,TX,Internet Provider,200,13000,2023-05-10\nSan Diego,CA,Mobile Shop,270.00,11000,2023-06-15\nDallas,TX,Mobile Shop,280,14000,2023-07-01\nSan Jose,CA,Internet Provider,195.5,,2023-07-20\nAustin,TX,Mobile Shop,250,12500,2023-07-25\nJacksonville,FL,,199.99,10000,2023-08-05\nFort Worth,TX,Mobile Shop,260,13500,2023-08-15\nColumbus,OH,Internet Provider,210.00,14500,2023-09-01"}
{"purpose": "Clean and standardize movie titles, genres, release dates, and box office revenues from inconsistent and messy entertainment data.", "raw_table": "MovieID,Title,Genre,ReleaseDate,BoxOffice\n1,The_great escape,action,07/08/1963,11.7M\n2,star wars: A New hope,SCI-FI,25-05-1977,7.7 mil\n3,casablanca,Romance,1942/11/26,4,000,000\n4,Inception, sCi-Fi ,2010-07-16,829.9M\n5,ForRest gump,Drama,08/07/1994,678300000\n6,titanic,Drama,1997-12-19,2.187B\n7,The Lion_king,Animation,06-24-1994,968.5 M\n8,avatar,sci-fi,2009/12/18,2.79 B\n9,The Matrix,SCI_fi,31/03/1999,463517383\n10,Interstellar,SCI-Fi,2014-11-07,677.5M\n11,gladiator,action,2000/05/05,457640427\n12,La La land,Music,2016-12-09,446.1 M\n13,Avengers:Endgame,Action,26-04-2019,2.798b\n14,,Comedy,2012-10-05,150000000\n15,Parasite,thriller,2019-05-30,258.8M", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and replace underscores and hyphens with spaces in Title", "columnName": "Title", "expression": "value.trim().replace(/[_-]+/, ' ')"}, {"op": "core/text-transform", "description": "Capitalize first letter of each word in Title", "columnName": "Title", "expression": "value.split(' ').map(w, w.substring(0,1).toUpperCase() + w.substring(1).toLowerCase()).join(' ')"}, {"op": "core/text-transform", "description": "Normalize Genre to lowercase", "columnName": "Genre", "expression": "value.toLowerCase().trim()"}, {"op": "core/mass-edit", "description": "Standardize genre values", "columnName": "Genre", "edits": [{"from": ["sci-fi", "sci_fi", "SCI-FI", "SCI_fi", "Sci-Fi", "sCi-Fi", "sci-fi "], "to": "sci-fi"}, {"from": ["music"], "to": "musical"}, {"from": ["thriller"], "to": "thriller"}, {"from": ["action"], "to": "action"}, {"from": ["romance"], "to": "romance"}, {"from": ["animation"], "to": "animation"}, {"from": ["comedy"], "to": "comedy"}, {"from": ["drama"], "to": "drama"}]}, {"op": "core/text-transform", "description": "Parse ReleaseDate into ISO standard format yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "date.parse(value).toISOString().substring(0,10)"}, {"op": "core/text-transform", "description": "Clean BoxOffice values by removing commas and letters and convert to numeric in millions", "columnName": "BoxOffice", "expression": "value.toString().replace(/[,\\sMBbmilr]+/gi, '').toNumber()/1000"}, {"op": "core/mass-edit", "description": "Fill missing Title with 'Unknown'", "columnName": "Title", "edits": [{"from": [""], "to": "Unknown"}]}], "clean_table": "MovieID,Title,Genre,ReleaseDate,BoxOffice\n1,The Great Escape,action,1963-07-08,11.7\n2,Star Wars: A New Hope,sci-fi,1977-05-25,7.7\n3,Casablanca,romance,1942-11-26,4.0\n4,Inception,sci-fi,2010-07-16,829.9\n5,Forrest Gump,drama,1994-08-07,678.3\n6,Titanic,drama,1997-12-19,2187.0\n7,The Lion King,animation,1994-06-24,968.5\n8,Avatar,sci-fi,2009-12-18,2790.0\n9,The Matrix,sci-fi,1999-03-31,463.517383\n10,Interstellar,sci-fi,2014-11-07,677.5\n11,Gladiator,action,2000-05-05,457.640427\n12,La La Land,musical,2016-12-09,446.1\n13,Avengers Endgame,action,2019-04-26,2798.0\n14,Unknown,comedy,2012-10-05,150.0\n15,Parasite,thriller,2019-05-30,258.8"}
{"purpose": "Standardize inconsistent city and state names and normalize financial and date formats in government loan application data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew_york,ny,REtail,100000,50000,03-15-2023\nlos-angeles,CA,Retail,85000,NaN,2023/04/01\nChicago,IL,retail,92000,,04-15-2023\nhouston,TX,RETAIL,87000,45000,15/05/2023\nPHILADELPHIA,pa,Reta1l,95000,47000,2023-06-01\nPhoenix,Az,Manufacturing,120000,60000,2023.06.20\nsan_antonio,TX,manufacturing,110000,59000,06-25-2023\nSan Diego,CA,Manufacturing,missing,58000,2023/07/10\nDallas,Tx,Manufacturing,115000,62000,07-15-2023\nSan Jose,CA,REtail,99000,54000,2023-07-20\nAustin,tx,Retail,93000,55000,07/25/2023\nJacksonville,FL,retail,88000,,2023-08-01\nfort-worth,TX,Retail,87000,46000,2023-08-05\nColumbus,oh,Retail,89000,47000,08-10-2023\nCharlotte,NC,REtail,90000,48000,2023-08-15", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City with spaces", "columnName": "City", "expression": "value.replace('_', ' ').replace('-', ' ')"}, {"op": "core/text-transform", "description": "Capitalize each word in City", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/mass-edit", "description": "Standardize State abbreviations to uppercase", "columnName": "State", "edits": [{"from": ["ny", "pa", "az", "tx", "fl", "oh", "nc"], "to": ["NY", "PA", "AZ", "TX", "FL", "OH", "NC"]}, {"from": ["Tx", "tx", "Pa"], "to": ["TX", "TX", "PA"]}]}, {"op": "core/mass-edit", "description": "Correct misspelled BusinessType entries", "columnName": "BusinessType", "edits": [{"from": ["REtail", "Reta1l", "retail", "RETAIL", "REtail"], "to": "Retail"}, {"from": ["manufacturing", "Manufacturing", "Manufacturing"], "to": "Manufacturing"}]}, {"op": "core/mass-edit", "description": "Replace missing and invalid Price with empty", "columnName": "Price", "edits": [{"from": ["missing", "NaN"], "to": ""}]}, {"op": "core/text-transform", "description": "Ensure Price is numeric string or empty", "columnName": "Price", "expression": "value.match(/\\d+/) ? value.match(/\\d+/)[0] : ''"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount where empty", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Convert LoanAmount to numeric string", "columnName": "LoanAmount", "expression": "value ? value.toString() : ''"}, {"op": "core/date-parse", "description": "Parse ApplicationDate to yyyy-MM-dd", "columnName": "ApplicationDate", "format": "auto-detect"}, {"op": "core/text-transform", "description": "Format dates uniformly as yyyy-MM-dd", "columnName": "ApplicationDate", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew York,NY,Retail,100000,50000,2023-03-15\nLos Angeles,CA,Retail,85000,50000,2023-04-01\nChicago,IL,Retail,92000,50000,2023-04-15\nHouston,TX,Retail,87000,45000,2023-05-15\nPhiladelphia,PA,Retail,95000,47000,2023-06-01\nPhoenix,AZ,Manufacturing,120000,60000,2023-06-20\nSan Antonio,TX,Manufacturing,110000,59000,2023-06-25\nSan Diego,CA,Manufacturing,,58000,2023-07-10\nDallas,TX,Manufacturing,115000,62000,2023-07-15\nSan Jose,CA,Retail,99000,54000,2023-07-20\nAustin,TX,Retail,93000,55000,2023-07-25\nJacksonville,FL,Retail,88000,55000,2023-08-01\nFort Worth,TX,Retail,87000,46000,2023-08-05\nColumbus,OH,Retail,89000,47000,2023-08-10\nCharlotte,NC,Retail,90000,48000,2023-08-15"}
{"purpose": "Standardize inconsistent city names and normalize date formats in government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,Retail,100000,50000,01-15-2021\nlos-angeles,CA,Manufacturing,200000,150000,2021/02/20\nCHICAGO,IL,healthcare,150000,100000,Mar 5 2021\nhouston,TX,retail,130000,,03-25-21\nPhoenix,AZ,Manufacturing,abc,70000,2021-04-01\nphiladelphia,pa,HEALTHCARE,120000,60000,04/15/2021\nsan antonio,TX,Retail,90000,45000,15-05-2021\nSan Diego,CA,Manufacturing,180000,140000,2021.06.10\ndallas,tx,Retail,95000,48000,2021-07-05\nsan_jose,CA,Healthcare,110000,55000,07/20/2021\nAustin,TX,manufacturing,160000,120000,August 1 2021\nJacksonville,FL,Retail,85000,40000,2021-08-15\nfort-worth,TX,Manufacturing,175000,130000,2021/09/10\nColumbus,OH,HEALTHCARE,140000,90000,09-25-2021", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens, capitalize city names", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').split(' ').map(s => s.toLowerCase().replace(/(^|\\s)\\w/g, c => c.toUpperCase())).join(' ')"}, {"op": "core/text-transform", "description": "Capitalize state abbreviations", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/text-transform", "description": "Capitalize BusinessType uniformly", "columnName": "BusinessType", "expression": "value.toLowerCase().replace(/(^|\\s)\\w/g, c => c.toUpperCase())"}, {"op": "core/mass-edit", "description": "Fix wrong Price values", "columnName": "Price", "edits": [{"from": ["abc"], "to": ""}]}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount with empty string", "columnName": "LoanAmount", "edits": [{"from": [""], "to": ""}]}, {"op": "core/text-transform", "description": "Standardize Date to yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate('MM-dd-yyyy').toString('yyyy-MM-dd') || value.toDate('yyyy/MM/dd').toString('yyyy-MM-dd') || value.toDate('MMM d yyyy').toString('yyyy-MM-dd') || value.toDate('MM/dd/yyyy').toString('yyyy-MM-dd') || value.toDate('yyyy-MM-dd').toString('yyyy-MM-dd') || value.toDate('dd-MM-yyyy').toString('yyyy-MM-dd') || value.toDate('yyyy.MM.dd').toString('yyyy-MM-dd') || value.toDate('MMMM d yyyy').toString('yyyy-MM-dd') || value.toDate('dd/MM/yyyy').toString('yyyy-MM-dd') || value"}, {"op": "core/fill-down", "description": "Fill down empty LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,100000,50000,2021-01-15\nLos Angeles,CA,Manufacturing,200000,150000,2021-02-20\nChicago,IL,Healthcare,150000,100000,2021-03-05\nHouston,TX,Retail,130000,100000,2021-03-25\nPhoenix,AZ,Manufacturing,,70000,2021-04-01\nPhiladelphia,PA,Healthcare,120000,60000,2021-04-15\nSan Antonio,TX,Retail,90000,45000,2021-05-15\nSan Diego,CA,Manufacturing,180000,140000,2021-06-10\nDallas,TX,Retail,95000,48000,2021-07-05\nSan Jose,CA,Healthcare,110000,55000,2021-07-20\nAustin,TX,Manufacturing,160000,120000,2021-08-01\nJacksonville,FL,Retail,85000,40000,2021-08-15\nFort Worth,TX,Manufacturing,175000,130000,2021-09-10\nColumbus,OH,Healthcare,140000,90000,2021-09-25"}
{"purpose": "Standardize inconsistent city and state names, normalize business types, and correct date and numeric formats in a government loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew_york,NY,retaiL,100000,50000,01/15/2023\nLos-Angeles,ca,Retaill,200000,abc,2023-02-30\nchicago,IL,,150000,75000,15-03-2023\nHouston,TX,manufacturing,120000,60000,03/25/2023\nPHOENIX,az,manufactur-ing,130000,,2023/04/10\nphiladelphia,PA,retail,110000,55000,2023_05_05\nSan-antonio,TX,RETAIL,90000,45000,2023-06-15\nsan diego,CA,manufacturing,wrong,70000,06/20/2023\nDallas,Tx,retail,95000,47500,2023-07-01\nSan_jose,CA,manufacturing,125000,62500,07-15-2023\nAustin,tx,retail,105000,52500,2023/08/01\nJacksonville,fl,manufacturing,115000,57500,08/15/2023\nFort Worth,TX,retail,85000,42500,2023-09-01\nColumbus,Oh,retail,100000,50000,09/15/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize first letters and remove underscores/hyphens in City", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toLowercase().split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase State codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Correct misspellings and normalize BusinessType", "columnName": "BusinessType", "edits": [{"from": ["retaiL", "Retaill", "RETAIL", "retail"], "to": "Retail"}, {"from": ["manufacturing", "manufactur-ing", "Manufacturing"], "to": "Manufacturing"}, {"from": [""], "to": "Retail"}]}, {"op": "core/mass-edit", "description": "Fix Price field: replace 'wrong' with empty to process later", "columnName": "Price", "edits": [{"from": ["wrong"], "to": ""}]}, {"op": "core/text-transform", "description": "Parse Price to number, empty to null", "columnName": "Price", "expression": "isNaN(Number(value)) || value.trim() === '' ? null : Number(value)"}, {"op": "core/text-transform", "description": "Parse LoanAmount to number, replace non-numeric or missing with null", "columnName": "LoanAmount", "expression": "isNaN(Number(value)) || value.trim() === '' ? null : Number(value)"}, {"op": "core/text-transform", "description": "Normalize Date formats to yyyy-MM-dd", "columnName": "Date", "expression": "var d = value.replace(/_/g, '-').replace(/\\//g, '-'); var dt = new Date(d); if (isNaN(dt)) { var parts = d.split('-'); if(parts.length == 3) { if(parts[0].length == 2 && parts[2].length == 4) { dt = new Date(parts[2] + '-' + parts[0] + '-' + parts[1]); } else if(parts[0].length == 4) { dt = new Date(parts[0] + '-' + parts[1] + '-' + parts[2]); } } } dt.toISOString().substring(0,10)"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,100000,50000,2023-01-15\nLos Angeles,CA,Retail,200000,null,2023-02-30\nChicago,IL,Retail,150000,75000,2023-03-15\nHouston,TX,Manufacturing,120000,60000,2023-03-25\nPhoenix,AZ,Manufacturing,130000,null,2023-04-10\nPhiladelphia,PA,Retail,110000,55000,2023-05-05\nSan Antonio,TX,Retail,90000,45000,2023-06-15\nSan Diego,CA,Manufacturing,null,70000,2023-06-20\nDallas,TX,Retail,95000,47500,2023-07-01\nSan Jose,CA,Manufacturing,125000,62500,2023-07-15\nAustin,TX,Retail,105000,52500,2023-08-01\nJacksonville,FL,Manufacturing,115000,57500,2023-08-15\nFort Worth,TX,Retail,85000,42500,2023-09-01\nColumbus,OH,Retail,100000,50000,2023-09-15"}
{"purpose": "Standardize city names, fix date formats, and normalize loan amounts for energy project financing data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_York,ny,solar-InC,12000,10,000,2023/01/15\nlos-angeles,CA,Wind Ltd,15000,15000,15-02-2023\nhouston,TX,Solar inc,13000,13_000,03.03.2023\nchicago,il,Wind ltd,11500,,2023-04-10\nphoenix,AZ,SOLAR INC,14000,14000,2023/5/20\nphiladelphia,pa,wind-ltd,NaN,11000,2023.06.15\nsan-antonio,tx,Solar inc,12500,12500,07/07/2023\nSan Diego,ca,Wind Ltd,13500,NaN,2023-08-12\nDallas,TX,Solar inc,12700,12700,2023/9/1\nsan jose,CA,wind ltd,13000,13000,2023-10-05\nAustin,tx,SOLAR INC,14000,14,000,11-11-2023\nJacksonville,fl,Wind Ltd,NaN,12000,2023/12/01\nFort-Worth,TX,Solar inc,12800,12800,2023-12-15", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names with spaces", "columnName": "City", "expression": "value.replace('_', ' ').replace('-', ' ')"}, {"op": "core/text-transform", "description": "Capitalize each word in City names", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "description": "Uppercase State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Standardize BusinessType values", "columnName": "BusinessType", "expression": "value.toLowercase().replace('solar inc', 'Solar Inc').replace('wind ltd', 'Wind Ltd').replace('solar-inc', 'Solar Inc').replace('wind-ltd', 'Wind Ltd')"}, {"op": "core/text-transform", "description": "Fix Price column: replace NaN or missing with blank", "columnName": "Price", "expression": "if(value.toLowercase() == 'nan' || value.trim() == '', '', value)"}, {"op": "core/text-transform", "description": "Remove commas and underscores from LoanAmount and parse as number", "columnName": "LoanAmount", "expression": "value.replace(',', '').replace('_', '')"}, {"op": "core/mass-edit", "columnName": "LoanAmount", "edits": [{"from": [""], "to": "0"}, {"from": ["NaN", "nan"], "to": "0"}]}, {"op": "core/date-parse", "columnName": "Date", "expression": "value", "onError": "keep-original", "onNull": "keep-original", "guessCellType": true}, {"op": "core/text-transform", "description": "Format Date column to yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/mass-edit", "columnName": "Price", "edits": [{"from": [""], "to": "0"}]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Inc,12000,10000,2023-01-15\nLos Angeles,CA,Wind Ltd,15000,15000,2023-02-15\nHouston,TX,Solar Inc,13000,13000,2023-03-03\nChicago,IL,Wind Ltd,11500,0,2023-04-10\nPhoenix,AZ,Solar Inc,14000,14000,2023-05-20\nPhiladelphia,PA,Wind Ltd,0,11000,2023-06-15\nSan Antonio,TX,Solar Inc,12500,12500,2023-07-07\nSan Diego,CA,Wind Ltd,13500,0,2023-08-12\nDallas,TX,Solar Inc,12700,12700,2023-09-01\nSan Jose,CA,Wind Ltd,13000,13000,2023-10-05\nAustin,TX,Solar Inc,14000,14000,2023-11-11\nJacksonville,FL,Wind Ltd,0,12000,2023-12-01\nFort Worth,TX,Solar Inc,12800,12800,2023-12-15"}
{"purpose": "Clean and standardize city names and date formats, normalize business types, and fix numeric fields for municipal grant applications.", "raw_table": "City,State,BusinessType,GrantAmount,ApplicationDate\nnew-york,NY,Non-Profit,50000,03-25-2023\nlos angeles,CA,nonprofit,45000,2023/04/12\nCHICAGO,IL,For-Profit,70000,15-05-2023\nhouston,TX,for-profit,68000,2023.06.01\nPHOENIX,Az,Non_profit,32000,2023/07/20\nphiladelphia,pa,forprofit,75000,2023-08-05\nsan antonio,tx,Non-Profit,NaN,2023-09-10\nsan-diego,CA,For Profit,60000,09/15/2023\nDALLAS,tx,,55000,2023-10-01\nsan jose,ca,NonProfit,58000,10-12-2023\nAustin,TX,for profit,62000,2023/11/20\njacksonville,fl,for-Profit,49000,2023-12-01\nFORT WORTH,TX,Non Profit,53000,12/15/2023\ncolumbus,oh,Non-Profit,51000,2023.12.30\ncharlotte,nc,forprofit,67000,2024-01-05", "cleaning_workflow": [{"op": "core/text-transform", "description": "Clean city names by removing hyphens and capitalizing properly", "columnName": "City", "expression": "value.replaceAll('[-_]',' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize state abbreviations to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values to 'Non-Profit' or 'For-Profit'", "columnName": "BusinessType", "edits": [{"from": ["nonprofit", "NonProfit", "Non_profit", "Non Profit", "Non-Profit"], "to": "Non-Profit"}, {"from": ["forprofit", "For Profit", "for profit", "for-profit", "For-Profit", "for-Profit"], "to": "For-Profit"}]}, {"op": "core/mass-edit", "description": "Replace 'NaN' in GrantAmount with blank", "columnName": "GrantAmount", "edits": [{"from": ["NaN"], "to": ""}]}, {"op": "core/text-transform", "description": "Convert GrantAmount to numeric string without commas", "columnName": "GrantAmount", "expression": "value.replaceAll(',', '')"}, {"op": "core/date-parse", "description": "Parse ApplicationDate into consistent yyyy-MM-dd format", "columnName": "ApplicationDate", "expression": "value", "dateFormat": "guess", "newColumn": false, "onError": "keep-original"}, {"op": "core/text-transform", "description": "Format ApplicationDate to ISO yyyy-MM-dd", "columnName": "ApplicationDate", "expression": "value.toDate().toISOString().substring(0,10)"}, {"op": "core/fill-down", "description": "Fill down missing BusinessType values", "columnName": "BusinessType"}], "clean_table": "City,State,BusinessType,GrantAmount,ApplicationDate\nNew York,NY,Non-Profit,50000,2023-03-25\nLos Angeles,CA,Non-Profit,45000,2023-04-12\nChicago,IL,For-Profit,70000,2023-05-15\nHouston,TX,For-Profit,68000,2023-06-01\nPhoenix,AZ,Non-Profit,32000,2023-07-20\nPhiladelphia,PA,For-Profit,75000,2023-08-05\nSan Antonio,TX,Non-Profit,,2023-09-10\nSan Diego,CA,For-Profit,60000,2023-09-15\nDallas,TX,For-Profit,55000,2023-10-01\nSan Jose,CA,Non-Profit,58000,2023-10-12\nAustin,TX,For-Profit,62000,2023-11-20\nJacksonville,FL,For-Profit,49000,2023-12-01\nFort Worth,TX,Non-Profit,53000,2023-12-15\nColumbus,OH,Non-Profit,51000,2023-12-30\nCharlotte,NC,For-Profit,67000,2024-01-05"}
{"purpose": "Clean and standardize movie titles, release years, genres, box office revenues, and release dates for accurate analysis.", "raw_table": "MovieTitle,ReleaseYear,Genre,BoxOffice,ReleaseDate\nThe Shawshank Redemption,1994,Drama,28341469,$28,341,469,1994-09-23\npulp-fiction,1994-crime,crime ,213928762,October 14, 1994\nInception,2010,Science_Fiction,829895144,07/16/2010\nThe godfather,1972,Crime,134966411,$134,966,411,03-24-1972\nForrest Gump,1994,Drama,678222284,1994/07/06\nInterstellar,2014,science fiction,677471339,11-07-2014\nFight Club,1999,drama,37030102,$37,030,102,1999.10.15\nThe Dark Knight,2008,Action,1004558444,2008/07/18\nSchindler's List,1993,Drama,,12/15/1993\nThe Matrix,,Science_Fiction,463517383,1999-03-31\nGladiator,2000,Action,187705427,05/05/2000\nAvatar,2009,Science_Fiction,2847246203,2009-12-18\nThe Lion King,1994,Animation,968483777,06-24-1994\nToy Story,1995,Animation,373554033,11/22/1995\nThe Avengers,2012,Action,1518812988,05.04.2012", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize MovieTitle capitalization", "columnName": "MovieTitle", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "description": "Fix ReleaseYear by extracting 4-digit year only", "columnName": "ReleaseYear", "expression": "value.match(/\\\\d{4}/).length > 0 ? value.match(/\\\\d{4}/)[0] : \"\""}, {"op": "core/text-transform", "description": "Standardize Genre to proper capitalization and fix underscores", "columnName": "Genre", "expression": "value.toLowercase().replace('_', ' ').split(' ').map(s, i, a, s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Clean BoxOffice to numeric value only, remove $ and commas", "columnName": "BoxOffice", "expression": "value.replace(/[^0-9]/g, '')"}, {"op": "core/text-transform", "description": "Parse ReleaseDate into ISO format yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "value.toDate() ? value.toDate().toISOString().substring(0, 10) : ''"}, {"op": "core/mass-edit", "description": "Fill missing ReleaseYear from ReleaseDate", "columnName": "ReleaseYear", "edits": [{"from": [""], "to": ""}]}, {"op": "core/fill-down", "description": "Fill missing ReleaseYear downwards where empty", "columnName": "ReleaseYear"}, {"op": "core/mass-edit", "description": "Fill missing BoxOffice with 0", "columnName": "BoxOffice", "edits": [{"from": [""], "to": "0"}]}], "clean_table": "MovieTitle,ReleaseYear,Genre,BoxOffice,ReleaseDate\nThe Shawshank Redemption,1994,Drama,28341469,1994-09-23\nPulp Fiction,1994,Crime,213928762,1994-10-14\nInception,2010,Science Fiction,829895144,2010-07-16\nThe Godfather,1972,Crime,134966411,1972-03-24\nForrest Gump,1994,Drama,678222284,1994-07-06\nInterstellar,2014,Science Fiction,677471339,2014-11-07\nFight Club,1999,Drama,37030102,1999-10-15\nThe Dark Knight,2008,Action,1004558444,2008-07-18\nSchindler'S List,1993,Drama,0,1993-12-15\nThe Matrix,1999,Science Fiction,463517383,1999-03-31\nGladiator,2000,Action,187705427,2000-05-05\nAvatar,2009,Science Fiction,2847246203,2009-12-18\nThe Lion King,1994,Animation,968483777,1994-06-24\nToy Story,1995,Animation,373554033,1995-11-22\nThe Avengers,2012,Action,1518812988,2012-05-04"}
{"purpose": "Clean and standardize movie theater chain names, locations, and showtime data for accurate reporting.", "raw_table": "Theater,City,State,TicketPrice,ShowDate,SeatsAvailable\nCINEMA-PLEX,los angeles,CA,12.5,03/15/2023,150\nMajestic_theater,New york,ny,15.00,2023-03-16,NA\nGrand-cinema,Chicago,IL,eleven,03-17-2023,120\ncinema-plex,Los Angeles,ca,12.50,15/03/2023,145\nMajestic Theater,NEW YORK,NY,15,Mar 16 2023,100\nGrand Cinema,CHICAGO,il,11.00,03/17/2023,125\ncineMa-plex,los angeles,Ca,12.5,2023/03/15,NA\nMajestic_theater,New York,NY,,2023-03-16,110\nGrand-cinema,Chicago,Ill,11,17-Mar-2023,130\nCINEMA_PLEX,LOS ANGELES,CA,12.50,03.15.2023,140\nMajestic Theater,New york,ny,15.00,03/16/23,115\nGrand Cinema,Chicago,IL,11,03/17/2023,NA", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize Theater names capitalization and spacing", "columnName": "Theater", "expression": "value.toLowercase().replaceAll('_',' ').replaceAll('-',' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Fix known misspellings in State", "columnName": "State", "edits": [{"from": ["Ill"], "to": "IL"}, {"from": ["ny"], "to": "NY"}, {"from": ["ca"], "to": "CA"}]}, {"op": "core/text-transform", "description": "Capitalize City names properly", "columnName": "City", "expression": "value.split(' ').map(s => s.toLowercase().capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Convert TicketPrice to numeric, fix text 'eleven' to 11", "columnName": "TicketPrice", "expression": "value.toLowercase() == 'eleven' ? 11 : (value == 'NA' || value == '' ? null : Number(value))"}, {"op": "core/date-parse", "description": "Parse ShowDate into ISO format", "columnName": "ShowDate", "expression": "value", "dateFormat": "multiple"}, {"op": "core/text-transform", "description": "Normalize SeatsAvailable, convert NA or missing to null and force numeric", "columnName": "SeatsAvailable", "expression": "value.toUppercase() == 'NA' || value == '' ? null : Number(value)"}, {"op": "core/fill-down", "description": "Fill down missing TicketPrice values", "columnName": "TicketPrice"}], "clean_table": "Theater,City,State,TicketPrice,ShowDate,SeatsAvailable\nCinema Plex,Los Angeles,CA,12.5,2023-03-15,150\nMajestic Theater,New York,NY,15,2023-03-16,null\nGrand Cinema,Chicago,IL,11,2023-03-17,120\nCinema Plex,Los Angeles,CA,12.5,2023-03-15,145\nMajestic Theater,New York,NY,15,2023-03-16,100\nGrand Cinema,Chicago,IL,11,2023-03-17,125\nCinema Plex,Los Angeles,CA,12.5,2023-03-15,null\nMajestic Theater,New York,NY,15,2023-03-16,110\nGrand Cinema,Chicago,IL,11,2023-03-17,130\nCinema Plex,Los Angeles,CA,12.5,2023-03-15,140\nMajestic Theater,New York,NY,15,2023-03-16,115\nGrand Cinema,Chicago,IL,11,2023-03-17,null"}
{"purpose": "Standardize movie genres and correct inconsistent release dates in the dataset.", "raw_table": "MovieTitle,Genre,ReleaseDate,Rating,BoxOffice\n\"the_shining\",\"Horror\",\"1980/05/23\",\"8.4\",\"47_million\"\n\"Inception\",\"sci-fi\",\"2010-07-16\",\"8.8\",\"829 million\"\n\"Titanic\",\"romance\",\"12/19/1997\",\"7.8\",\"2.187 billion\"\n\"joker\",\"Drama\",\"2019-10-04\",\"8.5\",\"$1.074 billion\"\n\"Avengers: Endgame\",\"Action\",\"2019-04-26\",\"8.4\",\"2.798 billion\"\n\"Parasite\",\"thriller\",\"2019-05-30\",\"8.6\",\"257_million\"\n\"Frozen_II\",\"Animation\",\"2019-11-22\",\"7.0\",\"1.450 billion\"\n\"The-godfather\",\"Crime\",\"03/24/1972\",\"9.2\",\"246_million\"\n\"La_La_Land\",\"musical\",\"12-09-2016\",\"8.0\",\"446 million\"\n\"The Dark Knight\",\"ACTION\",\"07-18-2008\",\"9.0\",\"1.005 billion\"\n\"The Lion King\",\"animation\",\"1994-06-24\",\"8.5\",\"968.5 million\"\n\"Interstellar\",\"SciFi\",\"2014-11-07\",\"8.6\",\"677 million\"\n\"Spider-man: far from home\",\"action\",\"07/02/2019\",\"7.5\",\"1.131 billion\"", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens from MovieTitle and capitalize each word", "columnName": "MovieTitle", "expression": "value.replace(/[_-]/g, ' ').split(' ').map(s -> s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Normalize Genre values to proper capitalization and standard genre names", "columnName": "Genre", "expression": "value.toLowercase().trim().replace('sci-fi', 'Sci-Fi').replace('scifi', 'Sci-Fi').replace('sci fi', 'Sci-Fi').replace('musical', 'Musical').replace('thriller', 'Thriller').replace('romance', 'Romance').replace('action', 'Action').replace('drama', 'Drama').replace('horror', 'Horror').replace('animation', 'Animation').replace('crime', 'Crime')"}, {"op": "core/text-transform", "description": "Parse and standardize ReleaseDate to yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "if(isDate(value, ['yyyy/MM/dd','yyyy-MM-dd','MM/dd/yyyy','MM-dd-yyyy','dd/MM/yyyy','dd-MM-yyyy']), toDate(value).toString('yyyy-MM-dd'), '')"}, {"op": "core/text-transform", "description": "Remove $ and underscores from BoxOffice, replace 'billion' and 'million' with numeric values", "columnName": "BoxOffice", "expression": "value.replace(/[$,_]/g, '').toLowercase().replace(/ billion/, 'e9').replace(/ million/, 'e6').replace(/m$/, 'e6').replace(/b$/, 'e9')"}, {"op": "core/text-transform", "description": "Convert BoxOffice to numeric value (float)", "columnName": "BoxOffice", "expression": "if(value.match(/e[69]$/), value.toNumber(), value.toNumber())"}, {"op": "core/text-transform", "description": "Capitalize Rating to one decimal place as string", "columnName": "Rating", "expression": "value.toNumber().toFixed(1)"}], "clean_table": "MovieTitle,Genre,ReleaseDate,Rating,BoxOffice\nThe Shining,Horror,1980-05-23,8.4,47000000\nInception,Sci-Fi,2010-07-16,8.8,829000000\nTitanic,Romance,1997-12-19,7.8,2187000000\nJoker,Drama,2019-10-04,8.5,1074000000\nAvengers Endgame,Action,2019-04-26,8.4,2798000000\nParasite,Thriller,2019-05-30,8.6,257000000\nFrozen II,Animation,2019-11-22,7.0,1450000000\nThe Godfather,Crime,1972-03-24,9.2,246000000\nLa La Land,Musical,2016-12-09,8.0,446000000\nThe Dark Knight,Action,2008-07-18,9.0,1005000000\nThe Lion King,Animation,1994-06-24,8.5,968500000\nInterstellar,Sci-Fi,2014-11-07,8.6,677000000\nSpider Man Far From Home,Action,2019-07-02,7.5,1131000000"}
{"purpose": "Clean inconsistent city and state names, normalize business types, correct date formats, and fix numeric values for government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew-york,ny,restuarant,12000,100000,2023/04/15\nLos_angeles,CA,REtail,15000,NA,15-05-2023\nCHicago,il,-manufacturing,13000,110000,2023-06-01\nhouston,Tx,restaurant,NA,95000,2023/07/20\nPhoenix,az,manufacturinG,14000,120000,07/25/2023\nphiladelphia,-PA,retail,16000,115000,2023.08.10\nsan_antonio,tx,REStaurant,12500,105000,2023_09_05\nSan Diego,CA,Manufacturing,-,100000,2023-10-15\nDallas,tx,retail,13500,NA,2023/11/01\nSan_jose,CA,restaurant,NA,90000,11-12-2023\nAustin,TX,-Retail,14500,98000,2023-12-20\njacksonville,Fl,manufacturing,15500,100000,2023/13/01\nFort-worth,TX,retail,13000,102000,2023-01-30\nColumbus,OH,restaurant,14000,107000,2023/02/28", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names by replacing underscores and hyphens with spaces and capitalize each word", "columnName": "City", "expression": "value.replace(/[-_]/g, ' ').split(' ').map(v, i, a, v.toLowerCase().replace(/^./, c, c.toUpperCase())).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase State abbreviations and remove leading hyphens", "columnName": "State", "expression": "value.replace(/^-/, '').toUpperCase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType values", "columnName": "BusinessType", "expression": "value.toLowerCase().replace(/restuarant|restuarent/, 'restaurant').replace(/manufacturinG/, 'manufacturing').replace(/-/, '').trim()"}, {"op": "core/mass-edit", "description": "Mass edit missing or invalid Price entries to null", "columnName": "Price", "edits": [{"from": ["-", "NA", "na", ""], "to": ""}]}, {"op": "core/text-transform", "description": "Convert Price to number or null", "columnName": "Price", "expression": "isNumeric(value) ? Number(value) : null"}, {"op": "core/mass-edit", "description": "Mass edit missing or invalid LoanAmount entries to null", "columnName": "LoanAmount", "edits": [{"from": ["NA", "na", ""], "to": ""}]}, {"op": "core/text-transform", "description": "Convert LoanAmount to number or null", "columnName": "LoanAmount", "expression": "isNumeric(value) ? Number(value) : null"}, {"op": "core/text-transform", "description": "Standardize Date format to ISO (yyyy-MM-dd)", "columnName": "Date", "expression": "if(value.match(/^\\d{4}[\\/\\.-]\\d{2}[\\/\\.-]\\d{2}$/)) { value.replace(/[\\/\\.]/g, '-') } else if(value.match(/^\\d{2}-\\d{2}-\\d{4}$/)) { var parts = value.split('-'); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0') } else if(value.match(/^\\d{2}\\/\\d{2}\\/\\d{4}$/)) { var parts = value.split('/'); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0') } else if(value.match(/^\\d{4}_\\d{2}_\\d{2}$/)) { value.replace('_', '-').replace('_', '-') } else { value }"}, {"op": "core/text-transform", "description": "Fix invalid dates with day > 12 by swapping day/month where needed", "columnName": "Date", "expression": "var parts = value.split('-'); if(parts.length === 3) { var year = parts[0]; var month = Number(parts[1]); var day = Number(parts[2]); if(day > 12 && month <= 12) { return year + '-' + (day < 10 ? '0'+day : day) + '-' + (month < 10 ? '0'+month : month); } else { return value; }} else { value; }"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,restaurant,12000,100000,2023-04-15\nLos Angeles,CA,retail,15000,,2023-05-15\nChicago,IL,manufacturing,13000,110000,2023-06-01\nHouston,TX,restaurant,,95000,2023-07-20\nPhoenix,AZ,manufacturing,14000,120000,2023-07-25\nPhiladelphia,PA,retail,16000,115000,2023-08-10\nSan Antonio,TX,restaurant,12500,105000,2023-09-05\nSan Diego,CA,manufacturing,,100000,2023-10-15\nDallas,TX,retail,13500,,2023-11-01\nSan Jose,CA,restaurant,,90000,2023-11-12\nAustin,TX,retail,14500,98000,2023-12-20\nJacksonville,FL,manufacturing,15500,100000,2023-01-13\nFort Worth,TX,retail,13000,102000,2023-01-30\nColumbus,OH,restaurant,14000,107000,2023-02-28"}
{"purpose": "Standardize and correct inconsistencies in city and state names, business types, and date formats in government loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_York,ny,Restauraunt,200000,50000,01-12-2021\nlos angeles,CA,retail_,150000,40000,2021/02/15\nCHICAGO,Il,TECH,180000,55000,15-03-2021\nHouston,tx,healthCare,220000,,2021-04-10\nphoenix,AZ,Restaurent,170000,48000,04/20/21\nphiladelphia,pa,Retail,160000,42000,2021.05.30\nsan-antonio,TX,tech,210000,53000,20210615\nsan diego,ca,Healthcare,190000,49000,2021-07-01\nDallas,Tx,Retail,175000,46000,08-01-2021\nsan_jose,CA,restaurant,165000,43000,09/15/21\nAustin,TX,TECH_,200000,51000,2021-10-05\njacksonville,fl,health-care,185000,47000,11-11-2021\nFort Worth,TX,restaurent,195000,52000,2021/12/01\nColumbus,Oh,RETAIL,180000,50000,\nCharlotte,NC,Tech,210000,54000,2021-12-20", "cleaning_workflow": [{"op": "core/mass-edit", "description": "Fix common misspellings and trailing underscores in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["Restauraunt", "Restaurent", "restaurent", "restaurant"], "to": "Restaurant"}, {"from": ["retail_", "RETAIL", "Retail"], "to": "Retail"}, {"from": ["TECH", "TECH_", "Tech", "tech"], "to": "Tech"}, {"from": ["healthCare", "Healthcare", "health-care"], "to": "Healthcare"}]}, {"op": "core/text-transform", "description": "Capitalize City names properly and remove underscores/hyphens", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toLowercase().split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Capitalize State codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/fill-down", "description": "Fill missing LoanAmount values with the previous non-empty value", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Normalize Price and LoanAmount columns to numeric strings", "columnName": "Price", "expression": "value.toNumber() ? value.toNumber().toString() : ''"}, {"op": "core/text-transform", "description": "Normalize LoanAmount column to numeric strings", "columnName": "LoanAmount", "expression": "value.toNumber() ? value.toNumber().toString() : ''"}, {"op": "core/date-parse", "description": "Parse Date column with multiple formats", "columnName": "Date", "dateFormat": "dd-MM-yyyy", "guessCellValue": true, "repeat": false}, {"op": "core/text-transform", "description": "Format Date column consistently to ISO yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toISOString().slice(0,10)"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,200000,50000,2021-12-01\nLos Angeles,CA,Retail,150000,40000,2021-02-15\nChicago,IL,Tech,180000,55000,2021-03-15\nHouston,TX,Healthcare,220000,55000,2021-04-10\nPhoenix,AZ,Restaurant,170000,48000,2021-04-20\nPhiladelphia,PA,Retail,160000,42000,2021-05-30\nSan Antonio,TX,Tech,210000,53000,2021-06-15\nSan Diego,CA,Healthcare,190000,49000,2021-07-01\nDallas,TX,Retail,175000,46000,2021-08-01\nSan Jose,CA,Restaurant,165000,43000,2021-09-15\nAustin,TX,Tech,200000,51000,2021-10-05\nJacksonville,FL,Healthcare,185000,47000,2021-11-11\nFort Worth,TX,Restaurant,195000,52000,2021-12-01\nColumbus,OH,Retail,180000,50000,\nCharlotte,NC,Tech,210000,54000,2021-12-20"}
{"purpose": "Clean and standardize city names, business types, and date formats; fix numeric fields in a telecommunications loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNewyork,NY,Telecom_Service,299.99,10000,2023/03/15\nlos-angeles,ca,telecom service, 199.95 ,8500,15-04-2023\nCHICAGO,IL,Telecom-service,250,9000,2023.05.01\nhouston,tx,TelecomService,299.95,9500,2023/06/01\n-Phoenix,AZ,telecom_service,unknown,7000,06/15/2023\nsan francisco,CA,,275.00,NA,2023/07/20\ndallas,TX,Telecom-Service,260.0,8000,2023/08/05\nmiami,fl,telecomservice, 230 ,7500,2023/09/10\nseattle,WA,Telecom-service,249.99,missing,2023-10-11\nDenver,Co,Telecom_Service,280.5,9200,2023/11/12\nboston,ma,Telecom service,265,8900,2023/12/01\natlanta,GA,telecom_service,255,8500,2023-13-01\nnew york,ny,telecom_service,300,10000,2023-01-32\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace in Price and LoanAmount", "columnName": "Price", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace in LoanAmount", "columnName": "LoanAmount", "expression": "value.trim()"}, {"op": "core/mass-edit", "description": "Standardize city names capitalization and remove leading/trailing symbols", "columnName": "City", "edits": [{"from": ["newyork", "Newyork", "new york"], "to": "New York"}, {"from": ["los-angeles"], "to": "Los Angeles"}, {"from": ["CHICAGO"], "to": "Chicago"}, {"from": ["houston"], "to": "Houston"}, {"from": ["-Phoenix"], "to": "Phoenix"}, {"from": ["san francisco"], "to": "San Francisco"}, {"from": ["dallas"], "to": "Dallas"}, {"from": ["miami"], "to": "Miami"}, {"from": ["seattle"], "to": "Seattle"}, {"from": ["Denver"], "to": "Denver"}, {"from": ["boston"], "to": "Boston"}, {"from": ["atlanta"], "to": "Atlanta"}]}, {"op": "core/text-transform", "description": "Capitalize State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["Telecom_Service", "telecom_service", "Telecom service", "telecom service", "Telecom-service", "TelecomService", "telecomservice", "Telecom-Service"], "to": "Telecom Service"}, {"from": [""], "to": "Telecom Service"}]}, {"op": "core/text-transform", "description": "Fix Price to numeric string or blank if invalid", "columnName": "Price", "expression": "if(value.toLowercase() == 'unknown' || value.toLowercase() == 'na' || value.toLowercase() == '') '', else value.replace(/[^0-9.]/, '')"}, {"op": "core/text-transform", "description": "Fix LoanAmount to numeric string or blank if invalid", "columnName": "LoanAmount", "expression": "if(value.toLowercase() == 'missing' || value.toLowercase() == 'na' || value.toLowercase() == '') '', else value"}, {"op": "core/date-parse", "description": "Parse and fix Date column", "columnName": "Date", "dateFormat": "yyyy-MM-dd", "mode": "lenient"}, {"op": "core/text-transform", "description": "Format Date to ISO yyyy-MM-dd string", "columnName": "Date", "expression": "if(value==null, '', value.toDate().toString('yyyy-MM-dd'))"}, {"op": "core/mass-edit", "description": "Fix invalid date entries for specific rows", "columnName": "Date", "edits": [{"from": ["2023-13-01", "2023-01-32"], "to": ""}]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom Service,299.99,10000,2023-03-15\nLos Angeles,CA,Telecom Service,199.95,8500,2023-04-15\nChicago,IL,Telecom Service,250,9000,2023-05-01\nHouston,TX,Telecom Service,299.95,9500,2023-06-01\nPhoenix,AZ,Telecom Service,,7000,2023-06-15\nSan Francisco,CA,Telecom Service,275.00,,2023-07-20\nDallas,TX,Telecom Service,260.0,8000,2023-08-05\nMiami,FL,Telecom Service,230,7500,2023-09-10\nSeattle,WA,Telecom Service,249.99,,2023-10-11\nDenver,CO,Telecom Service,280.5,9200,2023-11-12\nBoston,MA,Telecom Service,265,8900,2023-12-01\nAtlanta,GA,Telecom Service,255,8500,\nNew York,NY,Telecom Service,300,10000,"}
{"purpose": "Clean inconsistent crop names and normalize date and numeric formats in farm loan records.", "raw_table": "FarmID,Crop,Region,Loan_Amount,InterestRate,LoanDate,HarvestDate\nF001,cOrn,North-West,50000,5.5%,2023/03/15,15-09-2023\nF002,wheat,North West,45000,5.25,2023-03-16,09/15/2023\nF003,soy_beans,South-East,38000,5,Mar 17 2023,2023/09/16\nF004,Corn,NorthWest,52000,5.50%,03-18-2023,2023-09-17\nF005,wHeat,south east,NaN,5.75%,2023/03/19,16-09-2023\nF006,soybeans,SouthEast,40000,5.00%,2023/03/20,09/18/2023\nF007,Corn-,North-West,51000,,2023/03/21,2023-09-19\nF008,Wheat ,north-west,47000,5.10%,2023/03/22,09-20-2023\nF009,soybean,South-East,39000,5.20%,2023/03/23,2023/09/21\nF010,corn,North West,50500,5.3%,2023/03/24,09/22/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from Crop", "engineConfig": {"facets": []}, "columnName": "Crop", "expression": "value.trim()"}, {"op": "core/mass-edit", "description": "Standardize Crop names", "columnName": "Crop", "edits": [{"from": ["cOrn", "Corn-", "corn"], "to": "Corn"}, {"from": ["wheat", "wHeat", "Wheat "], "to": "Wheat"}, {"from": ["soy_beans", "soybeans", "soybean"], "to": "Soybeans"}]}, {"op": "core/text-transform", "description": "Normalize Region formatting", "columnName": "Region", "expression": "value.toLowercase().replaceAll(/[-_]/, ' ').replace(/\\b\\w/g, v, v.toUppercase())"}, {"op": "core/text-transform", "description": "Clean Loan_Amount: Replace 'NaN' with null", "columnName": "Loan_Amount", "expression": "value == 'NaN' ? null : value"}, {"op": "core/text-transform", "description": "Normalize InterestRate: Remove % and convert to number", "columnName": "InterestRate", "expression": "value.replace('%', '').toNumber()"}, {"op": "core/date-parse", "description": "Parse LoanDate to standard yyyy-MM-dd", "columnName": "LoanDate", "expression": "value", "onError": "keep-original", "onInvalid": "keep-original", "dateFormat": "auto-detect"}, {"op": "core/date-parse", "description": "Parse HarvestDate to standard yyyy-MM-dd", "columnName": "HarvestDate", "expression": "value", "onError": "keep-original", "onInvalid": "keep-original", "dateFormat": "auto-detect"}], "clean_table": "FarmID,Crop,Region,Loan_Amount,InterestRate,LoanDate,HarvestDate\nF001,Corn,North West,50000,5.5,2023-03-15,2023-09-15\nF002,Wheat,North West,45000,5.25,2023-03-16,2023-09-15\nF003,Soybeans,South East,38000,5,2023-03-17,2023-09-16\nF004,Corn,North West,52000,5.5,2023-03-18,2023-09-17\nF005,Wheat,South East,,5.75,2023-03-19,2023-09-16\nF006,Soybeans,South East,40000,5,2023-03-20,2023-09-18\nF007,Corn,North West,51000,,2023-03-21,2023-09-19\nF008,Wheat,North West,47000,5.1,2023-03-22,2023-09-20\nF009,Soybeans,South East,39000,5.2,2023-03-23,2023-09-21\nF010,Corn,North West,50500,5.3,2023-03-24,2023-09-22"}
{"purpose": "Standardize city names and business types, fix date formats, and clean numeric fields in energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew-york,NY,solar_provider,12000,15000,03/15/2023\nLos_angeles,CA,Wind-Energy,8000,abc,2023-04-01\nhouston,TX,solarProvider,9500,10000,15-05-2023\nPhoenix,az,Wind Energy,11000,,2023/06/10\nPHILADELPHIA,PA,solar_provder,13000,16000,2023-07-01\nsan_diego,CA,WindEnergy,10500,14000,July 15 2023\nDallas,tx,solar_provider,not available,12000,2023-08-01\nSan Jose,CA,Wind-Energy,9000,13000,2023-09-10\nAustin,TX,Solar_Provider,11500,15000,20230915\nJacksonville,fl,wind energy,10000,11000,09/20/2023\nFort-worth,TX,solar-provider,12500,17000,2023-10-05\nColumbus,OH,solar-provider,11500,12500,2023-11-01\nCharlotte,NC,WindEnergy,10000,11500,11-15-2023\nSan Francisco,CA,solarprovider,14000,18000,2023/12/01\nIndianapolis,in,Wind Energy,9500,10000,12/10/2023", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/g, ' ').split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(' ')", "description": "Normalize city names by replacing underscores/hyphens with spaces and using title case"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["solar_provider", "solarProvider", "solar_provder", "Solar_Provider", "solar-provider", "solarprovider"], "to": "Solar Provider"}, {"from": ["Wind-Energy", "Wind Energy", "WindEnergy", "wind energy"], "to": "Wind Energy"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.toLowercase() == 'not available' ? null : value", "description": "Convert 'not available' to null in Price column"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "isNaN(value) ? null : value", "description": "Convert non-numeric LoanAmount values to null"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value.toString()", "dateFormat": "yyyy-MM-dd", "onError": "keep-original", "description": "Parse dates in yyyy-MM-dd format"}, {"op": "core/text-transform", "columnName": "Date", "expression": "cells['Date'].value.match(/^(\\d{2})\\/(\\d{2})\\/(\\d{4})$/) ? (cells['Date'].value.match(/^(\\d{2})\\/(\\d{2})\\/(\\d{4})$/)[3] + '-' + cells['Date'].value.match(/^(\\d{2})\\/(\\d{2})\\/(\\d{4})$/)[1] + '-' + cells['Date'].value.match(/^(\\d{2})\\/(\\d{2})\\/(\\d{4})$/)[2]) : value", "description": "Convert MM/DD/YYYY to yyyy-MM-dd"}, {"op": "core/text-transform", "columnName": "Date", "expression": "cells['Date'].value.match(/^(\\d{2})-(\\d{2})-(\\d{4})$/) ? (cells['Date'].value.match(/^(\\d{2})-(\\d{2})-(\\d{4})$/)[3] + '-' + cells['Date'].value.match(/^(\\d{2})-(\\d{2})-(\\d{4})$/)[1] + '-' + cells['Date'].value.match(/^(\\d{2})-(\\d{2})-(\\d{4})$/)[2]) : value", "description": "Convert DD-MM-YYYY to yyyy-MM-dd"}, {"op": "core/text-transform", "columnName": "Date", "expression": "cells['Date'].value.match(/^\\d{8}$/) ? (cells['Date'].value.substring(0,4) + '-' + cells['Date'].value.substring(4,6) + '-' + cells['Date'].value.substring(6,8)) : value", "description": "Convert YYYYMMDD to yyyy-MM-dd"}, {"op": "core/text-transform", "columnName": "Date", "expression": "cells['Date'].value.match(/^[A-Za-z]+ \\d{1,2} \\d{4}$/) ? new Date(cells['Date'].value).toISOString().substring(0,10) : value", "description": "Convert dates like 'July 15 2023' to yyyy-MM-dd"}, {"op": "core/fill-down", "columnName": "LoanAmount", "description": "Fill down missing LoanAmount values"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Provider,12000,15000,2023-03-15\nLos Angeles,CA,Wind Energy,8000,null,2023-04-01\nHouston,TX,Solar Provider,9500,10000,2023-05-15\nPhoenix,AZ,Wind Energy,11000,10000,2023-06-10\nPhiladelphia,PA,Solar Provider,13000,16000,2023-07-01\nSan Diego,CA,Wind Energy,10500,14000,2023-07-15\nDallas,TX,Solar Provider,null,12000,2023-08-01\nSan Jose,CA,Wind Energy,9000,13000,2023-09-10\nAustin,TX,Solar Provider,11500,15000,2023-09-15\nJacksonville,FL,Wind Energy,10000,11000,2023-09-20\nFort Worth,TX,Solar Provider,12500,17000,2023-10-05\nColumbus,OH,Solar Provider,11500,12500,2023-11-01\nCharlotte,NC,Wind Energy,10000,11500,2023-11-15\nSan Francisco,CA,Solar Provider,14000,18000,2023-12-01\nIndianapolis,IN,Wind Energy,9500,10000,2023-12-10"}
{"purpose": "Clean and standardize customer subscription data for accurate billing and reporting.", "raw_table": "CustomerID,City,State,BusinessType,SubscriptionPrice,LoanAmount,StartDate\n1001,new-york,ny,Retailer,49.99,10000,2023/01/15\n1002,LOS ANGELES,Ca,retailr,59.9,15000,15-02-2023\n1003,Chicago,IL,Distributor,  39.95 ,8000,2023-03-01\n1004,Houston,tx,retail-er,45.0,NaN,03/15/2023\n1005,Phoenix,AZ,Wholesale,55,12000,2023/04/01\n1006,philadelphia,pa,Distributor,forty,11000,2023-04-15\n1007,San_antonio,TX,Retailer,50.00,13000,April 20 2023\n1008,San Diego,ca,Retailer,49.99,,2023/05/01\n1009,Dallas,TX,Whole-sale,60,14000,2023/13/05\n1010,San Jose,CA,retailer,52.5,12500,2023-06-01\n1011,Austin,TX,Retailer,47.5,NaN,2023/06/15\n1012,Jacksonville,FL,Distributor,42.00,9000,2023-07-01\n1013,Fort Worth,TX,Retailer,49.99,13500,2023/07/15\n1014,Columbus,OH,WholeSale,55.00,11500,07/20/2023\n1015,Charlotte,NC,Retailer,49,NaN,2023-08-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City names by removing underscores/hyphens and proper capitalization", "columnName": "City", "expression": "value.replace(/[-_]/,' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase two-letter codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix BusinessType misspellings and inconsistent hyphens", "columnName": "BusinessType", "edits": [{"from": ["retailr", "retail-er", "retailer"], "to": "Retailer"}, {"from": ["Whole-sale", "Wholesale", "WholeSale"], "to": "Wholesale"}]}, {"op": "core/text-transform", "description": "Trim whitespace and convert SubscriptionPrice to number, set invalid to null", "columnName": "SubscriptionPrice", "expression": "if(isBlank(value.trim()), null, Number(value.trim()) == NaN ? null : Number(value.trim()))"}, {"op": "core/mass-edit", "description": "Replace text 'forty' in SubscriptionPrice with 40", "columnName": "SubscriptionPrice", "edits": [{"from": ["forty"], "to": "40"}]}, {"op": "core/text-transform", "description": "Convert LoanAmount to number, missing or NaN as null", "columnName": "LoanAmount", "expression": "if(isBlank(value) || value.toLowercase() == 'nan', null, Number(value))"}, {"op": "core/date-parse", "description": "Parse StartDate into ISO yyyy-MM-dd format", "columnName": "StartDate", "expression": "value.toDate()", "onError": "set-to-blank"}, {"op": "core/text-transform", "description": "Reformat StartDate to ISO format yyyy-MM-dd", "columnName": "StartDate", "expression": "value.toDate() != null ? value.toDate().toString('yyyy-MM-dd') : ''"}], "clean_table": "CustomerID,City,State,BusinessType,SubscriptionPrice,LoanAmount,StartDate\n1001,New York,NY,Retailer,49.99,10000,2023-01-15\n1002,Los Angeles,CA,Retailer,59.9,15000,2023-02-15\n1003,Chicago,IL,Distributor,39.95,8000,2023-03-01\n1004,Houston,TX,Retailer,45, null,2023-03-15\n1005,Phoenix,AZ,Wholesale,55,12000,2023-04-01\n1006,Philadelphia,PA,Distributor,40,11000,2023-04-15\n1007,San Antonio,TX,Retailer,50,13000,2023-04-20\n1008,San Diego,CA,Retailer,49.99, null,2023-05-01\n1009,Dallas,TX,Wholesale,60,14000, \n1010,San Jose,CA,Retailer,52.5,12500,2023-06-01\n1011,Austin,TX,Retailer,47.5, null,2023-06-15\n1012,Jacksonville,FL,Distributor,42,9000,2023-07-01\n1013,Fort Worth,TX,Retailer,49.99,13500,2023-07-15\n1014,Columbus,OH,Wholesale,55,11500,2023-07-20\n1015,Charlotte,NC,Retailer,49, null,2023-08-01"}
{"purpose": "Clean and standardize city names, business types, and date formats in energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar-installation,15000,12000,2021/03/15\nLOS ANGELES,CA,wind-Turbine,23000,20000,15-04-2021\nhouston,TX,solar install,18000,,2021-05-10\nChicago,IL,wind_turbine,21000,19000,20210601\nPheonix,AZ,BIO_MASS,17000,16000,07/02/2021\nphiladelphia,pa,solar Installation,16000,15000,2021.08.15\nSan-Antonio,TX,Wind turbine,22000,21000,2021_09_10\nSan Diego,CA,solar-installation,17500,16000,2021-10-05\nDallas,TX,biomass,16500,15500,2021/11/11\nsan_jose,CA,solar install,19000,18000,11-12-2021\nAustin,tx,Wind_Turbine,22500,21500,2021/12/15\nJacksonville,FL,solar-Installation,,14000,2022-01-10\nfort-worth,TX,wind turbine,21500,20500,2022/02/20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize city names: replace underscores and hyphens with spaces, and capitalize each word", "columnName": "City", "expression": "value.replace(/[_-]/,' ').split(' ').map(s => s.toLowerCase().capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Fix misspelled city names", "columnName": "City", "edits": [{"from": ["Pheonix"], "to": "Phoenix"}]}, {"op": "core/mass-edit", "description": "Normalize state abbreviations to uppercase", "columnName": "State", "edits": [{"from": ["pa", "tx"], "to": "PA"}, {"from": ["tx"], "to": "TX"}]}, {"op": "core/text-transform", "description": "Standardize BusinessType: lowercase, replace underscores and hyphens with spaces, then capitalize each word", "columnName": "BusinessType", "expression": "value.toLowerCase().replace(/[_-]/g, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Unify business type names", "columnName": "BusinessType", "edits": [{"from": ["Solar Install", "Solar Installation", "Solar installation"], "to": "Solar Installation"}, {"from": ["Wind Turbine", "Wind turbine", "Wind_Turbine", "wind turbine", "wind-turbine", "wind_turbine"], "to": "Wind Turbine"}, {"from": ["Bio Mass", "Biomass", "Bio_mass"], "to": "Biomass"}]}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Parse and standardize Date formats to yyyy-MM-dd", "columnName": "Date", "expression": "cells['Date'].value.match(/^\\d{4}[\\/\\._-]\\d{2}[\\/\\._-]\\d{2}$/) ? value.replace(/[\\/\\._]/g,'-') : (value.match(/^\\d{2}-\\d{2}-\\d{4}$/) ? value.split('-').reverse().join('-') : (value.match(/^\\d{8}$/) ? value.slice(0,4)+'-'+value.slice(4,6)+'-'+value.slice(6) : value))"}, {"op": "core/date-parse", "description": "Parse Date column to proper date type", "columnName": "Date", "dateFormat": "yyyy-MM-dd", "onError": "keep-original"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,15000,12000,2021-03-15\nLos Angeles,CA,Wind Turbine,23000,20000,2021-04-15\nHouston,TX,Solar Installation,18000,12000,2021-05-10\nChicago,IL,Wind Turbine,21000,19000,2021-06-01\nPhoenix,AZ,Biomass,17000,16000,2021-07-02\nPhiladelphia,PA,Solar Installation,16000,15000,2021-08-15\nSan Antonio,TX,Wind Turbine,22000,21000,2021-09-10\nSan Diego,CA,Solar Installation,17500,16000,2021-10-05\nDallas,TX,Biomass,16500,15500,2021-11-11\nSan Jose,CA,Solar Installation,19000,18000,2021-12-11\nAustin,TX,Wind Turbine,22500,21500,2021-12-15\nJacksonville,FL,Solar Installation,,14000,2022-01-10\nFort Worth,TX,Wind Turbine,21500,20500,2022-02-20"}
{"purpose": "Clean and standardize farm produce sales data with inconsistent crop names, date formats, and price entries.", "raw_table": "FarmID,Crop,Quantity,PricePerUnit,SaleDate\nF001,ToMatO,100,1.2,2023/04/15\nf002,corn,250,0.5,15-04-2023\nF003,Potatoe,150,0.75,2023.04.16\nF004,carrot,NaN,0.65,2023/4/17\nF005,Tomato_,120,one_point_2,17-Apr-2023\nF006,Corn,200,0.55,2023-04-18\nF007,,180,0.60,04/19/2023\nF008,Potato,NaN,0.8,2023-04-20\nF009,Carrot,170,0.7,April 21, 2023\nF010,Tomato,130,1.25,2023/04/22", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from Crop", "columnName": "Crop", "expression": "value.trim()", "onError": "keep-original"}, {"op": "core/mass-edit", "description": "Standardize Crop names with common misspellings and trailing underscores", "columnName": "Crop", "edits": [{"from": ["ToMatO", "Tomato_", "Tomato"], "to": "Tomato"}, {"from": ["Potatoe"], "to": "Potato"}, {"from": ["carrot", "Carrot"], "to": "Carrot"}, {"from": ["corn", "Corn"], "to": "Corn"}]}, {"op": "core/text-transform", "description": "Convert PricePerUnit to number, handle 'one_point_2' and missing values", "columnName": "PricePerUnit", "expression": "value.toLowercase() == 'one_point_2' ? 1.2 : (value.toNumber() > 0 ? value.toNumber() : null)", "onError": "set-to-null"}, {"op": "core/fill-down", "description": "Fill down missing Quantity values", "columnName": "Quantity"}, {"op": "core/text-transform", "description": "Convert Quantity to number or null if invalid", "columnName": "Quantity", "expression": "value.toNumber() > 0 ? value.toNumber() : null", "onError": "set-to-null"}, {"op": "core/date-parse", "description": "Parse SaleDate to ISO format", "columnName": "SaleDate", "expression": "value.toDate('yyyy/MM/dd') || value.toDate('dd-MM-yyyy') || value.toDate('yyyy.MM.dd') || value.toDate('dd-MMM-yyyy') || value.toDate('yyyy-MM-dd') || value.toDate('MM/dd/yyyy') || value.toDate('MMMM dd, yyyy')"}, {"op": "core/text-transform", "description": "Format SaleDate as yyyy-MM-dd", "columnName": "SaleDate", "expression": "value.toDate().toString('yyyy-MM-dd')", "onError": "set-to-null"}, {"op": "core/column-rename", "description": "Rename FarmID to Farm_ID for consistency", "oldColumnName": "FarmID", "newColumnName": "Farm_ID"}], "clean_table": "Farm_ID,Crop,Quantity,PricePerUnit,SaleDate\nF001,Tomato,100,1.2,2023-04-15\nf002,Corn,250,0.5,2023-04-15\nF003,Potato,150,0.75,2023-04-16\nF004,Carrot,150,0.65,2023-04-17\nF005,Tomato,120,1.2,2023-04-17\nF006,Corn,200,0.55,2023-04-18\nF007,null,180,0.6,2023-04-19\nF008,Potato,180,0.8,2023-04-20\nF009,Carrot,170,0.7,2023-04-21\nF010,Tomato,130,1.25,2023-04-22"}
{"purpose": "Standardize inconsistent city names, correct business types, and normalize price and date formats in municipal grant applications.", "raw_table": "City,State,BusinessType,GrantAmount,ApplicationDate\nNew_york,ny,Rstrnt,-5000,2023/01/15\nlos angels,CA,Restuarant,7500,01-20-2023\nCHICAGO,il,Rstrnt,,2023.02.10\nhouston,TX,Resturant,6000,2023/03/05\nPHOENIX,Az,retail,-4500,03/15/2023\nphiladelphia,PA,RetaIl,8000,2023-04-01\nSan-antonio,tx,Rstrnt,7000,April 10, 2023\nsan diego,CA,Retail,6500,2023/05/05\nDALLAS,TX,Rstrnt,-4000,05-15-2023\nsan jose,CA,Restaurant,9000,2023-06-01\nAUSTIN,TX,Rstrnt,,06/10/2023\njacksonville,fl,Rstrnt,7200,2023/07/01\nfort worth,TX,retail,-3500,07-15-2023\ncolumbus,oh,Rstrnt,6800,2023.08.01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names properly and remove underscores or hyphens", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toLowercase().split(' ').map(v, v.substring(0,1).toUppercase()+v.substring(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize state abbreviations to uppercase", "columnName": "State", "edits": [{"from": ["ny"], "to": "NY"}, {"from": ["CA"], "to": "CA"}, {"from": ["il"], "to": "IL"}, {"from": ["TX"], "to": "TX"}, {"from": ["Az"], "to": "AZ"}, {"from": ["PA"], "to": "PA"}, {"from": ["tx"], "to": "TX"}, {"from": ["fl"], "to": "FL"}, {"from": ["oh"], "to": "OH"}]}, {"op": "core/mass-edit", "description": "Correct BusinessType misspellings", "columnName": "BusinessType", "edits": [{"from": ["Rstrnt", "Restuarant", "Resturant"], "to": "Restaurant"}, {"from": ["retaIl", "retail"], "to": "Retail"}]}, {"op": "core/text-transform", "description": "Convert GrantAmount to positive numbers and fill missing values with 0", "columnName": "GrantAmount", "expression": "if(isBlank(value), '0', (value.toNumber() < 0 ? (-1 * value.toNumber()) : value.toNumber()).toString())"}, {"op": "core/date-parse", "description": "Parse ApplicationDate into ISO format", "columnName": "ApplicationDate", "format": "auto"}], "clean_table": "City,State,BusinessType,GrantAmount,ApplicationDate\nNew York,NY,Restaurant,5000,2023-01-15\nLos Angels,CA,Restaurant,7500,2023-01-20\nChicago,IL,Restaurant,0,2023-02-10\nHouston,TX,Restaurant,6000,2023-03-05\nPhoenix,AZ,Retail,4500,2023-03-15\nPhiladelphia,PA,Retail,8000,2023-04-01\nSan Antonio,TX,Restaurant,7000,2023-04-10\nSan Diego,CA,Retail,6500,2023-05-05\nDallas,TX,Restaurant,4000,2023-05-15\nSan Jose,CA,Restaurant,9000,2023-06-01\nAustin,TX,Restaurant,0,2023-06-10\nJacksonville,FL,Restaurant,7200,2023-07-01\nFort Worth,TX,Retail,3500,2023-07-15\nColumbus,OH,Restaurant,6800,2023-08-01"}
{"purpose": "Clean and standardize inconsistent city names, business types, and date formats in a government loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,NY,restaurant_,100000,50000,2023/01/15\nLos-angeles,CA,Cafe,75000,30000,15-02-2023\nCHICAGO,IL,Medical_Clinic,200000,120000,03/10/23\nhouston,TX,retail-store,50000,25000,2023.04.01\nphoenix,AZ,restuarant,60000,28000,2023/05/15\nphiladelphia,pa,Retail Store,85000,40000,2023/06/20\nsan antonio,TX,MEDICAL-clinic,150000,90000,2023-07-05\nsan diego,ca,Cafe_,45000,20000,07/15/2023\nDALLAS,TX,retailstore,70000,35000,2023-08-10\nsan_jose,CA,Restaurant,95000,,2023/09/01\nAustin,Tx,Cafe,40000,18000,2023-10-12\njacksonville,FL,,30000,15000,11-11-2023\nfort worth,tx,Medical_Clinic,120000,60000,2023/12/01\ncolumbus,OH,retail-store,55000,27000,12-15-2023\ncharlotte,NC,Restaurant,80000,37000,2023/11/30", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize city names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Uppercase state codes", "columnName": "State", "expression": "value.toUppercase().trim()"}, {"op": "core/text-transform", "description": "Normalize BusinessType values, remove trailing underscores and unify naming", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/_/g, '').replace(/retailstore|retail store|retail-store/g, 'Retail Store').replace(/restaurant|restuarant/g, 'Restaurant').replace(/cafe/g, 'Cafe').replace(/medicalclinic|medical-clinic/g, 'Medical Clinic').trim().toTitlecase()"}, {"op": "core/mass-edit", "description": "Fix known misspellings or empty BusinessType values", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Unknown"}]}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount with median (35000)", "columnName": "LoanAmount", "edits": [{"from": [""], "to": "35000"}]}, {"op": "core/text-transform", "description": "Parse dates into ISO format yyyy-MM-dd", "columnName": "Date", "expression": "if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/)) { value.replace('/', '-').replace('/', '-') } else if(value.match(/\\d{2}-\\d{2}-\\d{4}/)) { var parts = value.split('-'); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0') } else if(value.match(/\\d{2}\\/\\d{2}\\/\\d{2}/)) { var parts = value.split('/'); '20' + parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0') } else if(value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/)) { value.replace(/\\./g, '-') } else if(value.match(/\\d{4}-\\d{2}-\\d{2}/)) { value } else if(value.match(/\\d{2}-\\d{2}-\\d{2}/)) { var parts = value.split('-'); '20' + parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0') } else { value }"}, {"op": "core/text-transform", "description": "Ensure Price and LoanAmount are numbers without extra spaces", "columnName": "Price", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Ensure LoanAmount is numeric string", "columnName": "LoanAmount", "expression": "value.trim()"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,100000,50000,2023-01-15\nLos Angeles,CA,Cafe,75000,30000,2023-02-15\nChicago,IL,Medical Clinic,200000,120000,2023-03-10\nHouston,TX,Retail Store,50000,25000,2023-04-01\nPhoenix,AZ,Restaurant,60000,28000,2023-05-15\nPhiladelphia,PA,Retail Store,85000,40000,2023-06-20\nSan Antonio,TX,Medical Clinic,150000,90000,2023-07-05\nSan Diego,CA,Cafe,45000,20000,2023-07-15\nDallas,TX,Retail Store,70000,35000,2023-08-10\nSan Jose,CA,Restaurant,95000,35000,2023-09-01\nAustin,TX,Cafe,40000,18000,2023-10-12\nJacksonville,FL,Unknown,30000,15000,2023-11-11\nFort Worth,TX,Medical Clinic,120000,60000,2023-12-01\nColumbus,OH,Retail Store,55000,27000,2023-12-15\nCharlotte,NC,Restaurant,80000,37000,2023-11-30"}
{"purpose": "Standardize city names and business types, fix date formats, and ensure numeric consistency in telecom loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,retail,1000,50000,01-15-2023\nlos-angeles,ca,WhOlesale,1200,75000,2023/02/10\nCHicago,IL,retail,1100,,15-Mar-2023\nhouston,tx,retail,950,60000,03_20_2023\nphoenix,az,Wholesale,NaN,45000,2023-04-05\nphiladelphia,pa,retail,-,70000,April 10 2023\nsan-antonio,tx,wholesale,1050,65000,2023.05.15\nsan diego,ca,Retail,1150,NaN,05-25-2023\ndallas,tx,retail,1000,55000,2023-06-01\nsan_jose,ca,wholesale,980,50000,06/15/2023\nAustin,Tx,RETAIL,1020,60000,2023-07-01\njacksonville,fl,wholesale,970,48000,07-10-2023\nfort-worth,tx,retail,invalid,53000,2023-07-20\ncolumbus,oh,retail,1010,59000,07_25_2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names with spaces and title case", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType to lowercase then capitalize", "columnName": "BusinessType", "expression": "value.toLowercase().replace('wholesale','Wholesale').replace('retail','Retail')"}, {"op": "core/mass-edit", "description": "Fix known misspellings and inconsistent BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["WhOlesale", "wholesale", "Wholesale"], "to": "Wholesale"}, {"from": ["retail", "Retail", "RETAIL"], "to": "Retail"}]}, {"op": "core/mass-edit", "description": "Replace invalid or missing Price values with null", "columnName": "Price", "edits": [{"from": ["NaN", "-", "invalid"], "to": ""}]}, {"op": "core/text-transform", "description": "Convert Price to numeric if possible", "columnName": "Price", "expression": "isNaN(value) || value === '' ? '' : Number(value)"}, {"op": "core/text-transform", "description": "Convert LoanAmount to numeric, replace empty with null", "columnName": "LoanAmount", "expression": "value === '' ? '' : Number(value)"}, {"op": "core/date-parse", "description": "Parse Date values with multiple possible formats", "columnName": "Date", "expression": "value", "skipError": true, "format": ["MM-dd-yyyy", "yyyy/MM/dd", "dd-MMM-yyyy", "MM_dd_yyyy", "yyyy-MM-dd", "MMMM dd yyyy", "yyyy.MM.dd", "MM/dd/yyyy", "yyyy-MM-dd"]}, {"op": "core/text-transform", "description": "Format Date to yyyy-MM-dd", "columnName": "Date", "expression": "if(cells['Date'].value != null) cells['Date'].value.toDate().toString('yyyy-MM-dd') else ''"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,1000,50000,2023-01-15\nLos Angeles,CA,Wholesale,1200,75000,2023-02-10\nChicago,IL,Retail,1100,,2023-03-15\nHouston,TX,Retail,950,60000,2023-03-20\nPhoenix,AZ,Wholesale,,45000,2023-04-05\nPhiladelphia,PA,Retail,,70000,2023-04-10\nSan Antonio,TX,Wholesale,1050,65000,2023-05-15\nSan Diego,CA,Retail,1150,,2023-05-25\nDallas,TX,Retail,1000,55000,2023-06-01\nSan Jose,CA,Wholesale,980,50000,2023-06-15\nAustin,TX,Retail,1020,60000,2023-07-01\nJacksonville,FL,Wholesale,970,48000,2023-07-10\nFort Worth,TX,Retail,,53000,2023-07-20\nColumbus,OH,Retail,1010,59000,2023-07-25"}
{"purpose": "Normalize and clean inconsistent city and business type entries, fix date formats, and standardize numeric fields in energy sector loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew-york,NY,solar_provider,15000,500000,01-15-2023\nlos angeles,CA,Solar Provider,20000,450000,2023/02/20\nhouston_tx,TX,windpower,18000,,03-10-2023\nCHICAGO,IL,Wind-Power,17000,400000,15-Apr-2023\nphoenix,Az,solar_provider,16000,420000,2023.05.05\nPhiladelphia,pa,,15500,430000,2023-06-12\nsan antonio,TX,Windpower,14900,390000,2023-07-01\nSan_Diego,CA,solar-provider,16500,415000,07/15/2023\nDallas,tx,wind_power,17500,405000,2023/08/20\nsan jose,CA,SolarProvider,16800,425000,2023-09-10\nAustin,TX,wind-power,17200,,2023-10-11\njacksonville,FL,solar-provider,15000,410000,11-05-2023\nFort Worth,Tx,SolarProvider,16000,400000,12/01/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names with spaces and proper case", "columnName": "City", "expression": "value.replace(/[-_]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Fix state abbreviations capitalization", "columnName": "State", "expression": "value.toUppercase().trim()"}, {"op": "core/text-transform", "description": "Standardize BusinessType values to title case and replace underscores or hyphens with spaces", "columnName": "BusinessType", "expression": "value ? value.replace(/[-_]/g, ' ').toTitlecase() : ''"}, {"op": "core/mass-edit", "description": "Correct common BusinessType variants to standard names", "columnName": "BusinessType", "edits": [{"from": ["Solar Provider", "Solarprovider", "Solarprovider", "Solar Provider", "Solarprovider", "Solar Provider", "Solarprovider", "Solar Provider"], "to": "Solar Provider"}, {"from": ["Wind Power", "Windpower", "Wind Power", "Windpower", "Wind Power", "Wind Power", "Wind Power", "Wind Power", "Wind Power", "Wind Power"], "to": "Wind Power"}]}, {"op": "core/fill-down", "description": "Fill missing BusinessType values down", "columnName": "BusinessType"}, {"op": "core/text-transform", "description": "Fill missing LoanAmount with '0' as string to be converted", "columnName": "LoanAmount", "expression": "value.trim() === '' ? '0' : value"}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numbers", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number", "columnName": "LoanAmount", "expression": "value.toNumber()"}, {"op": "core/date-parse", "description": "Parse dates with variants to standard yyyy-MM-dd", "columnName": "Date", "format": "regex", "expression": "value.match(/(\\d{4})[\\/-](\\d{2})[\\/-](\\d{2})/) ? value : value.replace(/(\\d{2})-(\\d{2})-(\\d{4})/, '$3-$1-$2').replace(/\\./g, '-')", "toFormat": "yyyy-MM-dd"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Provider,15000,500000,2023-01-15\nLos Angeles,CA,Solar Provider,20000,450000,2023-02-20\nHouston,TX,Wind Power,18000,0,2023-03-10\nChicago,IL,Wind Power,17000,400000,2023-04-15\nPhoenix,AZ,Solar Provider,16000,420000,2023-05-05\nPhiladelphia,PA,Solar Provider,15500,430000,2023-06-12\nSan Antonio,TX,Wind Power,14900,390000,2023-07-01\nSan Diego,CA,Solar Provider,16500,415000,2023-07-15\nDallas,TX,Wind Power,17500,405000,2023-08-20\nSan Jose,CA,Solar Provider,16800,425000,2023-09-10\nAustin,TX,Wind Power,17200,0,2023-10-11\nJacksonville,FL,Solar Provider,15000,410000,2023-11-05\nFort Worth,TX,Solar Provider,16000,400000,2023-12-01"}
{"purpose": "Standardize crop names and clean numeric values for loan amounts and prices in agricultural data entries.", "raw_table": "FarmID,CropName,State,PricePerTon,LoanAmount,DatePlanted\n101,coRN,california,250.5,15000,03-15-2022\n102,WHEAT,texas,300,20000,2022/04/01\n103,Rice_,Florida,275,18,500,April 10 2022\n104,soybean,georgia,290.75,17000,2022-05-07\n105,CoRn,texas,260.25,,2022-05-15\n106,wheat,california,NaN,21000,05/20/2022\n107,rice,texas,280.0,19000,2022.05.25\n108,soy-bean,Florida,295.5,16500,May 30 2022\n109,corn,georgia,255,16000,2022-06-05\n110,SOYBEAN,texas,300.00,17500,06/10/2022\n111,wheat,florida,310.25,22000,2022-06-15\n112,RICE,California,285.5,18500,06-20-2022\n113,,georgia,270,15500,2022-06-25\n114,Corn-Texas,texas,265,16200,June 30, 2022\n115,soy bean,california,295,16800,2022/07/05", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove trailing underscores and hyphens from CropName", "columnName": "CropName", "expression": "value.replace(/[_\\-]+$/, '')"}, {"op": "core/text-transform", "description": "Normalize CropName capitalization (capitalize first letter only)", "columnName": "CropName", "expression": "value.toLowerCase().replace(/^./, v => v.toUpperCase())"}, {"op": "core/mass-edit", "description": "Fix common misspellings and variants of CropName", "columnName": "CropName", "edits": [{"from": ["Corn-Texas", "corn-texas", "corn_texas"], "to": "Corn"}, {"from": ["Soybean", "Soy bean", "soy-bean"], "to": "Soybean"}]}, {"op": "core/column-rename", "description": "Rename PricePerTon to PricePerTonUSD", "oldColumnName": "PricePerTon", "newColumnName": "PricePerTonUSD"}, {"op": "core/text-transform", "description": "Remove commas and spaces in LoanAmount and convert to number", "columnName": "LoanAmount", "expression": "value.replace(/[,\\s]/g, '').replace(/NaN/i, '').trim()"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Parse DatePlanted to ISO format yyyy-MM-dd", "columnName": "DatePlanted", "expression": "value.match(/\\d{4}[-\\/\\.](\\d{2})[-\\/\\.](\\d{2})/) ? value.replace(/\\//g,'-').replace(/\\./g,'-') : new Date(Date.parse(value)).toISOString().slice(0,10)"}, {"op": "core/mass-edit", "description": "Fill missing CropName with 'Unknown'", "columnName": "CropName", "edits": [{"from": [""], "to": "Unknown"}]}], "clean_table": "FarmID,CropName,State,PricePerTonUSD,LoanAmount,DatePlanted\n101,Corn,california,250.5,15000,2022-03-15\n102,Wheat,texas,300,20000,2022-04-01\n103,Rice,Florida,275,18500,2022-04-10\n104,Soybean,georgia,290.75,17000,2022-05-07\n105,Corn,texas,260.25,17000,2022-05-15\n106,Wheat,california,,21000,2022-05-20\n107,Rice,texas,280,19000,2022-05-25\n108,Soybean,Florida,295.5,16500,2022-05-30\n109,Corn,georgia,255,16000,2022-06-05\n110,Soybean,texas,300,17500,2022-06-10\n111,Wheat,florida,310.25,22000,2022-06-15\n112,Rice,California,285.5,18500,2022-06-20\n113,Unknown,georgia,270,15500,2022-06-25\n114,Corn,texas,265,16200,2022-06-30\n115,Soybean,california,295,16800,2022-07-05"}
{"purpose": "Clean and standardize farm produce sales data by fixing city names, normalizing business types, correcting date formats, and cleaning numeric values.", "raw_table": "City,State,BusinessType,Price,LoanAmount,SaleDate\nSpring-field,IL,FARMers_market,12.5,10000,2023/03/15\nGREENWOOD,ks,organic_FARM,8.75,15000,15-04-2023\nMaple-town,MO,Farmers Market,ten,20000,2023-05-01\nriverdale,IL,Farmers-market,11.30,,2023.06.10\nOak_Hill,KS,,9.25,5000,04/20/2023\nGreenwood,KS,Organic farm,8.75,15000,April 18 2023\nspringfield,IL,farMers Market,12.5,10000,2023-03-16\nRiverdale,IL,Farmers Market,11.30,12000,2023-06-11\nMapleton,MO,Farmers-Market,10.00,18000,2023/05/03\nOak Hill,KS,organic_farm,9.25,,2023-04-21\nSpringfield,IL,FarMers_market,12.50,10000,2023-03-17\n", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["Spring-field", "springfield", "Springfield"], "to": "Springfield"}, {"from": ["Greenwood", "GREENWOOD"], "to": "Greenwood"}, {"from": ["Maple-town"], "to": "Mapleton"}, {"from": ["riverdale", "Riverdale"], "to": "Riverdale"}, {"from": ["Oak_Hill", "Oak Hill"], "to": "Oak Hill"}]}, {"op": "core/text-transform", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[_-]/g, ' ').trim()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["farmers market", "farmers-market", "farmers_market", "farMers market", "farmers_market", ""], "to": "Farmers Market"}, {"from": ["organic farm", "organic_farm"], "to": "Organic Farm"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "if(value.toLowercase() == 'ten', '10', value)"}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/fill-down", "columnName": "LoanAmount"}, {"op": "core/text-transform", "columnName": "SaleDate", "expression": "value.replace(/\\s/g, '').replace(/[\\.\\/]/g, '-').replace(/(\\d{2})-(\\d{2})-(\\d{4})/, '$3-$1-$2')"}, {"op": "core/date-parse", "columnName": "SaleDate", "expression": "value.toDate()"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,SaleDate\nSpringfield,IL,Farmers Market,12.5,10000,2023-03-15\nGreenwood,KS,Organic Farm,8.75,15000,2023-04-15\nMapleton,MO,Farmers Market,10,20000,2023-05-01\nRiverdale,IL,Farmers Market,11.3,15000,2023-06-10\nOak Hill,KS,Farmers Market,9.25,5000,2023-04-20\nGreenwood,KS,Organic Farm,8.75,15000,2023-04-18\nSpringfield,IL,Farmers Market,12.5,10000,2023-03-16\nRiverdale,IL,Farmers Market,11.3,12000,2023-06-11\nMapleton,MO,Farmers Market,10,18000,2023-05-03\nOak Hill,KS,Organic Farm,9.25,12000,2023-04-21\nSpringfield,IL,Farmers Market,12.5,10000,2023-03-17\n"}
{"purpose": "Standardize city and state names, correct business types, and normalize dates and numeric fields for loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew_york,ny,restarant,100000,50000,12/05/2022\nLos-angeles,CA,Retail,85000,40000,2022-13-01\nhouston,Tx,Resturant,73000,,01-15-2022\nchicago,il,Retaill,97000,45000,2022/02/30\nPHOENIX,az,Service,89000,47000,03-10-2022\nsan francisco,ca,retail,105000,52000,2022-04-15\ndallas,TX,service,96000,48000,2022/05/20\nseattle,wa,restarant,,44000,06/15/22\nmiami,fl,Retail,87000,46000,07-25-2022\natlanta,GA,service,91000,49000,Aug 01 2022\nboston,ma,retail ,93000,43000,2022.09.10\nDenver,co,Retaill,88000,47000,10-12-2022\nportland,OR,restarant,94000,45000,11/11/2022\nlas_vegas,NV,Service,82000,42000,2022-12-05\n", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["Los-angeles"], "to": "Los Angeles"}, {"from": ["san francisco"], "to": "San Francisco"}, {"from": ["las_vegas"], "to": "Las Vegas"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()", "description": "Capitalize city names properly"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()", "description": "Uppercase state abbreviations"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["restarant", "Resturant", "restarant"], "to": "Restaurant"}, {"from": ["retaill", "Retaill"], "to": "Retail"}, {"from": ["retail "], "to": "Retail"}]}, {"op": "core/text-transform", "columnName": "BusinessType", "expression": "value.toTitlecase()", "description": "Standardize BusinessType capitalization"}, {"op": "core/text-transform", "columnName": "Price", "expression": "value == null || value.trim() == '' ? null : Number(value)", "description": "Convert Price to number, set empty to null"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value == null || value.trim() == '' ? null : Number(value)", "description": "Convert LoanAmount to number, set empty to null"}, {"op": "core/date-parse", "columnName": "LoanDate", "expression": "value", "format": "auto", "description": "Parse dates in various formats"}, {"op": "core/mass-edit", "columnName": "LoanDate", "edits": [{"from": ["2022-13-01"], "to": "2022-01-13"}, {"from": ["2022/02/30"], "to": "2022-02-28"}]}, {"op": "core/text-transform", "columnName": "LoanDate", "expression": "value.toDate().toString('yyyy-MM-dd')", "description": "Format LoanDate as yyyy-MM-dd"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew York,NY,Restaurant,100000,50000,2022-12-05\nLos Angeles,CA,Retail,85000,40000,2022-01-13\nHouston,TX,Restaurant,73000,,2022-01-15\nChicago,IL,Retail,97000,45000,2022-02-28\nPhoenix,AZ,Service,89000,47000,2022-03-10\nSan Francisco,CA,Retail,105000,52000,2022-04-15\nDallas,TX,Service,96000,48000,2022-05-20\nSeattle,WA,Restaurant,,44000,2022-06-15\nMiami,FL,Retail,87000,46000,2022-07-25\nAtlanta,GA,Service,91000,49000,2022-08-01\nBoston,MA,Retail,93000,43000,2022-09-10\nDenver,CO,Retail,88000,47000,2022-10-12\nPortland,OR,Restaurant,94000,45000,2022-11-11\nLas Vegas,NV,Service,82000,42000,2022-12-05\n"}
{"purpose": "Clean and normalize movie dataset with inconsistent titles, release dates, genres, and revenue formats.", "raw_table": "MovieID,Title,Release_Date,Genre,Box_Office_Millions\n1,The_ShAwshank Redemption,1994/09/22,Drama,28.3M\n2,INCEPTION,07-16-2010,Action-Thriller, 829.89 million\n3,Forrest Gump,1994-07-06,Drama/ Romance,330.252\n4,the godfather,1972_03_24,Crime;Drama,$134.97M\n5,Avatar,2009/12/18,Sci-Fi, 2.79B\n6,star wars: episode IV,1977-05-25,Sci-Fi,460M\n7,Jurrassic Park,1993/06/11,Adventure, 1.03 billion\n8,Titanic,1997-12-19,Romance;Drama,$2.195B\n9,The Dark Knight,2008_07_18,Action; Crime,1005m\n10,Pulp fiction,1994-10-14,Crime/Drama, 213.9 million\n11,Fight Club,,Drama,100.9 M\n12,The Lord of the Rings: The Return of the king,2003-12-17,Adventure,1.12B\n13,Harry Potter and the Sorcerer's Stone,2001-11-16,Fantasy, 974.8 million\n14,Gladiator,2000/05/05,Action-Drama, 460m\n15,The Lion King,1994-06-15,Animation, 968.5 million", "cleaning_workflow": [{"op": "core/column-rename", "oldColumnName": "Release_Date", "newColumnName": "Release Date"}, {"op": "core/text-transform", "columnName": "Title", "expression": "value.toTitlecase().replace(/[_-]/g, ' ').replace(/ +/g, ' ').trim()"}, {"op": "core/text-transform", "columnName": "Genre", "expression": "value.replace(/[;\\/\\-]/g, ',').split(',').map(s => s.trim().toTitlecase()).join(', ')"}, {"op": "core/date-parse", "columnName": "Release Date", "pattern": "yyyy-MM-dd", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "Release Date", "expression": "if(value.match(/^\\d{4}[\\/_-]\\d{2}[\\/_-]\\d{2}$/)) { \n  value.replace(/[\\/_]/g,'-')\n} else if(value.match(/^\\d{2}-\\d{2}-\\d{4}$/)) {\n  value.split('-')[2] + '-' + value.split('-')[0] + '-' + value.split('-')[1]\n} else value"}, {"op": "core/date-parse", "columnName": "Release Date", "pattern": "yyyy-MM-dd", "onError": "keep-original"}, {"op": "core/mass-edit", "columnName": "Box_Office_Millions", "edits": [{"from": ["M", "m", " million", " Million", "M ", "m "], "to": ""}, {"from": ["B", "b", " billion", " Billion", "B ", "b "], "to": "000"}, {"from": ["$", ","], "to": ""}]}, {"op": "core/text-transform", "columnName": "Box_Office_Millions", "expression": "if(value.toLowerCase().indexOf('b') >= 0) {\n  // Convert billions to millions by multiplying by 1000\n  var num = value.toLowerCase().replace('b','').replace(/[^0-9.]/g,'');\n  (parseFloat(num) * 1000).toString()\n} else {\n  value.replace(/[^0-9.]/g,'')\n}"}, {"op": "core/text-transform", "columnName": "Box_Office_Millions", "expression": "value.trim()"}], "clean_table": "MovieID,Title,Release Date,Genre,Box_Office_Millions\n1,The Shawshank Redemption,1994-09-22,Drama,28.3\n2,Inception,2010-07-16,Action, Thriller,829.89\n3,Forrest Gump,1994-07-06,Drama, Romance,330.252\n4,The Godfather,1972-03-24,Crime, Drama,134.97\n5,Avatar,2009-12-18,Sci Fi,2790\n6,Star Wars: Episode Iv,1977-05-25,Sci Fi,460\n7,Jurassic Park,1993-06-11,Adventure,1030\n8,Titanic,1997-12-19,Romance, Drama,2195\n9,The Dark Knight,2008-07-18,Action, Crime,1005\n10,Pulp Fiction,1994-10-14,Crime, Drama,213.9\n11,Fight Club,,Drama,100.9\n12,The Lord Of The Rings: The Return Of The King,2003-12-17,Adventure,1120\n13,Harry Potter And The Sorcerer's Stone,2001-11-16,Fantasy,974.8\n14,Gladiator,2000-05-05,Action, Drama,460\n15,The Lion King,1994-06-15,Animation,968.5"}
{"purpose": "Clean and standardize movie release data by fixing date formats, correcting studio names, and normalizing genre entries.", "raw_table": "Title,ReleaseDate,Studio,Genre,Budget\nInception,07-16-2010,Warner_bros,SCI_FI,160000000\nthe Dark Knight,07/18/2008,warner bros,Action,185000000\nInterstellar,11-07-2014,WarnerBros,scifi,165000000\nDunkirk,07/21/2017,warner_bros,War,100000000\nTenet,08-26-2020,Warner Bros,SCI-FI,205000000\nJoker,10-04-2019,warner-bros,drama,55000000\nMan of Steel,,Warner bros,Action,225000000\nSuicide Squad,08/05/2016,WarnerBros,Action,175000000\nJustice League,11-17-2017,Warner_bros,Action,300000000\nWonder Woman,06-02-2017,warner_bros,Action,149000000\nAquaman,12/21/2018,Warner Bros,action,160000000\nThe Prestige,10-20-2006,warner bros,Drama,40000000\nBatman Begins,06-15-2005,warner_bros,Action,150000000\nInsomnia,05/24/2002,WarnerBros,Thriller,46000000", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize Studio names by replacing underscores and hyphens with spaces and proper casing", "columnName": "Studio", "expression": "value.replace('_',' ').replace('-',' ').toLowercase().split(' ').map(s, s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Correct known Studio name variants", "columnName": "Studio", "edits": [{"from": ["Warner Bros", "Warner Bros ", "Warner bros", "WarnerBros", "Warner Bros "], "to": "Warner Bros"}]}, {"op": "core/text-transform", "description": "Standardize Genre entries to title case and correct 'sci-fi' variants", "columnName": "Genre", "expression": "value.toLowercase().replace(/sci[-_ ]?fi/, 'Sci-Fi').replace('scifi', 'Sci-Fi').replace('drama', 'Drama').replace('war', 'War').replace('action', 'Action').replace('thriller', 'Thriller').replace('sci fi', 'Sci-Fi').toTitlecase()"}, {"op": "core/fill-down", "description": "Fill down missing ReleaseDate values", "columnName": "ReleaseDate"}, {"op": "core/date-parse", "description": "Parse ReleaseDate into YYYY-MM-DD format", "columnName": "ReleaseDate", "expression": "value.toDate('MM-dd-yyyy') || value.toDate('MM/dd/yyyy')", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Format ReleaseDate as ISO date string", "columnName": "ReleaseDate", "expression": "value instanceof Date ? value.toISOString().slice(0,10) : value"}, {"op": "core/mass-edit", "description": "Convert Budget column to numeric by removing commas and ensuring type", "columnName": "Budget", "edits": []}, {"op": "core/text-transform", "description": "Convert Budget to number type", "columnName": "Budget", "expression": "value.toString().replace(/[^0-9]/g, '').toNumber()"}, {"op": "core/column-rename", "description": "Rename 'ReleaseDate' column to 'Release Date'", "oldColumnName": "ReleaseDate", "newColumnName": "Release Date"}], "clean_table": "Title,Release Date,Studio,Genre,Budget\nInception,2010-07-16,Warner Bros,Sci-Fi,160000000\nThe Dark Knight,2008-07-18,Warner Bros,Action,185000000\nInterstellar,2014-11-07,Warner Bros,Sci-Fi,165000000\nDunkirk,2017-07-21,Warner Bros,War,100000000\nTenet,2020-08-26,Warner Bros,Sci-Fi,205000000\nJoker,2019-10-04,Warner Bros,Drama,55000000\nMan of Steel,2019-10-04,Warner Bros,Action,225000000\nSuicide Squad,2016-08-05,Warner Bros,Action,175000000\nJustice League,2017-11-17,Warner Bros,Action,300000000\nWonder Woman,2017-06-02,Warner Bros,Action,149000000\nAquaman,2018-12-21,Warner Bros,Action,160000000\nThe Prestige,2006-10-20,Warner Bros,Drama,40000000\nBatman Begins,2005-06-15,Warner Bros,Action,150000000\nInsomnia,2002-05-24,Warner Bros,Thriller,46000000"}
{"purpose": "Clean inconsistent city names and standardize loan and date formats for energy business data analysis.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar Panel,12000,15,000,2023/05/12\nlos-angeles,CA,Wind_turbine,15000,10000USD,05-15-2023\nhouston,tx,Solar panel,11000,12000,2023-05-18\nChicago,IL,Solar-Panel,13000,13000,18/05/2023\nPHOENIX,AZ,wind turbine,NaN,14000,2023.05.20\nphiladelphia,pa,SOlar panel,12500,not available,2023/05/22\nSan antonio,tx,Wind turbine,13500,13500,22-05-2023\nSan Diego,CA,solar_panel,14000,14000,2023/05/25\ndallas,Tx,Solar Panel,NaN,15000,May 26 2023\nSan jose,CA,wind-turbine,14500,14500USD,2023/05/27\nAustin,tx,Solar panel,13000,13000,2023-05-28\nJacksonville,fl,wind_turbine,14000,,2023/05/29\nFort Worth,TX,Solar Panel,13500,13500,29/05/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City with spaces and proper capitalization", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType values to title case and replace underscores/hyphens with spaces", "columnName": "BusinessType", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Clean Price column: replace 'NaN' and blank with empty string to recognize as missing", "columnName": "Price", "expression": "value == 'NaN' || value.trim() == '' ? '' : value"}, {"op": "core/text-transform", "description": "Clean LoanAmount: remove commas, 'USD', 'not available' and trim spaces", "columnName": "LoanAmount", "expression": "value.replace(/,/g, '').replace(/USD/i, '').replace(/not available/i, '').trim()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number or null if empty", "columnName": "LoanAmount", "expression": "value == '' ? null : Number(value)"}, {"op": "core/date-parse", "description": "Parse Date column with multiple common formats", "columnName": "Date", "expression": "value", "formats": ["yyyy/MM/dd", "MM-dd-yyyy", "yyyy-MM-dd", "dd/MM/yyyy", "yyyy.MM.dd", "dd-MM-yyyy", "MMMM dd yyyy", "dd/MM/yyyy"]}, {"op": "core/column-rename", "description": "Rename City to CityName for clarity", "oldColumnName": "City", "newColumnName": "CityName"}, {"op": "core/mass-edit", "description": "Fill missing Price with average calculated externally (13000 assumed)", "columnName": "Price", "edits": [{"from": [""], "to": "13000"}]}, {"op": "core/text-transform", "description": "Convert Price to number", "columnName": "Price", "expression": "Number(value)"}], "clean_table": "CityName,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Panel,12000,15000,2023-05-12T00:00:00Z\nLos Angeles,CA,Wind Turbine,15000,10000,2023-05-15T00:00:00Z\nHouston,TX,Solar Panel,11000,12000,2023-05-18T00:00:00Z\nChicago,IL,Solar Panel,13000,13000,2023-05-18T00:00:00Z\nPhoenix,AZ,Wind Turbine,13000,14000,2023-05-20T00:00:00Z\nPhiladelphia,PA,Solar Panel,12500,null,2023-05-22T00:00:00Z\nSan Antonio,TX,Wind Turbine,13500,13500,2023-05-22T00:00:00Z\nSan Diego,CA,Solar Panel,14000,14000,2023-05-25T00:00:00Z\nDallas,TX,Solar Panel,13000,15000,2023-05-26T00:00:00Z\nSan Jose,CA,Wind Turbine,14500,14500,2023-05-27T00:00:00Z\nAustin,TX,Solar Panel,13000,13000,2023-05-28T00:00:00Z\nJacksonville,FL,Wind Turbine,14000,null,2023-05-29T00:00:00Z\nFort Worth,TX,Solar Panel,13500,13500,2023-05-29T00:00:00Z"}
{"purpose": "Standardize movie theater information by correcting inconsistent city names, fixing date formats, and normalizing ticket prices.", "raw_table": "TheaterName,City,State,TicketPrice,OpeningDate,NumScreens\nGrand_Cinema,los angeles,CA,12.50,03-15-2023,8\nStarplex,the Bronx,ny,15,2023/04/01,10\nCine-World,San franCISCO,ca,ten dollars,2023-05-20,12\nMoviePlex,,NY,13.00,May 25 2023,6\nCinema_Paradiso,Chicago,IL,$11.00,2023.06.01,7\nFlicks,houston,Tx,14.00,06/10/23,9\nEpicTheatre,miami,fl,13.5,Jun 15 2023,11\nSilverScreen,Seattle,WA,,2023-07-01,5\nMajestic,Atlanta,GA,13,07-05-2023,8\nFilmHouse,Denver,co,12.75,2023/07/12,7\nRegal_Cinemas,Portland,Oregon,thirteen,2023-07-20,10\nLiteCinema,Boston,MA,11.5,2023-07-22,6\nMegaMovies,Dallas,tx,14$,2023-07-25,8\nCineStar,San Diego,CA,12.00,7/28/2023,7", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["los angeles"], "to": "Los Angeles"}, {"from": ["the Bronx"], "to": "Bronx"}, {"from": ["San franCISCO"], "to": "San Francisco"}, {"from": [""], "to": "New York"}, {"from": ["houston"], "to": "Houston"}, {"from": ["miami"], "to": "Miami"}, {"from": ["Portland"], "to": "Portland"}, {"from": ["Dallas"], "to": "Dallas"}]}, {"op": "core/mass-edit", "columnName": "State", "edits": [{"from": ["ny"], "to": "NY"}, {"from": ["ca"], "to": "CA"}, {"from": ["Tx"], "to": "TX"}, {"from": ["fl"], "to": "FL"}, {"from": ["co"], "to": "CO"}, {"from": ["Oregon"], "to": "OR"}, {"from": ["tx"], "to": "TX"}]}, {"op": "core/text-transform", "columnName": "TicketPrice", "expression": "value.toString().replace(/\\$/,'').replace(/[^0-9\\.]/g,'').trim().length > 0 ? Number(value.toString().replace(/\\$/,'').replace(/[^0-9\\.]/g,'')) : null"}, {"op": "core/date-parse", "columnName": "OpeningDate", "mode": "lenient", "format": ""}, {"op": "core/mass-edit", "columnName": "TheaterName", "edits": [{"from": ["Grand_Cinema"], "to": "Grand Cinema"}, {"from": ["Cine-World"], "to": "Cine World"}, {"from": ["Cinema_Paradiso"], "to": "Cinema Paradiso"}, {"from": ["Regal_Cinemas"], "to": "Regal Cinemas"}]}], "clean_table": "TheaterName,City,State,TicketPrice,OpeningDate,NumScreens\nGrand Cinema,Los Angeles,CA,12.5,2023-03-15T00:00:00Z,8\nStarplex,Bronx,NY,15,2023-04-01T00:00:00Z,10\nCine World,San Francisco,CA,10,2023-05-20T00:00:00Z,12\nMoviePlex,New York,NY,13,2023-05-25T00:00:00Z,6\nCinema Paradiso,Chicago,IL,11,2023-06-01T00:00:00Z,7\nFlicks,Houston,TX,14,2023-06-10T00:00:00Z,9\nEpicTheatre,Miami,FL,13.5,2023-06-15T00:00:00Z,11\nSilverScreen,Seattle,WA,,2023-07-01T00:00:00Z,5\nMajestic,Atlanta,GA,13,2023-07-05T00:00:00Z,8\nFilmHouse,Denver,CO,12.75,2023-07-12T00:00:00Z,7\nRegal Cinemas,Portland,OR,13,2023-07-20T00:00:00Z,10\nLiteCinema,Boston,MA,11.5,2023-07-22T00:00:00Z,6\nMegaMovies,Dallas,TX,14,2023-07-25T00:00:00Z,8\nCineStar,San Diego,CA,12,2023-07-28T00:00:00Z,7"}
{"purpose": "Clean inconsistent city names and normalize energy provider business types.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,NY,eleCtrici_ty,0.15,10000,01/05/2022\nLOS ANGELES,CA,Gas-Provider,0.12,,2022-02-15\nchicago,IL,solar_provider,0.18,15000,15-Mar-2022\nhouston,TX,,0.14,12000,2022/04/10\nPHOENIX,az,Electricity,0.13,11000,04-20-2022\nphiladelphia,PA,gas provider,0.11,9000,May 30 2022\nsan antonio,TX,solar-Provider,0.20,13000,2022.06.15\nSan Diego,ca,electricity,0.15,14000,07/01/2022\nDALLAS,TX,GAS_PROVIDER,0.10,8000,8/5/2022\nsan jose,CA,solar provider,0.19,16000,2022-08-10\nAUSTIN,tx,Electricity,0.16,,09/15/2022\njacksonville,FL,Gas_provider,0.13,9500,2022-10-01\nfort worth,tx,solar_provider,0.17,14000,11/11/2022\ncolumbus,OH,electricity,0.14,11500,12-01-2022\ncharlotte,NC,GAS-provider,0.12,10500,2022/12/15", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names properly", "columnName": "City", "expression": "value.toLowercase().split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Upper-case state abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["eleCtrici_ty", "Electricity", "electricity", "electricity", "Electricity"], "to": "Electricity"}, {"from": ["Gas-Provider", "gas provider", "GAS_PROVIDER", "Gas_provider", "GAS-provider"], "to": "Gas Provider"}, {"from": ["solar_provider", "solar-Provider", "solar provider", "solar_provider"], "to": "Solar Provider"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount with average rounded to nearest 500", "columnName": "LoanAmount", "edits": [{"from": [""], "to": "11750"}]}, {"op": "core/text-transform", "description": "Normalize Price to have two decimals", "columnName": "Price", "expression": "value.toNumber().toFixed(2)"}, {"op": "core/date-parse", "description": "Parse and standardize Date formats to yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate()", "onError": "keep-original", "onErrorValue": "value"}, {"op": "core/text-transform", "description": "Format Date column as yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Electricity,0.15,10000,2022-01-05\nLos Angeles,CA,Gas Provider,0.12,11750,2022-02-15\nChicago,IL,Solar Provider,0.18,15000,2022-03-15\nHouston,TX,Unknown,0.14,12000,2022-04-10\nPhoenix,AZ,Electricity,0.13,11000,2022-04-20\nPhiladelphia,PA,Gas Provider,0.11,9000,2022-05-30\nSan Antonio,TX,Solar Provider,0.20,13000,2022-06-15\nSan Diego,CA,Electricity,0.15,14000,2022-07-01\nDallas,TX,Gas Provider,0.10,8000,2022-08-05\nSan Jose,CA,Solar Provider,0.19,16000,2022-08-10\nAustin,TX,Electricity,0.16,11750,2022-09-15\nJacksonville,FL,Gas Provider,0.13,9500,2022-10-01\nFort Worth,TX,Solar Provider,0.17,14000,2022-11-11\nColumbus,OH,Electricity,0.14,11500,2022-12-01\nCharlotte,NC,Gas Provider,0.12,10500,2022-12-15"}
{"purpose": "Standardize and clean inconsistent city names, business types, and date formats in telecom sales records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,small-Business,1200,5000,2023/04/15\nlos angeles,ca,enterprise,2500,15000,15-04-2023\nChcago,IL,SMALL business,1150,6000,04-15-2023\nHousTon,TX,En-terprise,2600,14000,2023-04-16\nphoenix,AZ,small_business,1100,7000,April 17, 2023\nphiladelphia,pa,enterprise,2550,16000,2023_04_18\nsan antonio,Tx,Small-Business,1050,6000,2023/18/04\nsan-diego,CA,enterprise,2650,15500,04/19/2023\ndallas,TX,sMALL_business,1000,6500,2023.04.20\nsan jose,ca,enterprise,2700,17000,2023-04-21\n-austin,tx,small_business,950,5800,Apr 22 2023\njacksonville,fl,enterprise,2600,15800,20230423\nfort worth,TX,small-BUSINESS,980,5900,23.04.2023\ncolumbus,oh,enterprise,2550,16500,2023/04/24", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove leading/trailing hyphens and underscores in City", "columnName": "City", "expression": "value.trim().replace(/^[\\-_]+|[\\-_]+$/g, '')"}, {"op": "core/text-transform", "description": "Capitalize each word in City", "columnName": "City", "expression": "value.toLowerCase().split(/\\s+/).map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Capitalize State abbreviations", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType variants to two types: 'Small Business' and 'Enterprise'", "columnName": "BusinessType", "expression": "value.toLowerCase().replace(/[_\\-]/g, ' ').replace(/small\\s*business/, 'Small Business').replace(/enterprise/, 'Enterprise')"}, {"op": "core/mass-edit", "description": "Fix misspelled city name 'Chcago' to 'Chicago'", "columnName": "City", "edits": [{"from": ["Chcago"], "to": "Chicago"}]}, {"op": "core/date-parse", "description": "Parse Date column to consistent ISO format yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate()", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Format Date column as yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate() ? value.toDate().toISOString().slice(0,10) : value"}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numeric, remove any non-numeric characters", "columnName": "Price", "expression": "value.replace(/[^0-9\\.]/g, '').length > 0 ? Number(value.replace(/[^0-9\\.]/g, '')) : null"}, {"op": "core/text-transform", "description": "Convert LoanAmount to numeric", "columnName": "LoanAmount", "expression": "value.replace(/[^0-9\\.]/g, '').length > 0 ? Number(value.replace(/[^0-9\\.]/g, '')) : null"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Small Business,1200,5000,2023-04-15\nLos Angeles,CA,Enterprise,2500,15000,2023-04-15\nChicago,IL,Small Business,1150,6000,2023-04-15\nHouston,TX,Enterprise,2600,14000,2023-04-16\nPhoenix,AZ,Small Business,1100,7000,2023-04-17\nPhiladelphia,PA,Enterprise,2550,16000,2023-04-18\nSan Antonio,TX,Small Business,1050,6000,2023-04-18\nSan Diego,CA,Enterprise,2650,15500,2023-04-19\nDallas,TX,Small Business,1000,6500,2023-04-20\nSan Jose,CA,Enterprise,2700,17000,2023-04-21\nAustin,TX,Small Business,950,5800,2023-04-22\nJacksonville,FL,Enterprise,2600,15800,2023-04-23\nFort Worth,TX,Small Business,980,5900,2023-04-23\nColumbus,OH,Enterprise,2550,16500,2023-04-24"}
{"purpose": "Standardize city names, correct business types, and normalize numeric and date formats in telecom customer data.", "raw_table": "CustomerID,City,State,BusinessType,MonthlyCharge,LoanAmount,ContractStartDate\n1001,New_york,ny,Small-Business,120.5,15000,2023/01/15\n1002,Los Angeles,CA,enterprise,250.75,50000,15-02-2023\n1003,CHICAGO,il,SMALL_busines,100.00, ,2023-03-01\n1004,Houston,Tx,Consumer,75.50,7000,03/05/2023\n1005,phoenix,AZ,consumer,80,8000,2023.04.01\n1006,philadelphia,pa,LARGE-BUSINESS,300.00,60000,04-15-2023\n1007,San-Antonio,tx,enterprise,260.0,55000,2023/05/01\n1008,San Diego,CA,small-business,115.25,14000,May 10, 2023\n1009,dallas,Tx,Consumer,78.9,7500,2023-06-01\n1010,san jose,ca,Enterprise,255.5,52000,2023/07/01\n1011,Austin,tx,,95.0,9000,07/15/2023\n1012,Jacksonville,fl,small-business,110.0,13500,2023-08-01\n1013,Fort Worth,tx,LARGE-BUSINESS,310,61000,08/15/2023\n1014,Columbus,OH,consumer,85.25,8500,2023/09/01\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names and remove underscores/hyphens", "columnName": "City", "expression": "value.toLowercase().replaceAll(/[_-]/,' ').split(' ').map(s, s[0].toUppercase() + s.slice(1)).join(' ')", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Standardize state codes to uppercase two-letter codes", "columnName": "State", "expression": "value.toUppercase().trim()", "onError": "keep-original"}, {"op": "core/mass-edit", "description": "Correct BusinessType misspellings and normalize casing", "columnName": "BusinessType", "edits": [{"from": ["Small-Business", "small-business", "SMALL_busines", "small busines", "small busines"], "to": "Small Business"}, {"from": ["Consumer", "consumer"], "to": "Consumer"}, {"from": ["Enterprise", "enterprise"], "to": "Enterprise"}, {"from": ["LARGE-BUSINESS", "Large-Business", "large-business"], "to": "Large Business"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Normalize MonthlyCharge to two decimals as string", "columnName": "MonthlyCharge", "expression": "if (value.trim()=='') null else Number(value).toFixed(2)", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Normalize LoanAmount to integer string, fill missing with 0", "columnName": "LoanAmount", "expression": "value.trim()=='' ? '0' : String(Number(value))", "onError": "keep-original"}, {"op": "core/date-parse", "description": "Parse ContractStartDate values to yyyy-MM-dd format", "columnName": "ContractStartDate", "mode": "custom", "customDateFormat": "", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Format ContractStartDate uniformly as yyyy-MM-dd", "columnName": "ContractStartDate", "expression": "value.toDate().toString('yyyy-MM-dd')", "onError": "keep-original"}], "clean_table": "CustomerID,City,State,BusinessType,MonthlyCharge,LoanAmount,ContractStartDate\n1001,New York,NY,Small Business,120.50,15000,2023-01-15\n1002,Los Angeles,CA,Enterprise,250.75,50000,2023-02-15\n1003,Chicago,IL,Small Business,100.00,0,2023-03-01\n1004,Houston,TX,Consumer,75.50,7000,2023-03-05\n1005,Phoenix,AZ,Consumer,80.00,8000,2023-04-01\n1006,Philadelphia,PA,Large Business,300.00,60000,2023-04-15\n1007,San Antonio,TX,Enterprise,260.00,55000,2023-05-01\n1008,San Diego,CA,Small Business,115.25,14000,2023-05-10\n1009,Dallas,TX,Consumer,78.90,7500,2023-06-01\n1010,San Jose,CA,Enterprise,255.50,52000,2023-07-01\n1011,Austin,TX,Unknown,95.00,9000,2023-07-15\n1012,Jacksonville,FL,Small Business,110.00,13500,2023-08-01\n1013,Fort Worth,TX,Large Business,310.00,61000,2023-08-15\n1014,Columbus,OH,Consumer,85.25,8500,2023-09-01\n"}
{"purpose": "Clean and standardize city names and business types, fix date formats, and normalize numeric fields for loan and price data in energy sector transactions.", "raw_table": "City,State,BusinessType,Price,LoanAmount,TransactionDate\nNew_york,NY,solar Company,12000,15000,2023/01/15\nlos Angeles,CA,Wind-energy,8500,10000,15-02-2023\nhouston,tx,solar company,9000,,2023.03.01\nChicago,IL,Solar_Company,11000,13000,03/15/23\nphoenix,az,Wind Energy,8000,9000,March 20 2023\nphiladelphia,PA,,9500,10500,2023-04-05\nSan Antonio,TX,wind-energy,8500,9500,2023/04/15\nsan-diego,CA,solar company,12500,13500,04-22-2023\nDallas,TX,solar-company,10000,11000,20230425\nsan Jose,CA,wind energy,7700,8800,2023/05/01\nAustin,TX,Solar Company,10500,11500,May 5th 2023\njacksonville,FL,wind-energy,8000,8500,2023-05-10\nFort Worth,TX,solar company,9500,10000,2023/05/15", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize city names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.replace(\"_\", \" \").replace(\"-\", \" \").toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize state codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["solar Company", "solar company", "Solar_Company", "solar-company", "Solar Company"], "to": "Solar Company"}, {"from": ["Wind-energy", "Wind Energy", "wind-energy", "wind energy", "wind energy"], "to": "Wind Energy"}]}, {"op": "core/mass-edit", "description": "Fill missing BusinessType with 'Unknown'", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Fix date format to ISO yyyy-MM-dd", "columnName": "TransactionDate", "expression": "value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/).length > 0 ? value.replace('/', '-').replace('/', '-') : (value.match(/\\d{2}-\\d{2}-\\d{4}/).length > 0 ? value.split('-')[2] + '-' + value.split('-')[0].padStart(2,'0') + '-' + value.split('-')[1].padStart(2,'0') : (value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/).length > 0 ? value.replace('.', '-').replace('.', '-') : (value.match(/\\d{2}\\/\\d{2}\\/\\d{2}/).length > 0 ? '20' + value.split('/')[2] + '-' + value.split('/')[0].padStart(2,'0') + '-' + value.split('/')[1].padStart(2,'0') : (value.match(/March 20 2023/).length > 0 ? '2023-03-20' : (value.match(/\\d{4}-\\d{2}-\\d{2}/).length > 0 ? value : (value.match(/\\d{8}/).length > 0 ? value.slice(0,4) + '-' + value.slice(4,6) + '-' + value.slice(6) : (value.match(/May 5th 2023/).length > 0 ? '2023-05-05' : value))))))))"}, {"op": "core/text-transform", "description": "Convert Price to number, remove any non-digit characters", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number, set missing as 0", "columnName": "LoanAmount", "expression": "value == null || value == '' ? 0 : value.toNumber()"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,TransactionDate\nNew York,NY,Solar Company,12000,15000,2023-01-15\nLos Angeles,CA,Wind Energy,8500,10000,2023-02-15\nHouston,TX,Solar Company,9000,0,2023-03-01\nChicago,IL,Solar Company,11000,13000,2023-03-15\nPhoenix,AZ,Wind Energy,8000,9000,2023-03-20\nPhiladelphia,PA,Unknown,9500,10500,2023-04-05\nSan Antonio,TX,Wind Energy,8500,9500,2023-04-15\nSan Diego,CA,Solar Company,12500,13500,2023-04-22\nDallas,TX,Solar Company,10000,11000,2023-04-25\nSan Jose,CA,Wind Energy,7700,8800,2023-05-01\nAustin,TX,Solar Company,10500,11500,2023-05-05\nJacksonville,FL,Wind Energy,8000,8500,2023-05-10\nFort Worth,TX,Solar Company,9500,10000,2023-05-15"}
{"purpose": "Standardize city and state names, unify loan amount formats, fix date inconsistencies, and normalize crop types for agricultural loan records.", "raw_table": "ID,City,State,Crop,Price,LoanAmount,Date\n1,dallas,TXW,dair y,1500,10000,03-15-2023\n2,Austin,tx,corn,2000,  12000,2023/04/01\n3,Houston,TxWheat,3000,13000,15-05-2023\n4,San-antonio,TX,Corn,1700,,2023-06-01\n5,Dallas,txwheat,maize,2100,11000,2023.07.18\n6,Houston,TXW,DAIRY, 1600,14000,2023/08/12\n7,,TX,maize,2000,9000,2023-09-05\n8,Austin,TXWheat,maize,1800,11500,09-25-2023\n9,San Antonio,txw,corn,1900,12500,2023-10-11\n10,Dallas,TXW,DAIR Y,1750,13500,11/05/2023\n11,Houston,TXWHEAT,maize,,14000,2023-11-15\n12,Austin,TXW,corn,2100, ,2023-12-01\n13,San-Antonio,txwheat,DAIRY,1950,13000,12.20.2023\n14,Dallas,TXWheat,maize,2000,14500,2023-12-25\n15,Houston,TXWheat,corn,1850,12500,01-05-2024", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["dallas", "Dallas"], "to": "Dallas"}, {"from": ["Austin"], "to": "Austin"}, {"from": ["Houston"], "to": "Houston"}, {"from": ["San-antonio", "San Antonio", "San-Antonio"], "to": "San Antonio"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/mass-edit", "columnName": "State", "edits": [{"from": ["TXW", "txw", "TxW", "txwheat", "TXWheat", "txwheat", "TXWHEAT"], "to": "TX"}, {"from": ["tx", "Tx"], "to": "TX"}]}, {"op": "core/mass-edit", "columnName": "Crop", "edits": [{"from": ["dair y", "DAIR Y", "DAIRY"], "to": "Dairy"}, {"from": ["corn", "Corn"], "to": "Corn"}, {"from": ["maize"], "to": "Maize"}, {"from": ["wheat", "Wheat", "WHEAT"], "to": "Wheat"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.trim() == '' ? null : Number(value.trim())"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value.trim() == '' ? null : Number(value.trim())"}, {"op": "core/date-parse", "columnName": "Date", "format": "auto"}, {"op": "core/fill-down", "columnName": "City"}, {"op": "core/mass-edit", "columnName": "LoanAmount", "edits": [{"from": [null], "to": "0"}]}, {"op": "core/mass-edit", "columnName": "Price", "edits": [{"from": [null], "to": "0"}]}], "clean_table": "ID,City,State,Crop,Price,LoanAmount,Date\n1,Dallas,TX,Dairy,1500,10000,2023-03-15T00:00:00Z\n2,Austin,TX,Corn,2000,12000,2023-04-01T00:00:00Z\n3,Houston,TX,Wheat,3000,13000,2023-05-15T00:00:00Z\n4,San Antonio,TX,Corn,1700,0,2023-06-01T00:00:00Z\n5,Dallas,TX,Maize,2100,11000,2023-07-18T00:00:00Z\n6,Houston,TX,Dairy,1600,14000,2023-08-12T00:00:00Z\n7,Unknown,TX,Maize,2000,9000,2023-09-05T00:00:00Z\n8,Austin,TX,Wheat,1800,11500,2023-09-25T00:00:00Z\n9,San Antonio,TX,Corn,1900,12500,2023-10-11T00:00:00Z\n10,Dallas,TX,Dairy,1750,13500,2023-11-05T00:00:00Z\n11,Houston,TX,Wheat,0,14000,2023-11-15T00:00:00Z\n12,Austin,TX,Corn,2100,0,2023-12-01T00:00:00Z\n13,San Antonio,TX,Dairy,1950,13000,2023-12-20T00:00:00Z\n14,Dallas,TX,Wheat,2000,14500,2023-12-25T00:00:00Z\n15,Houston,TX,Wheat,1850,12500,2024-01-05T00:00:00Z"}
{"purpose": "Standardize telecommunications customer data by fixing city names, normalizing business types, and correcting date and numeric formats.", "raw_table": "CustomerID,City,State,BusinessType,MonthlyCharge,LoanAmount,SignupDate\n1001,NeW_york,NY,small-Biz,120.5,15000,01-15-2023\n1002,los angeles ,ca,Enterprise, 220.00, 50000 ,2023/02/20\n1003,Chicago,IL,small biz,99.99,12000,03-05-23\n1004,Houston,tx,SMALL-BIZ,,13000,2023-04-10\n1005,philadelphia,PA,enterprise,180,55000,April 15 2023\n1006,Phoenix,Az,Medium-Biz,150.25, ,2023-05-01\n1007,San-antonio,TX,medium biz,140.75,25000,2023/06/10\n1008,San Diego,CA,Small Biz,130.00,14000,06-25-2023\n1009,Dallas,TX,Enterprise,210.5,52000,07-01-2023\n1010,San Jose,CA,enterprise,205,53000,07/05/2023\n1011,Austin,TX,medium-biz,145.5,27000,July 10, 2023\n1012,Jacksonville,fl,small_biz,110,11500,07-15-23\n1013,Fort Worth,TX,smallbiz,100.00,13000,2023-08-01\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens from City and business type, and trim spaces", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').trim().toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize capitalization of State to uppercase", "columnName": "State", "expression": "value.toUppercase().trim()"}, {"op": "core/text-transform", "description": "Normalize BusinessType values to consistent titles and remove extra spaces", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[_-]/g, ' ').trim()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType variants", "columnName": "BusinessType", "edits": [{"from": ["small biz", "smallbiz", "small biz", "small_biz", "small biz"], "to": "Small Biz"}, {"from": ["medium biz", "medium-biz", "medium biz"], "to": "Medium Biz"}, {"from": ["enterprise"], "to": "Enterprise"}]}, {"op": "core/text-transform", "description": "Convert MonthlyCharge to number and fill missing with 0", "columnName": "MonthlyCharge", "expression": "if(isNullOrBlank(value),0,Number(value.trim()))"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number and fill missing with 0", "columnName": "LoanAmount", "expression": "if(isNullOrBlank(value),0,Number(value.trim()))"}, {"op": "core/text-transform", "description": "Parse SignupDate in various formats to yyyy-MM-dd", "columnName": "SignupDate", "expression": "cells['SignupDate'].value.toDate('yyyy-MM-dd') ? cells['SignupDate'].value.toDate('yyyy-MM-dd').toString('yyyy-MM-dd') : \n(if(cells['SignupDate'].value.toDate('MM-dd-yyyy'), cells['SignupDate'].value.toDate('MM-dd-yyyy').toString('yyyy-MM-dd'), \nif(cells['SignupDate'].value.toDate('yyyy/MM/dd'), cells['SignupDate'].value.toDate('yyyy/MM/dd').toString('yyyy-MM-dd'), \nif(cells['SignupDate'].value.toDate('MMM dd yyyy'), cells['SignupDate'].value.toDate('MMM dd yyyy').toString('yyyy-MM-dd'), \nif(cells['SignupDate'].value.toDate('MMM dd, yyyy'), cells['SignupDate'].value.toDate('MMM dd, yyyy').toString('yyyy-MM-dd'), '')))))"}, {"op": "core/column-rename", "description": "Rename MonthlyCharge to Monthly_Charge for consistency", "oldColumnName": "MonthlyCharge", "newColumnName": "Monthly_Charge"}], "clean_table": "CustomerID,City,State,BusinessType,Monthly_Charge,LoanAmount,SignupDate\n1001,New York,NY,Small Biz,120.5,15000,2023-01-15\n1002,Los Angeles,CA,Enterprise,220,50000,2023-02-20\n1003,Chicago,IL,Small Biz,99.99,12000,2023-03-05\n1004,Houston,TX,Small Biz,0,13000,2023-04-10\n1005,Philadelphia,PA,Enterprise,180,55000,2023-04-15\n1006,Phoenix,AZ,Medium Biz,150.25,0,2023-05-01\n1007,San Antonio,TX,Medium Biz,140.75,25000,2023-06-10\n1008,San Diego,CA,Small Biz,130,14000,2023-06-25\n1009,Dallas,TX,Enterprise,210.5,52000,2023-07-01\n1010,San Jose,CA,Enterprise,205,53000,2023-07-05\n1011,Austin,TX,Medium Biz,145.5,27000,2023-07-10\n1012,Jacksonville,FL,Small Biz,110,11500,2023-07-15\n1013,Fort Worth,TX,Small Biz,100,13000,2023-08-01\n"}
{"purpose": "Clean and normalize movie dataset with inconsistent title formatting, release dates, and genre entries.", "raw_table": "Title,Director,ReleaseDate,Genre,Budget,BoxOffice\n\"the AvengerS\",\"joss whedon\",2012-05-04,Action,220000000,1518812988\n\"INCEPTION\",\"christopher nolan\",07/16/2010,SciFi,160000000,829895144\n\"interstellar\",\"christopher nolan\",2014/11/07,scifi,165000000,677471339\n\"Skyfall\",\"Sam Mendes\",2012-11-0X,action,200000000,1108561013\n\"The Dark Knight_Rises\",\"christopher nolan\",2012-07-20,Action,250000000,1081041287\n\"Jumanji: Welcome to the Jungle\",,,Adventure,90000000,962139754\n\"frozen\",\"jennifer lee\",2013-11-27,Animation,150000000,1276480335\n\"La La Land\",\"Damien Chazelle\",2016/12/09,Musical,30000000,446300000\n\"The Lion_King\",\"Roger Allers\",1994-06-15,animation,45000000,968483777\n,\"David Fincher\",1999/10/15,Thriller,63000000,100853753\n\"Avengers: Infinity_War\",\"Anthony and Joe Russo\",2018-04-27,Action,316000000,2048359754\n\"Parasite\",Bong Joon-ho,2019-05/30,Thriller,-,258708154\n\"The Godfather\",\"Francis Ford Coppola\",1972-03-24,Crime,6000000,246120974\n\"Pulp-Fiction\",\"Quentin Tarantino\",1994-10-14,crime,8000000,213928762\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize Title capitalization and remove underscores/hyphens", "columnName": "Title", "expression": "value.toLowercase().replace(/[_-]/, ' ').split(' ').map(w, w.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Fix missing or incorrect ReleaseDate values", "columnName": "ReleaseDate", "edits": [{"from": ["2012-11-0X"], "to": "2012-11-05"}, {"from": [""], "to": "2017-12-20"}, {"from": ["2019-05/30"], "to": "2019-05-30"}]}, {"op": "core/text-transform", "description": "Normalize Genre capitalization", "columnName": "Genre", "expression": "value.toLowercase().capitalize()"}, {"op": "core/mass-edit", "description": "Fix Genre inconsistent values", "columnName": "Genre", "edits": [{"from": ["SciFi", "Scifi"], "to": "Sci-Fi"}, {"from": ["crime"], "to": "Crime"}]}, {"op": "core/text-transform", "description": "Normalize Director capitalization", "columnName": "Director", "expression": "value.split(' and ').map(v, v.trim().split(' ').map(w, w.capitalize()).join(' ')).join(' and ')"}, {"op": "core/mass-edit", "description": "Fill missing Director with 'Unknown'", "columnName": "Director", "edits": [{"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Parse Budget and BoxOffice as numbers and fill missing with null", "columnName": "Budget", "expression": "isNonBlank(value) && value != '-' ? value.toNumber() : null"}, {"op": "core/text-transform", "description": "Parse BoxOffice as numbers", "columnName": "BoxOffice", "expression": "value.toNumber()"}, {"op": "core/date-parse", "description": "Parse ReleaseDate as standard date", "columnName": "ReleaseDate", "dateFormat": "yyyy-MM-dd", "guessCellType": true, "mode": "lenient"}], "clean_table": "Title,Director,ReleaseDate,Genre,Budget,BoxOffice\nThe Avengers,Joss Whedon,2012-05-04,Action,220000000,1518812988\nInception,Christopher Nolan,2010-07-16,Sci-Fi,160000000,829895144\nInterstellar,Christopher Nolan,2014-11-07,Sci-Fi,165000000,677471339\nSkyfall,Sam Mendes,2012-11-05,Action,200000000,1108561013\nThe Dark Knight Rises,Christopher Nolan,2012-07-20,Action,250000000,1081041287\nJumanji: Welcome To The Jungle,Unknown,2017-12-20,Adventure,90000000,962139754\nFrozen,Jennifer Lee,2013-11-27,Animation,150000000,1276480335\nLa La Land,Damien Chazelle,2016-12-09,Musical,30000000,446300000\nThe Lion King,Roger Allers,1994-06-15,Animation,45000000,968483777\n,David Fincher,1999-10-15,Thriller,63000000,100853753\nAvengers: Infinity War,Anthony And Joe Russo,2018-04-27,Action,316000000,2048359754\nParasite,Bong Joon-ho,2019-05-30,Thriller,null,258708154\nThe Godfather,Francis Ford Coppola,1972-03-24,Crime,6000000,246120974\nPulp Fiction,Quentin Tarantino,1994-10-14,Crime,8000000,213928762\n"}
{"purpose": "Standardize city names and business types, correct date and numeric formats in government loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,Restaurant,100000,50000,01/15/2022\nlos angeles,CA,retail_store,85000,40000,2022-02-20\nChicago,IL,RETAIL-store,90000,45000,3/5/2022\nhouston,TX,restaurant,NaN,30000,April 1 2022\nPHOENIX,AZ,Consulting,70000,,2022/04/10\nphiladelphia,PA,consultng,65000,35000,13-05-2022\nsan antonio,TX,Retail_Store,80000,40000,2022.06.15\nsan diego,CA,restaurant,95000,50000,07-20-2022\nDallas,TX,RESTAURANT,88000,NaN,2022-08-01\nsan jose,CA,Consulting,72000,36000,08/25/2022\nAustin,TX,retail-store,83000,41000,2022-09-10\njacksonville,FL,restaurant,91000,45000,10/05/2022\nfort worth,TX,Consulting,68000,34000,11-11-2022", "cleaning_workflow": [{"op": "core/text-transform", "description": "Fix underscores and hyphens in City names", "columnName": "City", "expression": "value.replaceAll('_', ' ').replaceAll('-', ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize BusinessType capitalization and remove underscores/hyphens", "columnName": "BusinessType", "expression": "value.replaceAll('_', '').replaceAll('-', '').toLowercase().replace('consultng', 'consulting').replace('consulting', 'Consulting').replace('restaurant', 'Restaurant').replace('retailstore', 'Retail Store')"}, {"op": "core/mass-edit", "description": "Fix known misspellings in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["consultng"], "to": "Consulting"}, {"from": ["retail_store"], "to": "Retail Store"}, {"from": ["retailstore"], "to": "Retail Store"}, {"from": ["retail-store"], "to": "Retail Store"}]}, {"op": "core/mass-edit", "description": "Fix missing Price and LoanAmount values by setting to 0", "columnName": "Price", "edits": [{"from": [""], "to": "0"}, {"from": ["NaN"], "to": "0"}]}, {"op": "core/mass-edit", "description": "Fix missing LoanAmount values by setting to 0", "columnName": "LoanAmount", "edits": [{"from": [""], "to": "0"}, {"from": ["NaN"], "to": "0"}]}, {"op": "core/text-transform", "description": "Normalize Price and LoanAmount to numeric strings (remove commas if any)", "columnName": "Price", "expression": "value.replaceAll(',', '')"}, {"op": "core/text-transform", "description": "Normalize LoanAmount to numeric strings (remove commas if any)", "columnName": "LoanAmount", "expression": "value.replaceAll(',', '')"}, {"op": "core/date-parse", "description": "Parse Date column to ISO format yyyy-MM-dd", "columnName": "Date", "format": "auto", "mode": "lenient"}, {"op": "core/column-rename", "description": "Rename City to CityName", "oldColumnName": "City", "newColumnName": "CityName"}], "clean_table": "CityName,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,100000,50000,2022-01-15\nLos Angeles,CA,Retail Store,85000,40000,2022-02-20\nChicago,IL,Retail Store,90000,45000,2022-03-05\nHouston,TX,Restaurant,0,30000,2022-04-01\nPhoenix,AZ,Consulting,70000,0,2022-04-10\nPhiladelphia,PA,Consulting,65000,35000,2022-05-13\nSan Antonio,TX,Retail Store,80000,40000,2022-06-15\nSan Diego,CA,Restaurant,95000,50000,2022-07-20\nDallas,TX,Restaurant,88000,0,2022-08-01\nSan Jose,CA,Consulting,72000,36000,2022-08-25\nAustin,TX,Retail Store,83000,41000,2022-09-10\nJacksonville,FL,Restaurant,91000,45000,2022-10-05\nFort Worth,TX,Consulting,68000,34000,2022-11-11"}
{"purpose": "Standardize and clean farm loan records with consistent formatting and corrected errors.", "raw_table": "FarmID,City,State,CropType,LoanAmount,Price_per_Ton,LoanDate\nF001,SpringField,il,Corn,50000,150,2023/03/15\nf002,Decatur,IL,Wheat,45000,145,03-22-2023\nF003,Peoria,IL,Soy-bean,52000,INVALID,2023-04-01\nF004,Champaign,IL,Corn,NA,155,4/10/2023\nF005,Springfield,IL,WHEAT,47000,148,2023.03.20\nF006,Champaign,IL,Corn,48000,152,2023-04-05\nF007,Peoria,il,Soybean,53000,149,2023/04/0\nF008,Decatur,IL,,46000,147,2023/03/28\nF009,Springfield,IL,Corn,49000,153,2023-03-30\nf010,peoria,IL,Soy bean,51000,150,2023/04/02", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.toLowercase().replace(/_/g, '').replace(/-/g, '').replace(/\\b\\w/g, v, v.toUppercase())"}, {"op": "core/mass-edit", "columnName": "State", "edits": [{"from": ["il", "Il", "iL", "IL"], "to": "IL"}]}, {"op": "core/mass-edit", "columnName": "CropType", "edits": [{"from": ["Soy-bean", "Soybean", "Soy bean"], "to": "Soybean"}, {"from": ["WHEAT", "wheat"], "to": "Wheat"}, {"from": [null, "", "NA"], "to": ""}]}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value == 'NA' ? null : parseFloat(value)"}, {"op": "core/text-transform", "columnName": "Price_per_Ton", "expression": "isNaN(parseFloat(value)) ? null : parseFloat(value)"}, {"op": "core/date-parse", "columnName": "LoanDate", "mode": "custom", "format": "yyyy-MM-dd", "expression": "value.replace(/[\\/\\.]/g, '-')"}, {"op": "core/fill-down", "columnName": "CropType"}], "clean_table": "FarmID,City,State,CropType,LoanAmount,Price_per_Ton,LoanDate\nF001,Springfield,IL,Corn,50000,150,2023-03-15\nF002,Decatur,IL,Wheat,45000,145,2023-03-22\nF003,Peoria,IL,Soybean,52000,,2023-04-01\nF004,Champaign,IL,Corn,,155,2023-04-10\nF005,Springfield,IL,Wheat,47000,148,2023-03-20\nF006,Champaign,IL,Corn,48000,152,2023-04-05\nF007,Peoria,IL,Soybean,53000,149,2023-04-01\nF008,Decatur,IL,Soybean,46000,147,2023-03-28\nF009,Springfield,IL,Corn,49000,153,2023-03-30\nF010,Peoria,IL,Soybean,51000,150,2023-04-02"}
{"purpose": "Standardize city names, business types, and date formats; fix numeric fields and remove extraneous characters.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,REtail,100000,50000,01/15/2023\nlos angeles,CA,-restaurant-,75000,abc,2023-02-30\nchicago ,IL,AutoRepair,125000,,3/10/2023\nhouston,tx,RETAIL,90000,45000,2023/04/05\nPHOENIX,AZ,restaurant,85000,40000,April 7 2023\nphiladelphia,PA,retail_,,30000,07-04-2023\nsan antonio,TX,auto repair,70000,35000,2023.05.01\nsan diego,CA,Restaurant,95000,47000,05/20/2023\n_dallas,TX,RETAIL,80000,40000,2023-06-15\nsan jose,CA,restaurant,88000,44000,15/06/2023\nAustin,TX,auto_repair,67000,33000,2023/07/10\njacksonville,FL,RETAIL,72000,36000,07/25/2023\nfort-worth,TX,restaurant,82000,,08/01/2023\ncolumbus,OH,,78000,39000,08-15-2023\ncharlotte,NC,RETAIL,83000,41500,2023-08-20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and remove leading/trailing underscores and hyphens from City", "columnName": "City", "expression": "value.trim().replace(/^[_-]+|[_-]+$/g, '').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.trim().toUppercase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType values to title case and remove underscores/hyphens", "columnName": "BusinessType", "expression": "value.replace(/[_-]/g, '').trim().toLowercase().match(/^(retail|restaurant|autorepair)$/) ? value.replace(/[_-]/g, '').trim().toLowercase().replace(/^./, v => v.toUpperCase()) : null"}, {"op": "core/mass-edit", "description": "Fix known misspellings and inconsistent BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["REtail", "RETAIL", "retail_", "RETAIL", "auto repair", "auto_repair", "-restaurant-"], "to": "Retail"}, {"from": ["restaurant", "Restaurant"], "to": "Restaurant"}, {"from": ["AutoRepair"], "to": "AutoRepair"}]}, {"op": "core/text-transform", "description": "Clean Price and LoanAmount columns to numeric, remove non-numeric chars", "columnName": "Price", "expression": "value.replace(/[^0-9]/g, '') ? Number(value.replace(/[^0-9]/g, '')) : null"}, {"op": "core/text-transform", "description": "Clean LoanAmount column to numeric, convert non-numeric or missing to null", "columnName": "LoanAmount", "expression": "value && value.replace(/[^0-9]/g, '') ? Number(value.replace(/[^0-9]/g, '')) : null"}, {"op": "core/date-parse", "description": "Parse Date with multiple formats, output ISO yyyy-MM-dd", "columnName": "Date", "format": "multiple", "dateFormats": ["MM/dd/yyyy", "yyyy-MM-dd", "M/d/yyyy", "yyyy/MM/dd", "MMMM d yyyy", "MM-dd-yyyy", "yyyy.MM.dd", "dd/MM/yyyy", "MM/dd/yy", "d-M-yyyy"], "to": "yyyy-MM-dd"}, {"op": "core/mass-edit", "description": "Fix impossible / invalid dates to null", "columnName": "Date", "edits": [{"from": ["2023-02-30"], "to": null}]}, {"op": "core/fill-down", "description": "Fill down missing BusinessType values", "columnName": "BusinessType"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,100000,50000,2023-01-15\nLos Angeles,CA,Restaurant,75000,,\nChicago,IL,AutoRepair,125000,,2023-03-10\nHouston,TX,Retail,90000,45000,2023-04-05\nPhoenix,AZ,Restaurant,85000,40000,2023-04-07\nPhiladelphia,PA,Retail,,30000,2023-07-04\nSan Antonio,TX,AutoRepair,70000,35000,2023-05-01\nSan Diego,CA,Restaurant,95000,47000,2023-05-20\nDallas,TX,Retail,80000,40000,2023-06-15\nSan Jose,CA,Restaurant,88000,44000,2023-06-15\nAustin,TX,AutoRepair,67000,33000,2023-07-10\nJacksonville,FL,Retail,72000,36000,2023-07-25\nFort Worth,TX,Restaurant,82000,,2023-08-01\nColumbus,OH,Retail,78000,39000,2023-08-15\nCharlotte,NC,Retail,83000,41500,2023-08-20"}
{"purpose": "Standardize city names, fix inconsistent business type entries, and normalize date and numeric formats in energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,ny,solar-installation,25000,50000,01/15/2023\nLos-Angeles,CA,Wind_Turbine,30000,75000,2023-02-10\nCHICAGO,il,solar installation,27000,,15-03-2023\nHouston,TX,solar-Install,23000,48000,03/20/23\nphiladelphia,pa,wind_turbine,28000,52000,04/05/2023\nPhoenix,AZ,SOLAR_INSTALLATION,25000,50000,2023/04/15\nsan antonio,tx, Wind-turbine ,27000,53000,05-10-2023\nsan diego,ca,solar-install,26000,49000,2023-06-01\nDallas,TX,Solar Inst,24000,47000,06/15/2023\nsan jose,CA,wind turbine,29000,60000,2023-07-20\nAustin,TX,SOLAR-installation,25500,51000,07-25-2023\nJacksonville,FL,wind-turbine,27500,54000,08/05/2023\nFort Worth,TX,solar_installation,26500,50500,2023-08-15", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from BusinessType", "columnName": "BusinessType", "expression": "value.trim()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["solar-installation", "solar Install", "solar-Install", "solar_installation", "solar-install", "Solar Inst", "SOLAR_INSTALLATION", "SOLAR-installation"], "to": "Solar Installation"}, {"from": ["wind_turbine", "Wind_Turbine", "wind turbine", "Wind-turbine", "wind-turbine", " Wind-turbine "], "to": "Wind Turbine"}]}, {"op": "core/text-transform", "description": "Capitalize City names properly", "columnName": "City", "expression": "value.toLowercase().split(' ').map(s, s[0].toUppercase() + s.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Remove hyphens and underscores from City and standardize", "columnName": "City", "expression": "value.replace(/[-_]/g, ' ')"}, {"op": "core/mass-edit", "description": "Standardize State codes to uppercase", "columnName": "State", "edits": [{"from": ["ny", "il", "pa", "az", "fl", "ca", "tx"], "to": "NY"}]}, {"op": "core/text-transform", "description": "Transform all State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/date-parse", "description": "Parse various Date formats", "columnName": "Date", "valueType": "date", "format": "MM/dd/yyyy"}, {"op": "core/text-transform", "description": "Format Date to yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/text-transform", "description": "Convert Price to number", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number and fill missing with 0", "columnName": "LoanAmount", "expression": "if(value == '' || value == null, 0, value.toNumber())"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,25000,50000,2023-01-15\nLos Angeles,CA,Wind Turbine,30000,75000,2023-02-10\nChicago,IL,Solar Installation,27000,0,2023-03-15\nHouston,TX,Solar Installation,23000,48000,2023-03-20\nPhiladelphia,PA,Wind Turbine,28000,52000,2023-04-05\nPhoenix,AZ,Solar Installation,25000,50000,2023-04-15\nSan Antonio,TX,Wind Turbine,27000,53000,2023-05-10\nSan Diego,CA,Solar Installation,26000,49000,2023-06-01\nDallas,TX,Solar Installation,24000,47000,2023-06-15\nSan Jose,CA,Wind Turbine,29000,60000,2023-07-20\nAustin,TX,Solar Installation,25500,51000,2023-07-25\nJacksonville,FL,Wind Turbine,27500,54000,2023-08-05\nFort Worth,TX,Solar Installation,26500,50500,2023-08-15"}
{"purpose": "Clean inconsistent city names, standardize date formats, and unify business types in telecommunications loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew-york,NY,Cellular,599.99,10000,03/15/2022\nlos angeles,CA,cell_towers,750.00,15000,2022-04-01\nCHICAGO,il,Mobile Carrier,abc,12000,15-May-2022\nhouston,TX,Cellular,650,9000,2022/06/10\nPHOENIX,az,cell-towers,700,11000,Jun 20 2022\nphiladelphia,PA,,550.5,8000,2022-07-05\nSan Antonio,TX,Mobile Carrier,625.75,,07/15/2022\nsan_diego,CA,cellular,620,7000,2022-08-01\nDallas,tx,cell towers,640.00,8500,20220815\nsan jose,CA,Mobile Carrier,abc,9500,2022-08-20\nAustin,TX,cellular,610,10000,Aug 25 22\nJacksonville,FL,Cellular,600,-500,2022-09-01\nfort worth,TX,Cellular,615,7500,9/10/2022", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New-york"], "to": "New York"}, {"from": ["los angeles"], "to": "Los Angeles"}, {"from": ["san_diego"], "to": "San Diego"}, {"from": ["san jose"], "to": "San Jose"}, {"from": ["fort worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["cell_towers", "cell-towers", "cell towers"], "to": "Cell Towers"}, {"from": ["Cellular", "cellular"], "to": "Cellular"}, {"from": ["Mobile Carrier", "mobile carrier"], "to": "Mobile Carrier"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "isNaN(value) ? null : Number(value)"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "isNaN(value) || Number(value) < 0 ? null : Number(value)"}, {"op": "core/date-parse", "columnName": "Date", "dateFormat": "yyyy-MM-dd"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value.toString().length == 4 ? '20' + value : value"}, {"op": "core/fill-down", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Cellular,599.99,10000,2022-03-15\nLos Angeles,CA,Cell Towers,750,15000,2022-04-01\nChicago,IL,Mobile Carrier,null,12000,2022-05-15\nHouston,TX,Cellular,650,9000,2022-06-10\nPhoenix,AZ,Cell Towers,700,11000,2022-06-20\nPhiladelphia,PA,Unknown,550.5,8000,2022-07-05\nSan Antonio,TX,Mobile Carrier,625.75,8000,2022-07-15\nSan Diego,CA,Cellular,620,7000,2022-08-01\nDallas,TX,Cell Towers,640,8500,2022-08-15\nSan Jose,CA,Mobile Carrier,null,9500,2022-08-20\nAustin,TX,Cellular,610,10000,2022-08-25\nJacksonville,FL,Cellular,600,null,2022-09-01\nFort Worth,TX,Cellular,615,7500,2022-09-10"}
{"purpose": "Standardize movie genre labels and clean inconsistent release date formats in the dataset.", "raw_table": "Title,Genre,Release Date,Rating,Box Office\n\"The Last Frontier\",\"Action-Adventure\",\"12/31/2022\",\"PG-13\",\"$120M\"\n\"dreamscape\",\"Sci-Fi\",\"2023-02-15\",\"PG13\",\"100 million\"\n\"Sunset Boulevard\",\"Drama\",\"15th March 2021\",\"R\",\"85,000,000\"\n\"Galaxy-Quest\",\"Sci_Fi\",\"03/22/2020\",\"PG\",\"$75M\"\n\"Haunted Nights\",\"Horror\",\"2020/10/31\",\"r\",\"$40,000,000\"\n\"Laughter House\",\"comedy\",\"April 1 2019\",\"PG-13\",\"$50 million\"\n\"the Great Escape\",\"action adventure\",\"2018-07-04\",\"PG 13\",\"$135M\"\n\"Love & War\",\"rom-com\",\"2017/11/11\",\"PG\",\"$60,000,000\"\n\"Mystic River\",\"Drama\",\"07-15-2016\",\"R\",\"$70M\"\n\"Shadow Realm\",\"HorroR\",\"October 31, 2015\",\"r\",\"$30 million\"\n\"Future Worlds\",\"SCI-FI\",\"2014-12-25\",\"PG-13\",\"$90,000,000\"\n\"Happy Days\",\"Comedy\",\"2013/06/20\",\"PG\",\"45M\"", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize Genre values to lowercase and replace underscores/hyphens with spaces", "columnName": "Genre", "expression": "value.toLowercase().replace('_', ' ').replace('-', ' ')"}, {"op": "core/mass-edit", "description": "Standardize genre variations", "columnName": "Genre", "edits": [{"from": ["rom com", "rom-com"], "to": "romantic comedy"}, {"from": ["sci fi", "sci fi"], "to": "sci-fi"}, {"from": ["action adventure", "action adventure"], "to": "action-adventure"}, {"from": ["horro r", "horror", "horro r"], "to": "horror"}, {"from": ["comedy"], "to": "comedy"}, {"from": ["drama"], "to": "drama"}]}, {"op": "core/text-transform", "description": "Clean Release Date to ISO format yyyy-MM-dd", "columnName": "Release Date", "expression": "if(value.match(/\\d{4}-\\d{2}-\\d{2}/), value, if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/), value.split('/')[2] + '-' + value.split('/')[0].padStart(2,'0') + '-' + value.split('/')[1].padStart(2,'0'), if(value.match(/[A-Za-z]+ \\d{1,2} \\d{4}/), date.parse(value).toISOString().slice(0,10), if(value.match(/\\d{1,2}[a-z]{2} [A-Za-z]+ \\d{4}/), date.parse(value.replace(/\\d{1,2}[a-z]{2}/, value.match(/\\d{1,2}/))).toISOString().slice(0,10), if(value.match(/\\d{2}-\\d{2}-\\d{4}/), value.split('-')[2] + '-' + value.split('-')[0].padStart(2,'0') + '-' + value.split('-')[1].padStart(2,'0'), '')))))"}, {"op": "core/text-transform", "description": "Normalize Rating values (uppercase, standard PG-13 etc.)", "columnName": "Rating", "expression": "value.toUppercase().replace('PG 13','PG-13').trim()"}, {"op": "core/text-transform", "description": "Normalize Box Office to numeric value in millions", "columnName": "Box Office", "expression": "var v = value.toLowercase().replace(/\\$/g,'').replace(/,/g,'').replace(/million/g,'').replace(/m/g,'').trim(); if(v == '') {0} else {Number(v)}"}], "clean_table": "Title,Genre,Release Date,Rating,Box Office\n\"The Last Frontier\",action-adventure,2022-12-31,PG-13,120\n\"dreamscape\",sci-fi,2023-02-15,PG-13,100\n\"Sunset Boulevard\",drama,2021-03-15,R,85\n\"Galaxy-Quest\",sci-fi,2020-03-22,PG,75\n\"Haunted Nights\",horror,2020-10-31,R,40\n\"Laughter House\",comedy,2019-04-01,PG-13,50\n\"the Great Escape\",action-adventure,2018-07-04,PG-13,135\n\"Love & War\",romantic comedy,2017-11-11,PG,60\n\"Mystic River\",drama,2016-07-15,R,70\n\"Shadow Realm\",horror,2015-10-31,R,30\n\"Future Worlds\",sci-fi,2014-12-25,PG-13,90\n\"Happy Days\",comedy,2013-06-20,PG,45"}
{"purpose": "Standardize city and state names, unify business types, correct date formats, and clean numeric values in telecom loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,ny,Mobile_Shop,1000,5000,01-12-2023\nLos_Angeles,CA,Internet-Cafe,850,abc,2023/02/15\nchicago,illinois,MobileShop,1200,7000,15/03/2023\nHouston,TX,Mobile-shop,950,4500,2023-04-01\nphiladelphia,pa,Mobile Shop,1100,6000,April 5 2023\nPhoenix,az,Internet_cafe,800,4000,2023.05.10\nsan antonio,TX,Mobile_Shop,1050,5500,05-15-2023\nSan Diego,ca,INTERNET-CAFE,900,4200,2023/06/20\nDallas,Tx,mobile-shop,980,,2023-07-01\nSan Jose,CA,Internet Cafe,870,4300,07/15/2023\nAustin,tx,MobileShop,1000,5000,2023-08-01\njacksonville,fl,Mobile Shop,1025,5150,2023/09/01\nFort Worth,TX,Internet_cafe,850,4100,2023-10-05\nColumbus,OH,mobile_shop,950,4600,2023-11-10\nCharlotte,NC,Internet-Cafe,900,4300,11-15-2023", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["Mobile_Shop", "MobileShop", "Mobile-shop", "mobile-shop", "mobile_shop"], "to": "Mobile Shop"}, {"from": ["Internet-Cafe", "Internet_cafe", "INTERNET-CAFE", "Internet Cafe", "internet-cafe"], "to": "Internet Cafe"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "if(value.match(/^[0-9]+$/), value.toNumber(), null)"}, {"op": "core/mass-edit", "columnName": "LoanAmount", "edits": [{"from": [null, ""], "to": "null"}]}, {"op": "core/date-parse", "columnName": "Date", "expression": "value", "format": "var fmts = ['MM-dd-yyyy','yyyy/MM/dd','dd/MM/yyyy','yyyy-MM-dd','MMMM d yyyy','yyyy.MM.dd','MM/dd/yyyy','yyyy/MM/dd','dd-MM-yyyy'];\nfor(var i=0;i<fmts.length;i++){var d=org.joda.time.format.DateTimeFormat.forPattern(fmts[i]).parseLocalDate(value);if(d){return d.toString('yyyy-MM-dd')}}return null;"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Mobile Shop,1000,5000,2023-01-12\nLos Angeles,CA,Internet Cafe,850,null,2023-02-15\nChicago,ILLINOIS,Mobile Shop,1200,7000,2023-03-15\nHouston,TX,Mobile Shop,950,4500,2023-04-01\nPhiladelphia,PA,Mobile Shop,1100,6000,2023-04-05\nPhoenix,AZ,Internet Cafe,800,4000,2023-05-10\nSan Antonio,TX,Mobile Shop,1050,5500,2023-05-15\nSan Diego,CA,Internet Cafe,900,4200,2023-06-20\nDallas,TX,Mobile Shop,980,null,2023-07-01\nSan Jose,CA,Internet Cafe,870,4300,2023-07-15\nAustin,TX,Mobile Shop,1000,5000,2023-08-01\nJacksonville,FL,Mobile Shop,1025,5150,2023-09-01\nFort Worth,TX,Internet Cafe,850,4100,2023-10-05\nColumbus,OH,Mobile Shop,950,4600,2023-11-10\nCharlotte,NC,Internet Cafe,900,4300,2023-11-15"}
{"purpose": "Standardize and clean crop yield data with inconsistent city names, formats, and missing values.", "raw_table": "FarmID,City,State,Crop_Type,Yield_kg,Harvest_Date,Irrigation\n101,Green_valley,CA,Wheat,1200,2023/09/15,yes\n102,green-valley,ca,Corn,1100,15-09-2023,Yes\n103,Sunshine,TX,Rice,900,,no\n104,sunshine,TX,Rice,,2023.09.16,No\n105,Riverbank,ny,Barley,850,2023/09/10,YES\n106,River_bank,NY,barley,870,2023-09-10,yes\n107,Oldtown,FL,Corn,1000,09/14/2023,no\n108,oldtown,fl,CORN,980,2023/09/14,No\n109,Hilltop,WA,Wheat,1100,2023/09/13,yes\n110,hill_top,wa,Wheat,1050,2023-09-13,Yes\n111,Mist_valley,OR,Rice,950,2023-09-12,YES\n112,Mist-valley,or,Rice,940,2023-09-12,yes\n113,Lakeside,CA,Corn,,2023/09/11,No\n114,lakeside,CA,Corn,1020,,no", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City names by replacing underscores and hyphens with spaces and title case", "columnName": "City", "expression": "value.replace(/[_-]/,' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Capitalize State codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Capitalize Crop_Type values", "columnName": "Crop_Type", "expression": "value.toLowercase().replace('barley', 'Barley').replace('corn', 'Corn').replace('wheat', 'Wheat').replace('rice', 'Rice')"}, {"op": "core/mass-edit", "description": "Standardize Irrigation values", "columnName": "Irrigation", "edits": [{"from": ["yes", "Yes", "YES", "yEs"], "to": "Yes"}, {"from": ["no", "No", "NO", "nO"], "to": "No"}]}, {"op": "core/date-parse", "description": "Parse Harvest_Date to yyyy-MM-dd format", "columnName": "Harvest_Date", "mode": "lenient", "dateFormat": "yyyy-MM-dd"}, {"op": "core/fill-down", "description": "Fill down missing Yield_kg values within Crop_Type groups if possible", "columnName": "Yield_kg"}, {"op": "core/text-transform", "description": "Trim whitespace from all string columns", "columnName": "Crop_Type", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace from Irrigation column", "columnName": "Irrigation", "expression": "value.trim()"}], "clean_table": "FarmID,City,State,Crop_Type,Yield_kg,Harvest_Date,Irrigation\n101,Green Valley,CA,Wheat,1200,2023-09-15,Yes\n102,Green Valley,CA,Corn,1100,2023-09-15,Yes\n103,Sunshine,TX,Rice,900,2023-09-16,No\n104,Sunshine,TX,Rice,900,2023-09-16,No\n105,Riverbank,NY,Barley,850,2023-09-10,Yes\n106,Riverbank,NY,Barley,870,2023-09-10,Yes\n107,Oldtown,FL,Corn,1000,2023-09-14,No\n108,Oldtown,FL,Corn,980,2023-09-14,No\n109,Hilltop,WA,Wheat,1100,2023-09-13,Yes\n110,Hilltop,WA,Wheat,1050,2023-09-13,Yes\n111,Mist Valley,OR,Rice,950,2023-09-12,Yes\n112,Mist Valley,OR,Rice,940,2023-09-12,Yes\n113,Lakeside,CA,Corn,1020,2023-09-11,No\n114,Lakeside,CA,Corn,1020,2023-09-11,No"}
{"purpose": "Clean and standardize city names, business types, and date formats; correct numeric fields and remove extra characters.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,Telecom-Provider,1000$,50000,01-15-2023\nlos angeles,CA,Internet_Service,,40000,2023/02/20\nChicago,il,telecom provider,1200,45_000,15.03.2023\nhouston,TX,ISP,NaN,35000,March 20 2023\nPhoenix,AZ,Telecom-Provider,1150,40000,2023-04-01\nphiladelphia,pa,telecom_provider,1100$,38000,04-10-2023\nSan-Antonio,TX,Internet service,1050,NaN,2023/04/15\nSan Diego,CA,ISP,1000,39000,2023.04.20\nDallas,tx,Telecom provider,NaN,42000,04/25/2023\nsan jose,CA,Internet_Service,1300$,41000,April 30 2023\nAustin,TX,telecom-provider,1250,43500,2023-05-05\nJacksonville,fl,ISP,950,36000,05.10.2023\nFort Worth,TX,Internet_service,1000,40000,2023/05/15\nColumbus,OH,telecom-provider,1050$,39500,15-05-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names with spaces and capitalize", "columnName": "City", "expression": "value.replace(/[_-]+/,' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Capitalize state abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["Telecom-Provider", "telecom provider", "telecom_provider", "telecom-provider"], "to": "Telecom Provider"}, {"from": ["Internet_Service", "Internet service", "Internet_service"], "to": "Internet Service"}, {"from": ["ISP"], "to": "Internet Service Provider"}]}, {"op": "core/text-transform", "description": "Remove $ and _ characters from Price and convert to number", "columnName": "Price", "expression": "value.replace(/[$_]/g, '').trim() == '' || value.toLowercase() == 'nan' ? null : Number(value.replace(/[$_]/g, ''))"}, {"op": "core/text-transform", "description": "Remove _ from LoanAmount and convert to number", "columnName": "LoanAmount", "expression": "value.trim() == '' || value.toLowercase() == 'nan' ? null : Number(value.replace(/_/g, ''))"}, {"op": "core/date-parse", "description": "Parse Date into ISO format yyyy-MM-dd", "columnName": "Date", "dateFormat": "auto", "newColumnName": "Date", "mode": "replace"}, {"op": "core/fill-down", "description": "Fill down missing Price values", "columnName": "Price"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom Provider,1000,50000,2023-01-15\nLos Angeles,CA,Internet Service,1000,40000,2023-02-20\nChicago,IL,Telecom Provider,1200,45000,2023-03-15\nHouston,TX,Internet Service,1000,35000,2023-03-20\nPhoenix,AZ,Telecom Provider,1150,40000,2023-04-01\nPhiladelphia,PA,Telecom Provider,1100,38000,2023-04-10\nSan Antonio,TX,Internet Service,1050,35000,2023-04-15\nSan Diego,CA,Internet Service,1000,39000,2023-04-20\nDallas,TX,Telecom Provider,1000,42000,2023-04-25\nSan Jose,CA,Internet Service,1300,41000,2023-04-30\nAustin,TX,Telecom Provider,1250,43500,2023-05-05\nJacksonville,FL,Internet Service Provider,950,36000,2023-05-10\nFort Worth,TX,Internet Service,1000,40000,2023-05-15\nColumbus,OH,Telecom Provider,1050,39500,2023-05-15"}
{"purpose": "Standardize city and state names, fix date formats, and normalize business types in government loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,nyc,restaurant-Chain,$15,000,25000,01-15-2023\nLOS_ANGELES,CA,retail_store,$20k,30000,2023/02/20\nchicago,il,Health-Care,$18000,,03-05-23\nhouston,TX,restaurant_chain,$-12000,15000,15-Feb-2023\nphoenix,AZ,retailStore,$22000,27000,2023.03.25\nphiladelphia,pa,Health care,$19,500,23000,2023-04-01\nsan antonio,tx,restuarant_chain,$15000,17000,04/10/2023\nsan-diego,CA,retail_store,$21000,25000,2023_04_15\nDALLAS,tx,health-care,,26000,2023-04-20\nsan jose,CA,RETAIL_store,$20500,24000,2023-04-25\nAUSTIN,TX,restaurant_chain,$16000,18000,\njacksonville,fl,health-care,$17500,22000,2023/05/05\nFORT WORTH,TX,restaurant chain,$15800,19000,05-10-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and replace underscores and hyphens with spaces in City", "columnName": "City", "expression": "value.trim().replace('_',' ').replace('-',' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize State abbreviations to uppercase two-letter codes", "columnName": "State", "expression": "value.toLowercase().replace('nyc','ny').toUppercase()"}, {"op": "core/mass-edit", "description": "Correct BusinessType misspellings and standardize", "columnName": "BusinessType", "edits": [{"from": ["restaurant-Chain", "restaurant_chain", "restuarant_chain", "restaurant chain"], "to": "Restaurant Chain"}, {"from": ["retail_store", "retailStore", "RETAIL_store"], "to": "Retail Store"}, {"from": ["Health-Care", "Health care", "health-care", "health-care"], "to": "Health Care"}]}, {"op": "core/text-transform", "description": "Remove dollar signs and commas, convert Price to numeric string", "columnName": "Price", "expression": "value.replace('$','').replace(',','').toLowercase().replace('k','000').trim()"}, {"op": "core/text-transform", "description": "Convert Price to number or empty if invalid", "columnName": "Price", "expression": "isNonBlank(value) && value.match(/^[-]?\\d+(\\.\\d+)?$/) ? value : ''"}, {"op": "core/text-transform", "description": "Convert LoanAmount to string without extra characters", "columnName": "LoanAmount", "expression": "isNonBlank(value) ? value.replace(/[^\\d]/g, '') : ''"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number or empty if invalid", "columnName": "LoanAmount", "expression": "isNonBlank(value) && value.match(/^\\d+$/) ? value : ''"}, {"op": "core/date-parse", "description": "Parse Date column into ISO format", "columnName": "Date", "params": {"mode": "cells", "dateFormat": "best-effort", "onError": "set-to-blank"}}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant Chain,15000,25000,2023-01-15T00:00:00Z\nLos Angeles,CA,Retail Store,20000,30000,2023-02-20T00:00:00Z\nChicago,IL,Health Care,18000,,2023-03-05T00:00:00Z\nHouston,TX,Restaurant Chain,-12000,15000,2023-02-15T00:00:00Z\nPhoenix,AZ,Retail Store,22000,27000,2023-03-25T00:00:00Z\nPhiladelphia,PA,Health Care,19500,23000,2023-04-01T00:00:00Z\nSan Antonio,TX,Restaurant Chain,15000,17000,2023-04-10T00:00:00Z\nSan Diego,CA,Retail Store,21000,25000,2023-04-15T00:00:00Z\nDallas,TX,Health Care,,26000,2023-04-20T00:00:00Z\nSan Jose,CA,Retail Store,20500,24000,2023-04-25T00:00:00Z\nAustin,TX,Restaurant Chain,16000,18000,\nJacksonville,FL,Health Care,17500,22000,2023-05-05T00:00:00Z\nFort Worth,TX,Restaurant Chain,15800,19000,2023-05-10T00:00:00Z"}
{"purpose": "Clean and standardize farm produce sales records by correcting city and product names, normalizing date formats, and fixing numeric fields.", "raw_table": "FarmID,City,State,Produce,Quantity,Price,SaleDate\n101,SiLicon-valley,CA,Tomatos,100,2.5,2023/03/12\n102,dallas,TX,Carrots,50,1.75,03-15-2023\n103,New_York,NY,Potato,200,,15 March 2023\n104,Chicago,IL,Tomato,150,2.8,2023-03-17\n105,Houston,TX,carrots,80,1.7,17/03/2023\n106,Los-Angeles,CA,Tomatoes,120,2.6,Mar 18 2023\n107,Philadelphia,PA,,90,2.0,2023.03.19\n108,New york,NY,Potatoes,210,2.1,03/20/2023\n109,dallas,TX,carrot,70,1.65,2023-03-21\n110,Chicago,IL,Tomatos,130,2.7,21-03-2023\n111,houston,TX,Tomato,85,2.5,22 Mar 2023\n112,San Francisco,CA,Potato,190,2.2,2023/03/23\n113,NEW YORK,NY,carrots,60,1.8,23.03.2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names capitalization and remove underscores and hyphens", "columnName": "City", "expression": "value.toLowercase().replace('_',' ').replace('-',' ').split(' ').map(s, s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Fix misspellings and singular/plural inconsistencies in Produce names", "columnName": "Produce", "edits": [{"from": ["Tomatos", "tomatos", "Tomato"], "to": "Tomato"}, {"from": ["Potato", "Potatoes"], "to": "Potato"}, {"from": ["Carrot", "carrot", "carrots"], "to": "Carrot"}]}, {"op": "core/column-rename", "description": "Rename FarmID to Farm_ID for consistency", "oldColumnName": "FarmID", "newColumnName": "Farm_ID"}, {"op": "core/text-transform", "description": "Normalize sale dates to ISO format yyyy-MM-dd", "columnName": "SaleDate", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/mass-edit", "description": "Fill missing Price values with average price of that Produce", "columnName": "Price", "edits": [{"from": [""], "to": "2.0"}]}, {"op": "core/text-transform", "description": "Convert Quantity to integer", "columnName": "Quantity", "expression": "value.toNumber().toInt()"}, {"op": "core/text-transform", "description": "Convert Price to number with two decimals", "columnName": "Price", "expression": "value.toNumber().round(2)"}], "clean_table": "Farm_ID,City,State,Produce,Quantity,Price,SaleDate\n101,Silicon Valley,CA,Tomato,100,2.50,2023-03-12\n102,Dallas,TX,Carrot,50,1.75,2023-03-15\n103,New York,NY,Potato,200,2.00,2023-03-15\n104,Chicago,IL,Tomato,150,2.80,2023-03-17\n105,Houston,TX,Carrot,80,1.70,2023-03-17\n106,Los Angeles,CA,Tomato,120,2.60,2023-03-18\n107,Philadelphia,PA,,90,2.00,2023-03-19\n108,New York,NY,Potato,210,2.10,2023-03-20\n109,Dallas,TX,Carrot,70,1.65,2023-03-21\n110,Chicago,IL,Tomato,130,2.70,2023-03-21\n111,Houston,TX,Tomato,85,2.50,2023-03-22\n112,San Francisco,CA,Potato,190,2.20,2023-03-23\n113,New York,NY,Carrot,60,1.80,2023-03-23"}
{"purpose": "Standardize city and state names, fix date formats, and normalize business types in government loan application data.", "raw_table": "City,State,BusinessType,LoanAmount,Price,ApplicationDate\nNew york,NY,bakery,50000,150000,01/15/2023\nlos angeles,CA,Restaurent,75000,250000,2023-02-20\nCHICAGO,il,Cafe,60000,,03-10-23\nhouston,Tx,retail-store,45000,120000,April 5, 2023\n-Phoenix,az,Cafe,50000,130000,2023/04/15\nphiladelphia,pa,resturant,70000,200000,15-05-2023\nSAN_ANTONIO,TX,RETAIL,30000,90000,2023-06-01\nSan Diego,ca,Cafe,55000,140000,06/15/2023\nDallas,TX,bakery,48000,110000,2023.07.01\nsan jose,Ca,Retail-Store,47000,115000,07-20-2023\nAustin,tx,,52000,125000,2023/08/05\nJacksonville,FL,restaurant,68000,195000,08/15/2023\nfort-worth,Tx,Cafe,53000,130000,2023-09-01\nColumbus,OH,Bakery,49000,115000,09/15/2023\nCharlotte,NC,RESTAURANT,72000,210000,2023-10-01", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["-Phoenix", "SAN_ANTONIO", "fort-worth"], "to": "Phoenix"}, {"from": ["SAN_ANTONIO", "fort-worth"], "to": "San Antonio"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["Restaurent", "resturant", "RESTAURANT", "restaurant"], "to": "Restaurant"}, {"from": ["retail-store", "Retail-Store", "RETAIL"], "to": "Retail"}, {"from": ["Cafe", "cafe"], "to": "Cafe"}, {"from": ["bakery", "Bakery"], "to": "Bakery"}]}, {"op": "core/fill-down", "columnName": "BusinessType"}, {"op": "core/text-transform", "columnName": "Price", "expression": "value == null || value == '' ? null : Number(value)"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value == null || value == '' ? null : Number(value)"}, {"op": "core/date-parse", "columnName": "ApplicationDate", "options": {"mode": "lenient"}}], "clean_table": "City,State,BusinessType,LoanAmount,Price,ApplicationDate\nNew York,NY,Bakery,50000,150000,2023-01-15T00:00:00Z\nLos Angeles,CA,Restaurant,75000,250000,2023-02-20T00:00:00Z\nChicago,IL,Cafe,60000,,2023-03-10T00:00:00Z\nHouston,TX,Retail,45000,120000,2023-04-05T00:00:00Z\nPhoenix,AZ,Cafe,50000,130000,2023-04-15T00:00:00Z\nPhiladelphia,PA,Restaurant,70000,200000,2023-05-15T00:00:00Z\nSan Antonio,TX,Retail,30000,90000,2023-06-01T00:00:00Z\nSan Diego,CA,Cafe,55000,140000,2023-06-15T00:00:00Z\nDallas,TX,Bakery,48000,110000,2023-07-01T00:00:00Z\nSan Jose,CA,Retail,47000,115000,2023-07-20T00:00:00Z\nAustin,TX,Retail,52000,125000,2023-08-05T00:00:00Z\nJacksonville,FL,Restaurant,68000,195000,2023-08-15T00:00:00Z\nFort Worth,TX,Cafe,53000,130000,2023-09-01T00:00:00Z\nColumbus,OH,Bakery,49000,115000,2023-09-15T00:00:00Z\nCharlotte,NC,Restaurant,72000,210000,2023-10-01T00:00:00Z"}
{"purpose": "Standardize city and state names, fix inconsistent business types, and normalize date and numeric formats in telecommunications loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,ny,telecom_corp,1,200.50,100000,2022/01/15\nLOS ANGELES,Ca,Cell-Provider,950.00,85000,15-02-2022\nChicago,IL,telecom corp,1100.75,90000,2022.03.01\nhouston,tx,CellProvider,950,missing,2022/04/05\nPHOENIX,az,Telecom_CORP,1050.00,88000,April 10 2022\nphiladelphia,PA,cell provider,980.5,87000,2022-05-11\nSan Antonio,TX,telecom-corp,1025.00,91000,2022/06/07\nsan diego,CA,Cell-Provider,990,86000,2022/07/20\nDALLAS,Tx,telecom corp,1000,89000,2022-08-15\nsan jose,ca,cell_provider,970.25,88000,08/20/2022\nAustin,TX,TelecomCorp,1010,87000,2022-09-01\nJacksonville,fl,cellprovider,985.50,empty,2022.10.05\nFORT WORTH,TX,telecom_corp,995,90000,2022-11-10\nColumbus,OH,cell-provider,980,87000,2022/12/01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names properly", "engineConfig": {"mode": "row-based"}, "columnName": "City", "expression": "value.toLowercase().split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase state codes", "engineConfig": {"mode": "row-based"}, "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType names", "columnName": "BusinessType", "edits": [{"from": ["telecom_corp", "telecom corp", "telecom-corp", "Telecom_CORP", "TelecomCorp"], "to": "Telecom Corp"}, {"from": ["Cell-Provider", "CellProvider", "cell provider", "cell_provider", "cellprovider", "cell-provider"], "to": "Cell Provider"}]}, {"op": "core/text-transform", "description": "Fix Price column to be numeric string with two decimals", "engineConfig": {"mode": "row-based"}, "columnName": "Price", "expression": "value.replace(/[^0-9.]/g, '').toNumber().toFixed(2)"}, {"op": "core/mass-edit", "description": "Fix missing LoanAmount values", "columnName": "LoanAmount", "edits": [{"from": ["missing", "empty"], "to": ""}]}, {"op": "core/text-transform", "description": "Convert LoanAmount to numeric string (empty remains empty)", "engineConfig": {"mode": "row-based"}, "columnName": "LoanAmount", "expression": "value==null || value.trim()=='' ? '' : value.replace(/[^0-9]/g, '').toNumber().toString()"}, {"op": "core/text-transform", "description": "Normalize Date format to yyyy-MM-dd", "engineConfig": {"mode": "row-based"}, "columnName": "Date", "expression": "value.match(/\\d{4}[-\\/.]\\d{2}[-\\/.]\\d{2}/) ? value.replace(/[.\\/]/g,'-') : (value.toDate('MMM d yyyy') || value.toDate('dd-MM-yyyy') || value.toDate('MM/dd/yyyy')).toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom Corp,1200.50,100000,2022-01-15\nLos Angeles,CA,Cell Provider,950.00,85000,2022-02-15\nChicago,IL,Telecom Corp,1100.75,90000,2022-03-01\nHouston,TX,Cell Provider,950.00,,2022-04-05\nPhoenix,AZ,Telecom Corp,1050.00,88000,2022-04-10\nPhiladelphia,PA,Cell Provider,980.50,87000,2022-05-11\nSan Antonio,TX,Telecom Corp,1025.00,91000,2022-06-07\nSan Diego,CA,Cell Provider,990.00,86000,2022-07-20\nDallas,TX,Telecom Corp,1000.00,89000,2022-08-15\nSan Jose,CA,Cell Provider,970.25,88000,2022-08-20\nAustin,TX,Telecom Corp,1010.00,87000,2022-09-01\nJacksonville,FL,Cell Provider,985.50,,2022-10-05\nFort Worth,TX,Telecom Corp,995.00,90000,2022-11-10\nColumbus,OH,Cell Provider,980.00,87000,2022-12-01"}
{"purpose": "Standardize city and state names, fix business type inconsistencies, and normalize financial and date formats.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,Retailer,1200,50000,01/15/2023\nlos angeles,CA,retail-er,1300.50,60000,2023-02-20\nChicago,il,Wholesaler,1100,55000,15-03-2023\nhouston,TX,retail_er,1150.75,52000,2023/04/10\nphoenix,az,,1250,58000,2023-05-05\nphiladelphia,PA,Wholesaler,NaN,47000,06-06-2023\nsan-antonio,tx,RETAILER,1195.25,NaN,2023-07-07\nSan Diego,Ca,wholesaler,1230,53000,2023-08-15\nDALLAS,TX,retailer,1210,54000,2023.09.10\nsan jose,ca,Retailer,NaN,56000,20231010\nAustin,tx,wholesaler,1185,51000,10/11/2023\njacksonville,fl,Retailer,1225,50500,2023-12-01\nfort worth,TX,Wholesaler,1170,51500,12/15/2023\nColumbus,Oh,Retailer,1240,52500,2023-11-20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City with spaces and capitalize", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Capitalize State names uniformly", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Correct BusinessType inconsistent variants", "columnName": "BusinessType", "edits": [{"from": ["retail-er", "retail_er", "RETAILER", "retailer"], "to": "Retailer"}, {"from": ["Wholesaler", "wholesaler", "WHOLESALER"], "to": "Wholesaler"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Convert Price to number, replace NaN with 0", "columnName": "Price", "expression": "isNaN(value.toNumber()) ? 0 : value.toNumber()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number, replace NaN with 0", "columnName": "LoanAmount", "expression": "isNaN(value.toNumber()) ? 0 : value.toNumber()"}, {"op": "core/text-transform", "description": "Normalize Date formats to yyyy-MM-dd", "columnName": "Date", "expression": "value.match(/\\d{4}[-\\/.]\\d{2}[-\\/.]\\d{2}/) ? toDate(value).toString('yyyy-MM-dd') : value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/) ? toDate(value, 'MM/dd/yyyy').toString('yyyy-MM-dd') : value.match(/\\d{2}-\\d{2}-\\d{4}/) ? toDate(value, 'dd-MM-yyyy').toString('yyyy-MM-dd') : value.match(/\\d{8}/) ? toDate(value, 'yyyyMMdd').toString('yyyy-MM-dd') : 'Invalid Date'"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retailer,1200,50000,2023-01-15\nLos Angeles,CA,Retailer,1300.5,60000,2023-02-20\nChicago,IL,Wholesaler,1100,55000,2023-03-15\nHouston,TX,Retailer,1150.75,52000,2023-04-10\nPhoenix,AZ,Unknown,1250,58000,2023-05-05\nPhiladelphia,PA,Wholesaler,0,47000,2023-06-06\nSan Antonio,TX,Retailer,1195.25,0,2023-07-07\nSan Diego,CA,Wholesaler,1230,53000,2023-08-15\nDallas,TX,Retailer,1210,54000,2023-09-10\nSan Jose,CA,Retailer,0,56000,2023-10-10\nAustin,TX,Wholesaler,1185,51000,2023-10-11\nJacksonville,FL,Retailer,1225,50500,2023-12-01\nFort Worth,TX,Wholesaler,1170,51500,2023-12-15\nColumbus,OH,Retailer,1240,52500,2023-11-20"}
{"purpose": "Standardize city and business type names, fix date formats, and normalize numeric values in energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew_york,NY,solar-PANEL,1200,15000,2022/01/15\nLOS ANGELES,CA,Wind_turbine,1000,12000,15-02-2022\nChicago,il,Solar panel,1100,missing,03/05/2022\nhouston,TX,Geothermal,900,,2022.04.01\nPhoenix,AZ,solar_panel,missing,14000,2022-05-10\nphiladelphia,pa,Wind Turbine,1050,13000,\nSan Antonio,tx,wind_turbine,1000,12500,2022/07/12\nsan_diego,CA,geothermal,950,11500,07-15-2022\nDallas,TX,Solar Panel,1150,missing,2022/08/01\nsan jose,CA,solar-Panel,1125,13500,2022/08/20\nAustin,TX,Geothermal,missing,11000,2022/09/05\nJacksonville,fl,wind_turbine,980,12000,2022/09/15\nFort Worth,TX,solar_panel,1080,12800,2022/10/01\nColumbus,oh,Geothermal,970,11900,2022-10-15", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens, unify casing in City", "columnName": "City", "expression": "value.toLowercase().replace('_',' ').replace('-',' ').split(' ').map(s, s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Standardize BusinessType capitalization and spacing", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[_-]/g,' ').split(' ').map(s, s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Fix missing Price values to '1000'", "columnName": "Price", "edits": [{"from": ["", "missing"], "to": "1000"}]}, {"op": "core/mass-edit", "description": "Fix missing LoanAmount values to '12000'", "columnName": "LoanAmount", "edits": [{"from": ["", "missing"], "to": "12000"}]}, {"op": "core/text-transform", "description": "Normalize Date format to ISO yyyy-MM-dd", "columnName": "Date", "expression": "value.length()==0 ? null : date(value).toString('yyyy-MM-dd')"}, {"op": "core/fill-down", "description": "Fill down missing Dates", "columnName": "Date"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Panel,1200,15000,2022-01-15\nLos Angeles,CA,Wind Turbine,1000,12000,2022-02-15\nChicago,IL,Solar Panel,1100,12000,2022-03-05\nHouston,TX,Geothermal,900,12000,2022-04-01\nPhoenix,AZ,Solar Panel,1000,14000,2022-05-10\nPhiladelphia,PA,Wind Turbine,1050,13000,2022-05-10\nSan Antonio,TX,Wind Turbine,1000,12500,2022-07-12\nSan Diego,CA,Geothermal,950,11500,2022-07-15\nDallas,TX,Solar Panel,1150,12000,2022-08-01\nSan Jose,CA,Solar Panel,1125,13500,2022-08-20\nAustin,TX,Geothermal,1000,11000,2022-09-05\nJacksonville,FL,Wind Turbine,980,12000,2022-09-15\nFort Worth,TX,Solar Panel,1080,12800,2022-10-01\nColumbus,OH,Geothermal,970,11900,2022-10-15"}
{"purpose": "Standardize city and state names, normalize business types, and correct price and date formats for government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,NY,restaurent,150000,1000000,01-15-2023\nLos-angeles,ca,RETAIL,200000,1500000,2023/02/20\nchicago,IL,Tech Firm,250000,,03-05-2023\nhouston,Tx,healthcare,175000,1200000,2023-04-01\nPHOENIX,az,REStaurent,130000,900000,4/15/2023\nphiladelphia,PA,retail,NaN,800000,May 1 2023\nsan-antonio,TX,tech-firm,275000,1400000,2023.06.01\nSan Diego,CA,,220000,1300000,06-20-2023\nDallas,tx,Healthcare,190000,1100000,2023/07/15\nsan jose,CA,retail,210000,1250000,July 30, 2023\nAustin,TX,tech firm,260000,1350000,08-10-2023\nJacksonville,fl,Restaurent,140000,950000,08/25/2023\nFort Worth,TX,health care,180000,1150000,2023-09-10", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize City names properly", "columnName": "City", "expression": "value.toLowercase().split(/[-_ ]+/).map(s, s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize State abbreviations to uppercase two-letter codes", "columnName": "State", "edits": [{"from": ["ny", "Ny", "nY", "NY"], "to": "NY"}, {"from": ["ca", "Ca", "cA", "CA"], "to": "CA"}, {"from": ["tx", "Tx", "tX", "TX"], "to": "TX"}, {"from": ["il"], "to": "IL"}, {"from": ["az"], "to": "AZ"}, {"from": ["pa"], "to": "PA"}, {"from": ["fl"], "to": "FL"}]}, {"op": "core/mass-edit", "description": "Correct common misspellings and inconsistencies in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["restaurent", "Restaurent", "REStaurent"], "to": "Restaurant"}, {"from": ["retail", "RETAIL"], "to": "Retail"}, {"from": ["tech firm", "tech-firm", "Tech Firm"], "to": "Tech Firm"}, {"from": ["healthcare", "health care", "Healthcare"], "to": "Healthcare"}]}, {"op": "core/text-transform", "description": "Fill missing BusinessType with 'Unknown'", "columnName": "BusinessType", "expression": "value.trim() == '' ? 'Unknown' : value"}, {"op": "core/text-transform", "description": "Normalize Price column to numeric and replace NaN or missing with 0", "columnName": "Price", "expression": "isNaN(value.toNumber()) ? '0' : value.toNumber().toString()"}, {"op": "core/text-transform", "description": "Normalize LoanAmount column to numeric and replace missing with 0", "columnName": "LoanAmount", "expression": "value.trim() == '' || isNaN(value.toNumber()) ? '0' : value.toNumber().toString()"}, {"op": "core/text-transform", "description": "Parse and normalize Date column to ISO format yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,150000,1000000,2023-01-15\nLos Angeles,CA,Retail,200000,1500000,2023-02-20\nChicago,IL,Tech Firm,250000,0,2023-03-05\nHouston,TX,Healthcare,175000,1200000,2023-04-01\nPhoenix,AZ,Restaurant,130000,900000,2023-04-15\nPhiladelphia,PA,Retail,0,800000,2023-05-01\nSan Antonio,TX,Tech Firm,275000,1400000,2023-06-01\nSan Diego,CA,Unknown,220000,1300000,2023-06-20\nDallas,TX,Healthcare,190000,1100000,2023-07-15\nSan Jose,CA,Retail,210000,1250000,2023-07-30\nAustin,TX,Tech Firm,260000,1350000,2023-08-10\nJacksonville,FL,Restaurant,140000,950000,2023-08-25\nFort Worth,TX,Healthcare,180000,1150000,2023-09-10"}
{"purpose": "Standardize city and state names, normalize business types, and correct date and numeric formats for government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew_York,ny,Retail,50000,100000,01-15-2023\nlos-angeles,CA,Restaurnt,45000,90000,2023/02/20\nChicago,IL,retail,55000.00,110000,03-05-23\nHouston,tx,Consulting,NaN,85000,04/01/2023\nPHOENIX,Az,consultng,48000,NaN,2023-05-15\nphiladelphia,PA,retail,47000,95000,15-06-2023\nsan-antonio,TX,Consulting,52000,105000,06.20.2023\nSAN DIEGO,ca,Retail,49000,102000,2023-07-10\nDallas,TX,Retaill,53000,100000,2023/08/05\nSan jose,CA,restaurant,51000,98000,08-25-2023\nAustin,tx,Retail,NaN,97000,2023-09-10\nJacksonville,FL,Retail,46000,93000,\nFort_Worth,TX,Consulting,50000,91000,10-12-2023", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_York"], "to": "New York"}, {"from": ["los-angeles"], "to": "Los Angeles"}, {"from": ["san-antonio"], "to": "San Antonio"}, {"from": ["Fort_Worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["Restaurnt", "restaurant"], "to": "Restaurant"}, {"from": ["retail", "Retaill"], "to": "Retail"}, {"from": ["Consulting", "consultng"], "to": "Consulting"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "if(value == 'NaN' || value == '' || value == null) null else value.toNumber()"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "if(value == 'NaN' || value == '' || value == null) null else value.toNumber()"}, {"op": "core/date-parse", "columnName": "ApplicationDate", "format": "yyyy-MM-dd", "onError": "keep-original", "onBlank": "keep-original"}, {"op": "core/text-transform", "columnName": "ApplicationDate", "expression": "if(isNull(value) || value.trim() == '', null, \n  if(value.contains('-') && value.match(/\\d{2}-\\d{2}-\\d{4}/),\n    cells['ApplicationDate'].value.parse('MM-dd-yyyy').toString('yyyy-MM-dd'),\n  if(value.contains('/') && value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/),\n    cells['ApplicationDate'].value.parse('yyyy/MM/dd').toString('yyyy-MM-dd'),\n  if(value.contains('.') && value.match(/\\d{2}\\.\\d{2}\\.\\d{4}/),\n    cells['ApplicationDate'].value.parse('MM.dd.yyyy').toString('yyyy-MM-dd'),\n  if(value.contains('-') && value.match(/\\d{2}-\\d{2}-\\d{2}/),\n    cells['ApplicationDate'].value.parse('MM-dd-yy').toString('yyyy-MM-dd'),\n  value))))))"}, {"op": "core/fill-down", "columnName": "ApplicationDate"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew York,NY,Retail,50000,100000,2023-01-15\nLos Angeles,CA,Restaurant,45000,90000,2023-02-20\nChicago,IL,Retail,55000,110000,2023-03-05\nHouston,TX,Consulting,,85000,2023-04-01\nPhoenix,AZ,Consulting,48000,,2023-05-15\nPhiladelphia,PA,Retail,47000,95000,2023-06-15\nSan Antonio,TX,Consulting,52000,105000,2023-06-20\nSan Diego,CA,Retail,49000,102000,2023-07-10\nDallas,TX,Retail,53000,100000,2023-08-05\nSan Jose,CA,Restaurant,51000,98000,2023-08-25\nAustin,TX,Retail,,97000,2023-09-10\nJacksonville,FL,Retail,46000,93000,2023-09-10\nFort Worth,TX,Consulting,50000,91000,2023-10-12"}
{"purpose": "Clean and standardize farm equipment rental records with inconsistent formatting and errors.", "raw_table": "FarmID,Farm_City,State,Equipment-Type,Rental_Price,Loan_Amount,Rental_Date\n101,SpringField,il,TracTOR ,  1200.50 ,5000,2023/02/15\n102,green-valley,CA,Combine-harvester,1300, ,15-03-2023\n103,,tx,PlOW,1100.75,4500,2023-04-01\n104,Lakewood,Wa,tractor, ,4000,03/25/2023\n105,Maple-Town,NY,Combine Harvester,1350.00,5200,2023/04/10\n106,GreenValley,CA,Plow,1150,4800,2023.04.15\n107,Springfield,IL,TRACTOR,1250.25,5100,2023-02-20\n108,Lakewood,WA,Combine-harvester, ,5300,25/03/2023\n109,Maple town,ny,plow,1120.50,4700,2023-04-12\n110,Green-Valley,ca,tractor ,1180,5000,2023/04/16", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "Farm_City", "edits": [{"from": ["green-valley", "GreenValley", "Green-Valley"], "to": "Green Valley"}, {"from": ["Maple-Town", "Maple town"], "to": "Maple Town"}]}, {"op": "core/text-transform", "columnName": "Farm_City", "expression": "value.trim().toTitlecase()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "Equipment-Type", "edits": [{"from": ["tractor ", "TRACTOR", "TracTOR "], "to": "Tractor"}, {"from": ["Combine-harvester", "Combine Harvester", "Combine-harvester"], "to": "Combine Harvester"}, {"from": ["PlOW", "Plow"], "to": "Plow"}]}, {"op": "core/text-transform", "columnName": "Rental_Price", "expression": "value.trim() == '' ? null : Number(value.trim())"}, {"op": "core/text-transform", "columnName": "Loan_Amount", "expression": "value.trim() == '' ? null : Number(value.trim())"}, {"op": "core/date-parse", "columnName": "Rental_Date", "expression": "value", "mode": "custom", "format": "yyyy-MM-dd"}, {"op": "core/text-transform", "columnName": "Rental_Date", "expression": "if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/)) value.replace('/','-').replace('/','-') else value"}, {"op": "core/date-parse", "columnName": "Rental_Date", "expression": "value", "mode": "custom", "format": "yyyy-MM-dd"}, {"op": "core/fill-down", "columnName": "Farm_City"}], "clean_table": "FarmID,Farm_City,State,Equipment-Type,Rental_Price,Loan_Amount,Rental_Date\n101,Springfield,IL,Tractor,1200.5,5000,2023-02-15\n102,Green Valley,CA,Combine Harvester,1300,null,2023-03-15\n103,Green Valley,TX,Plow,1100.75,4500,2023-04-01\n104,Lakewood,WA,Tractor,null,4000,2023-03-25\n105,Maple Town,NY,Combine Harvester,1350,5200,2023-04-10\n106,Green Valley,CA,Plow,1150,4800,2023-04-15\n107,Springfield,IL,Tractor,1250.25,5100,2023-02-20\n108,Lakewood,WA,Combine Harvester,null,5300,2023-03-25\n109,Maple Town,NY,Plow,1120.5,4700,2023-04-12\n110,Green Valley,CA,Tractor,1180,5000,2023-04-16"}
{"purpose": "Standardize city and state names, fix date formats, correct business types, and normalize numeric fields for loan and price in telecommunications dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_York,NY,telecom_corp,1000,50000,2023/01/15\nlos angeles,CA,Telecom-Corp,NaN,60000,15-02-2023\nChicago,Il,telecom corp,950,55000,2023.03.10\nhouston,TX,TELECOM_Corp,1100,not available,2023-04-05\nPHOENIX,az,telecom Corp,-1200,45000,04/15/2023\nphiladelphia,PA,Telecom_Corp,1050,48000,2023/05/20\nsan-antonio,TX,telecom_corp,1000,47000,2023-06-01\nSan Diego,Ca,Telecom_Corp,NaN,50000,2023/07/10\nDallas,TX,telecom_corp,980,52000,July 15, 2023\nsan jose,CA,Telecom_corp,1020,53000,2023-08-25\nAustin,Tx,telecom_corp,1005,NaN,2023/09/05\nJacksonville,fl,telecom_corp,950,49000,2023-10-12\nfort worth,Tx,Telecom_corp,990,51000,2023/11/03\nColumbus,OH,telecom_corp,NaN,48000,2023-12-10", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names with spaces and proper capitalization", "columnName": "City", "expression": "value.replace(/[_-]/g,' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["telecom_corp", "Telecom-Corp", "telecom corp", "TELECOM_Corp", "telecom Corp", "Telecom_Corp", "Telecom_corp", "Telecom_corp", "Telecom_corp"], "to": "Telecom_Corp"}]}, {"op": "core/text-transform", "description": "Clean Price column: replace 'NaN' and negative prices with null; convert to number", "columnName": "Price", "expression": "if(value.toLowercase() == 'nan' || toNumber(value) < 0, null, toNumber(value))"}, {"op": "core/text-transform", "description": "Clean LoanAmount column: replace 'not available' and 'NaN' with null; convert to number", "columnName": "LoanAmount", "expression": "if(value.toLowercase() in ['not available','nan'], null, toNumber(value))"}, {"op": "core/date-parse", "description": "Parse Date column to ISO format", "columnName": "Date", "mode": "normal", "valueType": "date", "dateFormat": "auto"}, {"op": "core/fill-down", "description": "Fill down missing Price values", "columnName": "Price"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom_Corp,1000,50000,2023-01-15T00:00:00Z\nLos Angeles,CA,Telecom_Corp,1000,60000,2023-02-15T00:00:00Z\nChicago,IL,Telecom_Corp,950,55000,2023-03-10T00:00:00Z\nHouston,TX,Telecom_Corp,1100,55000,2023-04-05T00:00:00Z\nPhoenix,AZ,Telecom_Corp,null,45000,2023-04-15T00:00:00Z\nPhiladelphia,PA,Telecom_Corp,1050,48000,2023-05-20T00:00:00Z\nSan Antonio,TX,Telecom_Corp,1000,47000,2023-06-01T00:00:00Z\nSan Diego,CA,Telecom_Corp,1000,50000,2023-07-10T00:00:00Z\nDallas,TX,Telecom_Corp,980,52000,2023-07-15T00:00:00Z\nSan Jose,CA,Telecom_Corp,1020,53000,2023-08-25T00:00:00Z\nAustin,TX,Telecom_Corp,1005,53000,2023-09-05T00:00:00Z\nJacksonville,FL,Telecom_Corp,950,49000,2023-10-12T00:00:00Z\nFort Worth,TX,Telecom_Corp,990,51000,2023-11-03T00:00:00Z\nColumbus,OH,Telecom_Corp,990,48000,2023-12-10T00:00:00Z"}
{"purpose": "Standardize crop names and clean loan data for agricultural finance analysis.", "raw_table": "FarmID,Crop,State,LoanAmount,LoanDate,PricePerTon\n101,wheat,-texas,15000,2023/05/12,250\n102,Corn ,Kansas,20000,12-05-2023, 300\n103,RICE,nebraska,18000,2023.05.12, 280\n104,soy-bean,Iowa, 17000,May 12 2023,270\n105,wHeat,,16000,2023-05-12, 260\n106,,Illinois,15500,05/12/2023, 265\n107,corn,KANSAS,19000,2023/05/12, 295\n108,Rice,nebraska, ,2023-05-12,275\n109,soybean,Iowa,16500,20230512,268\n110,WHEAT,Texas,,2023/05/12,252", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "Crop", "edits": [{"from": ["wheat", "wHeat", "WHEAT"], "to": "Wheat"}, {"from": ["corn", "Corn "], "to": "Corn"}, {"from": ["RICE", "Rice"], "to": "Rice"}, {"from": ["soy-bean", "soybean"], "to": "Soybean"}]}, {"op": "core/text-transform", "columnName": "State", "expression": "value.trim().toTitlecase()", "description": "Trim whitespace and capitalize state names"}, {"op": "core/mass-edit", "columnName": "State", "edits": [{"from": [""], "to": "Unknown"}, {"from": ["-Texas"], "to": "Texas"}]}, {"op": "core/text-transform", "columnName": "LoanDate", "expression": "value.replace(/[-.]/, '/').replace(/^(\\d{4})\\/(\\d{2})\\/(\\d{2})$/, '$2/$3/$1').replace(/(May) (\\d{1,2}) (\\d{4})/, '05/$2/$3').replace(/^20230512$/, '05/12/2023')", "description": "Normalize dates to MM/DD/YYYY format"}, {"op": "core/date-parse", "columnName": "LoanDate", "pattern": "MM/dd/yyyy", "description": "Parse normalized LoanDate into date type"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value.trim() == '' ? null : Number(value.trim())", "description": "Convert LoanAmount to number and handle missing"}, {"op": "core/text-transform", "columnName": "PricePerTon", "expression": "Number(value.trim())", "description": "Convert PricePerTon to number"}], "clean_table": "FarmID,Crop,State,LoanAmount,LoanDate,PricePerTon\n101,Wheat,Texas,15000,05/12/2023,250\n102,Corn,Kansas,20000,05/12/2023,300\n103,Rice,Nebraska,18000,05/12/2023,280\n104,Soybean,Iowa,17000,05/12/2023,270\n105,Wheat,Unknown,16000,05/12/2023,260\n106,,Illinois,15500,05/12/2023,265\n107,Corn,Kansas,19000,05/12/2023,295\n108,Rice,Nebraska,,05/12/2023,275\n109,Soybean,Iowa,16500,05/12/2023,268\n110,Wheat,Texas,,05/12/2023,252"}
{"purpose": "Clean and normalize movie screening data including theater names, show dates, ticket prices, and city names.", "raw_table": "Theater,City,ShowDate,TicketPrice,SeatsSold\nRegal-CINEMAS,New york,03/12/2023,15.00,120\nAMC_theatre,los angeles,2023-03-15,$12,95\ncinepolis,,15-03-2023,10.5,88\nlandmark Theatre,Chicago,03/17/23,13,102\ncineworld,New-York,March 18 2023,14.00,110\nAMC theatre,Los Angeles,03/19/2023,12$,99\nRegal cinemas,CHICAGO,,15,100\ncinepolis,New York,2023/03/20,ten dollars,105\nlandmark theatre,los-angeles,3/21/2023,13.00,98\nCINEWORLD,Chicago,2023-03-22,14,101\nregal-cinemas,new york,03/23/2023,15,115\nAMC_theatre,Los_Angeles,03-24-23,12,100\ncinepolis,Chicago,03/25/2023,10,95\nlandmark-theatre,New york,2023-03-26,13,110\ncineworld,Los Angeles,03/27/23,14,108", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize Theater names capitalization and remove underscores and hyphens", "columnName": "Theater", "expression": "value.toLowercase().replace(/[-_]/g, ' ').split(' ').map(w, w[0].toUppercase() + w.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Normalize City names capitalization and replace underscores/hyphens with spaces", "columnName": "City", "expression": "value ? value.toLowercase().replace(/[-_]/g, ' ').split(' ').map(w, w[0].toUppercase() + w.slice(1)).join(' ') : ''"}, {"op": "core/fill-down", "description": "Fill down missing City values", "columnName": "City"}, {"op": "core/text-transform", "description": "Parse ShowDate into yyyy-MM-dd format", "columnName": "ShowDate", "expression": "value ? date.parse(value).toString('yyyy-MM-dd') : ''"}, {"op": "core/text-transform", "description": "Clean TicketPrice by removing dollar signs and converting words to numbers", "columnName": "TicketPrice", "expression": "value.toLowercase().replace(/\\$/g, '').replace('ten dollars', '10').trim()"}, {"op": "core/text-transform", "description": "Convert TicketPrice to number format with two decimals", "columnName": "TicketPrice", "expression": "value ? Number(value).toFixed(2) : ''"}, {"op": "core/mass-edit", "description": "Fix known City misspellings", "columnName": "City", "edits": [{"from": ["New york", "New-York", "New york"], "to": "New York"}, {"from": ["Los angeles", "Los Angeles", "los angeles", "los-angeles", "Los_Angeles"], "to": "Los Angeles"}, {"from": ["CHICAGO", "Chicago", "chicago"], "to": "Chicago"}]}, {"op": "core/mass-edit", "description": "Standardize Theater names from variations", "columnName": "Theater", "edits": [{"from": ["Regal Cinemas", "Regal Cinemas", "Regal Cinemas"], "to": "Regal Cinemas"}, {"from": ["Amc Theatre", "Amc Theatre", "Amc Theatre"], "to": "AMC Theatre"}, {"from": ["Cinepolis"], "to": "Cinepolis"}, {"from": ["Landmark Theatre", "Landmark Theatre", "Landmark Theatre"], "to": "Landmark Theatre"}, {"from": ["Cineworld"], "to": "Cineworld"}]}], "clean_table": "Theater,City,ShowDate,TicketPrice,SeatsSold\nRegal Cinemas,New York,2023-03-12,15.00,120\nAMC Theatre,Los Angeles,2023-03-15,12.00,95\nCinepolis,New York,2023-03-15,10.50,88\nLandmark Theatre,Chicago,2023-03-17,13.00,102\nCineworld,New York,2023-03-18,14.00,110\nAMC Theatre,Los Angeles,2023-03-19,12.00,99\nRegal Cinemas,Chicago,,15.00,100\nCinepolis,New York,2023-03-20,10.00,105\nLandmark Theatre,Los Angeles,2023-03-21,13.00,98\nCineworld,Chicago,2023-03-22,14.00,101\nRegal Cinemas,New York,2023-03-23,15.00,115\nAMC Theatre,Los Angeles,2023-03-24,12.00,100\nCinepolis,Chicago,2023-03-25,10.00,95\nLandmark Theatre,New York,2023-03-26,13.00,110\nCineworld,Los Angeles,2023-03-27,14.00,108"}
{"purpose": "Standardize city and state names, normalize business types, and correct date and numeric formats in government loan application data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nnew york,NY,Restaur@nt,250000,100000,2023/01/15\nLos-Angeles,ca,retail,150000,75000,15-02-2023\nChicago,IL,Manufacturing,300000,120000,2023.03.01\nhouston,Tx,ret@il,200000,90000,03/20/2023\nPHILADELPHIA,pa,Restuarant,180000,85000,2023-04-05\nPhoenix,AZ,Retail,220000,,2023/04/15\nSan_Antonio,tx,manufactuRing,275000,110000,2023-05-01\nSan Diego,CA,Retaill,210000,95000,05/10/2023\nDallas,TX,Manufacturing,310000,130000,2023/06/15\nsan jose,ca,restaurant,190000,80000,2023-07-01\nAustin,TX,RETAIL,230000,100000,07-15-2023\nJacksonville,FL,restaurant,205000,90000,2023.08.01\nFort Worth,TX,manufacturing,290000,115000,08/20/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and unify capitalization for City", "columnName": "City", "expression": "value.trim().toTitlecase()"}, {"op": "core/text-transform", "description": "Uppercase all State codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix common BusinessType misspellings", "columnName": "BusinessType", "edits": [{"from": ["Restaur@nt", "Restuarant", "restaurant"], "to": "Restaurant"}, {"from": ["ret@il", "retail", "RETAIL", "Retaill"], "to": "Retail"}, {"from": ["Manufacturing", "manufactuRing", "manufacturing"], "to": "Manufacturing"}]}, {"op": "core/text-transform", "description": "Remove underscores and hyphens from City", "columnName": "City", "expression": "value.replace(/[_-]/, ' ')"}, {"op": "core/date-parse", "description": "Parse ApplicationDate into yyyy-MM-dd", "columnName": "ApplicationDate", "expression": "value.toDate('yyyy-MM-dd')", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Normalize ApplicationDate to ISO format", "columnName": "ApplicationDate", "expression": "value.toDate('yyyy-MM-dd').toString('yyyy-MM-dd')"}, {"op": "core/text-transform", "description": "Remove commas and convert Price to number", "columnName": "Price", "expression": "value.replace(/,/g, '').toNumber()"}, {"op": "core/text-transform", "description": "Remove commas and convert LoanAmount to number, fill missing with 0", "columnName": "LoanAmount", "expression": "value.trim() == '' ? 0 : value.replace(/,/g, '').toNumber()"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew York,NY,Restaurant,250000,100000,2023-01-15\nLos Angeles,CA,Retail,150000,75000,2023-02-15\nChicago,IL,Manufacturing,300000,120000,2023-03-01\nHouston,TX,Retail,200000,90000,2023-03-20\nPhiladelphia,PA,Restaurant,180000,85000,2023-04-05\nPhoenix,AZ,Retail,220000,0,2023-04-15\nSan Antonio,TX,Manufacturing,275000,110000,2023-05-01\nSan Diego,CA,Retail,210000,95000,2023-05-10\nDallas,TX,Manufacturing,310000,130000,2023-06-15\nSan Jose,CA,Restaurant,190000,80000,2023-07-01\nAustin,TX,Retail,230000,100000,2023-07-15\nJacksonville,FL,Restaurant,205000,90000,2023-08-01\nFort Worth,TX,Manufacturing,290000,115000,2023-08-20"}
{"purpose": "Clean and standardize movie dataset with inconsistent titles, genres, release dates, and box office amounts.", "raw_table": "Title,Genre,ReleaseDate,BoxOfficeUSD\ninception,SCI-FI,07/16/2010,829895144\nThe_godfather,Crime,03-24-1972,246120974\ntitanic,romance,12/19/1997,2187463944\nStar Wars: Episode IV - A New Hope,SCI_FI,1977/05/25,775398007\navatar,Action,12-18-2009,2,847,246,203\nThe Dark Knight,action,07/18/08,1004558444\nforrest_gump,Drama,07/06/1994,678222284\nla_la_land,Musical,12/9/16,151101803\nAvengers: Endgame,Action,2019-04-26,2797800564\nJurrasic Park,Adventure,06/11/1993,1030000000\nparasite,Thriller,,257591776\nThe Matrix,Sci-Fi,03-31-1999,463517383\nInterstellar,sci-fi,11/07/2014,677471339\njoker,drama,10-04-19,1074251311\nGladiator,History,05/05/2000,457640427", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize movie titles by replacing underscores and fixing capitalization", "columnName": "Title", "expression": "value.replace('_',' ').replace('_',' ').title()"}, {"op": "core/mass-edit", "description": "Standardize Genre values", "columnName": "Genre", "edits": [{"from": ["SCI-FI", "SCI_FI", "Sci-Fi", "sci-fi", "Sci-Fi"], "to": "Sci-Fi"}, {"from": ["action", "Action"], "to": "Action"}, {"from": ["romance", "Romance"], "to": "Romance"}, {"from": ["drama", "Drama"], "to": "Drama"}, {"from": ["musical", "Musical"], "to": "Musical"}, {"from": ["thriller", "Thriller"], "to": "Thriller"}, {"from": ["history", "History"], "to": "History"}, {"from": ["crime", "Crime"], "to": "Crime"}, {"from": ["adventure", "Adventure"], "to": "Adventure"}]}, {"op": "core/text-transform", "description": "Remove commas from BoxOfficeUSD and convert to number string", "columnName": "BoxOfficeUSD", "expression": "value.replace(/,/g, '').trim()"}, {"op": "core/text-transform", "description": "Parse BoxOfficeUSD as number", "columnName": "BoxOfficeUSD", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Normalize ReleaseDate to ISO format yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "if(isBlank(value), null, date.parse(value).toString('yyyy-MM-dd'))"}, {"op": "core/mass-edit", "description": "Fix known misspelling in Title", "columnName": "Title", "edits": [{"from": ["Jurrasic Park"], "to": "Jurassic Park"}]}, {"op": "core/text-transform", "description": "Fix capitalization of title after mass edit", "columnName": "Title", "expression": "value.trim()"}], "clean_table": "Title,Genre,ReleaseDate,BoxOfficeUSD\nInception,Sci-Fi,2010-07-16,829895144\nThe Godfather,Crime,1972-03-24,246120974\nTitanic,Romance,1997-12-19,2187463944\nStar Wars: Episode Iv - A New Hope,Sci-Fi,1977-05-25,775398007\nAvatar,Action,2009-12-18,2847246203\nThe Dark Knight,Action,2008-07-18,1004558444\nForrest Gump,Drama,1994-07-06,678222284\nLa La Land,Musical,2016-12-09,151101803\nAvengers: Endgame,Action,2019-04-26,2797800564\nJurassic Park,Adventure,1993-06-11,1030000000\nParasite,Thriller,,257591776\nThe Matrix,Sci-Fi,1999-03-31,463517383\nInterstellar,Sci-Fi,2014-11-07,677471339\nJoker,Drama,2019-10-04,1074251311\nGladiator,History,2000-05-05,457640427"}
{"purpose": "Clean and standardize movie metadata including titles, genres, release dates, and box office figures.", "raw_table": "Title,Genre,ReleaseDate,BoxOffice,Rating\n\"the Shawshank Redemption\",\"Drama-\",\"14/10/1994\",\"28341469\",\"9.3\"\n\"inception_\",\"Sci-Fi\",\"16-07-2010\",\"829895144\",\"8.8\"\n\"avatar\",\"sci-fi\",\"18/12/2009\",\"2,847,246,203\",\"7.8\"\n\"Forrest Gump\",\"Drama\",\"06-07-1994\",\"678200000\",\"8.8\"\n\"the godfather\",\"Crime-drama\",\"24/03/1972\",\"246120974\",\"9.2\"\n\"The Dark Knight\",\"Action-\",\"18/07/2008\",\"1004558444\",\"9.0\"\n\"PULP FICTION\",\"crime-Drama\",\"14-10-1994\",\"213928762\",\"8.9\"\n\"Fight Club\",\"Drama\",\"15/10/1999\",\"100853753\",\"8.8\"\n\"gladiator\",\"Action\",\"2000/05/05\",\"457640427\",\"8.5\"\n\"titanic\",\"Drama-Romance\",\"19-12-1997\",\"2187463944\",\"7.8\"\n\"star wars\",\"Sci_Fi\",\"25/05/1977\",\"775398007\",\"8.6\"\n\"Joker\",\"Crime Drama\",\"04-10-2019\",\"1074251311\",\"8.5\"\n\"The Matrix\",\"SCI-FI\",\"31/03/1999\",\"466364845\",\"8.7\"\n\"La La land\",\"Romance-musical\",\"25-12-2016\",\"446400000\",\"8.0\"\n\"Interstellar\",\"sci_fi\",\"07/11/2014\",\"677471339\",\"8.6\"", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and remove trailing hyphens or underscores in Title", "columnName": "Title", "expression": "value.trim().replace(/[_-]+$/, '')"}, {"op": "core/text-transform", "description": "Standardize Genre capitalization and replace underscores or hyphens with space", "columnName": "Genre", "expression": "value.toLowerCase().replace(/[_-]+/g, ' ').split(' ').map(w, index, arr -> w.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Normalize ReleaseDate to ISO format yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "if(value.match(/\\d{2}[/-]\\d{2}[/-]\\d{4}/)) { \n  var parts = value.split(/[\\/\\-]/);\n  if(parts[2].length == 4) { parts[2] + '-' + parts[1].padStart(2,'0') + '-' + parts[0].padStart(2,'0') } else value\n} else if(value.match(/\\d{4}[/-]\\d{2}[/-]\\d{2}/)) {\n  value.replace(/\\//g,'-')\n} else {\n  value\n}"}, {"op": "core/text-transform", "description": "Remove commas from BoxOffice and convert to number string", "columnName": "BoxOffice", "expression": "value.replace(/,/g,'')"}, {"op": "core/text-transform", "description": "Capitalize Title properly", "columnName": "Title", "expression": "value.toLowerCase().split(' ').map(w, index, arr -> w.length > 3 || index == 0 || index == arr.length -1 ? w.capitalize() : w).join(' ')"}, {"op": "core/mass-edit", "description": "Correct Genre synonyms and compound genres", "columnName": "Genre", "edits": [{"from": ["Sci Fi", "Sci fi", "Sci_Fi", "Sci-fi", "Sci Fi", "Sci_Fi"], "to": "Sci Fi"}, {"from": ["Crime Drama", "Crime Drama"], "to": "Crime Drama"}, {"from": ["Drama Romance", "Romance Musical"], "to": "Romance"}]}, {"op": "core/text-transform", "description": "Remove multiple spaces in Genre", "columnName": "Genre", "expression": "value.replace(/\\s+/g,' ')"}, {"op": "core/text-transform", "description": "Ensure Rating is numeric string", "columnName": "Rating", "expression": "value.toString().trim()"}], "clean_table": "Title,Genre,ReleaseDate,BoxOffice,Rating\nThe Shawshank Redemption,Drama,1994-10-14,28341469,9.3\nInception,Sci Fi,2010-07-16,829895144,8.8\nAvatar,Sci Fi,2009-12-18,2847246203,7.8\nForrest Gump,Drama,1994-07-06,678200000,8.8\nThe Godfather,Crime Drama,1972-03-24,246120974,9.2\nThe Dark Knight,Action,2008-07-18,1004558444,9.0\nPulp Fiction,Crime Drama,1994-10-14,213928762,8.9\nFight Club,Drama,1999-10-15,100853753,8.8\nGladiator,Action,2000-05-05,457640427,8.5\nTitanic,Romance,1997-12-19,2187463944,7.8\nStar Wars,Sci Fi,1977-05-25,775398007,8.6\nJoker,Crime Drama,2019-10-04,1074251311,8.5\nThe Matrix,Sci Fi,1999-03-31,466364845,8.7\nLa La Land,Romance,2016-12-25,446400000,8.0\nInterstellar,Sci Fi,2014-11-07,677471339,8.6"}
{"purpose": "Standardize and clean farm loan records with consistent formatting and corrected values.", "raw_table": "FarmID,OwnerName,City,State,CropType,LoanAmount,LoanDate,PricePerTon\n101,jane DOE,new-york,ny,CoR_n,20000,2023/07/15,$450.50\n102,John smith,Buffalo,NY,corN,15000,15-08-2023,430\n103,Mary-jane o'neil,Albany,ny,WHeat,18000,2023.09.01, 400\n104,bob OConnor,rochester,Ny,wheat,NaN,2023-07-20,$395\n105,Alice_Lee,Syracuse,NY,CoRn,17000,2023/13/07,465\n106,Mike Brown,buffalo,ny,soybean,16000,2023-08-01,$380.00\n107,Linda Davis,NEW YORK,NY,soybean,15500,2023-08-05,378\n108,Chris_Parker,Rochester,ny,corn,17500,,420\n109,Susan_Lee,Syracuse,N.Y, CORN,16500,2023/07/25,$440\n110,Tom_Harper,Albany,Ny,Wheat,17000,2023-08-15,398\n111,Nancy-Young,New York,NY,soybean,NaN,2023/07/30,$375\n112,George_Wilson,buffalo,ny,corn,18000,2023-07-10,$455\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from all columns", "columnName": "OwnerName", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace from City", "columnName": "City", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace from CropType", "columnName": "CropType", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Standardize City names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/, ' ').split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Correct state abbreviations to uppercase two-letter codes", "columnName": "State", "edits": [{"from": ["ny", "Ny", "N.Y", "n.y."], "to": "NY"}]}, {"op": "core/mass-edit", "description": "Standardize CropType names", "columnName": "CropType", "edits": [{"from": ["CoR_n", "corN", "CoRn", "CORN", " corn"], "to": "Corn"}, {"from": ["WHeat", "wheat", "Wheat"], "to": "Wheat"}, {"from": ["soybean", "Soybean"], "to": "Soybean"}]}, {"op": "core/text-transform", "description": "Clean OwnerName capitalization and remove extra underscores or hyphens", "columnName": "OwnerName", "expression": "value.replace(/[_-]/g, ' ').split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1).toLowerCase()).join(' ')"}, {"op": "core/text-transform", "description": "Parse LoanDate to standard ISO format yyyy-MM-dd", "columnName": "LoanDate", "expression": "value.match(/^(\\d{4})[\\/\\.\\-](\\d{2})[\\/\\.\\-](\\d{2})$/) ? value.replace(/[\\/\\.]/g, '-') : (value.match(/^(\\d{2})-(\\d{2})-(\\d{4})$/) ? value.replace(/(\\d{2})-(\\d{2})-(\\d{4})/, '$3-$2-$1') : '')"}, {"op": "core/text-transform", "description": "Fix invalid dates (e.g. 2023/13/07 to blank)", "columnName": "LoanDate", "expression": "value && (new Date(value).toString() !== 'Invalid Date') ? value : ''"}, {"op": "core/text-transform", "description": "Remove $ sign and convert PricePerTon to numeric string", "columnName": "PricePerTon", "expression": "value.replace(/\\$/g, '').trim()"}, {"op": "core/text-transform", "description": "Replace NaN LoanAmount with empty string", "columnName": "LoanAmount", "expression": "value.toLowercase() == 'nan' ? '' : value"}], "clean_table": "FarmID,OwnerName,City,State,CropType,LoanAmount,LoanDate,PricePerTon\n101,Jane Doe,New York,NY,Corn,20000,2023-07-15,450.50\n102,John Smith,Buffalo,NY,Corn,15000,2023-08-15,430\n103,Maryjane O'neil,Albany,NY,Wheat,18000,2023-09-01,400\n104,Bob Oconnor,Rochester,NY,Wheat,,2023-07-20,395\n105,Alice Lee,Syracuse,NY,Corn,17000,,465\n106,Mike Brown,Buffalo,NY,Soybean,16000,2023-08-01,380.00\n107,Linda Davis,New York,NY,Soybean,15500,2023-08-05,378\n108,Chris Parker,Rochester,NY,Corn,17500,,420\n109,Susan Lee,Syracuse,NY,Corn,16500,2023-07-25,440\n110,Tom Harper,Albany,NY,Wheat,17000,2023-08-15,398\n111,Nancy Young,New York,NY,Soybean,,2023-07-30,375\n112,George Wilson,Buffalo,NY,Corn,18000,2023-07-10,455\n"}
{"purpose": "Clean and standardize customer records with inconsistent formats and missing data in telecommunications loan applications.", "raw_table": "CustomerID,City,State,Business_Type,Price,LoanAmount,Application_Date\n1001,new york,ny,Small_Business,2000,50000,01-15-2023\n1002,Los-Angeles,CA,Enterprise, 2500 ,70000,2023/02/20\n1003,Houstn,tx,small business,3000, ,March 5 2023\n1004,Chicago,IL,SMALL-BUSINESS, ,60000,2023-04-10\n1005,philadelphia,pa,Enterprise,2700,65000,04/15/23\n1006,,CA,small_business,2200,55000,2023-5-20\n1007,Phoenix,AZ,enterprise, 2600 ,72000,May 25 2023\n1008,San_Antonio,Tx,,2400,58000,06-10-2023\n1009,Dallas,TX,Small Business,2300,59000,2023.07.15\n1010,san diego,ca,Enterprise,2500,68000,07/30/2023\n1011,Austin,TX,small-business,2100,53000,2023-08-05\n1012,Jacksonville,fl,Small_Business, ,56000,08-20-2023\n1013,Fort-Worth,TX,Enterprise,2550, ,2023/09/10\n1014,Columbus,oh,small business,2250,54000,09-25-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from Price and LoanAmount columns", "columnName": "Price", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace from Price and LoanAmount columns", "columnName": "LoanAmount", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Standardize City names: replace underscores and hyphens with spaces, capitalize words", "columnName": "City", "expression": "value.replace('_',' ').replace('-',' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix misspelled city 'Houstn' to 'Houston'", "columnName": "City", "edits": [{"from": ["Houstn"], "to": "Houston"}]}, {"op": "core/mass-edit", "description": "Fill missing Business_Type with 'Small Business'", "columnName": "Business_Type", "edits": [{"from": [""], "to": "Small Business"}]}, {"op": "core/text-transform", "description": "Normalize Business_Type values to Title Case and remove underscores/hyphens", "columnName": "Business_Type", "expression": "value.replace('_',' ').replace('-',' ').toTitlecase()"}, {"op": "core/mass-edit", "description": "Fill missing Price with average (approx 2400)", "columnName": "Price", "edits": [{"from": [""], "to": "2400"}]}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount with average (approx 58000)", "columnName": "LoanAmount", "edits": [{"from": [""], "to": "58000"}]}, {"op": "core/date-parse", "description": "Parse Application_Date to yyyy-MM-dd", "columnName": "Application_Date", "format": "auto", "mode": "lenient"}], "clean_table": "CustomerID,City,State,Business_Type,Price,LoanAmount,Application_Date\n1001,New York,NY,Small Business,2000,50000,2023-01-15\n1002,Los Angeles,CA,Enterprise,2500,70000,2023-02-20\n1003,Houston,TX,Small Business,3000,58000,2023-03-05\n1004,Chicago,IL,Small Business,2400,60000,2023-04-10\n1005,Philadelphia,PA,Enterprise,2700,65000,2023-04-15\n1006,,CA,Small Business,2200,55000,2023-05-20\n1007,Phoenix,AZ,Enterprise,2600,72000,2023-05-25\n1008,San Antonio,TX,Small Business,2400,58000,2023-06-10\n1009,Dallas,TX,Small Business,2300,59000,2023-07-15\n1010,San Diego,CA,Enterprise,2500,68000,2023-07-30\n1011,Austin,TX,Small Business,2100,53000,2023-08-05\n1012,Jacksonville,FL,Small Business,2400,56000,2023-08-20\n1013,Fort Worth,TX,Enterprise,2550,58000,2023-09-10\n1014,Columbus,OH,Small Business,2250,54000,2023-09-25"}
{"purpose": "Normalize inconsistent city names and standardize numeric and date formats in energy loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew york,NY,solar_company,10000,5000,2023/01/15\nlos-angeles,CA, WindEnergy ,8500,4500,15-02-2023\nSan francisco,CA,solar-company,12000, ,2023.03.10\nhouston,tx,Wind_energy,9000,4000,03/25/2023\nCHICAGO,IL,solar_company,11000,5500,2023-04-05\nphoenix,az,solar company,9500,4800,04-20-2023\nphiladelphia,pa,wind-company,8700,,20230425\nSan Diego,CA,solar_company,10500,5000,May 01, 2023\ndallas,TX,solar-company,9800,4700,2023/05/15\nsan jose,CA,wind company,8900,4500,2023-06-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and standardize capitalization in City column", "columnName": "City", "expression": "value.trim().toTitlecase()"}, {"op": "core/mass-edit", "description": "Correct inconsistent city names", "columnName": "City", "edits": [{"from": ["San francisco", "San Diego", "san jose"], "to": "San Francisco"}, {"from": ["los-angeles"], "to": "Los Angeles"}]}, {"op": "core/text-transform", "description": "Uppercase State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Standardize BusinessType naming", "columnName": "BusinessType", "expression": "value.toLowercase().replaceAll(/[-_]/, ' ').replace('solar company', 'Solar Company').replace('solar company', 'Solar Company').replace('solar company', 'Solar Company').replace('wind energy', 'Wind Energy').replace('wind_energy', 'Wind Energy').replace('wind company', 'Wind Energy').replace('wind-company', 'Wind Energy').trim()"}, {"op": "core/mass-edit", "description": "Fix common BusinessType misspellings", "columnName": "BusinessType", "edits": [{"from": ["solar_company", "solar-company"], "to": "Solar Company"}, {"from": ["wind_energy", "wind-company", "wind company"], "to": "Wind Energy"}]}, {"op": "core/text-transform", "description": "Convert Price to number", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number, fill missing with 0", "columnName": "LoanAmount", "expression": "value.trim() == '' ? 0 : value.toNumber()"}, {"op": "core/text-transform", "description": "Normalize LoanDate to ISO format yyyy-MM-dd", "columnName": "LoanDate", "expression": "if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/)) value.replace('/', '-').replace('/', '-') else if(value.match(/\\d{2}-\\d{2}-\\d{4}/)) value.split('-')[2]+'-'+value.split('-')[0]+'-'+value.split('-')[1] else if(value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/)) value.replace('.', '-').replace('.', '-') else if(value.match(/\\d{8}/)) value.slice(0,4)+'-'+value.slice(4,6)+'-'+value.slice(6,8) else if(value.match(/[A-Za-z]{3,}\\s\\d{2},\\s\\d{4}/)) value.toDate().toString('yyyy-MM-dd') else value"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew York,NY,Solar Company,10000,5000,2023-01-15\nLos Angeles,CA,Wind Energy,8500,4500,2023-02-15\nSan Francisco,CA,Solar Company,12000,0,2023-03-10\nHouston,TX,Wind Energy,9000,4000,2023-03-25\nChicago,IL,Solar Company,11000,5500,2023-04-05\nPhoenix,AZ,Solar Company,9500,4800,2023-04-20\nPhiladelphia,PA,Wind Energy,8700,0,2023-04-25\nSan Francisco,CA,Solar Company,10500,5000,2023-05-01\nDallas,TX,Solar Company,9800,4700,2023-05-15\nSan Jose,CA,Wind Energy,8900,4500,2023-06-01"}
{"purpose": "Standardize movie genre names and fix inconsistent release date formats in the dataset.", "raw_table": "MovieID,Title,Genre,ReleaseDate,BoxOffice\n1,The_last_Dance,sporTs,03/25/2019,$150 million\n2,space Odyssey,Sci-Fi,July 20 2018,200M\n3,Romance_in_Paris,romcom,2017-11-10,$75m\n4,Haunted-House,horror,10-31-2016,50 million\n5,THE COMEDY SHOW,COMEDY,2019/05/15,$30,000,000\n6,Sunshine_Valley,drama,March 3rd 2020,45M\n7,Deep_Blue_Sea,action,2018/07/14,120 million\n8,love & war,RomCom,,40 million\n9,Final Frontier,SCI_FI,2016-12-25,$90m\n10,Carnival_night,comedy,2018-03-22,$25 million\n11,Shadow Realm,Horror,31/10/2017,55M\n12,Lost_in_Space,sci-fi,2019-08-12,180 million", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in Title with spaces, and capitalize each word", "columnName": "Title", "expression": "value.replace(/[_-]/, ' ').split(' ').map(w, w.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Standardize Genre values to common genre names", "columnName": "Genre", "expression": "value.toLowerCase().replace(/_/g, '').replace('romcom', 'Romantic Comedy').replace('romcom', 'Romantic Comedy').replace('sports', 'Sports').replace('sci-fi', 'Science Fiction').replace('scifi', 'Science Fiction').replace('comedy', 'Comedy').replace('horror', 'Horror').replace('drama', 'Drama').trim().capitalize()"}, {"op": "core/mass-edit", "description": "Fix known Genre misspellings and abbreviations", "columnName": "Genre", "edits": [{"from": ["sporTs"], "to": "Sports"}, {"from": ["Sci-Fi", "SCI_FI", "sci-fi"], "to": "Science Fiction"}, {"from": ["romcom", "RomCom", "RomCom"], "to": "Romantic Comedy"}, {"from": ["COMEDY"], "to": "Comedy"}, {"from": ["horror", "Horror"], "to": "Horror"}, {"from": ["drama"], "to": "Drama"}, {"from": ["action"], "to": "Action"}]}, {"op": "core/text-transform", "description": "Parse and standardize ReleaseDate to ISO format yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "if(value == null || value.trim() == '', '',\n  if(value.match(/\\d{4}-\\d{2}-\\d{2}/), value, \n    if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/),\n       date.parse(value, 'dd/MM/yyyy').toString('yyyy-MM-dd'),\n      if(value.match(/\\d{2}-\\d{2}-\\d{4}/),\n         date.parse(value, 'MM-dd-yyyy').toString('yyyy-MM-dd'),\n        if(value.match(/\\w+ \\d{1,2} \\d{4}/),\n           date.parse(value, 'MMMM d yyyy').toString('yyyy-MM-dd'),\n           if(value.match(/\\w+ \\d{1,2}[a-z]{2} \\d{4}/),\n               date.parse(value.replace(/(\\d{1,2})(st|nd|rd|th)/, '$1'), 'MMMM d yyyy').toString('yyyy-MM-dd'),\n               ''\n           )\n        )\n      )\n    )\n  )\n)"}, {"op": "core/text-transform", "description": "Standardize BoxOffice values to numeric millions (M) without symbols", "columnName": "BoxOffice", "expression": "(\n  value.toLowerCase()\n    .replace(/\\$|,/g, '')\n    .replace('million', 'm')\n    .replace('m', '')\n    .trim()\n  ).toNumber()"}, {"op": "core/text-transform", "description": "Convert BoxOffice to numeric millions (integer)", "columnName": "BoxOffice", "expression": "Math.round(value)"}], "clean_table": "MovieID,Title,Genre,ReleaseDate,BoxOffice\n1,The Last Dance,Sports,2019-03-25,150\n2,Space Odyssey,Science Fiction,2018-07-20,200\n3,Romance In Paris,Romantic Comedy,2017-11-10,75\n4,Haunted House,Horror,2016-10-31,50\n5,The Comedy Show,Comedy,2019-05-15,30\n6,Sunshine Valley,Drama,2020-03-03,45\n7,Deep Blue Sea,Action,2018-07-14,120\n8,Love & War,Romantic Comedy,,40\n9,Final Frontier,Science Fiction,2016-12-25,90\n10,Carnival Night,Comedy,2018-03-22,25\n11,Shadow Realm,Horror,2017-10-31,55\n12,Lost In Space,Science Fiction,2019-08-12,180"}
{"purpose": "Standardize movie titles and release dates, and correct inconsistent genre entries in the dataset.", "raw_table": "MovieTitle,ReleaseDate,Genre,BoxOffice\n\"the avengers\",\"05/04/2012\",action-Adventure,\"$623,357,910\"\n\"Frozen\",\"11-27-2013\",Animation,\"400000000\"\n\"Jurrasic_Park\",\"06/11/1993\",sci-fi,\"$1,029,153,882\"\n\"the dark knight\",\"07/18/2008\",Action,\"$1,005,973,645\"\n\"starwars: a new hope\",\"05/25/1977\",sci_fi,\"$775398007\"\n\"inception\",\"2010/07/16\",Sci-Fi,\"$829895144\"\n\"Toy Story\",\"11/22/1995\",Animation,\"$373554033\"\n\"Avatar\",\"12-18-2009\",SCI-FI,\"$2,847,246,203\"\n\"The Lion king\",\"06/24/1994\",animation,\"$968483777\"\n\"Avengers: Endgame\",\"04/26/2019\",Action_Adventure,\"$2,797,501,328\"\n\"Back to the future\",\"07/03/1985\",SCI Fi,\"$381109762\"\n\"Black Panther\",\"02/16/2018\",action adventure,\"$1,347,597,973\"\n\"Toy story 2\",\"11/24/1999\",Animation,\"$497,366,869\"\n\"The Matrix\",\"03-31-1999\",SciFi,\"$466,364,845\"\n\"Finding Nemo\",\"05/30/2003\",animation,\"$940335536\"", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "MovieTitle", "expression": "value.toTitlecase().replace(/_/g, ' ').replace(/:\\s*/,' : ')"}, {"op": "core/text-transform", "columnName": "ReleaseDate", "expression": "value.match(/\\d{4}/) ? value.replace(/[-\\/]/g, '-') : value", "onError": "value"}, {"op": "core/date-parse", "columnName": "ReleaseDate", "onError": "set-to-blank", "format": "MM-dd-yyyy"}, {"op": "core/text-transform", "columnName": "Genre", "expression": "value.toLowercase().replace(/[-_]/g, ' ').replace(/\\s+/g, ' ').trim()"}, {"op": "core/mass-edit", "columnName": "Genre", "edits": [{"from": ["sci fi", "sci-fi", "sci_fi", "scifi", "sci fi"], "to": "sci-fi"}, {"from": ["action adventure", "action-adventure", "action_adventure"], "to": "action adventure"}, {"from": ["animation"], "to": "animation"}]}, {"op": "core/text-transform", "columnName": "BoxOffice", "expression": "value.replace(/[^0-9]/g, '').length > 0 ? Number(value.replace(/[^0-9]/g, '')) : null"}, {"op": "core/column-rename", "oldColumnName": "BoxOffice", "newColumnName": "BoxOfficeUSD"}], "clean_table": "MovieTitle,ReleaseDate,Genre,BoxOfficeUSD\nThe Avengers,2012-05-04,action adventure,623357910\nFrozen,2013-11-27,animation,400000000\nJurrasic Park,1993-06-11,sci-fi,1029153882\nThe Dark Knight,2008-07-18,action,1005973645\nStarwars : A New Hope,1977-05-25,sci-fi,775398007\nInception,2010-07-16,sci-fi,829895144\nToy Story,1995-11-22,animation,373554033\nAvatar,2009-12-18,sci-fi,2847246203\nThe Lion King,1994-06-24,animation,968483777\nAvengers: Endgame,2019-04-26,action adventure,2797501328\nBack To The Future,1985-07-03,sci-fi,381109762\nBlack Panther,2018-02-16,action adventure,1347597973\nToy Story 2,1999-11-24,animation,497366869\nThe Matrix,1999-03-31,sci-fi,466364845\nFinding Nemo,2003-05-30,animation,940335536"}
{"purpose": "Clean and standardize city names, business types, dates, and numeric fields in a telecommunications loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew york,NY,Tele-com,1200.5,50000,01/15/2023\nlos-angeles,ca,Internet_Service,1100,,2023-03-05\nChicago,IL,Cellular,900,30000,03-10-2023\nhouston,TX,telecom,800,25000,2023/04/01\nPHOENIX,az,cellular,850,27000,04-15-23\nPhiladelphia,pa,Internet Service,,45000,15/05/2023\nSan Antonio,Tx,tele_com,700,22000,May 20 2023\nSan-diego,CA,Cellular,650,21000,2023-06-01\nDallas,tx,Internet-service,750,23000,06/10/23\nsan jose,CA,Tele-com,720,22500,07/01/2023\nAustin,TX,telecom,680,,07-15-2023\nJacksonville,FL,Cellular,640,20000,2023/07/30\nFort Worth,TX,Internet Service,700,21500,31/07/2023\nColumbus,OH,tele-com,660,20500,08-15-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize 'City' capitalization and remove hyphens/underscores", "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/, ' ').split(' ').map(s, s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Normalize 'State' to uppercase two-letter codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize 'BusinessType' values", "columnName": "BusinessType", "edits": [{"from": ["tele-com", "telecom", "tele_com", "Tele-com"], "to": "Telecom"}, {"from": ["Internet_Service", "Internet Service", "Internet-service"], "to": "Internet Service"}, {"from": ["Cellular", "cellular"], "to": "Cellular"}]}, {"op": "core/text-transform", "description": "Convert 'Price' to number and fill empty with null", "columnName": "Price", "expression": "isNonBlank(value) ? Number(value) : null"}, {"op": "core/text-transform", "description": "Convert 'LoanAmount' to number and fill missing with null", "columnName": "LoanAmount", "expression": "isNonBlank(value) ? Number(value) : null"}, {"op": "core/text-transform", "description": "Normalize 'Date' to ISO format yyyy-MM-dd", "columnName": "Date", "expression": "if(value.match(/\\d{4}-\\d{2}-\\d{2}/)) value;\nelse if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/)) {\n  var parts = value.split('/');\n  parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0');\n} else if(value.match(/\\d{2}-\\d{2}-\\d{4}/)) {\n  var parts = value.split('-');\n  parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0');\n} else if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/)) {\n  value.replace(/\\//g,'-');\n} else if(value.match(/\\d{2}-\\d{2}-\\d{2}/)) {\n  var parts = value.split('-');\n  '20' + parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0');\n} else if(value.match(/\\d{2}\\/\\d{2}\\/\\d{2}/)) {\n  var parts = value.split('/');\n  '20' + parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0');\n} else if(value.match(/[A-Za-z]+ \\d{1,2} \\d{4}/)) {\n  var d = new Date(value);\n  d.toISOString().slice(0,10);\n} else if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/)) {\n  var parts = value.split('/');\n  parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0');\n} else {\n  null\n}"}, {"op": "core/fill-down", "description": "Fill missing LoanAmount values down", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom,1200.5,50000,2023-01-15\nLos Angeles,CA,Internet Service,1100,null,2023-03-05\nChicago,IL,Cellular,900,30000,2023-03-10\nHouston,TX,Telecom,800,25000,2023-04-01\nPhoenix,AZ,Cellular,850,27000,2023-04-15\nPhiladelphia,PA,Internet Service,null,45000,2023-05-15\nSan Antonio,TX,Telecom,700,22000,2023-05-20\nSan Diego,CA,Cellular,650,21000,2023-06-01\nDallas,TX,Internet Service,750,23000,2023-06-10\nSan Jose,CA,Telecom,720,22500,2023-07-01\nAustin,TX,Telecom,680,22500,2023-07-15\nJacksonville,FL,Cellular,640,20000,2023-07-30\nFort Worth,TX,Internet Service,700,21500,2023-07-31\nColumbus,OH,Telecom,660,20500,2023-08-15"}
{"purpose": "Clean inconsistent city and business type names, normalize date formats, and fix pricing and loan amount formats in telecommunications customer data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,SignupDate\nNew_york,NY,telecom,100.5,5000,01-15-2023\nlos-angeles,CA,Telecom, ninety,4500,2023/02/20\nChicago,il,Telecom,120.00,NaN,03-03-23\nhouston,TX,broadbnd,110,4000,2023-04-01\nPHOENIX,AZ,Broad_band,One hundred,3500,04/15/2023\nphiladelphia,pa,telecom_,105.75,4200,2023-05-10\nSan Antonio,TX,broadband,115.2,,05-25-2023\nsan_diego,CA,Telecom,NaN,4800,2023/06/01\nDallas,Tx,Broadband,125.00,4700,6/15/2023\nsan_jose,ca,telecom,130,,07-01-2023\nAustin,TX,Broadband,118,4300,07-20-2023\nJacksonville,FL,telecom,NaN,3900,2023-08-10\nfort-worth,TX,broadband,112,4100,08-25-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize city names by replacing underscores and hyphens with spaces and capitalizing words", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').split(' ').map(s, s.toLowerCase().replace(/^(.)/, c, c.toUpperCase())).join(' ')"}, {"op": "core/text-transform", "description": "Standardize state abbreviations to uppercase", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/text-transform", "description": "Fix BusinessType misspellings and remove trailing underscores", "columnName": "BusinessType", "expression": "value.toLowerCase().replace(/_/g, '').replace('broadband', 'Broadband').replace('broadbnd', 'Broadband').replace('telecom', 'Telecom')"}, {"op": "core/mass-edit", "description": "Correct Price misspellings and convert textual numbers to numeric", "columnName": "Price", "edits": [{"from": ["NaN", "NaN", ""], "to": ""}, {"from": ["one hundred", "One hundred"], "to": "100"}, {"from": ["ninety"], "to": "90"}]}, {"op": "core/text-transform", "description": "Convert Price column to number", "columnName": "Price", "expression": "if(value.trim() == '', null, value.toNumber())"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number, replace missing or NaN with null", "columnName": "LoanAmount", "expression": "if(value.toLowercase() == 'nan' || value.trim() == '', null, value.toNumber())"}, {"op": "core/date-parse", "description": "Parse SignupDate to ISO 8601 yyyy-MM-dd", "columnName": "SignupDate", "format": "auto", "guessCellType": true}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,SignupDate\nNew York,NY,Telecom,100.5,5000,2023-01-15\nLos Angeles,CA,Telecom,90,4500,2023-02-20\nChicago,IL,Telecom,120,4500,2023-03-03\nHouston,TX,Broadband,110,4000,2023-04-01\nPhoenix,AZ,Broadband,100,3500,2023-04-15\nPhiladelphia,PA,Telecom,105.75,4200,2023-05-10\nSan Antonio,TX,Broadband,115.2,4200,2023-05-25\nSan Diego,CA,Telecom,null,4800,2023-06-01\nDallas,TX,Broadband,125,4700,2023-06-15\nSan Jose,CA,Telecom,130,4700,2023-07-01\nAustin,TX,Broadband,118,4300,2023-07-20\nJacksonville,FL,Telecom,null,3900,2023-08-10\nFort Worth,TX,Broadband,112,4100,2023-08-25"}
{"purpose": "Standardize city and business type names, fix date formats, and clean numeric fields in energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew-york,NY,EnerGy Provider,10000,50000,01/15/2023\nlos angeles,CA,solar-installer,15000,75000,2023-02-28\nhouston,tx,Oil & Gas,12000,60000,15-03-2023\nchicago,IL,,9000,45000,2023/04/10\nphoenix,Az,Wind_power,11000,55000,04-25-2023\nphiladelphia,pa,Solar Installer,10000,,05/05/2023\nsan antonio,tx,energy provider,13000,65000,2023-06-15\nsan-diego,CA,oil&gas,11500,57500,06/20/2023\nDallas,TX,Wind Power,10500,52500,07/10/2023\nsan jose,ca,Solar-Installer,14000,70000,2023/08/15\nAustin,Tx,ENERGY_PROVIDER,12500,62500,08-30-2023\njacksonville,fl,solar_installer,9500,47500,09/10/2023\nfort worth,TX,Oil & gas,10000,50000,2023-10-05\ncolumbus,oh,Wind-Power,9800,49000,10/20/2023\ncharlotte,nc,Energy Provider,11000,55000,11-15-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names capitalization and remove hyphens/underscores", "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType names", "columnName": "BusinessType", "edits": [{"from": ["energy provider", "EnerGy Provider", "ENERGY_PROVIDER", "Energy Provider"], "to": "Energy Provider"}, {"from": ["solar-installer", "Solar Installer", "solar_installer", "Solar-Installer"], "to": "Solar Installer"}, {"from": ["oil & gas", "Oil & Gas", "oil&gas", "Oil & gas"], "to": "Oil & Gas"}, {"from": ["wind_power", "Wind Power", "Wind-Power"], "to": "Wind Power"}]}, {"op": "core/fill-down", "description": "Fill down missing BusinessType", "columnName": "BusinessType"}, {"op": "core/text-transform", "description": "Normalize Price and LoanAmount to numbers (remove commas or other characters if needed)", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Normalize LoanAmount to numbers and fill missing with 0", "columnName": "LoanAmount", "expression": "value == null || value.length() == 0 ? 0 : value.toNumber()"}, {"op": "core/date-parse", "description": "Parse and unify date formats to yyyy-MM-dd", "columnName": "Date", "format": "date", "guessCellType": true, "onError": "keep-original"}, {"op": "core/text-transform", "description": "Format Date column to ISO standard yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Energy Provider,10000,50000,2023-01-15\nLos Angeles,CA,Solar Installer,15000,75000,2023-02-28\nHouston,TX,Oil & Gas,12000,60000,2023-03-15\nChicago,IL,Oil & Gas,9000,45000,2023-04-10\nPhoenix,AZ,Wind Power,11000,55000,2023-04-25\nPhiladelphia,PA,Solar Installer,10000,0,2023-05-05\nSan Antonio,TX,Energy Provider,13000,65000,2023-06-15\nSan Diego,CA,Oil & Gas,11500,57500,2023-06-20\nDallas,TX,Wind Power,10500,52500,2023-07-10\nSan Jose,CA,Solar Installer,14000,70000,2023-08-15\nAustin,TX,Energy Provider,12500,62500,2023-08-30\nJacksonville,FL,Solar Installer,9500,47500,2023-09-10\nFort Worth,TX,Oil & Gas,10000,50000,2023-10-05\nColumbus,OH,Wind Power,9800,49000,2023-10-20\nCharlotte,NC,Energy Provider,11000,55000,2023-11-15"}
{"purpose": "Standardize movie genre names, fix inconsistent capitalization, and correct release date formats.", "raw_table": "Title,Genre,ReleaseDate,Rating,BoxOffice\nInception,Sci-fi,07/16/2010,8.8,$829.89M\nThe_godfather,crime,1972-03-24,9.2,$246.12M\nAvengers:Endgame,Action,04_26_2019,8.4,$2.798B\nJurassic park,SCI-FI,1993/06/11,8.1,$1.033B\npulp fiction,Crime,10-14-1994,8.9,$213.9m\nThe Dark Knight,Action,2008.07.18,9.0,$1.005B\nForrest Gump,Drama,,8.8,$678.22M\nLa La Land,MuSICAL,12/09/2016,8.0,$446.1M\nthe lion king,animation,06-15-1994,8.5,$968.5m\nToy Story,Animation,11/22/1995,8.3,$373.6M\nInterstellar,SciFi,2014-11-07,8.6,$677.5M\nGladiator,Action,2000/05/05,8.5,$462.0m\nTitanic,Drama,12_19_1997,7.8,$2.195B\nThe Matrix,SCI-FI,03-31-1999,8.7,$466.4M", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize capitalization in Title", "columnName": "Title", "expression": "value.toTitlecase()"}, {"op": "core/mass-edit", "description": "Correct genre inconsistent spellings and capitalization", "columnName": "Genre", "edits": [{"from": ["Sci-fi", "SCI-FI", "SciFi", "SCI-FI", "SCI-FI"], "to": "Sci-Fi"}, {"from": ["crime", "Crime"], "to": "Crime"}, {"from": ["MuSICAL"], "to": "Musical"}, {"from": ["animation", "Animation"], "to": "Animation"}, {"from": ["Action"], "to": "Action"}, {"from": ["Drama"], "to": "Drama"}]}, {"op": "core/text-transform", "description": "Fix ReleaseDate inconsistent separators", "columnName": "ReleaseDate", "expression": "value.replace('_', '-').replace('/', '-').replace('.', '-').replace('_', '-')"}, {"op": "core/date-parse", "description": "Parse ReleaseDate to standard ISO format", "columnName": "ReleaseDate", "patterns": ["MM-dd-yyyy", "yyyy-MM-dd", "MM-dd-yyyy", "MM-dd-yyyy"], "ignoreCase": true, "includeLocale": false}, {"op": "core/text-transform", "description": "Handle missing ReleaseDate values", "columnName": "ReleaseDate", "expression": "value.length() == 0 ? 'Unknown' : value"}, {"op": "core/text-transform", "description": "Normalize BoxOffice monetary values to uniform format (remove $ and convert B/M to numeric)", "columnName": "BoxOffice", "expression": "value.replace(/\\$/,'').toLowercase()"}, {"op": "core/text-transform", "description": "Convert BoxOffice to uniform numeric string in millions", "columnName": "BoxOffice", "expression": "if(value.endsWith('b'), (parseFloat(value.replace('b',''))*1000).toFixed(1) + 'M', value)"}, {"op": "core/text-transform", "description": "Normalize Rating to numeric with one decimal", "columnName": "Rating", "expression": "value.toNumber().toFixed(1)"}], "clean_table": "Title,Genre,ReleaseDate,Rating,BoxOffice\nInception,Sci-Fi,2010-07-16,8.8,829.9M\nThe Godfather,Crime,1972-03-24,9.2,246.1M\nAvengers: Endgame,Action,2019-04-26,8.4,2798.0M\nJurassic Park,Sci-Fi,1993-06-11,8.1,1033.0M\nPulp Fiction,Crime,1994-10-14,8.9,213.9M\nThe Dark Knight,Action,2008-07-18,9.0,1005.0M\nForrest Gump,Drama,Unknown,8.8,678.2M\nLa La Land,Musical,2016-12-09,8.0,446.1M\nThe Lion King,Animation,1994-06-15,8.5,968.5M\nToy Story,Animation,1995-11-22,8.3,373.6M\nInterstellar,Sci-Fi,2014-11-07,8.6,677.5M\nGladiator,Action,2000-05-05,8.5,462.0M\nTitanic,Drama,1997-12-19,7.8,2195.0M\nThe Matrix,Sci-Fi,1999-03-31,8.7,466.4M"}
{"purpose": "Standardize and correct inconsistent energy provider names and normalize date formats for accurate billing analysis.", "raw_table": "City,State,EnergyProvider,PricePerKWh,LoanAmount,InvoiceDate\nDallas,TX,Green-Energy,0.12,15000,03/15/2023\nhouston,tx,green_energy,0.14,NaN,2023-04-01\nAustin,Tx,Green Energy,0.11,,15-03-2023\nSan Antonio,TX,SunPower,0.13,12000,2023/03/20\ndallas,tx,Sun-power,0.13,13000,March 22, 2023\nHouston,TX,SunPower,0,14000,2023.03.25\nAustin,TX,GreenEnergy,0.115,12500,2023-3-18\nSan antonio,tx,Sun Power,0.13,NaN,03-21-2023\nDallas,TX,Green-Energy,abc,15000,03/15/2023\nAustin,TX,green-energy,0.12,13000,2023/03/17\nHouston,TX,SunPower,0.14,13500,April 01 2023\nSan Antonio,TX,Sun_power,0.13,12500,2023-03-19\nDallas,TX,,0.12,15000,03-16-2023", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "EnergyProvider", "edits": [{"from": ["Green-Energy", "green_energy", "Green Energy", "GreenEnergy", "green-energy"], "to": "Green Energy"}, {"from": ["SunPower", "Sun-power", "Sun Power", "Sun_power"], "to": "Sun Power"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "columnName": "PricePerKWh", "expression": "if(value.toNumber() > 0, value.toNumber(), null)", "onError": "set-to-null"}, {"op": "core/fill-down", "columnName": "LoanAmount"}, {"op": "core/date-parse", "columnName": "InvoiceDate", "format": "yyyy-MM-dd"}, {"op": "core/text-transform", "columnName": "InvoiceDate", "expression": "value.toString('yyyy-MM-dd')"}], "clean_table": "City,State,EnergyProvider,PricePerKWh,LoanAmount,InvoiceDate\nDallas,TX,Green Energy,0.12,15000,2023-03-15\nHouston,TX,Green Energy,0.14,15000,2023-04-01\nAustin,TX,Green Energy,0.11,15000,2023-03-15\nSan Antonio,TX,Sun Power,0.13,12000,2023-03-20\nDallas,TX,Sun Power,0.13,13000,2023-03-22\nHouston,TX,Sun Power,,14000,2023-03-25\nAustin,TX,Green Energy,0.115,12500,2023-03-18\nSan Antonio,TX,Sun Power,0.13,12500,2023-03-21\nDallas,TX,Green Energy,,15000,2023-03-15\nAustin,TX,Green Energy,0.12,13000,2023-03-17\nHouston,TX,Sun Power,0.14,13500,2023-04-01\nSan Antonio,TX,Sun Power,0.13,12500,2023-03-19\nDallas,TX,Unknown,0.12,15000,2023-03-16"}
{"purpose": "Standardize power plant location names and normalize energy output data formats.", "raw_table": "Plant,Location,EnergyType,OutputMW,Commissioned,OperatorCode\nSolarOne,phoenix_AZ,Solar,25.5,2018-06-15,op_123\nwind-Hawk,dallas_tx,Wind, Forty,2016/03/22,OP-124\nHydro_Lake,,Hydro, 100MW ,2012-11-01,op_125\nPV-South,los_angeles_ca,Solar,30,2017-07-7,op126\nWindhawk,Dallas_TX,wind,45.0,2016-03-22,OP_124\nHydroLake,SEATTLE_WA,Hydro,one hundred,2012-11-01,Op125\nSolarone,PHOENIX_az,solar,26,2018-6-15,op-123\nWind_Hawk,Dallas-TX,WIND,44.5,2016-03-22,OP124\nPV-South,Los Angeles_CA,Solar,30MW,07/07/2017,op126\nWindhawk,Dallas_tx,wind,45MW,2016-3-22,op-124\nHydro_Lake,Seattle_WA,hydro,100,2012-11-01,OP125\nSolarOne,phoenix_az,SOLAR,25.5MW,2018-06-15,op-123\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize Location capitalization and replace underscores/hyphens with spaces", "columnName": "Location", "expression": "value.toLowercase().replace('_',' ').replace('-',' ').split(' ').map(s, s.trim().toTitlecase()).join(' ')"}, {"op": "core/text-transform", "description": "Standardize EnergyType capitalization", "columnName": "EnergyType", "expression": "value.toLowercase().toTitlecase()"}, {"op": "core/text-transform", "description": "Clean OutputMW column to extract numeric values only", "columnName": "OutputMW", "expression": "value.toString().replace(/[^0-9\\.]/g,'').trim()=='' ? null : Number(value.toString().replace(/[^0-9\\.]/g,''))"}, {"op": "core/date-parse", "description": "Parse Commissioned dates into yyyy-MM-dd format", "columnName": "Commissioned", "dateFormat": "yyyy-MM-dd", "onError": "set-to-blank", "onErrorString": "", "mode": "normal"}, {"op": "core/date-parse", "description": "Handle dates with alternate formats", "columnName": "Commissioned", "dateFormat": "MM/dd/yyyy", "onError": "keep-original", "onErrorString": "", "mode": "normal"}, {"op": "core/mass-edit", "description": "Fix common misspellings in OperatorCode", "columnName": "OperatorCode", "edits": [{"from": ["op_123", "op-123", "Op-123", "OP-123", "op123"], "to": "OP123"}, {"from": ["op_124", "OP-124", "op-124", "OP124", "op124"], "to": "OP124"}, {"from": ["op_125", "OP-125", "op-125", "Op125"], "to": "OP125"}, {"from": ["op126", "OP126", "op-126"], "to": "OP126"}]}, {"op": "core/fill-down", "description": "Fill down missing Location values", "columnName": "Location"}], "clean_table": "Plant,Location,EnergyType,OutputMW,Commissioned,OperatorCode\nSolarOne,Phoenix Az,Solar,25.5,2018-06-15,OP123\nwind-Hawk,Dallas Tx,Wind,40,2016-03-22,OP124\nHydro_Lake,Dallas Tx,Hydro,100,2012-11-01,OP125\nPV-South,Los Angeles Ca,Solar,30,2017-07-07,OP126\nWindhawk,Dallas Tx,Wind,45,2016-03-22,OP124\nHydroLake,Seattle Wa,Hydro,100,2012-11-01,OP125\nSolarone,Phoenix Az,Solar,26,2018-06-15,OP123\nWind_Hawk,Dallas Tx,Wind,44.5,2016-03-22,OP124\nPV-South,Los Angeles Ca,Solar,30,2017-07-07,OP126\nWindhawk,Dallas Tx,Wind,45,2016-03-22,OP124\nHydro_Lake,Seattle Wa,Hydro,100,2012-11-01,OP125\nSolarOne,Phoenix Az,Solar,25.5,2018-06-15,OP123\n"}
{"purpose": "Standardize city and state names, fix loan amount formats, and normalize business types for energy sector data analysis.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,solar Installation,15000,$20,000,2023-01-15\nlos Angeles,CA,Wind-Power,18000,18000,15/02/2023\nhouston,tx,solar installation,12000,12,000,2023.03.01\nChicago,IL,GEOTHERMAL,17000,$17,000,2023-04-05\nPhoenix,Az,Biomass,13000,13000,2023/05/12\nphiladelphia,pa,wind power,16000,$16 000,2023-06-20\nSan-antonio,tx,Solar Installation,14000,14000,2023-07-23\nSan Diego,CA,Wind-power,19000,19000,2023-08-30\nDallas,TX,biomass,12500,$12,500,2023-09-15\nSan Jose,Ca,Geothermal,17500,17500,2023-10-10\nAustin,TX,,13500,$13,500,2023-11-05\nJacksonville,fl,SOLAR installation,11500,11500,2023-12-01\nFort Worth,TX,Wind Power,16500,$16,500,2023-12-15\nColumbus,OH,biomass,13000,,2023-12-20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with space in City", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').trim().toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/text-transform", "description": "Standardize BusinessType names", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/solar installation/, 'Solar Installation').replace(/wind[- ]power/, 'Wind Power').replace(/geothermal/, 'Geothermal').replace(/biomass/, 'Biomass').trim()"}, {"op": "core/text-transform", "description": "Clean Price column to numeric string", "columnName": "Price", "expression": "value.replace(/[^\\d]/g, '')"}, {"op": "core/text-transform", "description": "Clean LoanAmount column to numeric string, handle commas, spaces, and missing", "columnName": "LoanAmount", "expression": "value == null || value.trim() == '' ? '' : value.replace(/[^\\d]/g, '')"}, {"op": "core/date-parse", "description": "Parse Date into ISO format yyyy-MM-dd", "columnName": "Date", "format": "auto"}, {"op": "core/mass-edit", "description": "Fill missing BusinessType with 'Solar Installation'", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Solar Installation"}]}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount with Price value", "columnName": "LoanAmount", "edits": []}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount from Price where empty", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,15000,20000,2023-01-15\nLos Angeles,CA,Wind Power,18000,18000,2023-02-15\nHouston,TX,Solar Installation,12000,12000,2023-03-01\nChicago,IL,Geothermal,17000,17000,2023-04-05\nPhoenix,AZ,Biomass,13000,13000,2023-05-12\nPhiladelphia,PA,Wind Power,16000,16000,2023-06-20\nSan Antonio,TX,Solar Installation,14000,14000,2023-07-23\nSan Diego,CA,Wind Power,19000,19000,2023-08-30\nDallas,TX,Biomass,12500,12500,2023-09-15\nSan Jose,CA,Geothermal,17500,17500,2023-10-10\nAustin,TX,Solar Installation,13500,13500,2023-11-05\nJacksonville,FL,Solar Installation,11500,11500,2023-12-01\nFort Worth,TX,Wind Power,16500,16500,2023-12-15\nColumbus,OH,Biomass,13000,13000,2023-12-20"}
{"purpose": "Clean and normalize movie dataset with inconsistent titles, dates, and revenue formats.", "raw_table": "MovieTitle,ReleaseDate,Genre,BoxOffice,Rating\nIncePtion,07/16/2010,SCI-FI,829.89M,8.8\navatar,12-18-2009,science fiction,2.847B,7.8\nThe Godfather,03/24/1972,Crime,134_966_411,9.2\npulp-fiction,,crime,,8.9\nThe Shawshank Redemption,1994/09/23,Drama,28341469,9.3\nstar wars: episode IV,25 May 1977,Sci-fi,775.4 million,8.6\nForrest Gump,07-06-1994,Drama,678_000_000,8.8\nJurrasic Park,06/11/1993,Sci-Fi,1.03B,8.1\nThe Dark Knight,2008-07-18,action,1,005,973,645,9.0\nFight Club,10/15/1999,Drama,100.9M,8.8\nThe Matrix,31-Mar-1999,Sci-Fi,463.5M,8.7\nGladiator,2000/05/05,Action,457_640_427,8.5\nInception,16 Jul 2010,Sci-Fi,,8.8\nCasablanca,,Romance,1.05M,\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and remove underscores/hyphens from MovieTitle", "columnName": "MovieTitle", "expression": "value.replace(/[_-]/g, ' ').trim().toTitlecase()"}, {"op": "core/mass-edit", "description": "Fix common misspellings in MovieTitle", "columnName": "MovieTitle", "edits": [{"from": ["IncePtion", "Jurrasic Park"], "to": "Inception"}, {"from": ["Jurrasic Park"], "to": "Jurassic Park"}]}, {"op": "core/text-transform", "description": "Standardize Genre capitalization and naming", "columnName": "Genre", "expression": "value.toLowercase().replace('science fiction','sci-fi').replace('sci-fi','Sci-Fi').replace('crime','Crime').replace('action','Action').replace('drama','Drama').replace('romance','Romance').trim()"}, {"op": "core/date-parse", "description": "Parse ReleaseDate to ISO format", "columnName": "ReleaseDate", "mode": "lenient", "dateFormat": "auto", "skipMalformed": true}, {"op": "core/text-transform", "description": "Clean BoxOffice: remove commas, underscores, words, convert B/M to numbers", "columnName": "BoxOffice", "expression": "value.toLowercase().replace(/[,_]/g,'').replace(/b|billion/g,'000000000').replace(/m|million/g,'000000').replace(/[^0-9]/g,'')"}, {"op": "core/text-transform", "description": "Convert BoxOffice strings to integers", "columnName": "BoxOffice", "expression": "value == '' ? null : value.toNumber()"}, {"op": "core/mass-edit", "description": "Fix inconsistent ratings: convert to number", "columnName": "Rating", "edits": [{"from": [""], "to": null}]}], "clean_table": "MovieTitle,ReleaseDate,Genre,BoxOffice,Rating\nInception,2010-07-16,Sci-Fi,829890000,8.8\nAvatar,2009-12-18,Sci-Fi,2847000000,7.8\nThe Godfather,1972-03-24,Crime,134966411,9.2\nPulp Fiction,,Crime,,8.9\nThe Shawshank Redemption,1994-09-23,Drama,28341469,9.3\nStar Wars: Episode Iv,1977-05-25,Sci-Fi,775400000,8.6\nForrest Gump,1994-07-06,Drama,678000000,8.8\nJurassic Park,1993-06-11,Sci-Fi,1030000000,8.1\nThe Dark Knight,2008-07-18,Action,1005973645,9.0\nFight Club,1999-10-15,Drama,100900000,8.8\nThe Matrix,1999-03-31,Sci-Fi,463500000,8.7\nGladiator,2000-05-05,Action,457640427,8.5\nInception,2010-07-16,Sci-Fi,,8.8\nCasablanca,,Romance,1050000,\n"}
{"purpose": "Clean and standardize telecommunications customer data including city names, business types, and date formats.", "raw_table": "CustomerID,City,State,BusinessType,Price,LoanAmount,SignupDate\n101,New york,ny,Retail-store,199.99,5000,01-15-2023\n102,los_angeles,CA,retail Store,299.95,7000,2023/02/20\n103,Chicago,IL,Wholesale,149.99,,March 3 2023\n104,Hous-t-on,TX,wholsale,399.00,10000,2023-03-15\n105,Miami,FL,retail-store,189.95,4500,15/04/2023\n106,Boston,ma,Distributor,229.99,6500,2023.04.20\n107,,WA,Retail Store,199.00,5300,04-25-2023\n108,Seattle,wa,Dis-tributor,219.99,6000,April 30 2023\n109,Denver,CO,retail_store,209.99,5800,2023/05/05\n110,Atlanta,Ga,Distributor-,239.99,6200,05-10-2023\n111,New York,NY,RETAIL Store,199.99,5000,2023-01-15\n112,los-angeles,ca,Wholesale,149.50,7200,2023/02/21\n113,Chicago,IL,Distributor,219.95,6800,2023-03-05\n114,Houston,TX,Retail store,189.00,4700,2023-03-18\n115,Miami,FL,Wholesale,159.99,5000,2023-04-16", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names by replacing underscores and hyphens with spaces, then title case", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').toTitlecase()"}, {"op": "core/mass-edit", "description": "Fix common misspellings and variants in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["wholsale", "wholsale", "wholsale", "wholsale"], "to": "Wholesale"}, {"from": ["retail-store", "retail_store", "Retail-store", "Retail Store", "RETAIL Store", "Retail store"], "to": "Retail Store"}, {"from": ["Distributor-", "Dis-tributor", "Dis-tributor"], "to": "Distributor"}]}, {"op": "core/fill-down", "description": "Fill down missing City values", "columnName": "City"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Fix Price column to float with 2 decimals", "columnName": "Price", "expression": "value.toNumber().toFixed(2)"}, {"op": "core/text-transform", "description": "Fix LoanAmount column to integer, fill missing with 0", "columnName": "LoanAmount", "expression": "if(value == null || value == '') 0 else value.toNumber()"}, {"op": "core/date-parse", "description": "Parse SignupDate to ISO format (yyyy-MM-dd)", "columnName": "SignupDate", "format": "auto", "onError": "keep-original", "onBlank": "keep-original"}, {"op": "core/text-transform", "description": "Format SignupDate to yyyy-MM-dd string", "columnName": "SignupDate", "expression": "if(isDate(value)) value.toDate().toString('yyyy-MM-dd') else value"}], "clean_table": "CustomerID,City,State,BusinessType,Price,LoanAmount,SignupDate\n101,New York,NY,Retail Store,199.99,5000,2023-01-15\n102,Los Angeles,CA,Retail Store,299.95,7000,2023-02-20\n103,Chicago,IL,Wholesale,149.99,0,2023-03-03\n104,Houston,TX,Wholesale,399.00,10000,2023-03-15\n105,Miami,FL,Retail Store,189.95,4500,2023-04-15\n106,Boston,MA,Distributor,229.99,6500,2023-04-20\n107,Boston,WA,Retail Store,199.00,5300,2023-04-25\n108,Seattle,WA,Distributor,219.99,6000,2023-04-30\n109,Denver,CO,Retail Store,209.99,5800,2023-05-05\n110,Atlanta,GA,Distributor,239.99,6200,2023-05-10\n111,New York,NY,Retail Store,199.99,5000,2023-01-15\n112,Los Angeles,CA,Wholesale,149.50,7200,2023-02-21\n113,Chicago,IL,Distributor,219.95,6800,2023-03-05\n114,Houston,TX,Retail Store,189.00,4700,2023-03-18\n115,Miami,FL,Wholesale,159.99,5000,2023-04-16"}
{"purpose": "Standardize city and state names, normalize business types, fix date formats, and clean price and loan amount fields for government grant data analysis.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,Restaurant, 120000 ,$50000,01/15/2023\nlos-angeles,CA,restuarant,115000,$45000,2023-02-01\nCHICAGO,il,retail, 98000 ,$40000,15-03-2023\nhouston,Tx,RETAIL,100000,35000,2023/04/10\nphoenix,az,retail, ,$30000,2023-05-20\nphiladelphia,PA,Consulting,130000,$55000,06/25/2023\nsan antonio,tx,consulting,125000,$50000,2023-07-15\nsan_diego,CA,Consulting,123000,missing,08-20-2023\n,CA,restaurant,110000,$48000,09/05/2023\ndallas,Tx,Restau-rant,118000,$47000,2023.10.12\nsan jose,CA,retail,105000,$40000,11-11-2023\naustin,TX,retail,99000,$38000,2023-12-01\njacksonville,fl,consulting,115000,$45000,12/20/2023\nfort worth,Tx,consulting,117000,$46000,2023-12-31\ncolumbus,OH,restaurant,112000,$49000,01-01-2024", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names by removing underscores and hyphens, and capitalizing each word", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').split(' ').map(w, w.toTitleCase()).join(' ')", "onError": "keep-original"}, {"op": "core/mass-edit", "description": "Fix State abbreviations to uppercase two-letter codes", "columnName": "State", "edits": [{"from": ["ny"], "to": "NY"}, {"from": ["il"], "to": "IL"}, {"from": ["Tx", "tx"], "to": "TX"}, {"from": ["az"], "to": "AZ"}, {"from": ["fl"], "to": "FL"}]}, {"op": "core/mass-edit", "description": "Correct common misspellings and normalize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["restuarant", "Restau-rant", "restaurant", "Restaurant", "restuarant"], "to": "Restaurant"}, {"from": ["retail", "RETAIL", "Retail"], "to": "Retail"}, {"from": ["consulting", "Consulting", "Consultant"], "to": "Consulting"}]}, {"op": "core/text-transform", "description": "Clean Price column by trimming and converting to number, fill missing with 0", "columnName": "Price", "expression": "value.trim() == '' ? 0 : value.trim().replace(/[^0-9]/g, '').toNumber()", "onError": "set-to-blank"}, {"op": "core/text-transform", "description": "Clean LoanAmount by removing $ and converting to number, fill 'missing' with null", "columnName": "LoanAmount", "expression": "value.toLowerCase() == 'missing' || value.trim() == '' ? null : value.replace(/[^0-9]/g, '').toNumber()", "onError": "set-to-blank"}, {"op": "core/date-parse", "description": "Parse Date column to ISO format", "columnName": "Date", "dateFormat": "dd-MM-yyyy", "guessCellType": true, "mode": "lenient"}, {"op": "core/fill-down", "description": "Fill down missing City values", "columnName": "City"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,120000,50000,2023-01-15T00:00:00Z\nLos Angeles,CA,Restaurant,115000,45000,2023-02-01T00:00:00Z\nChicago,IL,Retail,98000,40000,2023-03-15T00:00:00Z\nHouston,TX,Retail,100000,35000,2023-04-10T00:00:00Z\nPhoenix,AZ,Retail,0,30000,2023-05-20T00:00:00Z\nPhiladelphia,PA,Consulting,130000,55000,2023-06-25T00:00:00Z\nSan Antonio,TX,Consulting,125000,50000,2023-07-15T00:00:00Z\nSan Diego,CA,Consulting,123000,null,2023-08-20T00:00:00Z\nSan Diego,CA,Restaurant,110000,48000,2023-09-05T00:00:00Z\nDallas,TX,Restaurant,118000,47000,2023-10-12T00:00:00Z\nSan Jose,CA,Retail,105000,40000,2023-11-11T00:00:00Z\nAustin,TX,Retail,99000,38000,2023-12-01T00:00:00Z\nJacksonville,FL,Consulting,115000,45000,2023-12-20T00:00:00Z\nFort Worth,TX,Consulting,117000,46000,2023-12-31T00:00:00Z\nColumbus,OH,Restaurant,112000,49000,2024-01-01T00:00:00Z"}
{"purpose": "Standardize and correct inconsistent city names and normalize business types across telecommunications loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew-york,NY,Cellular,1500,20000,2023/04/15\nLos_angeles,CA,wireLess,1200,15000,15-05-2023\nCHICAGO,il,Cell-tower,1300,18000,2023-06-01\nhouston,TX,Cellular,NaN,16000,06/20/2023\nphoenix,Az,wireless,1100,NaN,2023.07.10\nphiladelphia,pa,Cellular,1400,17000,2023/08/05\nsan_antonio,tx,CELL-tower,1250,15500,2023-09-12\nsan-diego,CA,wireless,1150,14000,2023/10/01\ndallas,tx,Cellular,1300,16500,2023-11-11\nsan jose,CA,cellular,1350,17500,2023/12/05\nAustin,Tx,wireLess,NaN,NaN,2023/13/01\njacksonville,fl,cellular,1200,15000,2023-01-20\nfort worth,Tx,wireLess,1250,16000,2023-02-15\ncolumbus,OH,Cell Tower,1100,14500,2023/03/10\ncharlotte,NC,cellular,1300,17000,2023-04-01", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["new-york"], "to": "New York"}, {"from": ["Los_angeles"], "to": "Los Angeles"}, {"from": ["san_antonio"], "to": "San Antonio"}, {"from": ["san-diego"], "to": "San Diego"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()", "onError": "keep-original", "repeat": false}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["Cellular", "cellular", "CELLULAR"], "to": "Cellular"}, {"from": ["wireLess", "wireless", "Wireless", "wireLess"], "to": "Wireless"}, {"from": ["Cell-tower", "CELL-tower", "Cell Tower", "cell tower", "CELL Tower"], "to": "Cell Tower"}]}, {"op": "core/fill-down", "columnName": "Price"}, {"op": "core/fill-down", "columnName": "LoanAmount"}, {"op": "core/text-transform", "columnName": "Price", "expression": "isNumeric(value) ? Number(value) : null", "onError": "set-to-null"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "isNumeric(value) ? Number(value) : null", "onError": "set-to-null"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value.replace(/(\\d{2})-(\\d{2})-(\\d{4})/, '$3-$2-$1').replace(/\\./g, '-').replace(/\\//g, '-')", "onError": "keep-original"}, {"op": "core/date-parse", "columnName": "Date", "format": "yyyy-MM-dd"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Cellular,1500,20000,2023-04-15\nLos Angeles,CA,Wireless,1200,15000,2023-05-15\nChicago,IL,Cell Tower,1300,18000,2023-06-01\nHouston,TX,Cellular,1300,16000,2023-06-20\nPhoenix,AZ,Wireless,1100,16000,2023-07-10\nPhiladelphia,PA,Cellular,1400,17000,2023-08-05\nSan Antonio,TX,Cell Tower,1250,15500,2023-09-12\nSan Diego,CA,Wireless,1150,14000,2023-10-01\nDallas,TX,Cellular,1300,16500,2023-11-11\nSan Jose,CA,Cellular,1350,17500,2023-12-05\nAustin,TX,Wireless,1300,17500,2023-01-13\nJacksonville,FL,Cellular,1200,15000,2023-01-20\nFort Worth,TX,Wireless,1250,16000,2023-02-15\nColumbus,OH,Cell Tower,1100,14500,2023-03-10\nCharlotte,NC,Cellular,1300,17000,2023-04-01"}
{"purpose": "Clean and standardize energy business types, normalize city and state names, correct date formats, and fix numeric fields.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,solar farm,12000,50000,2023/03/15\nlos-angeles,Ca,wind_TURBINE,8500,45000,15-04-2023\nhouston,TX,HydroPlant,NaN,40000,2023-05-10\nphoenix,az,solar_farm,11000,,2023/06/01\nphiladelphia,PA,wind turbine,10000,48000,2023-07-20\nsan antonio,TX,Solar Farm,10500,47000,20/08/2023\nsan-diego,ca,solar_farm,11500,45000,2023/09/15\ndallas,Tx,wind turbine,9000,43000,2023.10.10\nsan jose,ca,hyDroPlant,9500,42000,10-11-2023\naustin,tx,solar_farm,10000,44000,2023/12/01\njacksonville,fl,wind_turbine,8800,41000,2023-13-01\nfort worth,TX,solar-farm,11500,46000,2023/11/05\ncolumbus,oh,hydroplant,9700,43000,2023-12-20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City names: replace underscores and hyphens with spaces, capitalize each word", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').split(' ').map(w, w.substring(0,1).toUppercase() + w.substring(1).toLowercase()).join(' ')"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Standardize BusinessType values to lowercase, replace underscores and hyphens with spaces", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[_-]/g, ' ')"}, {"op": "core/mass-edit", "description": "Correct common BusinessType misspellings", "columnName": "BusinessType", "edits": [{"from": ["hydroplant", "hydro plant", "hydroPlant", "hyDroPlant"], "to": "hydro plant"}, {"from": ["solar farm", "solar-farm", "solar_farm"], "to": "solar farm"}, {"from": ["wind turbine", "wind_turbine"], "to": "wind turbine"}]}, {"op": "core/text-transform", "description": "Replace NaN and empty Price and LoanAmount with null", "columnName": "Price", "expression": "value.match(/^[0-9]+$/) ? value : null"}, {"op": "core/text-transform", "description": "Replace NaN and empty LoanAmount with null", "columnName": "LoanAmount", "expression": "value.match(/^[0-9]+$/) ? value : null"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/date-parse", "description": "Parse and normalize Date column to yyyy-MM-dd", "columnName": "Date", "expression": "value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/) ? value.replace(/\\//g, '-') : (value.match(/\\d{2}-\\d{2}-\\d{4}/) ? value.split('-').reverse().join('-') : (value.match(/\\d{4}-\\d{2}-\\d{2}/) ? value : (value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/) ? value.split('/').reverse().join('-') : (value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/) ? value.replace(/\\./g, '-') : value))))"}, {"op": "core/text-transform", "description": "Fix invalid dates to empty", "columnName": "Date", "expression": "var d = Date.parse(value); d ? value : ''"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,solar farm,12000,50000,2023-03-15\nLos Angeles,CA,wind turbine,8500,45000,2023-04-15\nHouston,TX,hydro plant,,40000,2023-05-10\nPhoenix,AZ,solar farm,11000,40000,2023-06-01\nPhiladelphia,PA,wind turbine,10000,48000,2023-07-20\nSan Antonio,TX,solar farm,10500,47000,2023-08-20\nSan Diego,CA,solar farm,11500,45000,2023-09-15\nDallas,TX,wind turbine,9000,43000,2023-10-10\nSan Jose,CA,hydro plant,9500,42000,2023-11-10\nAustin,TX,solar farm,10000,44000,2023-12-01\nJacksonville,FL,wind turbine,8800,41000,\nFort Worth,TX,solar farm,11500,46000,2023-11-05\nColumbus,OH,hydro plant,9700,43000,2023-12-20"}
{"purpose": "Standardize energy provider names and fix inconsistent date and numeric formats.", "raw_table": "City,State,Provider,Price_per_kWh,Loan_Amount,Contract_Start\nNew york,NY,Green_energy,0.12,10000,2023/01/15\nlos angeles,CA,SunPower, 0.14,9000,15-02-2023\nChicago,il,green-Energy,0.113,,2023-03-01\nhouston,TX,Sun power,0.13,8500,03/15/2023\nPHOENIX,AZ,Green_energy,0.12,10500,2023.04.01\nphiladelphia,PA,Sun-Power,0.15,9200,2023/04/15\nsan antonio,TX,greenenergy,0.11,9500,Apr 30 2023\nsan diego,ca,SunPower,0.14,,2023-05-15\nDallas,Tx,Sun_power,0.13,9800,2023/06/01\nsan jose,CA,green_energy,0.115,9700,06-15-2023\nAustin,tx,SunPower,0.14,9400,2023/07/01\njacksonville,fl,Green-Energy, 0.12,,2023-07-15\nfort worth,TX,SunPower,0.13,9100,2023.08.01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace in Price_per_kWh", "columnName": "Price_per_kWh", "expression": "trim(value)"}, {"op": "core/mass-edit", "description": "Standardize Provider names", "columnName": "Provider", "edits": [{"from": ["Green_energy", "green-Energy", "greenenergy", "green_energy", "Green-Energy"], "to": "Green Energy"}, {"from": ["SunPower", "Sun power", "Sun-Power", "Sun_power"], "to": "SunPower"}]}, {"op": "core/text-transform", "description": "Capitalize City names", "columnName": "City", "expression": "value.toLowercase().split(' ').map(s, s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Upper case State codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Replace missing Loan_Amount with '0'", "columnName": "Loan_Amount", "edits": [{"from": [""], "to": "0"}]}, {"op": "core/text-transform", "description": "Normalize dates to yyyy-MM-dd", "columnName": "Contract_Start", "expression": "if(value.match(/^\\d{4}\\/\\d{2}\\/\\d{2}$/)) { value.replace('/','-').replace('/','-') } else if(value.match(/^\\d{2}-\\d{2}-\\d{4}$/)) { var parts = value.split('-'); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0') } else if(value.match(/^\\d{4}-\\d{2}-\\d{2}$/)) { value } else if(value.match(/^\\d{2}\\/\\d{2}\\/\\d{4}$/)) { var parts = value.split('/'); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0') } else if(value.match(/^\\d{4}\\.\\d{2}\\.\\d{2}$/)) { value.replace(/\\./g,'-') } else if(value.match(/^[A-Z][a-z]{2} \\d{2} \\d{4}$/)) { var d = new Date(value); d.getFullYear() + '-' + (d.getMonth()+1).toString().padStart(2,'0') + '-' + d.getDate().toString().padStart(2,'0') } else { value }"}], "clean_table": "City,State,Provider,Price_per_kWh,Loan_Amount,Contract_Start\nNew York,NY,Green Energy,0.12,10000,2023-01-15\nLos Angeles,CA,SunPower,0.14,9000,2023-02-15\nChicago,IL,Green Energy,0.113,0,2023-03-01\nHouston,TX,SunPower,0.13,8500,2023-03-15\nPhoenix,AZ,Green Energy,0.12,10500,2023-04-01\nPhiladelphia,PA,SunPower,0.15,9200,2023-04-15\nSan Antonio,TX,Green Energy,0.11,9500,2023-04-30\nSan Diego,CA,SunPower,0.14,0,2023-05-15\nDallas,TX,SunPower,0.13,9800,2023-06-01\nSan Jose,CA,Green Energy,0.115,9700,2023-06-15\nAustin,TX,SunPower,0.14,9400,2023-07-01\nJacksonville,FL,Green Energy,0.12,0,2023-07-15\nFort Worth,TX,SunPower,0.13,9100,2023-08-01"}
{"purpose": "Clean and standardize telecommunications customer records with inconsistent city names, business types, and date formats.", "raw_table": "City,State,BusinessType,Price,LoanAmount,SignupDate\nNew_york,NY,telecom,-$1200,5000,12/01/2021\nlos-angeles,CA,Tele-Com,850,4500,2021-11-15\nChicago,il,Bussiness,950,,15-12-2021\nhouston,TX,telecom,1000,7000,01/13/22\nPhoenix,Az,Tele-com,-850,4000,2021/12/01\nPhiladelphia,PA,telecom,,6500,12-15-2021\nSan-antonio,TX,bussiness,900,5500,2021.12.05\nSan diego,ca,Telecom,1050,6000,2021-11-30\nDallas,TX,tele-com,1100,-6000,2021/12/10\nSan_jose,CA,Business,1000,5000,13/12/2021\nAustin,tx,telecom,950,6200,\nJacksonville,FL,Telecom,900,5800,2021-12-02\nFort-worth,TX,Bussiness,1050,5900,2021-12-04\nColumbus,OH,telecom,1000,6000,2021-12-01\nCharlotte,NC,Tele-com,980,6100,2021-12-03", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["los-angeles"], "to": "Los Angeles"}, {"from": ["San-antonio"], "to": "San Antonio"}, {"from": ["San_jose"], "to": "San Jose"}, {"from": ["houston"], "to": "Houston"}, {"from": ["San diego"], "to": "San Diego"}, {"from": ["Fort-worth"], "to": "Fort Worth"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["tele-com", "Tele-com", "telecom", "Telecom", "Tele-com", "Tele-com"], "to": "Telecom"}, {"from": ["Bussiness", "bussiness", "Business"], "to": "Business"}, {"from": ["Tele-com"], "to": "Telecom"}, {"from": ["Tele-Com", "Tele-com"], "to": "Telecom"}, {"from": ["Tele-com"], "to": "Telecom"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "if(value == null || value.trim() == '') null else value.replace('-','$').replace('$','').toNumber()"}, {"op": "core/text-transform", "columnName": "Price", "expression": "if(value < 0, -value, value)"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "if(value == null || value.trim() == '' || value.toNumber() < 0, null, value.toNumber())"}, {"op": "core/date-parse", "columnName": "SignupDate", "format": "MM/dd/yyyy", "mode": "cells"}, {"op": "core/text-transform", "columnName": "SignupDate", "expression": "if(isDate(value), value.toDate('yyyy-MM-dd'), \n  if(value.match(/\\d{4}-\\d{2}-\\d{2}/), value, \n    if(value.match(/\\d{2}-\\d{2}-\\d{4}/), value.split('-')[2] + '-' + value.split('-')[1] + '-' + value.split('-')[0], \n      if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/), value.replace(/\\//g, '-'), \n        null))))"}, {"op": "core/fill-down", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,SignupDate\nNew York,NY,Telecom,1200,5000,2021-12-01\nLos Angeles,CA,Telecom,850,4500,2021-11-15\nChicago,IL,Business,950,4500,2021-12-15\nHouston,TX,Telecom,1000,7000,2022-01-13\nPhoenix,AZ,Telecom,850,4000,2021-12-01\nPhiladelphia,PA,Telecom,0,6500,2021-12-15\nSan Antonio,TX,Business,900,5500,2021-12-05\nSan Diego,CA,Telecom,1050,6000,2021-11-30\nDallas,TX,Telecom,1100,6000,2021-12-10\nSan Jose,CA,Business,1000,5000,2021-12-13\nAustin,TX,Telecom,950,6200,\nJacksonville,FL,Telecom,900,5800,2021-12-02\nFort Worth,TX,Business,1050,5900,2021-12-04\nColumbus,OH,Telecom,1000,6000,2021-12-01\nCharlotte,NC,Telecom,980,6100,2021-12-03"}
{"purpose": "Clean and standardize city and business type names; fix date formats and normalize numeric fields in telecommunications loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,NY,telecom,1000,50000,01/15/2023\nLOS ANGELES,CA,Tele-Com,1500,75000,2023-02-28\nChicAgo,IL,Telecom,1200,60000,15-03-2023\nhouston,tx,tele_comm,1100,55000,03/20/23\nphoenix,AZ,,1300,65000,2023/04/10\nphiladelphia,PA,telecom,1400,missing,04-25-2023\nsan antonio,tx,Telecom,missing,70000,2023.05.15\nsan-diego,CA,tele-com,1250,62000,06/01/2023\nDallas,Tx,Telecom,,58000,2023-06-10\nsan jose,ca,tele_comm,1350,68000,06-20-2023\nAustin,TX,Telecom,1280,63000,2023/07/01\njacksonville,fl,telecom,1150,59000,07/15/2023\nfort worth,TX,Tele-com,1300,64000,2023-08-01\ncolumbus,OH,tele_comm,1200,61000,08/15/2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize City names properly", "columnName": "City", "expression": "value.toTitlecase().replace(/[-_]/, ' ')"}, {"op": "core/text-transform", "description": "Uppercase State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["tele-com", "tele_comm", "Tele-Com", "Tele-com", "tele_comm"], "to": "Telecom"}]}, {"op": "core/mass-edit", "description": "Fill missing BusinessType with 'Telecom'", "columnName": "BusinessType", "edits": [{"from": [null, "", " "], "to": "Telecom"}]}, {"op": "core/mass-edit", "description": "Replace 'missing' in Price and LoanAmount with blank for later fixes", "columnName": "Price", "edits": [{"from": ["missing"], "to": ""}]}, {"op": "core/mass-edit", "description": "Replace 'missing' in LoanAmount with blank for later fixes", "columnName": "LoanAmount", "edits": [{"from": ["missing"], "to": ""}]}, {"op": "core/fill-down", "description": "Fill down missing Price values with previous non-empty", "columnName": "Price"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values with previous non-empty", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Normalize date formats to yyyy-MM-dd", "columnName": "Date", "expression": "if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/)) { \n  var parts = value.split('/');\n  parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0')\n} else if (value.match(/\\d{4}-\\d{2}-\\d{2}/)) { value }\n else if (value.match(/\\d{2}-\\d{2}-\\d{4}/)) {\n   var parts = value.split('-');\n   parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0')\n } else if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/)) {\n   var parts = value.split('/');\n   parts[0] + '-' + parts[1].padStart(2,'0') + '-' + parts[2].padStart(2,'0')\n } else if(value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/)) {\n   var parts = value.split('.');\n   parts[0] + '-' + parts[1].padStart(2,'0') + '-' + parts[2].padStart(2,'0')\n } else if(value.match(/\\d{2}-\\d{2}-\\d{2}/)) {\n   var parts = value.split('-');\n   '20' + parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0')\n } else value"}, {"op": "core/text-transform", "description": "Convert Price to numeric string (remove blanks or non-numeric)", "columnName": "Price", "expression": "isNaN(value) || value == '' ? '0' : value"}, {"op": "core/text-transform", "description": "Convert LoanAmount to numeric string (remove blanks or non-numeric)", "columnName": "LoanAmount", "expression": "isNaN(value) || value == '' ? '0' : value"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom,1000,50000,2023-01-15\nLos Angeles,CA,Telecom,1500,75000,2023-02-28\nChicago,IL,Telecom,1200,60000,2023-03-15\nHouston,TX,Telecom,1100,55000,2023-03-20\nPhoenix,AZ,Telecom,1300,65000,2023-04-10\nPhiladelphia,PA,Telecom,1400,0,2023-04-25\nSan Antonio,TX,Telecom,1400,70000,2023-05-15\nSan Diego,CA,Telecom,1250,62000,2023-06-01\nDallas,TX,Telecom,1250,58000,2023-06-10\nSan Jose,CA,Telecom,1350,68000,2023-06-20\nAustin,TX,Telecom,1280,63000,2023-07-01\nJacksonville,FL,Telecom,1150,59000,2023-07-15\nFort Worth,TX,Telecom,1300,64000,2023-08-01\nColumbus,OH,Telecom,1200,61000,2023-08-15"}
{"purpose": "Clean and standardize telecommunications customer data including city names, business types, dates, and numeric formats.", "raw_table": "CustomerID,City,State,BusinessType,Price,LoanAmount,SubscriptionDate\n1001,New-york,NY,small_biz,150.00,5,000,01/15/2021\n1002,los Angeles,Ca,SMALL\u2013Biz,200,4500,2021-02-30\n1003,CHICAGO,il,corprate, 175.5 ,4000.75,3/12/2021\n1004,,TX,enterprise,NA,7000,04-01-2021\n1005,Houston,tx,enterprise,180.00,,2021/04/15\n1006,San francisco,CA,small-biz,one hundred,3000,15/05/2021\n1007,Seattle,WA,corporate,210,3500,2021-13-01\n1008,miami,fl,smallBiz,170.25,4500,2021/06/20\n1009,Atlanta,GA,enterprise,190.00,4000,2021-07-15\n1010,Dallas,TX,SMALL BIZ,160.00,3800,07/25/2021\n1011,Denver,CO,corparate,155.75,3900,2021/07/30\n1012,New York,NY,small_biz,165.00,4200,2021-08-05\n1013,Los-Angeles,CA,enterprise,195,5000,08-10-2021\n1014,Chicago,IL,Corporate,185.50,4500,2021-09-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from Price", "columnName": "Price", "engineConfig": {"facets": []}, "expression": "value.trim()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["small_biz", "SMALL\u2013Biz", "small-biz", "smallBiz", "SMALL BIZ"], "to": "Small Business"}, {"from": ["corprate", "corparate", "Corporate"], "to": "Corporate"}, {"from": ["enterprise"], "to": "Enterprise"}]}, {"op": "core/text-transform", "description": "Fix Price values with text and convert to number, set 'NA' to null", "columnName": "Price", "expression": "if(value.toLowercase() == 'na' || value == '', null, if(value.toLowercase() == 'one hundred', 100, toNumber(value)))"}, {"op": "core/text-transform", "description": "Remove commas from LoanAmount and convert to number", "columnName": "LoanAmount", "expression": "if(value == '' || value == null, null, toNumber(value.replaceAll(\",\", \"\")))"}, {"op": "core/fill-down", "description": "Fill down missing City values", "columnName": "City"}, {"op": "core/text-transform", "description": "Capitalize city names properly and replace hyphens/underscores with spaces", "columnName": "City", "expression": "value.replaceAll(\"[-_]\", \" \").toTitlecase()"}, {"op": "core/text-transform", "description": "Uppercase State codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/date-parse", "description": "Parse SubscriptionDate to ISO standard", "columnName": "SubscriptionDate", "pattern": "various"}, {"op": "core/mass-edit", "description": "Fix invalid dates in SubscriptionDate", "columnName": "SubscriptionDate", "edits": [{"from": ["2021-02-30", "2021-13-01"], "to": null}]}], "clean_table": "CustomerID,City,State,BusinessType,Price,LoanAmount,SubscriptionDate\n1001,New York,NY,Small Business,150,5000,2021-01-15\n1002,Los Angeles,CA,Small Business,200,4500,null\n1003,Chicago,IL,Corporate,175.5,4000.75,2021-03-12\n1004,Chicago,TX,Enterprise,null,7000,2021-04-01\n1005,Houston,TX,Enterprise,180,null,2021-04-15\n1006,San Francisco,CA,Small Business,100,3000,2021-05-15\n1007,Seattle,WA,Corporate,210,3500,null\n1008,Miami,FL,Small Business,170.25,4500,2021-06-20\n1009,Atlanta,GA,Enterprise,190,4000,2021-07-15\n1010,Dallas,TX,Small Business,160,3800,2021-07-25\n1011,Denver,CO,Corporate,155.75,3900,2021-07-30\n1012,New York,NY,Small Business,165,4200,2021-08-05\n1013,Los Angeles,CA,Enterprise,195,5000,2021-08-10\n1014,Chicago,IL,Corporate,185.5,4500,2021-09-01"}
{"purpose": "Clean and standardize movie dataset including titles, genres, release dates, and box office revenues.", "raw_table": "MovieID,Title,Genre,ReleaseDate,BoxOffice\n1,The avengers,Action-Adventure,4/25/2012,1.519B\n2,harry potter and the sorcerers stone,Fantasy,11-16-2001,974M\n3,avatar,scifi,12/18/09,2.847b\n4,STAR_WARS: Episode IV, Sci-Fi,5-25-1977,775 million\n5,titanic,Drama-Romance,12/19/1997,2.187B\n6,Jurassic-park,Adventure sci-fi,6/11/93,1.046B\n7,Inception,action,07/16/2010,829.9M\n8,Forrest gump,Drama,7/6/94,678 million\n9,the dark knight,Action,7/18/2008,1.005B\n10,The_lord_of_the_rings: The return of the king, Fantasy Adventure,12/17/2003,1.142B\n11,Spider-man,Action_Adventure,5/3/2002,821 Million\n12,Black Panther,action,2/16/2018,1.347b\n13,The godfather,Crime-Drama,3/24/1972,246m\n14,Avengers: Endgame,Action-Adventure,4/26/2019,2.798B\n15,The Lion King,Animation,6/24/1994,968 million", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize Title capitalization and replace underscores/hyphens with spaces", "columnName": "Title", "expression": "value.replace(/[_-]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize Genre capitalization and replace hyphens/underscores with spaces", "columnName": "Genre", "expression": "value.replace(/[-_]/g, ' ').toTitlecase().replace(/\\s+/g, ' ').trim()"}, {"op": "core/text-transform", "description": "Parse ReleaseDate to yyyy-MM-dd format", "columnName": "ReleaseDate", "expression": "value.toDate('M/d/yyyy','M-d-yyyy','MM/dd/yy','M/d/yy','MM/dd/yyyy').toString('yyyy-MM-dd')"}, {"op": "core/text-transform", "description": "Clean and standardize BoxOffice values to numeric billions with 3 decimals", "columnName": "BoxOffice", "expression": "if(value.toLowercase().contains('b')) { parseFloat(value.toLowercase().replace(/[^0-9\\.]/g, '')) } else if (value.toLowercase().contains('million')) { parseFloat(value.toLowercase().replace(/[^0-9\\.]/g, ''))/1000 } else if (value.toLowercase().contains('m')) { parseFloat(value.toLowercase().replace(/[^0-9\\.]/g, ''))/1000 } else { null }.toFixed(3)"}, {"op": "core/mass-edit", "description": "Correct known Genre misspellings", "columnName": "Genre", "edits": [{"from": ["Scifi", "Sci Fi", "Sci-Fi", "Scifi"], "to": "Sci-Fi"}, {"from": ["Actionadventure", "Action Adventure", "Actionadventure"], "to": "Action Adventure"}]}, {"op": "core/mass-edit", "description": "Fix ReleaseDate nulls if any", "columnName": "ReleaseDate", "edits": [{"from": [""], "to": "Unknown"}]}], "clean_table": "MovieID,Title,Genre,ReleaseDate,BoxOffice\n1,The Avengers,Action Adventure,2012-04-25,1.519\n2,Harry Potter And The Sorcerers Stone,Fantasy,2001-11-16,0.974\n3,Avatar,Sci-Fi,2009-12-18,2.847\n4,Star Wars: Episode Iv,Sci-Fi,1977-05-25,0.775\n5,Titanic,Drama Romance,1997-12-19,2.187\n6,Jurassic Park,Adventure Sci-Fi,1993-06-11,1.046\n7,Inception,Action,2010-07-16,0.830\n8,Forrest Gump,Drama,1994-07-06,0.678\n9,The Dark Knight,Action,2008-07-18,1.005\n10,The Lord Of The Rings: The Return Of The King,Fantasy Adventure,2003-12-17,1.142\n11,Spider Man,Action Adventure,2002-05-03,0.821\n12,Black Panther,Action,2018-02-16,1.347\n13,The Godfather,Crime Drama,1972-03-24,0.246\n14,Avengers: Endgame,Action Adventure,2019-04-26,2.798\n15,The Lion King,Animation,1994-06-24,0.968"}
{"purpose": "Clean inconsistent and messy energy provider data including city names, business types, and normalize price and date formats.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,utility, 120.5 ,5000,2023-01-5\nlos-angeles,CA,Utility,130.0, ,01/12/2023\nChicago,IL,electric provider,110,4500,2023/02/20\nhouston,TX,Electric-Provider,115.75,4700,20-02-2023\nPhoenix,AZ,utility,125,,2023-03-07\nPhiladelphia,PA,utility, abc,5200,2023-03-15\nSan Antonio,TX,electric_provider,105,4800,15/03/2023\nsan_diego,CA,Utility,100.5,4900,2023-04-01\nDallas,TX,Electric-Provider, ,4600,2023-04-05\nSan Jose,CA,UTILTY,130,5300,2023/04/10\nAustin,TX,utility,120,5100,2023-04-15\nJacksonville,FL,ElectricProvider,115,4700,2023-04-20\nFort Worth,TX,utility,118.25,4950,2023-04-25\nColumbus,OH,electric-provider,122,4850,2023-04-30\nCharlotte,NC,utility,119,5000,2023-05-01", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.replace('_', ' ').replace('-', ' ').toTitlecase()", "description": "Replace underscores and hyphens with spaces and capitalize city names"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["utility", "Utility", "UTILTY"], "to": "Utility"}, {"from": ["electric provider", "Electric-Provider", "electric_provider", "ElectricProvider", "electric-provider"], "to": "Electric Provider"}], "description": "Normalize BusinessType values"}, {"op": "core/text-transform", "columnName": "Price", "expression": "isNonBlank(value) && value.match(/^[0-9]+(\\.[0-9]+)?$/) ? value.trim() : null", "description": "Remove invalid price values and trim whitespace"}, {"op": "core/mass-edit", "columnName": "Price", "edits": [{"from": [null, ""], "to": "null"}], "description": "Replace empty or invalid Price with null placeholder"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "isNonBlank(value) && value.match(/^[0-9]+$/) ? value.trim() : null", "description": "Clean LoanAmount to keep only valid numbers"}, {"op": "core/mass-edit", "columnName": "LoanAmount", "edits": [{"from": [null, ""], "to": "null"}], "description": "Replace empty or invalid LoanAmount with null placeholder"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value.replace(/\\//g, '-').replace(/^(\\d{2})-(\\d{2})-(\\d{4})$/, '$3-$1-$2').replace(/^(\\d{4})-(\\d{1})-(\\d{1,2})$/, function(s){ var parts = s.split('-'); return parts[0] + '-' + (parts[1].length==1?'0'+parts[1]:parts[1]) + '-' + (parts[2].length==1?'0'+parts[2]:parts[2]); })", "description": "Normalize dates to YYYY-MM-DD with zero padding"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value", "description": "Parse dates into standard date type"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Utility,120.5,5000,2023-01-05\nLos Angeles,CA,Utility,130.0,null,2023-01-12\nChicago,IL,Electric Provider,110,4500,2023-02-20\nHouston,TX,Electric Provider,115.75,4700,2023-02-20\nPhoenix,AZ,Utility,125,null,2023-03-07\nPhiladelphia,PA,Utility,null,5200,2023-03-15\nSan Antonio,TX,Electric Provider,105,4800,2023-03-15\nSan Diego,CA,Utility,100.5,4900,2023-04-01\nDallas,TX,Electric Provider,null,4600,2023-04-05\nSan Jose,CA,Utility,130,5300,2023-04-10\nAustin,TX,Utility,120,5100,2023-04-15\nJacksonville,FL,Electric Provider,115,4700,2023-04-20\nFort Worth,TX,Utility,118.25,4950,2023-04-25\nColumbus,OH,Electric Provider,122,4850,2023-04-30\nCharlotte,NC,Utility,119,5000,2023-05-01"}
{"purpose": "Standardize farm crop names, correct date formats, and normalize loan amounts for agricultural data analysis.", "raw_table": "FarmID,Crop,PlantDate,HarvestDate,LoanAmount,PricePerTon\n101,coRn,03/15/2022,09-20-2022,$15000,250\n102,WHEAT,2022/04/01,10/05/2022,13000,  220\n103,Rice,Apr 10 2022,11-15-2022,  17000 ,270\n104,soy-bean,2022-05-05,12/01/22,missing,300\n105,Corn,05_15_2022,09/25/2022,$14000,260\n106,wheat,2022/04/10,10/10/2022,12000, 215\n107,soy bean,04/20/2022,,11000,290\n108,RICE,2022-04-15,11/18/22,16500,$275\n109,CORN,03-25-2022,09/30/2022,15500,255\n110,soy-beans,May 01 2022,12-05-2022,11500,285", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize crop names to lowercase and remove hyphens/underscores", "columnName": "Crop", "expression": "value.toLowercase().replace(/[-_]/g, ' ').trim()"}, {"op": "core/mass-edit", "description": "Standardize crop synonyms", "columnName": "Crop", "edits": [{"from": ["soy bean", "soy beans", "soybean", "soy-bean", "soy-beans"], "to": "soybean"}, {"from": ["corn", "co rn", "corn "], "to": "corn"}, {"from": ["wheat", "wheat "], "to": "wheat"}, {"from": ["rice"], "to": "rice"}]}, {"op": "core/text-transform", "description": "Parse PlantDate into ISO date format yyyy-MM-dd", "columnName": "PlantDate", "expression": "value.toDate().toISOString().slice(0,10)"}, {"op": "core/text-transform", "description": "Parse HarvestDate into ISO date format yyyy-MM-dd", "columnName": "HarvestDate", "expression": "value && value.length > 0 ? value.toDate().toISOString().slice(0,10) : null"}, {"op": "core/mass-edit", "description": "Fill missing HarvestDate with null strings for consistency", "columnName": "HarvestDate", "edits": [{"from": [null, "", "missing"], "to": ""}]}, {"op": "core/text-transform", "description": "Remove $ and spaces from LoanAmount and convert to number", "columnName": "LoanAmount", "expression": "value.toString().replace(/[^0-9.]/g, '').trim() == '' ? null : Number(value.toString().replace(/[^0-9.]/g, ''))"}, {"op": "core/text-transform", "description": "Remove $ and spaces from PricePerTon and convert to number", "columnName": "PricePerTon", "expression": "value.toString().replace(/[^0-9.]/g, '').trim() == '' ? null : Number(value.toString().replace(/[^0-9.]/g, ''))"}], "clean_table": "FarmID,Crop,PlantDate,HarvestDate,LoanAmount,PricePerTon\n101,corn,2022-03-15,2022-09-20,15000,250\n102,wheat,2022-04-01,2022-10-05,13000,220\n103,rice,2022-04-10,2022-11-15,17000,270\n104,soybean,2022-05-05,2022-12-01,,300\n105,corn,2022-05-15,2022-09-25,14000,260\n106,wheat,2022-04-10,2022-10-10,12000,215\n107,soybean,2022-04-20,,11000,290\n108,rice,2022-04-15,2022-11-18,16500,275\n109,corn,2022-03-25,2022-09-30,15500,255\n110,soybean,2022-05-01,2022-12-05,11500,285"}
{"purpose": "Clean and standardize city names, fix inconsistent business types, and normalize date and numeric formats in telecommunications loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew-york,NY,Telecom,1200,50000,2023/03/15\nlos angeles,CA,telecom, 1500 ,70000,15-03-2023\nChica_go,IL,Telecom,1300,65000,03-16-2023\nHouston,TX,tele-com,1100,,2023.03.17\nPHOENIX,AZ,Telecom,,48000,Mar 18 2023\nPhiladelphia,PA,telecom,1250,52000,18/03/2023\nSan-antonio,TX,Telecom,1350,60000,03/19/2023\nsan diego,CA,telecom,1400,61000,2023-03-20\nDallas,TX,Telecom, ,59000,03-21-2023\nsan jose,CA,telecom,1450,62000,2023/03/22\nAustin,TX,Telecom,,58000,March 23 2023\nJacksonville,FL,telecom_,1380,63000,2023/03/24\nfort worth,TX,Telecom,1420, ,24-Mar-2023\nColumbus,OH,telecom,1300,64000,2023/03/25", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove extra underscores and hyphens in City names", "columnName": "City", "expression": "value.replace(/[-_]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Trim whitespace from Price and convert to number", "columnName": "Price", "expression": "value.trim() == '' ? null : Number(value.trim())"}, {"op": "core/mass-edit", "description": "Standardize BusinessType entries", "columnName": "BusinessType", "edits": [{"from": ["tele-com", "telecom_", "telecom"], "to": "Telecom"}]}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/date-parse", "description": "Parse Date to ISO format yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate('yyyy/MM/dd') || value.toDate('dd-MM-yyyy') || value.toDate('MM-dd-yyyy') || value.toDate('yyyy.MM.dd') || value.toDate('MMM dd yyyy') || value.toDate('dd/MM/yyyy') || value.toDate('dd-MMM-yyyy') || value.toDate('MMMM dd yyyy')"}, {"op": "core/text-transform", "description": "Format Date column to yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/text-transform", "description": "Capitalize State codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Fill missing Price values with average price", "columnName": "Price", "expression": "value == null ? 1335 : value"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom,1200,50000,2023-03-15\nLos Angeles,CA,Telecom,1500,70000,2023-03-15\nChicago,IL,Telecom,1300,65000,2023-03-16\nHouston,TX,Telecom,1100,65000,2023-03-17\nPhoenix,AZ,Telecom,1335,48000,2023-03-18\nPhiladelphia,PA,Telecom,1250,52000,2023-03-18\nSan Antonio,TX,Telecom,1350,60000,2023-03-19\nSan Diego,CA,Telecom,1400,61000,2023-03-20\nDallas,TX,Telecom,1335,59000,2023-03-21\nSan Jose,CA,Telecom,1450,62000,2023-03-22\nAustin,TX,Telecom,1335,58000,2023-03-23\nJacksonville,FL,Telecom,1380,63000,2023-03-24\nFort Worth,TX,Telecom,1420,63000,2023-03-24\nColumbus,OH,Telecom,1300,64000,2023-03-25"}
{"purpose": "Clean inconsistent city names and standardize loan and price formats in energy equipment sales data.", "raw_table": "City,State,Business_Type,Price,Loan_Amount,Sale_Date\nNew_york,NY,solar Installation,15,000,5000,01-12-2023\nlos-angeles,CA,Wind_Turbine,12000,10000,2023/01/15\nhouston,tx,solar installation,13,500,8,000,15 Jan 2023\nChicago,IL,GEOTHERMAL,8500.00,7000.00,2023-01-20\nphoenix,AZ,Wind turbine,NaN,6000,01/22/2023\nphiladelphia,pa,solar_installation,14000.00,,2023.01.25\nSAN ANTONIO,TX,Geothermal,9000,8000,Jan 27 2023\nSan_diego,CA,wind turbine,11000,9000,2023/01/29\nDallas,tx,,12500,7000,2023-01-30\nsan jose,CA,Solar Installation,13500,,2023-02-01\nAustin,TX,Geothermal,NaN,7500,02-03-2023\nJacksonville,fl,solar installation,13000,6500,2023/02/05\nFort_Worth,TX,Wind_Turbine,11500,8500,02/07/2023\nColumbus,OH,Geothermal,8800,7000,2023-02-10\nCharlotte,nc,Solar_Installation,14200,9000,2023.02.12", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in City names", "columnName": "City", "expression": "value.replace('_', ' ').replace('-', ' ')"}, {"op": "core/text-transform", "description": "Capitalize each word in City", "columnName": "City", "expression": "value.toLowercase().split(' ').map(word, word.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize Business_Type to Title Case and remove underscores", "columnName": "Business_Type", "expression": "value.toLowercase().replace('_', ' ').split(' ').map(word, word.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Fix common Business_Type misspellings", "columnName": "Business_Type", "edits": [{"from": ["Wind turbine", "Wind_Turbine", "wind turbine"], "to": "Wind Turbine"}, {"from": ["Solar Installation", "solar installation", "solar_installation"], "to": "Solar Installation"}, {"from": ["Geothermal", "GEOTHERMAL", "Geothermal"], "to": "Geothermal"}]}, {"op": "core/text-transform", "description": "Remove commas in Price and convert to number string", "columnName": "Price", "expression": "value.replace(',', '').trim()"}, {"op": "core/text-transform", "description": "Remove commas in Loan_Amount and convert to number string", "columnName": "Loan_Amount", "expression": "value.replace(',', '').trim()"}, {"op": "core/text-transform", "description": "Replace blank Loan_Amount with null for consistency", "columnName": "Loan_Amount", "expression": "value.trim() == '' ? null : value"}, {"op": "core/date-parse", "description": "Parse Sale_Date into standard yyyy-MM-dd format", "columnName": "Sale_Date", "valueType": "date", "dateFormat": "auto"}, {"op": "core/fill-down", "description": "Fill down missing Business_Type values", "columnName": "Business_Type"}], "clean_table": "City,State,Business_Type,Price,Loan_Amount,Sale_Date\nNew York,NY,Solar Installation,15000,5000,2023-01-12\nLos Angeles,CA,Wind Turbine,12000,10000,2023-01-15\nHouston,TX,Solar Installation,13500,8000,2023-01-15\nChicago,IL,Geothermal,8500,7000,2023-01-20\nPhoenix,AZ,Wind Turbine,NaN,6000,2023-01-22\nPhiladelphia,PA,Solar Installation,14000,,2023-01-25\nSan Antonio,TX,Geothermal,9000,8000,2023-01-27\nSan Diego,CA,Wind Turbine,11000,9000,2023-01-29\nDallas,TX,Wind Turbine,12500,7000,2023-01-30\nSan Jose,CA,Solar Installation,13500,,2023-02-01\nAustin,TX,Geothermal,NaN,7500,2023-02-03\nJacksonville,FL,Solar Installation,13000,6500,2023-02-05\nFort Worth,TX,Wind Turbine,11500,8500,2023-02-07\nColumbus,OH,Geothermal,8800,7000,2023-02-10\nCharlotte,NC,Solar Installation,14200,9000,2023-02-12"}
{"purpose": "Standardize movie titles and release dates, and clean up inconsistent genre names in the dataset.", "raw_table": "MovieTitle,ReleaseDate,Genre,BoxOffice,Rating\n\"the_lord of the rings\",\"07/29/2001\",\"Fantasy-Adventure\",\"$313,000,000\",\"8.8\"\n\"Avengers: Endgame\",\"Apr 26 2019\",\"Action|adventure\",\"$2,798,000,000\",\"8.4\"\n\"inception\",\"2010-07-16\",\"SCI-FI\",\"$829,895,144\",\"8.8\"\n\"Titanic\",\"Dec-19-1997\",\"Romance\",\"$2,187,000,000\",\"7.8\"\n\"The Godfather\",\"03/24/1972\",\"crime\",\"$134,966,411\",\"9.2\"\n\"star wars: episode iv\",\"May 25 1977\",\"sci_fi\",\"$775,398,007\",\"8.6\"\n\"Joker\",\"10-04-2019\",\"crime/drama\",\"$1074,000,000\",\"8.5\"\n\"Frozen 2\",\"November 22, 2019\",\"Animation\",\"$1,450,000,000\",\"7.0\"\n\"parasite\",\"2019/05/30\",\"Thriller\",\"$258,700,000\",\"8.6\"\n\"Spider-man: far from home\",\"07/02/2019\",\"action-adventure\",\"$1,131,927,996\",\"7.5\"\n\"Black Panther\",\"02/16/2018\",\"ACTION\",\"$1,347,000,000\",\"7.3\"\n\"The Shawshank Redemption\",\"1994-09-22\",\"drama\",\"$28,341,469\",\"9.3\"\n\"Avatar\",\"12/18/2009\",\"sci-fi\",\"$2,847,000,000\",\"7.8\"\n\"The Dark Knight\",\"07/18/2008\",\"Action-CRIME\",\"$1,005,000,000\",\"9.0\"", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize MovieTitle capitalization and remove underscores", "columnName": "MovieTitle", "expression": "value.replace(/_/g, ' ').split(' ').map(s => s.toLowerCase()).map(s => s.length > 2 || s.toLowerCase() === 'of' ? s.capitalize() : s).join(' ')"}, {"op": "core/text-transform", "description": "Standardize ReleaseDate format to yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/text-transform", "description": "Clean Genre by replacing separators with comma and standardizing case", "columnName": "Genre", "expression": "value.replace(/[-_|\\/]/g, ',').split(',').map(g => g.trim().toLowerCase().capitalize()).join(', ')"}, {"op": "core/text-transform", "description": "Remove dollar signs and commas from BoxOffice, parse as number", "columnName": "BoxOffice", "expression": "value.replace(/[$,]/g, '').toNumber()"}, {"op": "core/text-transform", "description": "Convert Rating to number", "columnName": "Rating", "expression": "value.toNumber()"}, {"op": "core/mass-edit", "description": "Fix common genre misspellings", "columnName": "Genre", "edits": [{"from": ["Fantasy-Adventure", "Sci-Fi", "Sci_fi", "sci-fi", "SCI-FI", "sci_fi"], "to": "Sci-Fi"}, {"from": ["Action", "action", "ACTION", "action-adventure", "Action-CRIME", "Action|adventure"], "to": "Action"}, {"from": ["Crime", "crime", "crime/drama", "Crime/Drama"], "to": "Crime"}, {"from": ["Thriller", "thriller"], "to": "Thriller"}, {"from": ["Romance", "romance"], "to": "Romance"}, {"from": ["Animation", "animation"], "to": "Animation"}, {"from": ["Drama", "drama"], "to": "Drama"}]}, {"op": "core/mass-edit", "description": "Fix MovieTitle known typos", "columnName": "MovieTitle", "edits": [{"from": ["Star Wars: Episode Iv"], "to": "Star Wars: Episode IV"}, {"from": ["Spider-man: Far From Home"], "to": "Spider-Man: Far From Home"}]}], "clean_table": "MovieTitle,ReleaseDate,Genre,BoxOffice,Rating\nThe Lord Of The Rings,2001-07-29,Sci-Fi,313000000,8.8\nAvengers: Endgame,2019-04-26,Action,2798000000,8.4\nInception,2010-07-16,Sci-Fi,829895144,8.8\nTitanic,1997-12-19,Romance,2187000000,7.8\nThe Godfather,1972-03-24,Crime,134966411,9.2\nStar Wars: Episode IV,1977-05-25,Sci-Fi,775398007,8.6\nJoker,2019-10-04,Crime,1074000000,8.5\nFrozen 2,2019-11-22,Animation,1450000000,7.0\nParasite,2019-05-30,Thriller,258700000,8.6\nSpider-Man: Far From Home,2019-07-02,Action,1131927996,7.5\nBlack Panther,2018-02-16,Action,1347000000,7.3\nThe Shawshank Redemption,1994-09-22,Drama,28341469,9.3\nAvatar,2009-12-18,Sci-Fi,2847000000,7.8\nThe Dark Knight,2008-07-18,Action,1005000000,9.0"}
{"purpose": "Standardize inconsistent city and state names, normalize business types, and correct date and numeric formats for government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew_york,ny,Restaurant,100000,50000,01/15/2022\nLos-Angeles,CA,retail,75000,35000,2022-03-22\nchicago,il,HealthCare, 50000 ,25000,15-05-2022\nhouston,TX,retail,85000,,2022/07/10\nPHOENIX,az,restaurant,62000,30000,07-30-22\nphiladelphia,Pa,Health-care,70000,40000,2022.04.12\nsan-antonio,TX,restaurant, ,20000,2022-08-01\nsan diego,CA,Retail,90000,45000,2022/09/15\nDallas,tx,HEALTHCARE,67000,34000,09-10-2022\nsan_jose,CA,restaurant,58000,29000,2022-11-20\nAustin,TX,retail,72000,36000,2022/12/05\njacksonville,fl,HEALTH CARE,63000,31000,\nfort-worth,tx,retail,81000,40000,2022-10-10\ncolumbus,OH,restaurant,55000,27500,10-25-2022\ncharlotte,nc,healthcare,60000,30000,2022-06-15", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove extra underscores and hyphens from City names and fix capitalization", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase two-letter abbreviations", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["Restaurant", "restaurant"], "to": "Restaurant"}, {"from": ["Retail", "retail", "RETAIL"], "to": "Retail"}, {"from": ["HealthCare", "Health-care", "HEALTHCARE", "HEALTH CARE", "healthcare"], "to": "Healthcare"}]}, {"op": "core/text-transform", "description": "Trim whitespace in Price and LoanAmount and convert to number strings", "columnName": "Price", "expression": "value.trim() == '' ? null : value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace in LoanAmount and convert to number strings", "columnName": "LoanAmount", "expression": "value == null || value.trim() == '' ? null : value.trim()"}, {"op": "core/date-parse", "description": "Parse Date column to standard yyyy-MM-dd format", "columnName": "Date", "valueType": "date", "dateFormat": "auto"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values where possible", "columnName": "LoanAmount"}, {"op": "core/text-transform", "description": "Capitalize City fully (correct multiple words)", "columnName": "City", "expression": "value.split(' ').map(w => w.toTitlecase()).join(' ')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,100000,50000,2022-01-15\nLos Angeles,CA,Retail,75000,35000,2022-03-22\nChicago,IL,Healthcare,50000,25000,2022-05-15\nHouston,TX,Retail,85000,,2022-07-10\nPhoenix,AZ,Restaurant,62000,30000,2022-07-30\nPhiladelphia,PA,Healthcare,70000,40000,2022-04-12\nSan Antonio,TX,Restaurant,,20000,2022-08-01\nSan Diego,CA,Retail,90000,45000,2022-09-15\nDallas,TX,Healthcare,67000,34000,2022-09-10\nSan Jose,CA,Restaurant,58000,29000,2022-11-20\nAustin,TX,Retail,72000,36000,2022-12-05\nJacksonville,FL,Healthcare,63000,31000,\nFort Worth,TX,Retail,81000,40000,2022-10-10\nColumbus,OH,Restaurant,55000,27500,2022-10-25\nCharlotte,NC,Healthcare,60000,30000,2022-06-15"}
{"purpose": "Clean and standardize city names, business types, and date formats in a government loan application dataset.", "raw_table": "City,State,BusinessType,LoanAmount,Price,ApplicationDate\nNew-york,ny,REtail,50000,100000,01/15/2023\nlos angeles,CA,restaurant,75000,150000,2023-02-20\nChiCago,il,Retaill,60000,120000,03-05-2023\nhouston,TX,Manufacturing,70000,130000,2023/04/10\npHIladelphia,pa,,65000,110000,04.15.2023\nPhoenix,Az,restaurant,abc,125000,05/01/2023\nsan_antonio,tx,reTail,55000,,06-20-2023\nSan Diego,CA,manufacturing,72000,135000,07-25-23\nDallas,TX,RETAIL,68000,128000,8/30/2023\nsan jose,ca,restauraant,71000,140000,09-15-2023\nAustin,Tx,Manufacturing,67000,130000,2023-10-05\njacksonville,fl,,62000,115000,11/12/2023\nFort Worth,Tx,Retail,69000,125000,2023-12-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names properly and replace underscores and hyphens with spaces", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').toTitlecase()"}, {"op": "core/mass-edit", "description": "Standardize state codes to uppercase", "columnName": "State", "edits": [{"from": ["ny", "il", "pa", "Az", "tx", "ca", "Tx", "fl"], "to": ["NY", "IL", "PA", "AZ", "TX", "CA", "TX", "FL"]}]}, {"op": "core/mass-edit", "description": "Fix misspellings and standardize BusinessType to Title Case", "columnName": "BusinessType", "edits": [{"from": ["REtail", "Retaill", "reTail", "RETAIL", "restauraant"], "to": "Retail"}, {"from": ["restaurant"], "to": "Restaurant"}, {"from": ["Manufacturing"], "to": "Manufacturing"}]}, {"op": "core/mass-edit", "description": "Fill missing BusinessType with 'Unknown'", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Fix LoanAmount datatype and coerce invalids to empty", "columnName": "LoanAmount", "expression": "value.match(/^[0-9]+$/) ? value : ''"}, {"op": "core/text-transform", "description": "Fill missing Price with 0", "columnName": "Price", "expression": "value.match(/^[0-9]+$/) ? value : '0'"}, {"op": "core/date-parse", "description": "Parse ApplicationDate to standard yyyy-MM-dd format", "columnName": "ApplicationDate", "options": {"guessCellType": true, "mode": "replace"}}], "clean_table": "City,State,BusinessType,LoanAmount,Price,ApplicationDate\nNew York,NY,Retail,50000,100000,2023-01-15\nLos Angeles,CA,Restaurant,75000,150000,2023-02-20\nChicago,IL,Retail,60000,120000,2023-03-05\nHouston,TX,Manufacturing,70000,130000,2023-04-10\nPhiladelphia,PA,Unknown,65000,110000,2023-04-15\nPhoenix,AZ,Restaurant,,125000,2023-05-01\nSan Antonio,TX,Retail,55000,0,2023-06-20\nSan Diego,CA,Manufacturing,72000,135000,2023-07-25\nDallas,TX,Retail,68000,128000,2023-08-30\nSan Jose,CA,Retail,71000,140000,2023-09-15\nAustin,TX,Manufacturing,67000,130000,2023-10-05\nJacksonville,FL,Unknown,62000,115000,2023-11-12\nFort Worth,TX,Retail,69000,125000,2023-12-01"}
{"purpose": "Standardize crop yield records by fixing inconsistent crop names, formatting dates, and normalizing numeric values.", "raw_table": "FarmID,Crop,Yield_tons,Harvest_Date,Region\nF001,wiheat,2.5,2023/09/10,north-west\nF002,Corn,3.1,09-15-2023,NorthWest\nF003,Rice, ,2023.09.11,north-west\nF004,wheat,2,15-09-2023,North-west\nF005,CORN,3.0,2023/9/16,North West\nF006,RICE,2.8,,northwest\nF007,Wheat,2.7,2023-09-12,northwest\nF008, corn,3.2,2023/09/14,North-west\nF009,Rice ,2.9,2023/09/13,north west\nF010,wheat-,2.4,2023/09/10,northwest\nF011,,2.6,2023/09/15,NorthWest\nF012,Corn,three,2023/09/16,North-west", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and remove trailing hyphens in Crop", "columnName": "Crop", "expression": "value.trim().replace(/-$/, '')"}, {"op": "core/mass-edit", "description": "Standardize Crop names", "columnName": "Crop", "edits": [{"from": ["wiheat", "wheat", "Wheat", "wheat-"], "to": "Wheat"}, {"from": ["Corn", "CORN", " corn"], "to": "Corn"}, {"from": ["Rice", "RICE", "Rice "], "to": "Rice"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Parse Yield_tons to number, convert 'three' to 3", "columnName": "Yield_tons", "expression": "value.toLowercase() == 'three' ? 3 : (value == null || value.trim() == '' ? null : value.toNumber())"}, {"op": "core/date-parse", "description": "Normalize Harvest_Date to yyyy-MM-dd", "columnName": "Harvest_Date", "pattern": "auto", "onError": "keep-original"}, {"op": "core/text-transform", "description": "Standardize Region casing and spacing", "columnName": "Region", "expression": "value.toLowercase().replace(/[-_]/g, ' ').replace(/\\s+/g, ' ').trim().split(' ').map(word => word.capitalize()).join(' ')"}, {"op": "core/fill-down", "description": "Fill down missing Yield_tons", "columnName": "Yield_tons"}], "clean_table": "FarmID,Crop,Yield_tons,Harvest_Date,Region\nF001,Wheat,2.5,2023-09-10,North West\nF002,Corn,3.1,2023-09-15,North West\nF003,Rice,3,2023-09-11,North West\nF004,Wheat,2,2023-09-15,North West\nF005,Corn,3,2023-09-16,North West\nF006,Rice,2.8,,North West\nF007,Wheat,2.7,2023-09-12,North West\nF008,Corn,3.2,2023-09-14,North West\nF009,Rice,2.9,2023-09-13,North West\nF010,Wheat,2.4,2023-09-10,North West\nF011,Unknown,2.6,2023-09-15,North West\nF012,Corn,3,2023-09-16,North West"}
{"purpose": "Clean and standardize inconsistent city and business type names, normalize date formats, and fix numeric values in an energy loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar-installation,12000,50000,2022/01/15\nlos angeles,CA,Wind_Turbine,15000,NaN,15-02-2022\nCHICAGO,IL,solar installation,11,000,45000,2022-03-01\nHouston,TX,solar-Panel,13500,47000,03/15/2022\nPhOenix,AZ,wind turbine,14000,48000,2022.04.01\nphiladelphia,PA,solarInstalation,13000,46000,April 5 2022\nSan-antonio,TX,,12500,44000,2022/05/10\nsan diego,CA,Solar Installation,NaN,42000,2022-06-01\nDallas,TX,wind Turbine,14500,50000,2022/06/15\nSAN JOSE,CA,solar_installation,13800,47000,2022-07-01\nAustin,TX,wind-turbine,14200,49000,07/15/2022\njacksonville,FL,solar installation,12900,45000,2022-08-01\nFort_Worth,TX,solar-Installation,13100,46000,08/15/2022", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and convert City names to title case, replace underscores and hyphens with spaces", "columnName": "City", "expression": "value.replace('_',' ').replace('-',' ').toTitlecase().trim()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase().trim()"}, {"op": "core/text-transform", "description": "Normalize BusinessType by fixing misspellings and replacing underscores/hyphens with spaces", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[-_]/, ' ').replace('solar instalation', 'solar installation').replace('solarinstalation', 'solar installation').trim()"}, {"op": "core/mass-edit", "description": "Fix known misspellings and missing BusinessType", "columnName": "BusinessType", "edits": [{"from": [""], "to": "solar installation"}]}, {"op": "core/text-transform", "description": "Remove commas from Price and convert to number string", "columnName": "Price", "expression": "value.replace(\",\",\"\")"}, {"op": "core/mass-edit", "description": "Replace NaN with empty string in Price and LoanAmount", "columnName": "Price", "edits": [{"from": ["NaN"], "to": ""}]}, {"op": "core/mass-edit", "description": "Replace NaN with empty string in LoanAmount", "columnName": "LoanAmount", "edits": [{"from": ["NaN"], "to": ""}]}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numeric strings, trim whitespace", "columnName": "Price", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace in LoanAmount", "columnName": "LoanAmount", "expression": "value.trim()"}, {"op": "core/date-parse", "description": "Parse and standardize Date column formats", "columnName": "Date", "format": "yyyy-MM-dd"}, {"op": "core/fill-down", "description": "Fill down missing Price values", "columnName": "Price"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,solar installation,12000,50000,2022-01-15\nLos Angeles,CA,wind turbine,15000,44000,2022-02-15\nChicago,IL,solar installation,11000,45000,2022-03-01\nHouston,TX,solar panel,13500,47000,2022-03-15\nPhoenix,AZ,wind turbine,14000,48000,2022-04-01\nPhiladelphia,PA,solar installation,13000,46000,2022-04-05\nSan Antonio,TX,solar installation,12500,44000,2022-05-10\nSan Diego,CA,solar installation,12500,42000,2022-06-01\nDallas,TX,wind turbine,14500,50000,2022-06-15\nSan Jose,CA,solar installation,13800,47000,2022-07-01\nAustin,TX,wind turbine,14200,49000,2022-07-15\nJacksonville,FL,solar installation,12900,45000,2022-08-01\nFort Worth,TX,solar installation,13100,46000,2022-08-15"}
{"purpose": "Standardize inconsistent city and crop names and correct date formats for agricultural loan data.", "raw_table": "FarmID,City,State,Crop,LoanAmount,PricePerTon,LoanDate\n001,Green_valley,CA,Wheat,100000,250,2022-03-15\n002,green-Valley,ca,wheaat,120000,260,15/04/2022\n003,RedHill,TX,Corn,90000,230,2022/05/20\n004,redhill,Tx,corn ,85000,225,05-22-2022\n005,Blue_lake,WA,Soybean,110000,270,2022.06.10\n006,BlueLake,wa,soy bean,115000,275,10-Jun-2022\n007,Yellow_Creek,OR,Rice,95000,240,20220615\n008,yellowcreek,or,Rice,97000,245,06/16/2022\n009,Green_valley,CA,,105000,255,2022-07-01\n010,RedHill,TX,Corn,NaN,235,07-05-2022\n011,Blue_lake,WA,Soybean,112000,NaN,2022/07/10\n012,Yellow_Creek,OR,Rice,98000,250,2022-07-12\n013,GreenValley,CA,Wheat,102000,258,July 15, 2022\n014,Red-Hill,TX,Corn,92000,232,2022-Jul-18", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize city names formatting by removing underscores and hyphens and capitalizing properly", "columnName": "City", "expression": "value.replace(/[-_]/, ' ').toLowercase().split(' ').map(s, s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Trim spaces from Crop values and fix common misspellings", "columnName": "Crop", "expression": "value.trim().toLowercase().replace('wheaat','wheat').replace('soy bean','soybean')"}, {"op": "core/mass-edit", "description": "Correct State abbreviations capitalization", "columnName": "State", "edits": [{"from": ["ca", "tx", "wa", "or"], "to": ["CA", "TX", "WA", "OR"]}]}, {"op": "core/text-transform", "description": "Replace 'NaN' in LoanAmount and PricePerTon with empty for later filling", "columnName": "LoanAmount", "expression": "value == 'NaN' ? '' : value"}, {"op": "core/text-transform", "description": "Replace 'NaN' in PricePerTon with empty for later filling", "columnName": "PricePerTon", "expression": "value == 'NaN' ? '' : value"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}, {"op": "core/fill-down", "description": "Fill down missing PricePerTon values", "columnName": "PricePerTon"}, {"op": "core/date-parse", "description": "Parse LoanDate into ISO yyyy-mm-dd format", "columnName": "LoanDate", "dateFormat": "auto"}, {"op": "core/text-transform", "description": "Capitalize Crop names for consistency", "columnName": "Crop", "expression": "value.toLowercase().split(' ').map(s, s.capitalize()).join(' ')"}], "clean_table": "FarmID,City,State,Crop,LoanAmount,PricePerTon,LoanDate\n001,Green Valley,CA,Wheat,100000,250,2022-03-15\n002,Green Valley,CA,Wheat,120000,260,2022-04-15\n003,Red Hill,TX,Corn,90000,230,2022-05-20\n004,Red Hill,TX,Corn,85000,225,2022-05-22\n005,Blue Lake,WA,Soybean,110000,270,2022-06-10\n006,Blue Lake,WA,Soybean,115000,275,2022-06-10\n007,Yellow Creek,OR,Rice,95000,240,2022-06-15\n008,Yellow Creek,OR,Rice,97000,245,2022-06-16\n009,Green Valley,CA,,105000,255,2022-07-01\n010,Red Hill,TX,Corn,92000,235,2022-07-05\n011,Blue Lake,WA,Soybean,112000,270,2022-07-10\n012,Yellow Creek,OR,Rice,98000,250,2022-07-12\n013,Green Valley,CA,Wheat,102000,258,2022-07-15\n014,Red Hill,TX,Corn,92000,232,2022-07-18"}
{"purpose": "Standardize city and state names, fix business type inconsistencies, and normalize date and numeric formats in telecom loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew-york,ny,Cell_Towers,120000,50000,01/15/2023\nlos angeles,CA,Mobile_Retail,85000,35000,2023-02-10\nChicago,il,cell towers,95000,NaN,03-05-2023\nhouston,tx,Mobile retail,87000,42000,4/1/2023\nPhoenix,AZ,,78000,31000,2023/05/20\nphiladelphia,pa,Cell_tower,90000,40000,May 25 2023\nSan Antonio,Tx,Mobile-retail,88000,38000,2023-06-15\nsan diego,CA,Cell Towers,NaN,45000,06/30/23\nDALLAS,tx,Mobile Retail,92000,NaN,07-10-2023\nsan jose,ca,cell_towers,110000,47000,8/5/2023\nAustin,Tx,Mobile Retail,86000,39000,2023-09-01\nJacksonville,fl,cell towers,83000,,09-15-2023\nfort worth,TX,mobile_retail,89000,41000,Sept 20 2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize City names properly", "columnName": "City", "expression": "value.toTitlecase().replace(/[-_]/, ' ')"}, {"op": "core/text-transform", "description": "Convert State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["Cell_Towers", "cell towers", "Cell_tower", "cell_towers"], "to": "Cell Towers"}, {"from": ["Mobile_Retail", "Mobile retail", "Mobile-retail", "Mobile Retail", "mobile_retail"], "to": "Mobile Retail"}, {"from": [null, ""], "to": "Unknown"}]}, {"op": "core/mass-edit", "description": "Fix missing or NaN values for LoanAmount and Price", "columnName": "LoanAmount", "edits": [{"from": ["NaN", "", null], "to": "0"}]}, {"op": "core/mass-edit", "description": "Fix missing or NaN values for Price", "columnName": "Price", "edits": [{"from": ["NaN", "", null], "to": "0"}]}, {"op": "core/text-transform", "description": "Normalize Date to yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate(\"MM/dd/yyyy\").toString(\"yyyy-MM-dd\") || value.toDate(\"yyyy-MM-dd\").toString(\"yyyy-MM-dd\") || value.toDate(\"MM-dd-yyyy\").toString(\"yyyy-MM-dd\") || value.toDate(\"yyyy/MM/dd\").toString(\"yyyy-MM-dd\") || value.toDate(\"MMM dd yyyy\").toString(\"yyyy-MM-dd\") || value.toDate(\"MMM dd yy\").toString(\"yyyy-MM-dd\")"}, {"op": "core/column-rename", "description": "Rename State to StateCode", "oldColumnName": "State", "newColumnName": "StateCode"}, {"op": "core/text-transform", "description": "Trim any whitespace in all text columns", "columnName": "City", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim any whitespace in BusinessType", "columnName": "BusinessType", "expression": "value.trim()"}], "clean_table": "City,StateCode,BusinessType,Price,LoanAmount,Date\nNew York,NY,Cell Towers,120000,50000,2023-01-15\nLos Angeles,CA,Mobile Retail,85000,35000,2023-02-10\nChicago,IL,Cell Towers,95000,0,2023-03-05\nHouston,TX,Mobile Retail,87000,42000,2023-04-01\nPhoenix,AZ,Unknown,78000,31000,2023-05-20\nPhiladelphia,PA,Cell Towers,90000,40000,2023-05-25\nSan Antonio,TX,Mobile Retail,88000,38000,2023-06-15\nSan Diego,CA,Cell Towers,0,45000,2023-06-30\nDallas,TX,Mobile Retail,92000,0,2023-07-10\nSan Jose,CA,Cell Towers,110000,47000,2023-08-05\nAustin,TX,Mobile Retail,86000,39000,2023-09-01\nJacksonville,FL,Cell Towers,83000,0,2023-09-15\nFort Worth,TX,Mobile Retail,89000,41000,2023-09-20"}
{"purpose": "Clean inconsistent city and state names, standardize business types, and correct date and numeric formats for telecommunications customer records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ContractDate\nNew-york,ny,CORPORATE,1200,50000,2021/04/15\nlos angeles,CA,retail,850,35000,15-05-2021\nChicago,il,Wholesale, ,40000,2021-06-01\nhouston,TX,corporate,1100, ,2021.07.20\nPHOENIX,Az,RETAIL,900,30000,07/25/2021\nphiladelphia,pa,Wholesal,950,32000,2021/08/05\nSan-Antonio,tx,corporate,1150,45000,2021/09/10\nsan diego,CA,retail,870,31000,2021/10/01\nDallas,tx,wholesale,920,33000,2021/11/15\nsan jose,ca,retail,890,-,2021/12/05\nAustin,TEXAS,corporate,1050,48000,2022-01-10\nJacksonville,fl,retail, ,29000,2022/02/11\nfort worth,Tx,wholesale,940,34000,2022-03-15\ncolumbus,OH,Corporate,1080,47000,2022-04-20\nCharlotte,nc,retail,860,30000,2022.05.25", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names properly and replace hyphens or underscores", "engineConfig": {"facets": []}, "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/,' ').split(' ').map(s -> s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Standardize state abbreviations to uppercase two-letter codes", "engineConfig": {"facets": []}, "columnName": "State", "expression": "value.toUppercase().replace('TEXAS', 'TX').replace('TX', 'TX').replace('FL', 'FL').replace('NC', 'NC').replace('OH', 'OH')"}, {"op": "core/mass-edit", "description": "Normalize business types", "columnName": "BusinessType", "edits": [{"from": ["CORPORATE", "corporate", "Corporate"], "to": "Corporate"}, {"from": ["retail", "RETAIL", "Retail"], "to": "Retail"}, {"from": ["Wholesale", "wholesale", "Wholesal"], "to": "Wholesale"}]}, {"op": "core/text-transform", "description": "Fill missing Price with empty string to null", "engineConfig": {"facets": []}, "columnName": "Price", "expression": "value.trim() == '' ? null : value"}, {"op": "core/text-transform", "description": "Fill missing LoanAmount with null and replace dash with null", "engineConfig": {"facets": []}, "columnName": "LoanAmount", "expression": "value.trim() == '' || value.trim() == '-' ? null : value"}, {"op": "core/text-transform", "description": "Normalize Price and LoanAmount to numeric", "engineConfig": {"facets": []}, "columnName": "Price", "expression": "value == null ? null : value.toNumber()"}, {"op": "core/text-transform", "description": "Normalize LoanAmount to number", "engineConfig": {"facets": []}, "columnName": "LoanAmount", "expression": "value == null ? null : value.toNumber()"}, {"op": "core/text-transform", "description": "Parse ContractDate into yyyy-MM-dd format", "engineConfig": {"facets": []}, "columnName": "ContractDate", "expression": "if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/), value.replace(/\\//g,'-'), if(value.match(/\\d{2}-\\d{2}-\\d{4}/), value.split('-')[2] + '-' + value.split('-')[1] + '-' + value.split('-')[0], if(value.match(/\\d{4}-\\d{2}-\\d{2}/), value, if(value.match(/\\d{4}\\.\\d{2}\\.\\d{2}/), value.replace(/\\./g,'-'), if(value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/), value.split('/')[2] + '-' + value.split('/')[0] + '-' + value.split('/')[1], value)))))"}, {"op": "core/text-transform", "description": "Trim all whitespace from all string columns", "engineConfig": {"facets": []}, "columnName": "City", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace in State", "engineConfig": {"facets": []}, "columnName": "State", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace in BusinessType", "engineConfig": {"facets": []}, "columnName": "BusinessType", "expression": "value.trim()"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ContractDate\nNew York,NY,Corporate,1200,50000,2021-04-15\nLos Angeles,CA,Retail,850,35000,2021-05-15\nChicago,IL,Wholesale,,40000,2021-06-01\nHouston,TX,Corporate,1100,,2021-07-20\nPhoenix,AZ,Retail,900,30000,2021-07-25\nPhiladelphia,PA,Wholesale,950,32000,2021-08-05\nSan Antonio,TX,Corporate,1150,45000,2021-09-10\nSan Diego,CA,Retail,870,31000,2021-10-01\nDallas,TX,Wholesale,920,33000,2021-11-15\nSan Jose,CA,Retail,890,,2021-12-05\nAustin,TX,Corporate,1050,48000,2022-01-10\nJacksonville,FL,Retail,,29000,2022-02-11\nFort Worth,TX,Wholesale,940,34000,2022-03-15\nColumbus,OH,Corporate,1080,47000,2022-04-20\nCharlotte,NC,Retail,860,30000,2022-05-25"}
{"purpose": "Standardize and clean inconsistent city and state names, normalize business types, and fix date formats for government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew-york,ny,retail_,100000,50000,01/15/2022\nLOS ANGELES,CA,service,85000,40000,2022-02-10\nChiCago,illinois,manufacturing-,120000,70000,15-03-2022\nhouston,Tx,RETAIL,90000,,03/25/22\nphiladelphia,pa,,75000,35000,2022/04/05\nPhoenix,az,Service,110000,60000,04-30-2022\nsan antonio,tx,retail,95000,45000,05.10.2022\nSan-Diego,ca,Manufacturing,115000,65000,2022.06.15\nDallas,TX,service ,80000,40000,07/01/2022\nsan jose,CA,retail,85000,42000,2022-07-20\nAustin,tx,Manufacturing,105000,55000,08-05-2022\nJacksonville,fl,service,70000,30000,2022-09-10\nfort worth,TX,retail,88000,44000,09/25/2022\nColumbus,oh,Service,92000,46000,2022-10-15", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize City names properly and remove underscores and hyphens", "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/, ' ').split(' ').map(s, s.substring(0,1).toUppercase()+s.substring(1)).join(' ')"}, {"op": "core/text-transform", "description": "Normalize State names to uppercase two-letter codes", "columnName": "State", "expression": "value.toUppercase().replace('ILLINOIS', 'IL').replace('TX', 'TX').replace('PA', 'PA').replace('AZ', 'AZ').replace('CA', 'CA').replace('FL', 'FL').replace('OH', 'OH')"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["retail_", "retail", "RETAIL", "retail ", "retail"], "to": "Retail"}, {"from": ["service", "Service", "service "], "to": "Service"}, {"from": ["manufacturing-", "Manufacturing"], "to": "Manufacturing"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/mass-edit", "description": "Fill missing LoanAmount values with average of column", "columnName": "LoanAmount", "edits": [{"from": [""], "to": "47500"}]}, {"op": "core/text-transform", "description": "Clean Price and LoanAmount columns to numbers", "columnName": "Price", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Clean Price and LoanAmount columns to numbers", "columnName": "LoanAmount", "expression": "value.toNumber()"}, {"op": "core/text-transform", "description": "Parse Date to ISO format yyyy-MM-dd", "columnName": "Date", "expression": "value.match(/\\d{4}[-/.]\\d{2}[-/.]\\d{2}/) ? value.replace(/[.]/g, '-').toDate('yyyy-MM-dd').toString('yyyy-MM-dd') : (value.match(/\\d{2}\\/\\d{2}\\/\\d{4}/) ? value.toDate('MM/dd/yyyy').toString('yyyy-MM-dd') : (value.match(/\\d{2}-\\d{2}-\\d{4}/) ? value.toDate('MM-dd-yyyy').toString('yyyy-MM-dd') : (value.match(/\\d{2}-\\d{2}-\\d{2}/) ? value.toDate('MM-dd-yy').toString('yyyy-MM-dd') : ''))) "}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,100000,50000,2022-01-15\nLos Angeles,CA,Service,85000,40000,2022-02-10\nChicago,IL,Manufacturing,120000,70000,2022-03-15\nHouston,TX,Retail,90000,47500,2022-03-25\nPhiladelphia,PA,Unknown,75000,35000,2022-04-05\nPhoenix,AZ,Service,110000,60000,2022-04-30\nSan Antonio,TX,Retail,95000,45000,2022-05-10\nSan Diego,CA,Manufacturing,115000,65000,2022-06-15\nDallas,TX,Service,80000,40000,2022-07-01\nSan Jose,CA,Retail,85000,42000,2022-07-20\nAustin,TX,Manufacturing,105000,55000,2022-08-05\nJacksonville,FL,Service,70000,30000,2022-09-10\nFort Worth,TX,Retail,88000,44000,2022-09-25\nColumbus,OH,Service,92000,46000,2022-10-15"}
{"purpose": "Standardize movie genre labels and correct inconsistent release date formats in the dataset.", "raw_table": "MovieTitle,Genre,ReleaseDate,BoxOffice,Rating\n\"the_last_space\",\"SciFi\",\"12-05-2018\",123456789,7.8\n\"Love_in-Paris\",\"Rom-com\",\"2019/07/20\",87654321,8.1\n\"Horror_Night\",\"Horor\",\"2017-10-31\",45678901,6.5\n\"MysteryMan\",\"mystery\",\"31-12-2016\",23456789,7.0\n\"Space_Wars\",\"SCI-FI\",\"2015/05/04\",34567890,8.7\n\"comedy_central\",\"Comedy\",\"2016-13-01\",9876543,7.2\n\"Romance-Story\",\"romcom\",\"2018-02-29\",1234567,6.8\n\"Action_Zone\",\"Action\",\"2019-11-15\",76543210,8.3\n\"ThrillerX\",\"thriller\",\"2017/09/10\",56789012,7.6\n\"DramaticEnd\",\"drama\",\"2018-04-15\",34567890,7.9\n\"Sci_Fi_Adventure\",\"SCI-FY\",\"2016-06-06\",12345678,7.4\n\"Funny_Bone\",\"COMEDY\",\"2015-10-10\",23456789,6.9", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize MovieTitle properly", "columnName": "MovieTitle", "expression": "value.split(/[_-]/).map(s => s.toTitleCase()).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize Genre values", "columnName": "Genre", "edits": [{"from": ["SciFi", "SCI-FI", "SCI-FY"], "to": "Sci-Fi"}, {"from": ["Rom-com", "romcom"], "to": "Romantic Comedy"}, {"from": ["Horor"], "to": "Horror"}, {"from": ["mystery"], "to": "Mystery"}, {"from": ["Comedy", "COMEDY"], "to": "Comedy"}, {"from": ["Action"], "to": "Action"}, {"from": ["thriller"], "to": "Thriller"}, {"from": ["drama"], "to": "Drama"}]}, {"op": "core/text-transform", "description": "Normalize ReleaseDate to yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "if(value.match(/\\d{4}-\\d{2}-\\d{2}/)) value else if(value.match(/\\d{2}-\\d{2}-\\d{4}/)) { var parts = value.split('-'); parts[2] + '-' + parts[1] + '-' + parts[0] } else if(value.match(/\\d{4}\\/\\d{2}\\/\\d{2}/)) value.replace(/\\//g,'-') else ''"}, {"op": "core/mass-edit", "description": "Fix impossible dates", "columnName": "ReleaseDate", "edits": [{"from": ["2016-13-01"], "to": "2016-12-01"}, {"from": ["2018-02-29"], "to": "2018-02-28"}]}], "clean_table": "MovieTitle,Genre,ReleaseDate,BoxOffice,Rating\nThe Last Space,Sci-Fi,2018-05-12,123456789,7.8\nLove In Paris,Romantic Comedy,2019-07-20,87654321,8.1\nHorror Night,Horror,2017-10-31,45678901,6.5\nMystery Man,Mystery,2016-12-31,23456789,7.0\nSpace Wars,Sci-Fi,2015-05-04,34567890,8.7\nComedy Central,Comedy,2016-12-01,9876543,7.2\nRomance Story,Romantic Comedy,2018-02-28,1234567,6.8\nAction Zone,Action,2019-11-15,76543210,8.3\nThriller X,Thriller,2017-09-10,56789012,7.6\nDramatic End,Drama,2018-04-15,34567890,7.9\nSci Fi Adventure,Sci-Fi,2016-06-06,12345678,7.4\nFunny Bone,Comedy,2015-10-10,23456789,6.9"}
{"purpose": "Standardize and clean crop sales records by fixing inconsistent crop names, normalizing price and loan amount formats, and parsing dates correctly.", "raw_table": "FarmID,Crop,Region,Price_per_Ton,LoanAmount,SaleDate\n001,wHeAt,north_field,1500,10000,2023/03/15\n002,corn,south_field,1300.5, twelve thousand,15-04-2023\n003,Rice,,1400,8000,2023.05.01\n004,soy-bean,East_Field,1250,9000,2023/4/20\n005,WHEAT,North_Field,one thousand five hundred,11000,April 25 2023\n006,Corn,south_field,1350,10500,2023-04-30\n007,rice-west,West_field,1450,NaN,2023/05/05\n008,soy_bean,East_field,1200,9500,05/15/2023\n009,wheat,north_field,1500,10000,2023/03/16\n010,corn,south-field,1300,12000,2023/04/15\n011,rice,west_field,1400,,2023-05-01\n012,soybean,East_Field,1250,9000,2023-04-20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize crop names by removing hyphens/underscores and capitalize", "columnName": "Crop", "expression": "value.toLowercase().replace(/[-_]/, '').replace(/^./,v,v.toUppercase())"}, {"op": "core/mass-edit", "description": "Correct inconsistent crop names after transformation", "columnName": "Crop", "edits": [{"from": ["Soybean", "Soybean"], "to": "Soybean"}]}, {"op": "core/text-transform", "description": "Fix Price_per_Ton to numeric values, convert text to numbers where possible", "columnName": "Price_per_Ton", "expression": "if(value.match(/^[0-9]+(\\.[0-9]+)?$/), value.toNumber(), if(value.toLowercase().contains('one thousand five hundred'), 1500, null))"}, {"op": "core/text-transform", "description": "Normalize LoanAmount field, convert text like 'twelve thousand' to number or blank to null", "columnName": "LoanAmount", "expression": "if(value.toLowercase() == 'twelve thousand', 12000, if(value.toLowercase() == 'nan' || value == '', null, value.toNumber()))"}, {"op": "core/date-parse", "description": "Parse SaleDate field with multiple formats", "columnName": "SaleDate", "mode": "lenient", "dateFormat": "yyyy/MM/dd||dd-MM-yyyy||yyyy.MM.dd||yyyy/M/d||MMMM d yyyy||yyyy-MM-dd||MM/dd/yyyy"}, {"op": "core/text-transform", "description": "Standardize Region names by replacing underscores and hyphens then capitalize", "columnName": "Region", "expression": "value.replace(/[-_]/, ' ').toLowercase().trim().split(' ').map(s, s.capitalize()).join(' ')"}, {"op": "core/fill-down", "description": "Fill down missing Region values", "columnName": "Region"}], "clean_table": "FarmID,Crop,Region,Price_per_Ton,LoanAmount,SaleDate\n001,Wheat,North Field,1500,10000,2023-03-15\n002,Corn,South Field,1300.5,12000,2023-04-15\n003,Rice,South Field,1400,8000,2023-05-01\n004,Soybean,East Field,1250,9000,2023-04-20\n005,Wheat,North Field,1500,11000,2023-04-25\n006,Corn,South Field,1350,10500,2023-04-30\n007,Rice,West Field,1450,,2023-05-05\n008,Soybean,East Field,1200,9500,2023-05-15\n009,Wheat,North Field,1500,10000,2023-03-16\n010,Corn,South Field,1300,12000,2023-04-15\n011,Rice,West Field,1400,,2023-05-01\n012,Soybean,East Field,1250,9000,2023-04-20"}
{"purpose": "Clean inconsistent movie genre labels and normalize release dates in the dataset.", "raw_table": "MovieID,Title,Genre,ReleaseDate,Rating,BoxOffice\n1,The_Great_escape,Action_Adventure,07-15-2019,8.5,150M\n2,romantic sunset,romance,2018/12/05,7.2,85m\n3,Space_War,SCI-FI,15th Jan 2020,7.9,200 million\n4,Haunted Nights,Horror--Thriller,10/31/2017,6.8,50M\n5,Funny_bones,COMEDY ,March 3 2019,7.0,75m\n6,The Last Stand,action,2019-08-22,8,180M\n7,Lost in Time,scifi,2018-07-10,7.5,90m\n8,Love_in_the_Air,Romance ,2019/02/14,7.3,100M\n9,ghost town,horror,2016-10-30,6.5,40m\n10,Comic Relief,comedy,2017/04/01,7.1,60M\n11,Warriors-Nextdoor,Action-Adventure,2019.11.11,8.3,170M\n12,Star_Dust, SciFi ,Jan 5 2021,8.1,210m\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Remove underscores and hyphens from Title column", "columnName": "Title", "expression": "value.replace(/[_-]/g, ' ').trim()"}, {"op": "core/text-transform", "description": "Standardize Genre capitalization and separators", "columnName": "Genre", "expression": "value.toLowerCase().replace(/[-_]+/g, ' ').split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Parse ReleaseDate column to ISO format yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "value.trim() ? date.parse(value).toISOString().substring(0,10) : ''"}, {"op": "core/text-transform", "description": "Normalize BoxOffice to numeric value in millions as number", "columnName": "BoxOffice", "expression": "value.toLowerCase().replace(/[^0-9\\.]/g, '') ? Number(value.toLowerCase().replace(/[^0-9\\.]/g, '')) : null"}, {"op": "core/text-transform", "description": "Convert Rating to number", "columnName": "Rating", "expression": "Number(value)"}], "clean_table": "MovieID,Title,Genre,ReleaseDate,Rating,BoxOffice\n1,The Great escape,Action Adventure,2019-07-15,8.5,150\n2,romantic sunset,Romance,2018-12-05,7.2,85\n3,Space War,Sci Fi,2020-01-15,7.9,200\n4,Haunted Nights,Horror Thriller,2017-10-31,6.8,50\n5,Funny bones,Comedy,2019-03-03,7,75\n6,The Last Stand,Action,2019-08-22,8,180\n7,Lost in Time,Sci Fi,2018-07-10,7.5,90\n8,Love in the Air,Romance,2019-02-14,7.3,100\n9,ghost town,Horror,2016-10-30,6.5,40\n10,Comic Relief,Comedy,2017-04-01,7.1,60\n11,Warriors Nextdoor,Action Adventure,2019-11-11,8.3,170\n12,Star Dust,Sci Fi,2021-01-05,8.1,210\n"}
{"purpose": "Clean and standardize farm produce sales data with inconsistent city names, price formats, and date representations.", "raw_table": "Farm,City,State,Produce,Price_per_kg,Sale_Date,Quantity_kg\nGreenValley_Farms,san-francisco,CA,Apples,1.20,2023/05/01,100\nSunny Orchards,Los Angeles,ca,apples,1.2O,05-02-2023,150\nRiverside_Farm,San Diego,CA,Oranges,$0.90,2023.05.03,200\nHillTop,-los angeles,CA,Oranges,0.9,3 May 2023,180\nMeadow Farms,San Diego,ca,Oragne,0.85,2023/5/04,190\nGreenValley_Farms,San Francisco,CA,Apples,1.25,2023-05-01,120\nSunny Orchards,los-angeles,CA,apples,,05/02/2023,160\nRiverside_Farm,San-Diego,Ca,oranges,0.95,2023/05/03,210\nHillTop,Los Angeles,CA,Oranges,0.92,May 3 2023,175\nMeadow Farms,San Diego,CA,Oranges,0.88,2023-05-04,195\nGreenValley Farms,San Francisco,CA,Apple,1.22,2023/05/01,130\nSunny Orchards,losangeles,ca,Apple,1.18,05/02/2023,155\nRiverside Farm,San Diego,CA,Oranges,0.91,2023/05/03,205\nHillTop,Los Angeles,CA,Oranges,0.93,2023/05/03,170\nMeadow Farms,San Diego,CA,Oranges,0.90,2023-05-04,185", "cleaning_workflow": [{"op": "core/text-transform", "description": "Standardize City names by removing hyphens and underscores, trimming spaces, and proper casing", "columnName": "City", "expression": "value.replace(/[-_]/, ' ').trim().toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize Farm names by replacing underscores and hyphens with space, trimming and proper casing", "columnName": "Farm", "expression": "value.replace(/[_-]/, ' ').trim().toTitlecase()"}, {"op": "core/mass-edit", "description": "Correct common misspellings in Produce column", "columnName": "Produce", "edits": [{"from": ["Oragne", "Apple"], "to": "Apples"}]}, {"op": "core/text-transform", "description": "Normalize Produce column to lowercase first letter uppercase", "columnName": "Produce", "expression": "value.toLowercase().replace(/^./, value[0].toUppercase())"}, {"op": "core/text-transform", "description": "Clean Price_per_kg: remove $ and fix letter O to zero", "columnName": "Price_per_kg", "expression": "value.replace(/\\$/, '').replace(/O/g, '0').trim()"}, {"op": "core/text-transform", "description": "Convert Price_per_kg to number (float)", "columnName": "Price_per_kg", "expression": "value.toNumber()"}, {"op": "core/date-parse", "description": "Parse Sale_Date column into standard yyyy-MM-dd", "columnName": "Sale_Date", "dateFormat": "auto-detect", "mode": "lenient"}, {"op": "core/mass-edit", "description": "Standardize State abbreviations to uppercase", "columnName": "State", "edits": [{"from": ["ca", "Ca"], "to": "CA"}]}, {"op": "core/fill-down", "description": "Fill down missing Price_per_kg values for Sunny Orchards apples on 05/02/2023", "columnName": "Price_per_kg"}], "clean_table": "Farm,City,State,Produce,Price_per_kg,Sale_Date,Quantity_kg\nGreenvalley Farms,San Francisco,CA,Apples,1.2,2023-05-01,100\nSunny Orchards,Los Angeles,CA,Apples,1.2,2023-05-02,150\nRiverside Farm,San Diego,CA,Oranges,0.9,2023-05-03,200\nHilltop,Los Angeles,CA,Oranges,0.9,2023-05-03,180\nMeadow Farms,San Diego,CA,Oranges,0.85,2023-05-04,190\nGreenvalley Farms,San Francisco,CA,Apples,1.25,2023-05-01,120\nSunny Orchards,Los Angeles,CA,Apples,1.2,2023-05-02,160\nRiverside Farm,San Diego,CA,Oranges,0.95,2023-05-03,210\nHilltop,Los Angeles,CA,Oranges,0.92,2023-05-03,175\nMeadow Farms,San Diego,CA,Oranges,0.88,2023-05-04,195\nGreenvalley Farms,San Francisco,CA,Apples,1.22,2023-05-01,130\nSunny Orchards,Los Angeles,CA,Apples,1.18,2023-05-02,155\nRiverside Farm,San Diego,CA,Oranges,0.91,2023-05-03,205\nHilltop,Los Angeles,CA,Oranges,0.93,2023-05-03,170\nMeadow Farms,San Diego,CA,Oranges,0.9,2023-05-04,185"}
{"purpose": "Clean and standardize city names, business types, and price formats in the energy loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,ny,solar_power,1200.5,10000,2023/01/15\nlos angeles,CA,Wind-Energy,950.00,8000,15-02-2023\nChicagoo,IL,solar_power,1100,9000,2023-03-10\nHous-ton,TX,Wind-Energy,,7000,2023/04/05\nphoenix,AZ,solar-power,1000.75,6500,04-15-2023\nphiladelphia,PA,solarpower,1050.50,7200,2023-05-20\nSan francisco,ca,,1150.00,7800,2023/06/01\nDenver,co,Wind_Energy,980,6800,2023.07.10\nboston,MA,Solar Power,1025,7100,07/20/2023\nseattle,wa,windenergy,975.25,6900,2023-08-15\nMiami,FL,solar-power,1010,6700,2023/09/01\natlanta,GA,WIND-ENERGY,990,7300,2023-10-10\nDallas,TX,solar_power,1085,7500,2023/11/05\nDetroit,mi,wind energy,920,6400,2023-12-01", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_york"], "to": "New York"}, {"from": ["Chicagoo"], "to": "Chicago"}, {"from": ["Hous-ton"], "to": "Houston"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["solar_power", "solar-power", "solarpower", "Solar Power"], "to": "Solar Power"}, {"from": ["Wind-Energy", "Wind_Energy", "windenergy", "WIND-ENERGY", "wind energy"], "to": "Wind Energy"}]}, {"op": "core/fill-down", "columnName": "BusinessType"}, {"op": "core/text-transform", "columnName": "Price", "expression": "value != null && value != '' ? Number(value) : null"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value.replace(/\\./g, '/').replace(/-/g, '/').replace(/(\\d{2})\\/(\\d{2})\\/(\\d{4})/, '$3/$1/$2')"}, {"op": "core/date-parse", "columnName": "Date", "dateFormat": "yyyy/MM/dd"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Power,1200.5,10000,2023-01-15\nLos Angeles,CA,Wind Energy,950,8000,2023-02-15\nChicago,IL,Solar Power,1100,9000,2023-03-10\nHouston,TX,Wind Energy,,7000,2023-04-05\nPhoenix,AZ,Solar Power,1000.75,6500,2023-04-15\nPhiladelphia,PA,Solar Power,1050.5,7200,2023-05-20\nSan Francisco,CA,Solar Power,1150,7800,2023-06-01\nDenver,CO,Wind Energy,980,6800,2023-07-10\nBoston,MA,Solar Power,1025,7100,2023-07-20\nSeattle,WA,Wind Energy,975.25,6900,2023-08-15\nMiami,FL,Solar Power,1010,6700,2023-09-01\nAtlanta,GA,Wind Energy,990,7300,2023-10-10\nDallas,TX,Solar Power,1085,7500,2023-11-05\nDetroit,MI,Wind Energy,920,6400,2023-12-01"}
{"purpose": "Standardize movie production company names and normalize release dates.", "raw_table": "MovieTitle,ProductionCompany,ReleaseDate,BoxOffice\nIncepti0n,Warner_bros,07-16-2010,829895144\nThe Godfather,PARAMOUNT pictures,03/24/1972,246120986\navatar,20th_century fox,12.18.2009,2847246203\nInterstellar,warner bros.,11-07-2014,677471339\nThe Dark Knight,Warner-Bros,07/18/2008,1004558444\nTitanic,parAmount Pictures,12/19/1997,2187463944\nThe Matrix,WARNER bros,03.31.1999,463517383\nForrest Gump,Paramount_pictures,07-06-1994,678226465\nGladiator,universal pictures,05/05/2000,457640427\nPulp Fiction,Miramax_films,,213928762\nStar Wars,Lucasfilm ltd,05-25-1977,775398007\nJurassic Park,universal-pictures,06/11/1993,1070289600\nThe Avengers,marvel studios,05.04.2012,1518812988\nFight Club,20th_century-Fox,10/15/1999,100853753\nThe Shawshank Redemption,Columbia Pictures,09-23-1994,28341469", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize ProductionCompany by replacing underscores and hyphens with spaces", "columnName": "ProductionCompany", "expression": "value.replace(/[_-]/g, ' ')"}, {"op": "core/text-transform", "description": "Trim and lowercase ProductionCompany", "columnName": "ProductionCompany", "expression": "value.toLowerCase().trim()"}, {"op": "core/mass-edit", "description": "Standardize known production company names", "columnName": "ProductionCompany", "edits": [{"from": ["warner bros", "warner bros.", "warner bros "], "to": "Warner Bros"}, {"from": ["paramount pictures", "paramount_pictures", "paramount pictures "], "to": "Paramount Pictures"}, {"from": ["20th century fox", "20th century fox "], "to": "20th Century Fox"}, {"from": ["universal pictures", "universal-pictures"], "to": "Universal Pictures"}, {"from": ["miramax films", "miramax_films"], "to": "Miramax Films"}, {"from": ["lucasfilm ltd"], "to": "Lucasfilm Ltd"}, {"from": ["marvel studios"], "to": "Marvel Studios"}, {"from": ["columbia pictures"], "to": "Columbia Pictures"}]}, {"op": "core/text-transform", "description": "Standardize ReleaseDate format to yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "if(value==null || value.trim()==='') null else \n  ( \n    (value.match(/\\d{2}[-\\/.]\\d{2}[-\\/.]\\d{4}/) ? \n      (var parts = value.split(/[\\-\\.\\/]/); parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0')) : \n    (value.match(/\\d{4}[-\\/.]\\d{2}[-\\/.]\\d{2}/) ? value.replace(/[\\.]/g, '-') : \n    (value.match(/\\d{2}[-\\/.]\\d{2}[-\\/.]\\d{2}/) ? '19' + value.split(/[\\-\\.\\/]/)[2] + '-' + value.split(/[\\-\\.\\/]/)[0] + '-' + value.split(/[\\-\\.\\/]/)[1] : \n    value)))\n  )"}, {"op": "core/date-parse", "description": "Parse ReleaseDate to date type", "columnName": "ReleaseDate"}, {"op": "core/text-transform", "description": "Format ReleaseDate to yyyy-MM-dd string", "columnName": "ReleaseDate", "expression": "value.toString('yyyy-MM-dd')"}], "clean_table": "MovieTitle,ProductionCompany,ReleaseDate,BoxOffice\nIncepti0n,Warner Bros,2010-07-16,829895144\nThe Godfather,Paramount Pictures,1972-03-24,246120986\navatar,20th Century Fox,2009-12-18,2847246203\nInterstellar,Warner Bros,2014-11-07,677471339\nThe Dark Knight,Warner Bros,2008-07-18,1004558444\nTitanic,Paramount Pictures,1997-12-19,2187463944\nThe Matrix,Warner Bros,1999-03-31,463517383\nForrest Gump,Paramount Pictures,1994-07-06,678226465\nGladiator,Universal Pictures,2000-05-05,457640427\nPulp Fiction,Miramax Films,,213928762\nStar Wars,Lucasfilm Ltd,1977-05-25,775398007\nJurassic Park,Universal Pictures,1993-06-11,1070289600\nThe Avengers,Marvel Studios,2012-05-04,1518812988\nFight Club,20th Century Fox,1999-10-15,100853753\nThe Shawshank Redemption,Columbia Pictures,1994-09-23,28341469"}
{"purpose": "Standardize energy provider names and clean inconsistent date and price formats for accurate billing records.", "raw_table": "City,State,Provider,Price_per_kWh,Loan_Amount,Date\nNew_york,NY,Green Energy,0.12,15000,2022/03/15\nlos angeles,CA,green-energy,0.14,20000,15-04-2022\nCHICAGO,il,GreenEnergy,12 cents,18000,2022-05-20\nHouston,TX,Green_eergy,0.13,,2022/06/01\nphoenix,az,Green Energy,0.11,16000,2022-07-10\nphiladelphia,PA,green energy,0.13,17000,2022.08.15\nSan Antonio,TX,Green-Energy,0.14,19000,2022/09/01\nsan_diego,CA,green-energy,13 cents,17500,2022-10-05\nDALLAS,TX,GreenEnergy,0.12,16500,2022/11/20\nSan Jose,CA,Green Energy,0.11,15500,2022-12-01\nAustin,TX,greenenergy,0.13,18000,2023/01/15\nJacksonville,FL,Green-Energy,0.12,,2023-02-10", "cleaning_workflow": [{"op": "core/mass-edit", "description": "Standardize Provider names with variants", "columnName": "Provider", "edits": [{"from": ["Green Energy", "green energy", "GreenEnergy", "greenenergy", "Green-Energy", "green-energy", "Green_eergy"], "to": "Green Energy"}]}, {"op": "core/text-transform", "description": "Remove underscores and hyphens in City names and capitalize properly", "columnName": "City", "expression": "value.replace('_',' ').replace('-',' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize Price_per_kWh column to numeric decimal", "columnName": "Price_per_kWh", "expression": "value.toLowercase().replace(' cents','').match(/\\d*\\.?\\d+/)[0].toNumber() > 1 ? (value.toLowercase().replace(' cents','').match(/\\d*\\.?\\d+/)[0].toNumber() / 100) : value.toLowercase().replace(' cents','').match(/\\d*\\.?\\d+/)[0].toNumber()"}, {"op": "core/mass-edit", "description": "Fill missing Loan_Amount values with average (imputed)", "columnName": "Loan_Amount", "edits": [{"from": [""], "to": "17250"}]}, {"op": "core/date-parse", "description": "Standardize Date format to yyyy-MM-dd", "columnName": "Date", "format": "automatic"}, {"op": "core/text-transform", "description": "Capitalize State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}], "clean_table": "City,State,Provider,Price_per_kWh,Loan_Amount,Date\nNew York,NY,Green Energy,0.12,15000,2022-03-15\nLos Angeles,CA,Green Energy,0.14,20000,2022-04-15\nChicago,IL,Green Energy,0.12,18000,2022-05-20\nHouston,TX,Green Energy,0.13,17250,2022-06-01\nPhoenix,AZ,Green Energy,0.11,16000,2022-07-10\nPhiladelphia,PA,Green Energy,0.13,17000,2022-08-15\nSan Antonio,TX,Green Energy,0.14,19000,2022-09-01\nSan Diego,CA,Green Energy,0.13,17500,2022-10-05\nDallas,TX,Green Energy,0.12,16500,2022-11-20\nSan Jose,CA,Green Energy,0.11,15500,2022-12-01\nAustin,TX,Green Energy,0.13,18000,2023-01-15\nJacksonville,FL,Green Energy,0.12,17250,2023-02-10"}
{"purpose": "Standardize inconsistent city and state names, fix loan amount formats, and normalize date entries for government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew york, ny,Tech Startup,25,000,100000,01/15/2023\nlos_angeles,CA,Construction,50.000,150_000,2023-02-10\nChicago, il,REtail,30,500,80,000,FEB 5 2023\nhouston, TX,healthcare,20_000,,2023/03/01\nPhoenix,az,Education,15,000,120000,3-15-2023\nphiladelphia,PA,tech-startup,28,000,90000,March 20 2023\nsan antonio,tx,Construction,45,000,125000,2023.04.25\nSan Diego,CA,RETAIL,35,500,110000,04/30/2023\nDallas,tx,HealthCare,40,000,130000,May 5 2023\nsan jose, ca,Education,20,500,100000,2023-06-10\nAustin,TX,tech startup,22_000,95000,06/15/2023\nJacksonville,fl,Construction,50,000,140000,2023/07/01\nfort worth,TX,Retail,33,000,105000,July 10 2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and fix inconsistent capitalization in City column", "columnName": "City", "expression": "value.trim().toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State abbreviations to uppercase and trim", "columnName": "State", "expression": "value.trim().toUppercase()"}, {"op": "core/mass-edit", "description": "Fix misspellings and unify BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["Tech Startup", "tech startup", "tech-startup", "techstartup"], "to": "Tech Startup"}, {"from": ["Construction", "construction"], "to": "Construction"}, {"from": ["Retail", "REtail", "RETAIL", "Retail "], "to": "Retail"}, {"from": ["Healthcare", "healthcare", "HealthCare", "Health care"], "to": "Healthcare"}, {"from": ["Education", "education"], "to": "Education"}]}, {"op": "core/text-transform", "description": "Remove commas and underscores from Price and convert to number string", "columnName": "Price", "expression": "value.replace(/[,_]/, '').trim()"}, {"op": "core/text-transform", "description": "Remove commas and underscores from LoanAmount and convert to number string", "columnName": "LoanAmount", "expression": "value ? value.replace(/[,_]/, '').trim() : ''"}, {"op": "core/date-parse", "description": "Parse Date column with multiple date formats", "columnName": "Date", "expression": "value", "onError": "keep-original", "mode": "loose"}, {"op": "core/text-transform", "description": "Format Date to ISO yyyy-MM-dd", "columnName": "Date", "expression": "cells['Date'].value ? cells['Date'].date.toISOString().substring(0,10) : ''"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Tech Startup,25000,100000,2023-01-15\nLos Angeles,CA,Construction,50000,150000,2023-02-10\nChicago,IL,Retail,30500,80000,2023-02-05\nHouston,TX,Healthcare,20000,130000,2023-03-01\nPhoenix,AZ,Education,15000,120000,2023-03-15\nPhiladelphia,PA,Tech Startup,28000,90000,2023-03-20\nSan Antonio,TX,Construction,45000,125000,2023-04-25\nSan Diego,CA,Retail,35500,110000,2023-04-30\nDallas,TX,Healthcare,40000,130000,2023-05-05\nSan Jose,CA,Education,20500,100000,2023-06-10\nAustin,TX,Tech Startup,22000,95000,2023-06-15\nJacksonville,FL,Construction,50000,140000,2023-07-01\nFort Worth,TX,Retail,33000,105000,2023-07-10"}
{"purpose": "Clean and standardize city and state names, normalize business types, and correct date and numeric formats in telecommunications loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew-york,ny,telecom,1000,50000,01/15/2023\nLOS ANGELES,CA,Internet_Provider,2000,75000,2023-02-20\nSan_Francisco,CAL,ISP,1500,60000,15-03-2023\nchicago,il,telecom,,45000,2023/04/10\nHouston,TX,Telecom,,70000,2023.05.25\nPHOENIX,AZ,Internet-provider,1800,55000,05/30/23\nPhiladelphia,pa,ISP,1750,NA,2023-06-15\nsan antonio,tx,telecom,1650,62000,2023-07-01\nDallas,Tx,Internetprovider,1900,68000,07/15/2023\nsan-diego,CA,ISP,1700,50000,2023-08-20\nSan Jose,ca,telecom,NaN,59000,2023/09/10\nAustin,TX,Internet-Provider,2100,72000,2023-10-05\nJacksonville,fl,isp,1600,48000,10/20/2023", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["new-york"], "to": "New York"}, {"from": ["LOS ANGELES"], "to": "Los Angeles"}, {"from": ["San_Francisco"], "to": "San Francisco"}, {"from": ["san antonio"], "to": "San Antonio"}, {"from": ["san-diego"], "to": "San Diego"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase()"}, {"op": "core/mass-edit", "columnName": "State", "edits": [{"from": ["ny"], "to": "NY"}, {"from": ["CAL"], "to": "CA"}, {"from": ["pa"], "to": "PA"}, {"from": ["Tx"], "to": "TX"}, {"from": ["fl"], "to": "FL"}]}, {"op": "core/text-transform", "columnName": "BusinessType", "expression": "value.toLowercase().replaceAll('_','').replaceAll('-','')"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["internetprovider", "internetprovider", "internetprovider", "internetprovider"], "to": "Internet Provider"}, {"from": ["isp"], "to": "Internet Service Provider"}, {"from": ["telecom"], "to": "Telecommunications"}, {"from": ["internetprovider"], "to": "Internet Provider"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "if(value=='' || value.toLowercase()=='nan' || value.toLowercase()=='na') null else value.toNumber()"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "if(value=='' || value.toLowercase()=='nan' || value.toLowercase()=='na') null else value.toNumber()"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value.replace(/\\./, '-').replace(/\\//, '-').replace(/^(\\d{2})-(\\d{2})-(\\d{4})$/, '$3-$1-$2').replace(/^(\\d{2})-(\\d{2})-(\\d{2})$/, '20$3-$1-$2')"}, {"op": "core/date-parse", "columnName": "Date", "options": {"guessCellType": true, "mode": "lenient"}}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecommunications,1000,50000,2023-01-15\nLos Angeles,CA,Internet Provider,2000,75000,2023-02-20\nSan Francisco,CA,Internet Service Provider,1500,60000,2023-03-15\nChicago,IL,Telecommunications,,45000,2023-04-10\nHouston,TX,Telecommunications,,70000,2023-05-25\nPhoenix,AZ,Internet Provider,1800,55000,2023-05-30\nPhiladelphia,PA,Internet Service Provider,1750,,2023-06-15\nSan Antonio,TX,Telecommunications,1650,62000,2023-07-01\nDallas,TX,Internet Provider,1900,68000,2023-07-15\nSan Diego,CA,Internet Service Provider,1700,50000,2023-08-20\nSan Jose,CA,Telecommunications,,59000,2023-09-10\nAustin,TX,Internet Provider,2100,72000,2023-10-05\nJacksonville,FL,Internet Service Provider,1600,48000,2023-10-20"}
{"purpose": "Standardize and clean farm equipment sales data with inconsistent formatting and missing values.", "raw_table": "FarmID,City,State,EquipmentType,Price,LoanAmount,SaleDate\nF001,Springfield,illinois,Tractor,25000,15000,2023/01/15\nF002,lincoln,NE,combine-harvester,45000,,15-02-2023\nF003,Decatur,Illinois,TRACTOR,23000,12000,2023-03-05\nF004,lincoln,ne,plow,5000,3500,03/20/2023\nF005,CHARLESTON,IL,harvester,38000,25000,2023.04.25\nF006,,IL,tractor,26000,16000,2023/05/17\nF007,Springfield,IL,COMBINE-HARVESTER,47000,30000,2023-06-01\nF008,decatur,illinois,Plow,4800,,2023/07/10\nF009,Lincoln,NE,Tractor,25500,15500,2023-08-12\nF010,Charleston,IL,Harvester,39000,26000,2023-09-30\nF011,CHARLESTON,Illinois,TRACTOR,24500,14000,2023/10/05\nF012,Springfield,illinois,plow,5200,3700,2023-11-11\nF013,Decatur,IL,COMBINE-HARVESTER,46000,29000,\nF014,Lincoln,Ne,Harvester,38500,25500,2023/12/20\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize City names properly", "engineConfig": {"facets": []}, "columnName": "City", "expression": "value.toLowercase().split(' ').map(word, word.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Capitalize State codes as uppercase", "engineConfig": {"facets": []}, "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize EquipmentType to Title Case and replace hyphens with spaces", "engineConfig": {"facets": []}, "columnName": "EquipmentType", "expression": "value.toLowercase().replace('-', ' ').split(' ').map(word, word.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize missing LoanAmount values to empty", "engineConfig": {"facets": []}, "columnName": "LoanAmount", "edits": [{"from": [""], "to": ""}]}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numeric values as strings with no commas", "engineConfig": {"facets": []}, "columnName": "Price", "expression": "value.replace(/[^0-9.]/g, '')"}, {"op": "core/text-transform", "description": "Convert LoanAmount to numeric strings with no commas", "engineConfig": {"facets": []}, "columnName": "LoanAmount", "expression": "value==null||value=='' ? '' : value.replace(/[^0-9.]/g, '')"}, {"op": "core/date-parse", "description": "Parse SaleDate in flexible formats and convert to yyyy-MM-dd", "engineConfig": {"facets": []}, "columnName": "SaleDate", "mode": "custom", "format": "yyyy-MM-dd", "expression": "value.replace(/[\\.\\/]/g, '-')", "onError": "set-to-blank", "onBlank": "set-to-blank"}, {"op": "core/fill-down", "description": "Fill down missing City values", "engineConfig": {"facets": []}, "columnName": "City"}], "clean_table": "FarmID,City,State,EquipmentType,Price,LoanAmount,SaleDate\nF001,Springfield,IL,Tractor,25000,15000,2023-01-15\nF002,Lincoln,NE,Combine Harvester,45000,,2023-02-15\nF003,Decatur,IL,Tractor,23000,12000,2023-03-05\nF004,Lincoln,NE,Plow,5000,3500,2023-03-20\nF005,Charleston,IL,Harvester,38000,25000,2023-04-25\nF006,Charleston,IL,Tractor,26000,16000,2023-05-17\nF007,Springfield,IL,Combine Harvester,47000,30000,2023-06-01\nF008,Decatur,IL,Plow,4800,,2023-07-10\nF009,Lincoln,NE,Tractor,25500,15500,2023-08-12\nF010,Charleston,IL,Harvester,39000,26000,2023-09-30\nF011,Charleston,IL,Tractor,24500,14000,2023-10-05\nF012,Springfield,IL,Plow,5200,3700,2023-11-11\nF013,Decatur,IL,Combine Harvester,46000,29000,\nF014,Lincoln,NE,Harvester,38500,25500,2023-12-20\n"}
{"purpose": "Clean and normalize business license application data with inconsistent city names, business types, and date formats.", "raw_table": "ApplicantID,City,State,BusinessType,LicenseFee,LoanAmount,ApplicationDate\n001,NeW_York,NY,retail-store,500,15000,2023/03/15\n002,los-angeles,CA,Restaurant,450,20000,15-04-2023\n003,,CA,Retaill-store,600,,2023-05-01\n004,ChIcAgO,IL,consulting,550,18000,2023.06.10\n005,Houston,TX,Consult-ING,NaN,22000,07/20/2023\n006,phoenix,AZ,retailstore,400,17000,2023/08/01\n007,philadelphia,pa,,480,16000,2023/09/15\n008,San_antoniO,TX,RETAIL_STORE,520,NaN,2023-10-05\n009,dallas,TX,Consulting,530,21000,2023/11/11\n010,San Diego,ca,REstaurant,470,19000,11-12-2023\n011,SanJose,CA,Retail-store,510,19500,2023-12-01\n012,LosAngeles,CA,restaurant,495,18500,2023/12/15\n013,Hou_ston,TX,Consulting,NaN,20000,2023-12-20\n014,Chicago,IL,Retail-Store,505,17500,2023-11-30\n015,New York,NY,retail_store,490,16000,12/05/2023", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.replace(/[_\\-]/, ' ').toTitlecase()", "onError": "keep-original"}, {"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["LosAngeles", "Los Angeles", "los angeles", "los-angeles"], "to": "Los Angeles"}, {"from": ["Houston", "Hou_ston"], "to": "Houston"}, {"from": ["San antoniO", "San_antoniO"], "to": "San Antonio"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["retail-store", "Retail-store", "retail_store", "RETAIL_STORE", "retailstore"], "to": "Retail Store"}, {"from": ["Restaurant", "REstaurant", "restaurant"], "to": "Restaurant"}, {"from": ["consulting", "Consult-ING", "Consulting"], "to": "Consulting"}, {"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "columnName": "LicenseFee", "expression": "if(value=='NaN' || value=='', '', value.toNumber())", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "if(value=='NaN' || value=='', '', value.toNumber())", "onError": "keep-original"}, {"op": "core/date-parse", "columnName": "ApplicationDate", "expression": "value.toDate()", "dateFormat": "yyyy-MM-dd", "onError": "keep-original"}, {"op": "core/text-transform", "columnName": "ApplicationDate", "expression": "value.toString('yyyy-MM-dd')", "onError": "keep-original"}], "clean_table": "ApplicantID,City,State,BusinessType,LicenseFee,LoanAmount,ApplicationDate\n001,New York,NY,Retail Store,500,15000,2023-03-15\n002,Los Angeles,CA,Restaurant,450,20000,2023-04-15\n003,Unknown,CA,Retail Store,600,,2023-05-01\n004,Chicago,IL,Consulting,550,18000,2023-06-10\n005,Houston,TX,Consulting,,22000,2023-07-20\n006,Phoenix,AZ,Retail Store,400,17000,2023-08-01\n007,Philadelphia,PA,Unknown,480,16000,2023-09-15\n008,San Antonio,TX,Retail Store,520,,2023-10-05\n009,Dallas,TX,Consulting,530,21000,2023-11-11\n010,San Diego,CA,Restaurant,470,19000,2023-11-12\n011,San Jose,CA,Retail Store,510,19500,2023-12-01\n012,Los Angeles,CA,Restaurant,495,18500,2023-12-15\n013,Houston,TX,Consulting,,20000,2023-12-20\n014,Chicago,IL,Retail Store,505,17500,2023-11-30\n015,New York,NY,Retail Store,490,16000,2023-12-05"}
{"purpose": "Clean and standardize movie metadata including titles, genres, release dates, and box office revenue.", "raw_table": "MovieTitle,Genre,ReleaseDate,BoxOffice,Rating\nInception ,sci-Fi ,07/16/2010,$829.89M ,8.8\nThe God_father,Crime-Drama,1972-03-24,134.97 million,9.2\navatar,Sci fi,12/18/2009,2.847B,7.8\nparasite,thriller,05/30/2019,258.8 million,8.6\nJoker,Drama,10-04-2019,1.074b,8.5\nThe Shawshank Redemption,Drama,14/10/1994,28341469,9.3\navengers_endgame,Action-SciFi,2019/04/26,2.798B,8.4\nIntersteller,SciFi,2014/11/07,677.5 million,8.6\nTitanic,Drama-Romance,12_19_1997,2.187b,7.8\nUP,Animation,May 29 2009,$735.1 million,8.2\nFrozen,animation,11/27/2013,1.276b,7.5\nstar wars,SCI-FI,1977-05-25,775.4M,8.6\nThe Dark Knight,action-DRAMA,07 July 2008,$1.005b,9.0\nGladiator,Action,2000_05_05,457.6million,8.5\nThe Lion King,Animation,June 24 1994,$968.5 M,8.5", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from MovieTitle", "columnName": "MovieTitle", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Standardize Genre capitalization and separators", "columnName": "Genre", "expression": "value.toLowercase().replace(/-/g, ' ').replace(/_/g, ' ').split(' ').filter(v, v != '').map(v, v.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Parse and standardize ReleaseDate to yyyy-MM-dd", "columnName": "ReleaseDate", "expression": "if(isBlank(value), null, date.parse(value).toString('yyyy-MM-dd'))"}, {"op": "core/text-transform", "description": "Normalize BoxOffice to numeric millions", "columnName": "BoxOffice", "expression": "if(isBlank(value), null, if(value.toLowercase().contains('b'), num(value.replace(/[\\$,bB]/g, '')) * 1000, num(value.replace(/[\\$,mM]/g, ''))))"}, {"op": "core/text-transform", "description": "Convert BoxOffice millions to float with one decimal", "columnName": "BoxOffice", "expression": "round(value * 1.0, 1)"}, {"op": "core/text-transform", "description": "Standardize MovieTitle capitalization (Title Case)", "columnName": "MovieTitle", "expression": "value.split(/[_\\s]+/).map(word, word.toLowercase().replaceFirstChar(c, c.toUppercase())).join(' ')"}, {"op": "core/text-transform", "description": "Standardize Genre capitalization and join with comma", "columnName": "Genre", "expression": "value.split(' ').map(v, v.trim()).filter(v, v != '').unique().join(', ')"}, {"op": "core/text-transform", "description": "Capitalize Rating as float", "columnName": "Rating", "expression": "num(value)"}], "clean_table": "MovieTitle,Genre,ReleaseDate,BoxOffice,Rating\nInception,Sci Fi,2010-07-16,829.9,8.8\nThe God Father,Crime Drama,1972-03-24,135.0,9.2\nAvatar,Sci Fi,2009-12-18,2847.0,7.8\nParasite,Thriller,2019-05-30,258.8,8.6\nJoker,Drama,2019-10-04,1074.0,8.5\nThe Shawshank Redemption,Drama,1994-10-14,28.3,9.3\nAvengers Endgame,Action Sci Fi,2019-04-26,2798.0,8.4\nIntersteller,Sci Fi,2014-11-07,677.5,8.6\nTitanic,Drama Romance,1997-12-19,2187.0,7.8\nUp,Animation,2009-05-29,735.1,8.2\nFrozen,Animation,2013-11-27,1276.0,7.5\nStar Wars,Sci Fi,1977-05-25,775.4,8.6\nThe Dark Knight,Action Drama,2008-07-07,1005.0,9.0\nGladiator,Action,2000-05-05,457.6,8.5\nThe Lion King,Animation,1994-06-24,968.5,8.5"}
{"purpose": "Standardize city and business type names, fix date formats, and normalize numeric fields in energy loan data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew-york,NY,solar installation,12000,10000,2023/01/15\nlos_angeles,CA,Wind-Turbine,15000,12000,15-02-2023\nCHICAGO,il,Solar Panel,11000,missing,2023.03.10\nhouston,Tx,solar-installation,13000,11000,03/25/23\nPHOENIX,az,wind turbine,14000,13000,2023-04-05\nphiladelphia,Pa,solar Installation,missing,12500,2023/13/05\nsan-antonio,TX,wind-turbine,12500,11500,2023/05/20\nsan diego,CA,Solar panel,11500,10500,2023-06-15\nDALLAS,tx,Solar-Panel,missing,10000,2023/07/01\nsan jose,CA,wind turbine,13500,,2023-08-12\nAustin,Tx,solar_installation,12000,11000,2023/09/01\njacksonville,fl,Wind turbine,14000,13000,20230915\nfort worth,TX,SolarPanel,12500,11500,2023/10/10\ncolumbus,OH,solar installation,13000,missing,10/25/2023\ncharlotte,NC,wind-turbine,14000,12000,2023-11-05", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize city names properly and remove underscores/hyphens", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toLowercase().split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(' ')"}, {"op": "core/text-transform", "description": "Standardize state codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Standardize BusinessType values to Title Case and remove special chars", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[_-]/g, ' ').split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Fix missing LoanAmount and Price values", "columnName": "LoanAmount", "edits": [{"from": ["missing", ""], "to": ""}]}, {"op": "core/mass-edit", "description": "Fix missing Price values", "columnName": "Price", "edits": [{"from": ["missing"], "to": ""}]}, {"op": "core/text-transform", "description": "Normalize Price and LoanAmount to numeric values, missing to blank", "columnName": "Price", "expression": "isNaN(parseFloat(value)) ? '' : parseFloat(value).toString()"}, {"op": "core/text-transform", "description": "Normalize LoanAmount to numeric value, missing to blank", "columnName": "LoanAmount", "expression": "isNaN(parseFloat(value)) ? '' : parseFloat(value).toString()"}, {"op": "core/text-transform", "description": "Parse and normalize Date to ISO yyyy-MM-dd", "columnName": "Date", "expression": "value.match(/\\d{4}[-/.]\\d{2}[-/.]\\d{2}/) ? value.replace(/[.]/g, '-').slice(0,10) : (value.match(/\\d{2}[-/]\\d{2}[-/]\\d{4}/) ? (value.split(/[-/]/).reverse().join('-')) : (value.match(/^\\d{8}$/) ? value.slice(0,4)+'-'+value.slice(4,6)+'-'+value.slice(6,8) : ''))"}, {"op": "core/mass-edit", "description": "Correct date with invalid month/day typo", "columnName": "Date", "edits": [{"from": ["2023-13-05"], "to": "2023-05-13"}]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,12000,10000,2023-01-15\nLos Angeles,CA,Wind Turbine,15000,12000,2023-02-15\nChicago,IL,Solar Panel,11000,,2023-03-10\nHouston,TX,Solar Installation,13000,11000,2023-03-25\nPhoenix,AZ,Wind Turbine,14000,13000,2023-04-05\nPhiladelphia,PA,Solar Installation,,12500,2023-05-13\nSan Antonio,TX,Wind Turbine,12500,11500,2023-05-20\nSan Diego,CA,Solar Panel,11500,10500,2023-06-15\nDallas,TX,Solar Panel,,10000,2023-07-01\nSan Jose,CA,Wind Turbine,13500,,2023-08-12\nAustin,TX,Solar Installation,12000,11000,2023-09-01\nJacksonville,FL,Wind Turbine,14000,13000,2023-09-15\nFort Worth,TX,Solar Panel,12500,11500,2023-10-10\nColumbus,OH,Solar Installation,13000,,2023-10-25\nCharlotte,NC,Wind Turbine,14000,12000,2023-11-05"}
{"purpose": "Standardize inconsistent farm product names and clean date and price formats.", "raw_table": "FarmID,Farm_Name,Product,Price_per_Unit,Loan_Amount,Harvest_Date\n101,Green_valley,Tomato,1.5$,15000,2023/07/15\n102,Sunshine_farms,Potato ,$0.75,12000,15-08-2023\n103,Happy-Harvest,Tomatos,1.45,13000,2023.09.10\n104,RiverSide,Fresh potato,0.7,14000,2023/09/05\n105,Green_Valley,tomato,1.5,missing,2023/07/20\n106,sunshine_farms,Potato,0.8,$12500,2023-08-16\n107,Happy-Harvest,,1.4,13500,09/11/2023\n108,Riverside,Fresh-Potato,0.68,14000,2023/09/07\n109,Green-Valley,Tomato,1.55,15000,2023/07/18\n110,Sunshine_Farms,Potatoes,0.77,12000,2023/08/14", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace from Product", "columnName": "Product", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Standardize Product names to singular lowercase", "columnName": "Product", "expression": "if(value.toLowercase().match(/tomato/), 'tomato', if(value.toLowercase().match(/potato/), 'potato', ''))"}, {"op": "core/mass-edit", "description": "Fix missing Loan_Amount", "columnName": "Loan_Amount", "edits": [{"from": ["", "missing"], "to": "0"}]}, {"op": "core/text-transform", "description": "Remove $ sign and convert Price_per_Unit to number", "columnName": "Price_per_Unit", "expression": "value.replace(/\\$/,'').toNumber()"}, {"op": "core/text-transform", "description": "Remove $ sign and convert Loan_Amount to number", "columnName": "Loan_Amount", "expression": "value.toString().replace(/\\$/,'').toNumber()"}, {"op": "core/date-parse", "description": "Normalize Harvest_Date to yyyy-MM-dd", "columnName": "Harvest_Date", "expression": "value", "format": "auto-detect", "locale": "en"}, {"op": "core/text-transform", "description": "Capitalize Farm_Name with proper spacing", "columnName": "Farm_Name", "expression": "value.replace(/[_-]/g,' ').split(' ').map(v, v.trim().toLowercase().replace(/^(.)/,v.substring(0,1).toUppercase())).join(' ')"}], "clean_table": "FarmID,Farm_Name,Product,Price_per_Unit,Loan_Amount,Harvest_Date\n101,Green Valley,tomato,1.5,15000,2023-07-15\n102,Sunshine Farms,potato,0.75,12000,2023-08-15\n103,Happy Harvest,tomato,1.45,13000,2023-09-10\n104,Riverside,potato,0.7,14000,2023-09-05\n105,Green Valley,tomato,1.5,0,2023-07-20\n106,Sunshine Farms,potato,0.8,12500,2023-08-16\n107,Happy Harvest,,1.4,13500,2023-09-11\n108,Riverside,potato,0.68,14000,2023-09-07\n109,Green Valley,tomato,1.55,15000,2023-07-18\n110,Sunshine Farms,potato,0.77,12000,2023-08-14"}
{"purpose": "Standardize city names, normalize business types, fix date formats, and correct numeric values for loan amounts and prices in energy sector data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew-york,NY,solar-installation,12000,50,000,2023/01/15\nlos angeles,CA,Wind-Farm,15000,45000,15-02-2023\nHuston,TX,solar_installation,11000,,2023.03.05\nPhoenix,Az,Biomass_plant, 14000,40000,2023/4/07\nphiladelphia,pa,Wind farm,13000,47000,07-05-2023\nSan Antonio,tx,SOLAR-installation,12500,43000,2023-06-15\nSan-diego,CA,biomassPlant,13500,45000,2023/07/22\nDallas,TX,windfarm,14000,48000,2023.08.01\nSan Jose,ca,Solar Installation,11500,42000,2023/09/10\nAustin,TX,biomass_plant,13000,46000,2023-10-05\nJacksonville,fl,Wind-Farm,12500,45500,2023.11.11\nFort Worth,TX,solar_installation,11200,44000,2023/12/03\nColumbus,OH,,12000,43000,2023-12-15\nCharlotte,NC,Wind farm,13000,47000,2023/13/01\nDetroit,MI,Biomass_plant,14000,45000,2023/02/30", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim spaces from all text fields", "columnName": "City", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim spaces from all text fields", "columnName": "BusinessType", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Standardize City names capitalization and replace hyphens/underscores with spaces", "columnName": "City", "expression": "value.replace(/[-_]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State abbreviations to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Normalize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["solar-installation", "solar_installation", "SOLAR-installation", "Solar Installation"], "to": "Solar Installation"}, {"from": ["Wind-Farm", "Wind farm", "windfarm", "Wind Farm"], "to": "Wind Farm"}, {"from": ["Biomass_plant", "biomassPlant", "biomass_plant", "Biomass_plant"], "to": "Biomass Plant"}]}, {"op": "core/text-transform", "description": "Fix Price field with commas and spaces, convert to numeric string", "columnName": "Price", "expression": "value.replace(/[^0-9]/g, '')"}, {"op": "core/text-transform", "description": "Fix LoanAmount field with commas and missing values", "columnName": "LoanAmount", "expression": "value == null || value == '' ? '0' : value.replace(/[^0-9]/g, '')"}, {"op": "core/date-parse", "description": "Parse Date field with different formats, output ISO date", "columnName": "Date", "format": "auto", "onError": "keep-original", "onErrorString": ""}, {"op": "core/mass-edit", "description": "Fix invalid or missing dates", "columnName": "Date", "edits": [{"from": ["2023/13/01", "2023/02/30"], "to": ""}]}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Installation,12000,50000,2023-01-15T00:00:00Z\nLos Angeles,CA,Wind Farm,15000,45000,2023-02-15T00:00:00Z\nHuston,TX,Solar Installation,11000,0,2023-03-05T00:00:00Z\nPhoenix,AZ,Biomass Plant,14000,40000,2023-04-07T00:00:00Z\nPhiladelphia,PA,Wind Farm,13000,47000,2023-05-07T00:00:00Z\nSan Antonio,TX,Solar Installation,12500,43000,2023-06-15T00:00:00Z\nSan Diego,CA,Biomass Plant,13500,45000,2023-07-22T00:00:00Z\nDallas,TX,Wind Farm,14000,48000,2023-08-01T00:00:00Z\nSan Jose,CA,Solar Installation,11500,42000,2023-09-10T00:00:00Z\nAustin,TX,Biomass Plant,13000,46000,2023-10-05T00:00:00Z\nJacksonville,FL,Wind Farm,12500,45500,2023-11-11T00:00:00Z\nFort Worth,TX,Solar Installation,11200,44000,2023-12-03T00:00:00Z\nColumbus,OH,,12000,43000,\nCharlotte,NC,Wind Farm,13000,47000,\nDetroit,MI,Biomass Plant,14000,45000,"}
{"purpose": "Clean and standardize farm loan application data including locations, crop types, and dates.", "raw_table": "FarmID,City,State,CropType,LoanAmount,ApplicationDate,PricePerAcre\nF001,des moines,IA,CoRn,50000,2023/05/10,1200\nF002,Sioux-city,ia,soy_beans,45000,05-15-2023,1100\nF003,,IA,Wheat,40000,2023.05.20,1150\nF004,Cedar_Rapids,IA,coRn,55000,2023-05-18,1200\nF005,Ankeny,ia,soy beans,48000,18 May 2023,1090\nF006,Dubuque,IA,WhEAT,,2023/05/21,1130\nF007,marshalltown,ia,soy-beans,47000,05/22/2023,1080\nF008,Waterloo,IA, CORN,53000,2023-05-17,1190\nF009,Des_Moines,IA,,49000,2023-05-19,1170\nF010,Cedar Rapids,ia,soybeans,46000,May 20 2023,1105\nF011,Sioux City,IA,Wheat,42000,2023/05/16,1140\nF012,Ankeny,IA,soy_beans,45500,20230519,1085\nF013,Des Moines,IA,corn,51000,2023-05-21,1210\nF014,Cedar Rapids,IA,soybeans,47500,2023-05-22,1125\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and remove underscores/hyphens in City", "columnName": "City", "expression": "value.trim().replace(/[_-]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize CropType values to proper names", "columnName": "CropType", "expression": "value.toLowercase().replace(/[_-]/g, ' ').replace(/corn/, 'Corn').replace(/soy beans|soy beans|soy beans|soy beans|soy beans|soy beans|soy beans|soybeans|soy_beans|soy-beans/g, 'Soybeans').replace(/wheat/, 'Wheat')"}, {"op": "core/mass-edit", "columnName": "CropType", "description": "Fix empty CropType values", "edits": [{"from": [""], "to": "Unknown"}]}, {"op": "core/column-rename", "description": "Rename PricePerAcre to Price_per_Acre to match conventions", "oldColumnName": "PricePerAcre", "newColumnName": "Price_per_Acre"}, {"op": "core/date-parse", "description": "Parse ApplicationDate into ISO format", "columnName": "ApplicationDate", "format": "flexible"}, {"op": "core/mass-edit", "columnName": "LoanAmount", "description": "Fill missing LoanAmount with average loan (50000)", "edits": [{"from": [""], "to": "50000"}]}], "clean_table": "FarmID,City,State,CropType,LoanAmount,ApplicationDate,Price_per_Acre\nF001,Des Moines,IA,Corn,50000,2023-05-10,1200\nF002,Sioux City,IA,Soybeans,45000,2023-05-15,1100\nF003,,IA,Wheat,40000,2023-05-20,1150\nF004,Cedar Rapids,IA,Corn,55000,2023-05-18,1200\nF005,Ankeny,IA,Soybeans,48000,2023-05-18,1090\nF006,Dubuque,IA,Wheat,50000,2023-05-21,1130\nF007,Marshalltown,IA,Soybeans,47000,2023-05-22,1080\nF008,Waterloo,IA,Corn,53000,2023-05-17,1190\nF009,Des Moines,IA,Unknown,49000,2023-05-19,1170\nF010,Cedar Rapids,IA,Soybeans,46000,2023-05-20,1105\nF011,Sioux City,IA,Wheat,42000,2023-05-16,1140\nF012,Ankeny,IA,Soybeans,45500,2023-05-19,1085\nF013,Des Moines,IA,Corn,51000,2023-05-21,1210\nF014,Cedar Rapids,IA,Soybeans,47500,2023-05-22,1125\n"}
{"purpose": "Standardize crop sales data by correcting inconsistent crop names, formatting prices and dates, and normalizing payment types.", "raw_table": "FarmID,Crop,PriceUSD,Payment_Type,Sale_Date,Quantity_tonnes\nF001,WHeat,1000,credit-card,2023/04/10,10\nf002,corn,850,CASH,04-15-2023,8\nF003,Rice_,1200,Credit_Card,2023.04.18,12\nF004,soy-bean,900,Cash,18 April 2023,9\nF005,Barley,1100,credit card,2023/04/22,NaN\nf006,wheat,950,cash,2023-04-25,7\nF007,CORN,800,credit-card,04/28/2023,8\nF008,Rice,1150,cash,2023/04-30,11\nF009,soybean,930,credit card,2023/4/31,10\nF010,barley,1050,CASH,2023/04/20,10\nF011,,900,Credit-Card,2023/04/23,9\nF012,WHEAT-,1000,cash,04/24/2023,10", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace and remove trailing underscores or hyphens from Crop names", "columnName": "Crop", "expression": "value.trim().replace(/[_\\-]+$/,'')"}, {"op": "core/mass-edit", "description": "Standardize crop names capitalization", "columnName": "Crop", "edits": [{"from": ["WHeat", "wheat", "WHEAT-"], "to": "Wheat"}, {"from": ["corn", "CORN"], "to": "Corn"}, {"from": ["Rice_", "Rice"], "to": "Rice"}, {"from": ["soy-bean", "soybean"], "to": "Soybean"}, {"from": ["Barley", "barley"], "to": "Barley"}]}, {"op": "core/text-transform", "description": "Normalize Payment_Type values and lowercase", "columnName": "Payment_Type", "expression": "value.toLowerCase().replace(/[_\\-]/g, ' ').trim()"}, {"op": "core/mass-edit", "description": "Correct payment types to two categories", "columnName": "Payment_Type", "edits": [{"from": ["credit card", "credit_card", "credit-card", "credit card"], "to": "Credit Card"}, {"from": ["cash", "CASH"], "to": "Cash"}]}, {"op": "core/text-transform", "description": "Parse and standardize Sale_Date to yyyy-MM-dd", "columnName": "Sale_Date", "expression": "value.parseDate('yyyy/MM/dd') != null ? value.parseDate('yyyy/MM/dd').toString('yyyy-MM-dd') : (value.parseDate('MM-dd-yyyy') != null ? value.parseDate('MM-dd-yyyy').toString('yyyy-MM-dd') : (value.parseDate('yyyy.MM.dd') != null ? value.parseDate('yyyy.MM.dd').toString('yyyy-MM-dd') : (value.parseDate('dd MMMM yyyy') != null ? value.parseDate('dd MMMM yyyy').toString('yyyy-MM-dd') : (value.parseDate('MM/dd/yyyy') != null ? value.parseDate('MM/dd/yyyy').toString('yyyy-MM-dd') : ''))))"}, {"op": "core/mass-edit", "description": "Fix invalid date '2023/4/31' to '2023-04-30' (max day April)", "columnName": "Sale_Date", "edits": [{"from": ["2023-04-31"], "to": "2023-04-30"}]}, {"op": "core/mass-edit", "description": "Fill missing Crop values with previous non-empty", "columnName": "Crop", "edits": []}, {"op": "core/fill-down", "description": "Fill down missing Crop values", "columnName": "Crop"}, {"op": "core/text-transform", "description": "Convert Quantity_tonnes to integer and replace NaN with 0", "columnName": "Quantity_tonnes", "expression": "value.toNumber() != null && !isNaN(value.toNumber()) ? value.toNumber() : 0"}, {"op": "core/text-transform", "description": "Convert PriceUSD to integer", "columnName": "PriceUSD", "expression": "value.toNumber() != null ? Math.round(value.toNumber()) : 0"}], "clean_table": "FarmID,Crop,PriceUSD,Payment_Type,Sale_Date,Quantity_tonnes\nF001,Wheat,1000,Credit Card,2023-04-10,10\nf002,Corn,850,Cash,2023-04-15,8\nF003,Rice,1200,Credit Card,2023-04-18,12\nF004,Soybean,900,Cash,2023-04-18,9\nF005,Barley,1100,Credit Card,2023-04-22,0\nf006,Wheat,950,Cash,2023-04-25,7\nF007,Corn,800,Credit Card,2023-04-28,8\nF008,Rice,1150,Cash,2023-04-30,11\nF009,Soybean,930,Credit Card,2023-04-30,10\nF010,Barley,1050,Cash,2023-04-20,10\nF011,Soybean,900,Credit Card,2023-04-23,9\nF012,Wheat,1000,Cash,2023-04-24,10"}
{"purpose": "Clean and standardize inconsistent city names, business types, and date formats in an energy loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,solar_panel,25000,15000,03-15-2023\nLOS_angeles,CA,Solar-Plants,30000,20000,2023/04/10\nchicago,IL,Wind_Turbine,15000,10000,15-05-2023\nhouston,TX,solar_panel,22000,,2023.06.12\nPhoenix-AZ,AZ,wind turbine,18000,12000,2023-07-01\nphiladelphia,PA,SoLar_Panel,24000,16000,07/20/2023\nSan-antonio,TX,solar_panel,26000,17000,2023-08-15\nsan-diego,ca,Wind-turbine,21000,13000,08/25/2023\nDALLAS,TX,Solar-Panel,23000,14000,2023/09/05\nsan_jose,CA,solar-plant,25000,15500,2023-09-15\nAustin,TX,,27000,17500,09/30/2023\njacksonville,FL,solar_panel,20000,11000,10-10-2023\nfort-worth,TX,wind_turbine,19000,11500,2023/11/01\ncolumbus,OH,Solar_Panel,24000,15000,11-15-2023", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names with spaces and capitalize each word", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').split(' ').map(s => s.toLowerCase().capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Capitalize all State values", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Normalize BusinessType values to title case without underscores or hyphens", "columnName": "BusinessType", "expression": "value ? value.replace(/[_-]/g, ' ').toLowerCase().split(' ').map(s => s.capitalize()).join(' ') : ''"}, {"op": "core/mass-edit", "description": "Fix inconsistent BusinessType naming variations", "columnName": "BusinessType", "edits": [{"from": ["Solar Plants", "Solar Plant", "Solar Plants", "Solar-Plant", "Solar-Panel", "Solar Panel", "solar panel", "SoLar Panel", "solar_panel", "Solar_Panel"], "to": "Solar Panel"}, {"from": ["Wind Turbine", "wind turbine", "Wind-turbine", "wind_turbine"], "to": "Wind Turbine"}]}, {"op": "core/mass-edit", "description": "Fill missing BusinessType with 'Solar Panel'", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Solar Panel"}]}, {"op": "core/text-transform", "description": "Normalize Price and LoanAmount to numeric without quotes and missing numerical values to null", "columnName": "Price", "expression": "value.match(/\\d+/) ? Number(value.match(/\\d+/)[0]) : null"}, {"op": "core/text-transform", "description": "Normalize Price and LoanAmount to numeric without quotes and missing numerical values to null", "columnName": "LoanAmount", "expression": "value.match(/\\d+/) ? Number(value.match(/\\d+/)[0]) : null"}, {"op": "core/text-transform", "description": "Parse Date to ISO format yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Solar Panel,25000,15000,2023-03-15\nLos Angeles,CA,Solar Panel,30000,20000,2023-04-10\nChicago,IL,Wind Turbine,15000,10000,2023-05-15\nHouston,TX,Solar Panel,22000,10000,2023-06-12\nPhoenix Az,AZ,Wind Turbine,18000,12000,2023-07-01\nPhiladelphia,PA,Solar Panel,24000,16000,2023-07-20\nSan Antonio,TX,Solar Panel,26000,17000,2023-08-15\nSan Diego,CA,Wind Turbine,21000,13000,2023-08-25\nDallas,TX,Solar Panel,23000,14000,2023-09-05\nSan Jose,CA,Solar Panel,25000,15500,2023-09-15\nAustin,TX,Solar Panel,27000,17500,2023-09-30\nJacksonville,FL,Solar Panel,20000,11000,2023-10-10\nFort Worth,TX,Wind Turbine,19000,11500,2023-11-01\nColumbus,OH,Solar Panel,24000,15000,2023-11-15"}
{"purpose": "Clean and normalize inconsistent city and business type entries, fix date formats, and standardize numeric fields in a telecom loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew-york,NY,wireless_provider,1200.50,10000,2023/01/15\nlos angeles,CA,Cable provider,950-00,15000,15-02-2023\nCHICAGO,IL,cellular provider,1100.25,,2023-03-01\nHouston,TX,wirelessProvider,1300.75,12000,03/15/2023\nphiladElphia,pa,cellular-provider,1150,9500,2023.04.01\nPhoenix,Az,,980,7000,2023-04-15\nsan antonio,TX,wire-less provider,1050.00,8500,2023-04-20\nDallas,tx,Cable-provider,NaN,11000,04/25/2023\nSan diego,ca,wireless-provider,1000.5,9000,2023/05/01\nSan jose,CA,cable_provider,1025.75,NaN,2023-05-10\nAustin,TX,cellular Provider,1250,13000,May 15, 2023\nJacksonville,FL,wireless_provider,1100,Na,2023-05-20\nFort Worth,TX,cellular_provider,NaN,12000,2023/05/25", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Fix inconsistent State abbreviations capitalization", "columnName": "State", "edits": [{"from": ["pa"], "to": "PA"}, {"from": ["tx"], "to": "TX"}, {"from": ["az"], "to": "AZ"}, {"from": ["ca"], "to": "CA"}]}, {"op": "core/text-transform", "description": "Standardize BusinessType entries", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[-_]/g, ' ').replace(/wireless provider|wirelessprovider|wire-less provider/, 'Wireless Provider').replace(/cable provider|cable-provider|cable_provider/, 'Cable Provider').replace(/cellular provider|cellular-provider|cellular Provider/, 'Cellular Provider')"}, {"op": "core/mass-edit", "description": "Replace missing or empty BusinessType with 'Unknown'", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Unknown"}, {"from": [null], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Fix Price field to proper numeric format", "columnName": "Price", "expression": "value.toString().replace(/-/, '.').replace(/NaN|Na/, '').toNumber()"}, {"op": "core/text-transform", "description": "Fix LoanAmount missing values to blank", "columnName": "LoanAmount", "expression": "if(value.toLowercase() == 'nan' || value.toLowercase() == 'na' || value.trim() == '', '', value)"}, {"op": "core/text-transform", "description": "Parse LoanDate into ISO format yyyy-MM-dd", "columnName": "LoanDate", "expression": "if(isBlank(value), '', value.replace(/\\./g, '-').replace(/\\//g, '-').replace(/(\\d{2})-(\\d{2})-(\\d{4})/, '$3-$1-$2').replace(/May 15, 2023/, '2023-05-15'))"}, {"op": "core/date-parse", "description": "Parse standardized LoanDate strings to date type", "columnName": "LoanDate", "dateFormat": "yyyy-MM-dd", "onError": "keep-original", "onErrorString": ""}], "clean_table": "City,State,BusinessType,Price,LoanAmount,LoanDate\nNew York,NY,Wireless Provider,1200.5,10000,2023-01-15\nLos Angeles,CA,Cable Provider,950.0,15000,2023-02-15\nChicago,IL,Cellular Provider,1100.25,,2023-03-01\nHouston,TX,Wireless Provider,1300.75,12000,2023-03-15\nPhiladelphia,PA,Cellular Provider,1150.0,9500,2023-04-01\nPhoenix,AZ,Unknown,980.0,7000,2023-04-15\nSan Antonio,TX,Wireless Provider,1050.0,8500,2023-04-20\nDallas,TX,Cable Provider,,11000,2023-04-25\nSan Diego,CA,Wireless Provider,1000.5,9000,2023-05-01\nSan Jose,CA,Cable Provider,1025.75,,2023-05-10\nAustin,TX,Cellular Provider,1250.0,13000,2023-05-15\nJacksonville,FL,Wireless Provider,1100.0,,2023-05-20\nFort Worth,TX,Cellular Provider,,12000,2023-05-25"}
{"purpose": "Standardize energy provider names and fix inconsistent date and price formats in the dataset.", "raw_table": "City,State,Provider,PricePerkWh,Loan_Amount,ContractDate\nNew_York,ny,Green Energy,0.12,10000,2021/05/01\nLos angeles,CA,green-energy,0.115, 15000,05-15-2021\nChicago,IL,GreenEnergy,0.13,,2021.06.01\nHouston,tx,Green-energe,0.11,12000,2021/07/01\nPhoenix,AZ,Green Energy ,$0.12,13000,2021-08-01\nPhiladelphia,pa,GreenEnergy,0.125,11000,01/09/2021\nSan Antonio,TX,green energy,0.14,9000,2021/10/01\nSan Diego,ca,GreenEnergy,0.12,8000,2021-11-01\nDallas,TX,,0.13,7000,2021/12/01\nSan Jose,CA,GreenEnergy,12 cents,14000,2022-01-01\nAustin,tx,green-energy,0.11,15000,2022-02-01\nJacksonville,FL,GreenEnergy,0.130,,2022/03/01\nFort Worth,TX,green_energy,0.125,12500,03-15-2022\nColumbus,OH,Green Energy,0.12,13500,2022.04.01\nCharlotte,NC,GreenEnergy,0.11,14000,2022-05-01\n", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "Provider", "edits": [{"from": ["Green Energy", "green-energy", "GreenEnergy", "Green-energe", "Green Energy ", "green energy", "green-energy", "green_energy"], "to": "GreenEnergy"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase().replace('_', ' ')"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "columnName": "PricePerkWh", "expression": "value.match(/\\$?([0-9\\.]+)/).length>0 ? value.match(/\\$?([0-9\\.]+)/)[0].replace('$','').toNumber() : (value.toLowercase().contains('cents') ? (value.match(/[0-9]+/)[0].toNumber()/100) : value.toNumber())"}, {"op": "core/mass-edit", "columnName": "Loan_Amount", "edits": [{"from": [""], "to": "0"}]}, {"op": "core/date-parse", "columnName": "ContractDate", "format": "yyyy-MM-dd"}], "clean_table": "City,State,Provider,PricePerkWh,Loan_Amount,ContractDate\nNew York,NY,GreenEnergy,0.12,10000,2021-05-01\nLos Angeles,CA,GreenEnergy,0.115,15000,2021-05-15\nChicago,IL,GreenEnergy,0.13,0,2021-06-01\nHouston,TX,GreenEnergy,0.11,12000,2021-07-01\nPhoenix,AZ,GreenEnergy,0.12,13000,2021-08-01\nPhiladelphia,PA,GreenEnergy,0.125,11000,2021-09-01\nSan Antonio,TX,GreenEnergy,0.14,9000,2021-10-01\nSan Diego,CA,GreenEnergy,0.12,8000,2021-11-01\nDallas,TX,GreenEnergy,0.13,7000,2021-12-01\nSan Jose,CA,GreenEnergy,0.12,14000,2022-01-01\nAustin,TX,GreenEnergy,0.11,15000,2022-02-01\nJacksonville,FL,GreenEnergy,0.13,0,2022-03-01\nFort Worth,TX,GreenEnergy,0.125,12500,2022-03-15\nColumbus,OH,GreenEnergy,0.12,13500,2022-04-01\nCharlotte,NC,GreenEnergy,0.11,14000,2022-05-01\n"}
{"purpose": "Standardize inconsistent city names and formats, correct business types, normalize price and loan amount columns, and unify date formats in telecommunications customer data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,Telecom,1000,5000,2023/01/15\nlos-angeles,CA,tele-communications,1200,5500,15-02-2023\nCHICAGO,IL,Telecom,NaN,6000,2023.03.05\nhouston,TX, Telecom,1100,FiveThousand,2023-04-10\nPhoenix,AZ,Telecom,1050,4800,04/15/2023\nphiladelphia,PA,Tele-com,950,4700,2023-05-20\nSan-antonio,TX,Telecom,1000,NaN,May 25 2023\nsan diego,ca,telecom,NaN,4500,2023/06/01\nDALLAS,TX,TEL eCOMM,1150,5300,06-10-2023\nSan jose,CA,telecom,1080,5100,2023/07/05\nAustin,Tx,Telecom,1020,4900,2023-07-15\nJacksonville,fl,Telecom,970,4700,2023.08.01\nfort worth,TX,telecom,NaN,5000,2023-08-10\nColumbus,OH,Telecom,990,4800,2023/08/20", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City names by removing underscores and hyphens and proper case", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Standardize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Correct common misspellings and variants in BusinessType", "columnName": "BusinessType", "expression": "value.toLowercase().replace('tele-communications','telecom').replace('tele-com','telecom').replace(/tel ecomm/,'telecom').trim().toTitlecase()"}, {"op": "core/mass-edit", "description": "Replace textual number in LoanAmount with numeric", "columnName": "LoanAmount", "edits": [{"from": ["FiveThousand", "NaN"], "to": ["5000", ""]}]}, {"op": "core/text-transform", "description": "Convert Price and LoanAmount to numbers, set empty to blank", "columnName": "Price", "expression": "isNaN(parseFloat(value)) ? '' : parseFloat(value)"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number or blank", "columnName": "LoanAmount", "expression": "isNaN(parseFloat(value)) ? '' : parseFloat(value)"}, {"op": "core/date-parse", "description": "Parse Date column with multiple date formats", "columnName": "Date", "dateFormat": "yyyy-MM-dd", "guessCellType": true, "expression": "value.toDate()"}, {"op": "core/text-transform", "description": "Reformat Date to ISO yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/fill-down", "description": "Fill down missing LoanAmount values", "columnName": "LoanAmount"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Telecom,1000,5000,2023-01-15\nLos Angeles,CA,Telecom,1200,5500,2023-02-15\nChicago,IL,Telecom,,6000,2023-03-05\nHouston,TX,Telecom,1100,5000,2023-04-10\nPhoenix,AZ,Telecom,1050,4800,2023-04-15\nPhiladelphia,PA,Telecom,950,4700,2023-05-20\nSan Antonio,TX,Telecom,1000,4700,2023-05-25\nSan Diego,CA,Telecom,,4500,2023-06-01\nDallas,TX,Telecom,1150,5300,2023-06-10\nSan Jose,CA,Telecom,1080,5100,2023-07-05\nAustin,TX,Telecom,1020,4900,2023-07-15\nJacksonville,FL,Telecom,970,4700,2023-08-01\nFort Worth,TX,Telecom,,5000,2023-08-10\nColumbus,OH,Telecom,990,4800,2023-08-20"}
{"purpose": "Standardize and clean inconsistent city names, business types, and dates for accurate energy loan records analysis.", "raw_table": "City,State,BusinessType,LoanAmount,Price,Date\nnew york,NY,solar_company,50000,1200,03-15-2023\nLos-Angeles,CA,Wind_Farm,75000,1500,2023/04/01\nchicago,IL,Solar-company,60000,,15/03/2023\nHousTon,tx,windfarm,70000,1400,April 5 2023\nPHOENIX,AZ,solar Company,65000,1300,2023.04.10\nPhiladelphia,pa,,55000,1250,04-12-2023\nsan jose,CA,Wind Company,72000,1450,13-04-2023\nAustin,TX,solar_company,68000,1350,2023/04/14\njacksonville,fl,Wind_farm,71000,1400,2023-04-15\nFort-worth,TX,Solar-company,66000,1325,2023/04/16\nColumbus,OH,SolarCompany,63000,,04/17/2023\nSan-Diego,ca,wind-company,70000,1425,2023/04/18\nIndianapolis,IN,solar_farm,64000,1330,2023-04-19", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize each word in City and remove hyphens or underscores", "columnName": "City", "expression": "value.replace(/[-_]/g, ' ').split(' ').map(s, i -> s.toLowercase().replace(/^(.)/, v -> v.toUppercase())).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase all State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Standardize BusinessType names to Title Case and replace underscores/hyphens with space", "columnName": "BusinessType", "expression": "if(value == null || value.trim() == '', 'Unknown', value.replace(/[-_]/g, ' ').split(' ').map(s, i -> s.toLowercase().replace(/^(.)/, v -> v.toUppercase())).join(' '))"}, {"op": "core/mass-edit", "description": "Fix alternative BusinessType spellings", "columnName": "BusinessType", "edits": [{"from": ["Solar-company", "SolarCompany", "Solar Company", "solar company", "solar_company", "solar_farm"], "to": "Solar Company"}, {"from": ["Wind_farm", "Wind Farm", "windfarm", "Wind-company", "Wind Company", "wind-company"], "to": "Wind Company"}]}, {"op": "core/fill-down", "description": "Fill down missing BusinessType values", "columnName": "BusinessType"}, {"op": "core/text-transform", "description": "Parse Date column into ISO format yyyy-MM-dd", "columnName": "Date", "expression": "value.match(/\\d{4}[\\/\\.-]\\d{2}[\\/\\.-]\\d{2}/) ? value.replace(/[\\/\\.]/g, '-') : if(value.match(/\\d{2}[\\/\\.-]\\d{2}[\\/\\.-]\\d{4}/), (value.split(/[\\/\\.-]/)[2] + '-' + value.split(/[\\/\\.-]/)[0].padStart(2,'0') + '-' + value.split(/[\\/\\.-]/)[1].padStart(2,'0')), if(value.match(/[a-zA-Z]+ \\d{1,2} \\d{4}/), datetime.parse(value, 'MMMM d yyyy').toString('yyyy-MM-dd'), value))"}, {"op": "core/mass-edit", "description": "Fix missing Price values replacing with average (1350)", "columnName": "Price", "edits": [{"from": [""], "to": "1350"}, {"from": [null], "to": "1350"}]}], "clean_table": "City,State,BusinessType,LoanAmount,Price,Date\nNew York,NY,Solar Company,50000,1200,2023-03-15\nLos Angeles,CA,Wind Company,75000,1500,2023-04-01\nChicago,IL,Solar Company,60000,1350,2023-03-15\nHouston,TX,Wind Company,70000,1400,2023-04-05\nPhoenix,AZ,Solar Company,65000,1300,2023-04-10\nPhiladelphia,PA,Unknown,55000,1250,2023-04-12\nSan Jose,CA,Wind Company,72000,1450,2023-04-13\nAustin,TX,Solar Company,68000,1350,2023-04-14\nJacksonville,FL,Wind Company,71000,1400,2023-04-15\nFort Worth,TX,Solar Company,66000,1325,2023-04-16\nColumbus,OH,Solar Company,63000,1350,2023-04-17\nSan Diego,CA,Wind Company,70000,1425,2023-04-18\nIndianapolis,IN,Solar Company,64000,1330,2023-04-19"}
{"purpose": "Clean and standardize customer subscription data with inconsistent city names, business types, and dates.", "raw_table": "CustomerID,City,State,BusinessType,Price,LoanAmount,SubscriptionDate\n1001,neW_york,NY,telecomm,49.99,10000,2023/01/15\n1002,Los-angeles,CA,Telecom,59.99,15000,15-02-2023\n1003,Chicago,IL,Tele-comm,55,12000,2023-03-05\n1004,HousTon,TX,,65.50,13000,2023.04.01\n1005,phoenix,AZ,telecomm,NaN,11000,2023/05/12\n1006,Philadelphia,PA,telecom,70,NaN,2023-06-20\n1007,san antonio,TX,Telecomm,68.75,14000,2023/07/30\n1008,San-Diego,CA,TEL_ECOMM,72.00,13500,2023-08-15\n1009,Dallas,TX,telecom,abc,12500,2023-09-10\n1010,San jose,CA,telecomm,60,11500,2023/10/05\n1011,Austin,TX,telecom,58.25,NaN,2023-11-22\n1012,Jacksonville,FL,teleecomm,62.50,10500,2023/12/01\n1013,fort worth,TX,telecomm,59.99,13000,2023-13-01\n1014,Columbus,OH,Telecomm,61.00,12800,2023-02-28\n1015,Charlotte,NC,telecomm,57.75,12200,2023/03/15", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/g,' ').trim().split(' ').map(s => s.capitalize()).join(' ')", "description": "Standardize city names: lowercase, remove underscores/hyphens, capitalize words"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["telecomm", "Telecom", "Tele-comm", "Telecomm", "TEL_ECOMM", "teleecomm"], "to": "Telecom"}], "description": "Standardize BusinessType values to 'Telecom'"}, {"op": "core/mass-edit", "columnName": "Price", "edits": [{"from": ["NaN", "abc"], "to": ""}], "description": "Replace invalid price values with blank"}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.trim() == '' ? null : Number(value)", "description": "Convert Price to numeric, empty to null"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value.trim() == '' || value.toLowercase() == 'nan' ? null : Number(value)", "description": "Convert LoanAmount to numeric, empty or NaN to null"}, {"op": "core/date-parse", "columnName": "SubscriptionDate", "expression": "value", "onError": "keep-original", "onNull": "keep-original", "description": "Parse SubscriptionDate with flexible formats"}, {"op": "core/text-transform", "columnName": "SubscriptionDate", "expression": "cells['SubscriptionDate'].value instanceof Date ? cells['SubscriptionDate'].value.toISOString().substring(0,10) : ''", "description": "Format SubscriptionDate as YYYY-MM-DD, invalid dates to blank"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Telecom"}], "description": "Fill missing BusinessType values with 'Telecom'"}], "clean_table": "CustomerID,City,State,BusinessType,Price,LoanAmount,SubscriptionDate\n1001,New York,NY,Telecom,49.99,10000,2023-01-15\n1002,Los Angeles,CA,Telecom,59.99,15000,2023-02-15\n1003,Chicago,IL,Telecom,55,12000,2023-03-05\n1004,Houston,TX,Telecom,65.5,13000,2023-04-01\n1005,Phoenix,AZ,Telecom,,11000,2023-05-12\n1006,Philadelphia,PA,Telecom,70,,2023-06-20\n1007,San Antonio,TX,Telecom,68.75,14000,2023-07-30\n1008,San Diego,CA,Telecom,72,13500,2023-08-15\n1009,Dallas,TX,Telecom,,12500,2023-09-10\n1010,San Jose,CA,Telecom,60,11500,2023-10-05\n1011,Austin,TX,Telecom,58.25,,2023-11-22\n1012,Jacksonville,FL,Telecom,62.5,10500,2023-12-01\n1013,Fort Worth,TX,Telecom,59.99,13000,\n1014,Columbus,OH,Telecom,61,12800,2023-02-28\n1015,Charlotte,NC,Telecom,57.75,12200,2023-03-15"}
{"purpose": "Standardize movie genre names and fix inconsistencies in release years and ratings.", "raw_table": "MovieTitle,Genre,ReleaseYear,Rating,BoxOffice\n\"The_Last_Stand\",\"Action-Adventure\",2015,PG13,150000000\n\"Love_in_Paris\",\"rom-com\",2013,pg-13,45000000\n\"ghosts of the past\",\"Horror\",2018,R,73000000\n\"Space Odyssey\",\"sci fi\",Two_Thousand_Nineteen,PG,120000000\n\"The_Drama_Queen\",\"Drama\",2014,PG-13,35000000\n\"Kids Fun!\",\"Family\",,G,25000000\n\"Lost in Wonderland\",\"Fantasy\",2016,PG13-12,67000000\n\"The_Comedy_Hour\",\"COMEDY\",2011,PG,49000000\n\"Mystery_Night\",\"mystery\",2017,PG13,58000000\n\"Action-Packed\",\"Action\",2013,pg_13,130000000\n\"Romantic_Tales\",\"RomCom\",2015,PG-13,62000000\n\"Sci-Fi Chronicles\",\"Science Fiction\",2018,PG,90000000\n\"Horror_Night\",\"HORROR\",2010,R,40000000\n\"Family_Adventure\",\"family\",2012,G,30000000", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "Genre", "expression": "value.toLowercase()"}, {"op": "core/mass-edit", "columnName": "Genre", "edits": [{"from": ["rom-com", "romcom", "romcom"], "to": "romantic comedy"}, {"from": ["sci fi", "science fiction"], "to": "sci-fi"}, {"from": ["family"], "to": "family"}, {"from": ["mystery"], "to": "mystery"}, {"from": ["horror"], "to": "horror"}, {"from": ["comedy"], "to": "comedy"}, {"from": ["action-adventure", "action-packed", "action"], "to": "action"}, {"from": ["drama"], "to": "drama"}]}, {"op": "core/text-transform", "columnName": "ReleaseYear", "expression": "value.match(/\\d{4}/) ? value.match(/\\d{4}/)[0] : null"}, {"op": "core/mass-edit", "columnName": "Rating", "edits": [{"from": ["PG13", "pg-13", "PG-13", "pg_13", "PG13-12"], "to": "PG-13"}, {"from": ["PG"], "to": "PG"}, {"from": ["R"], "to": "R"}, {"from": ["G"], "to": "G"}]}, {"op": "core/text-transform", "columnName": "MovieTitle", "expression": "value.replace(/[_]/g, ' ').replace(/\\b\\w/g, v, v.toUppercase())"}, {"op": "core/column-rename", "oldColumnName": "BoxOffice", "newColumnName": "BoxOfficeUSD"}], "clean_table": "MovieTitle,Genre,ReleaseYear,Rating,BoxOfficeUSD\nThe Last Stand,action,2015,PG-13,150000000\nLove In Paris,romantic comedy,2013,PG-13,45000000\nGhosts Of The Past,horror,2018,R,73000000\nSpace Odyssey,sci-fi,2019,PG,120000000\nThe Drama Queen,drama,2014,PG-13,35000000\nKids Fun!,family,,G,25000000\nLost In Wonderland,fantasy,2016,PG-13,67000000\nThe Comedy Hour,comedy,2011,PG,49000000\nMystery Night,mystery,2017,PG-13,58000000\nAction Packed,action,2013,PG-13,130000000\nRomantic Tales,romantic comedy,2015,PG-13,62000000\nSci-Fi Chronicles,sci-fi,2018,PG,90000000\nHorror Night,horror,2010,R,40000000\nFamily Adventure,family,2012,G,30000000"}
{"purpose": "Standardize city names, dates, and numeric formats in a telecom customer loan dataset.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,retail, 200.50, 10000,2022/01/15\nlos-angeles,CA,REtail,150.75,7500,15-02-2022\nChicago,IL,Wholesale, 180,8000,2022.03.01\nHOUSTON,TX,retail, 175.00, null,2022/04/05\nphoenix,Az,wholesale,160.25,9000,April 10 2022\nphiladelphia,pa,retail, 190.00,8500,2022-05-20\nsan_diego,Ca,RETAIL, 170,7000,2022/06/15\ndallas,tx,wholesale, 165.50,,2022/07/07\nSan jose,CA,retail, 185.75,9500,2022-08-12\nAustin,Tx,RETAIL ,200,10000,2022/09/01\njacksonville,fl,Wholesale, 155.00,8000,2022/10/10\nfort-worth,TX,retail, 175.25,8500,2022.11.11\ncolumbus,oh,wholesale,165,7800,2022-12-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City names with spaces", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').toLowercase().replace(/\\b\\w/g, v, v.toUppercase())"}, {"op": "core/text-transform", "description": "Trim whitespace in all string columns", "columnName": "BusinessType", "expression": "value.trim().toLowercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["retail", "REtail", "RETAIL ", "RETAIL"], "to": "Retail"}, {"from": ["wholesale", "Wholesale"], "to": "Wholesale"}]}, {"op": "core/text-transform", "description": "Parse Price and convert to number with 2 decimal places", "columnName": "Price", "expression": "Number(value.trim()).toFixed(2)"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number, fill missing with 0", "columnName": "LoanAmount", "expression": "if(value.trim()==='' || value.toLowercase()=='null', '0', value.trim())"}, {"op": "core/date-parse", "description": "Parse Date column with multi-format support", "columnName": "Date", "expression": "value", "dateFormat": "yyyy-MM-dd", "guessCellType": true}, {"op": "core/text-transform", "description": "Format Date to ISO yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/text-transform", "description": "Capitalize State codes", "columnName": "State", "expression": "value.trim().toUppercase()"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Retail,200.50,10000,2022-01-15\nLos Angeles,CA,Retail,150.75,7500,2022-02-15\nChicago,IL,Wholesale,180.00,8000,2022-03-01\nHouston,TX,Retail,175.00,0,2022-04-05\nPhoenix,AZ,Wholesale,160.25,9000,2022-04-10\nPhiladelphia,PA,Retail,190.00,8500,2022-05-20\nSan Diego,CA,Retail,170.00,7000,2022-06-15\nDallas,TX,Wholesale,165.50,0,2022-07-07\nSan Jose,CA,Retail,185.75,9500,2022-08-12\nAustin,TX,Retail,200.00,10000,2022-09-01\nJacksonville,FL,Wholesale,155.00,8000,2022-10-10\nFort Worth,TX,Retail,175.25,8500,2022-11-11\nColumbus,OH,Wholesale,165.00,7800,2022-12-01"}
{"purpose": "Standardize movie genre names and correct inconsistent release date formats in a film dataset.", "raw_table": "Title,Genre,Director,ReleaseDate,BoxOffice\n\"The_Lost_World\",\"Sci-Fi\",\"J. Smith\",\"12/31/2015\",523000000\n\"Dreams of Tomorrow\",\"sci fi\",\"Julie_Ann\",\"2016-07-15\",null\n\"Haunted Nights\",\"Horor\",\"Mark O'Neil\",\"15-08-2017\",73000000\n\"Love & War\",\"Romance\",\"mary-jane\",\"2018/03/22\",125000000\n\"The Last Stand\",\"Action-Adventure\",\"K. LEE\",\"07/11/2014\",89000000\n\"Nightfall\",\"HorroR\",\"D. Evans\",\"2019.10.05\",45000000\n\"Echoes\",\"SciFi\",\"Anna_Bell\",\"2017-13-01\",null\n\"Silent Whisper\",\"romance\",\"Mary-Jane\",\"2017-05-20\",67000000\n\"Final Horizon\",\"Action Adventure\",\"Klee\",\"2016-11-23\",102000000\n\"Dark Waters\",\"horror\",\"Mark O'Neil\",\"2015/09/30\",48000000\n\"Tomorrow's Edge\",\"SCI-FI\",\"Julie Ann\",\"2018-02-29\",67000000\n\"Fading Light\",\"romance\",\"M. Jane\",\"2017-04-31\",null", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "Genre", "edits": [{"from": ["Sci-Fi", "sci fi", "SciFi", "SCI-FI"], "to": "Science Fiction"}, {"from": ["Horor", "HorroR", "horror"], "to": "Horror"}, {"from": ["Romance", "romance"], "to": "Romance"}, {"from": ["Action-Adventure", "Action Adventure"], "to": "Action Adventure"}]}, {"op": "core/text-transform", "columnName": "Title", "expression": "value.replace(/[_-]/g, ' ').trim()"}, {"op": "core/text-transform", "columnName": "Director", "expression": "value.toTitlecase().replace(/[_-]/g, ' ').trim()"}, {"op": "core/text-transform", "columnName": "ReleaseDate", "expression": "if(value.match(/^\\d{2}\\/\\d{2}\\/\\d{4}$/)) { \n  var parts = value.split('/');\n  parts[2] + '-' + parts[0].padStart(2,'0') + '-' + parts[1].padStart(2,'0')\n} else if (value.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\n  value\n} else if (value.match(/^\\d{2}-\\d{2}-\\d{4}$/)) {\n  var parts = value.split('-');\n  parts[2] + '-' + parts[1].padStart(2,'0') + '-' + parts[0].padStart(2,'0')\n} else if (value.match(/^\\d{4}\\/\\d{2}\\/\\d{2}$/)) {\n  value.replace(/\\//g,'-')\n} else if (value.match(/^\\d{4}\\.\\d{2}\\.\\d{2}$/)) {\n  value.replace(/\\./g,'-')\n} else {\n  null\n}", "onError": "set-to-null"}, {"op": "core/date-parse", "columnName": "ReleaseDate", "format": "yyyy-MM-dd", "onError": "keep-original"}, {"op": "core/mass-edit", "columnName": "ReleaseDate", "edits": [{"from": ["2018-02-29", "2017-04-31", "2017-13-01"], "to": [null, null, null]}]}, {"op": "core/mass-edit", "columnName": "BoxOffice", "edits": [{"from": ["null", ""], "to": ""}]}], "clean_table": "Title,Genre,Director,ReleaseDate,BoxOffice\nThe Lost World,Science Fiction,J. Smith,2015-12-31,523000000\nDreams of Tomorrow,Science Fiction,Julie Ann,2016-07-15,\nHaunted Nights,Horror,Mark O'Neil,2017-08-15,73000000\nLove & War,Romance,Mary Jane,2018-03-22,125000000\nThe Last Stand,Action Adventure,K. Lee,2014-07-11,89000000\nNightfall,Horror,D. Evans,2019-10-05,45000000\nEchoes,Science Fiction,Anna Bell,,\nSilent Whisper,Romance,Mary Jane,2017-05-20,67000000\nFinal Horizon,Action Adventure,Klee,2016-11-23,102000000\nDark Waters,Horror,Mark O'Neil,2015-09-30,48000000\nTomorrow's Edge,Science Fiction,Julie Ann,,67000000\nFading Light,Romance,M. Jane,,"}
{"purpose": "Standardize inconsistent city and state names, fix date formats, and normalize business types in government loan application data.", "raw_table": "ApplicantID,City,State,BusinessType,LoanAmount,ApplicationDate\n101,New_york,ny,Retail_store,50000,2023/04/15\n102,los angeles,CA,restaurant,75000,15-05-2023\n103,CHICAGO,IL,retailstore,45000,2023.06.01\n104,Houston,Tx,RESTAURANT_,80000,2023-07-20\n105,Phoenix,AZ,retail-store,55000,2023/08/05\n106,philadelphia,pa,,60000,2023-09-10\n107,san-antonio,TX,Retail_Store,70000,10/10/2023\n108,dalLas,tx,restaurent,65000,2023/11/15\n109,san diego,CA,Retail store,52000,2023/12/01\n110,dallas,,restaurant,68000,2023/13/01\n111,Austin,TX,Retail-store,58000,2023-01-30\n112,jacksonville,fl,RetailStore,49000,2023/02/28\n113,fort worth,TX,Restaurent,72000,2023-03-15\n114,Columbus,OH,Retail--Store,53000,03/20/2023\n115,Charlotte,NC,Retail store,,2023/04/01", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.toLowercase().replace('_',' ').replace('-',' ').trim()"}, {"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["philadelphia"], "to": "philadelphia"}, {"from": ["new york"], "to": "new york"}, {"from": ["los angeles"], "to": "los angeles"}, {"from": ["chicago"], "to": "chicago"}, {"from": ["houston"], "to": "houston"}, {"from": ["phoenix"], "to": "phoenix"}, {"from": ["san antonio"], "to": "san antonio"}, {"from": ["dallas"], "to": "dallas"}, {"from": ["san diego"], "to": "san diego"}, {"from": ["austin"], "to": "austin"}, {"from": ["jacksonville"], "to": "jacksonville"}, {"from": ["fort worth"], "to": "fort worth"}, {"from": ["columbus"], "to": "columbus"}, {"from": ["charlotte"], "to": "charlotte"}]}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase().replace('_','').replace('-','').trim()"}, {"op": "core/mass-edit", "columnName": "State", "edits": [{"from": [""], "to": "TX"}, {"from": ["tx"], "to": "TX"}, {"from": ["pa"], "to": "PA"}, {"from": ["fl"], "to": "FL"}]}, {"op": "core/text-transform", "columnName": "BusinessType", "expression": "value.toLowercase().replace(/[_\\-]+/,' ').replace(/restaurent/, 'restaurant').replace(/retailstore|retail store|retail-store|retail--store|retail_store/, 'retail store').trim()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": [""], "to": "retail store"}]}, {"op": "core/text-transform", "columnName": "ApplicationDate", "expression": "if(value.match(/^\\d{4}[\\/\\.-]\\d{2}[\\/\\.-]\\d{2}$/)) {value.replace(/[\\.]/,'-')} else if(value.match(/^\\d{2}-\\d{2}-\\d{4}$/)) {var parts = value.split('-'); parts[2]+'-'+parts[1]+'-'+parts[0]} else if(value.match(/^\\d{2}\\/\\d{2}\\/\\d{4}$/)) {var parts = value.split('/'); parts[2]+'-'+parts[0].padStart(2,'0')+'-'+parts[1].padStart(2,'0')} else value"}, {"op": "core/text-transform", "columnName": "ApplicationDate", "expression": "var d = new Date(value); d.getFullYear() > 1970 ? d.toISOString().slice(0,10) : ''"}, {"op": "core/mass-edit", "columnName": "LoanAmount", "edits": [{"from": [""], "to": "0"}]}], "clean_table": "ApplicantID,City,State,BusinessType,LoanAmount,ApplicationDate\n101,new york,NY,retail store,50000,2023-04-15\n102,los angeles,CA,restaurant,75000,2023-05-15\n103,chicago,IL,retail store,45000,2023-06-01\n104,houston,TX,restaurant,80000,2023-07-20\n105,phoenix,AZ,retail store,55000,2023-08-05\n106,philadelphia,PA,retail store,60000,2023-09-10\n107,san antonio,TX,retail store,70000,2023-10-10\n108,dallas,TX,restaurant,65000,2023-11-15\n109,san diego,CA,retail store,52000,2023-12-01\n110,dallas,TX,restaurant,68000,\n111,austin,TX,retail store,58000,2023-01-30\n112,jacksonville,FL,retail store,49000,2023-02-28\n113,fort worth,TX,restaurant,72000,2023-03-15\n114,columbus,OH,retail store,53000,2023-03-20\n115,charlotte,NC,retail store,0,2023-04-01"}
{"purpose": "Standardize city and state names, fix business type inconsistencies, and normalize date and numeric formats for government loan records.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApprovalDate\nNew york,NY,new_retail,150000,25000,03/15/2021\nlos-Angeles,ca,Retail,180000,30000,2021-04-01\nChicago,IL,restuarant,120000,20000,15-05-2021\nhouston,tx,Retail,130000,missing,2021/06/20\nPhoenix,Az,RETAIL,170000,27000,07-15-21\nphiladelphia,pa,retail_,140000,23000,2021.08.01\nSan_Antonio,TX,restaurant,110000,21000,08/30/2021\nSan diego,CA,restuarant,160000,missing,2021-09-10\nDallas,Tx,Retail,155000,26000,10/05/2021\nsan jose,ca,restaurant,165000,29000,11-15-21\nAustin,TX,retail,145000,24000,2021-12-01\nJacksonville,FL,resturant,135000,22000,12/15/2021\nFort Worth,Tx,RETAIL,150000,25000,2022/01/10", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase().replace(/[_-]/, ' ')", "description": "Standardize city names: title case and replace underscores/hyphens with space"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()", "description": "Convert state abbreviations to uppercase"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["new_retail", "retail_", "RETAIL", "retail"], "to": "Retail"}, {"from": ["restuarant", "resturant", "restaurant", "restuarant", "restuarant"], "to": "Restaurant"}], "description": "Normalize business types"}, {"op": "core/mass-edit", "columnName": "LoanAmount", "edits": [{"from": ["missing"], "to": ""}], "description": "Replace 'missing' with blank to denote missing values"}, {"op": "core/text-transform", "columnName": "Price", "expression": "value.toNumber()", "description": "Convert Price to numeric"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "value == null || value.trim() == '' ? null : value.toNumber()", "description": "Convert LoanAmount to numeric, keep nulls for missing"}, {"op": "core/date-parse", "columnName": "ApprovalDate", "expression": "value.toDate('MM/dd/yyyy') || value.toDate('yyyy-MM-dd') || value.toDate('dd-MM-yyyy') || value.toDate('yyyy/MM/dd') || value.toDate('MM-dd-yy') || value.toDate('yyyy.MM.dd')", "description": "Parse ApprovalDate with multiple formats"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApprovalDate\nNew York,NY,Retail,150000,25000,2021-03-15T00:00:00Z\nLos Angeles,CA,Retail,180000,30000,2021-04-01T00:00:00Z\nChicago,IL,Restaurant,120000,20000,2021-05-15T00:00:00Z\nHouston,TX,Retail,130000,,2021-06-20T00:00:00Z\nPhoenix,AZ,Retail,170000,27000,2021-07-15T00:00:00Z\nPhiladelphia,PA,Retail,140000,23000,2021-08-01T00:00:00Z\nSan Antonio,TX,Restaurant,110000,21000,2021-08-30T00:00:00Z\nSan Diego,CA,Restaurant,160000,,2021-09-10T00:00:00Z\nDallas,TX,Retail,155000,26000,2021-10-05T00:00:00Z\nSan Jose,CA,Restaurant,165000,29000,2021-11-15T00:00:00Z\nAustin,TX,Retail,145000,24000,2021-12-01T00:00:00Z\nJacksonville,FL,Restaurant,135000,22000,2021-12-15T00:00:00Z\nFort Worth,TX,Retail,150000,25000,2022-01-10T00:00:00Z"}
