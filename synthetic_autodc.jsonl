{"purpose": "Standardize and clean business records by fixing city names, business types, and date formats, and correcting numeric fields.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew_york,ny,restuarant,12000,50000,01-15-2022\nLos-angeles,CA,RETAIL,15000,60000,2022/02/20\nChicago,il,restuarant,NaN,45000,03-05-2022\nhouston,tx,retail,13000,,04/10/22\nPhoenix,AZ,restaurent,12500,55000,2022-05-15\nphiladelphia,PA,restuarant,14000,50000,15-06-2022\nSan-antonio,tx,RETAIL,13500,52000,2022.07.20\nsan_diego,CA,restaurant,14000,58000,08/25/2022\nDallas,Tx,restuarant,13000,NaN,September 10 2022\nsan jose,Ca,retail store,14500,60000,2022-10-05\nAustin,TX,restuarant,12800,57000,10-20-2022\nJacksonville,fl,RETAIL,12000,53000,2022/11/15\nfort worth,tx,restaurant,13500,55000,15-12-2022", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.toLowercase().replace(/[-_]/g, ' ').split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["restuarant", "restaurent", "restaurant", "restuarant"], "to": "Restaurant"}, {"from": ["retail", "retail store", "RETAIL"], "to": "Retail"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "isNaN(value) || value == 'NaN' || value == '' ? null : Number(value)"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "isNaN(value) || value == 'NaN' || value == '' ? null : Number(value)"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value.toString().replace(/\\./g, '-').replace(/\\//g, '-').replace(/^(\\d{2})-(\\d{2})-(\\d{4})$/, '$3-$1-$2').replace(/^([A-Za-z]+) (\\d{1,2}) (\\d{4})$/, (m, mon, day, year) => year + '-' + (new Date(mon + ' 1, 2000')).getMonth() + 1 + '-' + day).replace(/^\\d{2}-\\d{2}-\\d{2}$/, (m) => { let parts = m.split('-'); return '20' + parts[2] + '-' + parts[0] + '-' + parts[1]; })"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value.toDate().toISOString().substring(0,10)"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,12000,50000,2022-01-15\nLos Angeles,CA,Retail,15000,60000,2022-02-20\nChicago,IL,Restaurant,null,45000,2022-03-05\nHouston,TX,Retail,13000,null,2022-04-10\nPhoenix,AZ,Restaurant,12500,55000,2022-05-15\nPhiladelphia,PA,Restaurant,14000,50000,2022-06-15\nSan Antonio,TX,Retail,13500,52000,2022-07-20\nSan Diego,CA,Restaurant,14000,58000,2022-08-25\nDallas,TX,Restaurant,13000,null,2022-09-10\nSan Jose,CA,Retail,14500,60000,2022-10-05\nAustin,TX,Restaurant,12800,57000,2022-10-20\nJacksonville,FL,Retail,12000,53000,2022-11-15\nFort Worth,TX,Restaurant,13500,55000,2022-12-15"}
{"purpose": "Standardize city names and business types, fix date formats, and correct price and loan amount formats.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,Restuarant,120000,50000,01-12-2022\nlos-angeles,Ca,Cafe ,95000,45000,2022/02/15\nChicago,IL,retail,85000,40000,15th March 2022\nhouston,Tx,Retaill,78000,38000,2022-04-20\nPHOENIX,az,restaurant,112000,52000,4/25/2022\nPhiladelphia,PA,Cafe,92000,,2022.06.01\nsan_antonio,TX,retail,88000,42000,06-10-2022\nSan Diego,CA,restaurant,115000,55000,July 7, 2022\nDallas,tx,Retaurant,110000,53000,2022/08/15\nSan jose,CA,cafe,97000,46000,\nAustin,Tx,retail,84000,41000,08-25-2022\nJacksonville,fl,restuarant,113000,54000,2022/09/10\nFort-worth,Tx,Retail,86000,40000,October 5 2022\nColumbus,oh,Cafe,93000,47000,2022-11-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens in City with spaces", "columnName": "City", "expression": "value.replace(/[_-]/, ' ')"}, {"op": "core/text-transform", "description": "Capitalize first letter of each word in City", "columnName": "City", "expression": "value.toLowercase().split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["Restuarant", "restaurant", "Retaurant", "restuarant"], "to": "Restaurant"}, {"from": ["Cafe", "Cafe "], "to": "Cafe"}, {"from": ["Retail", "retail", "Retaill"], "to": "Retail"}]}, {"op": "core/text-transform", "description": "Trim extra spaces from BusinessType", "columnName": "BusinessType", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Normalize State to uppercase two-letter codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/text-transform", "description": "Parse and reformat Date into YYYY-MM-DD", "columnName": "Date", "expression": "if(value==null || value.trim()==='') null else date.parse(value).toString('yyyy-MM-dd')"}, {"op": "core/text-transform", "description": "Remove extra characters and convert Price to numeric", "columnName": "Price", "expression": "value.replace(/[^0-9.]/g, '').toNumber()"}, {"op": "core/text-transform", "description": "Remove extra characters and convert LoanAmount to numeric, set missing to 0", "columnName": "LoanAmount", "expression": "if(value==null || value.trim()==='') 0 else value.replace(/[^0-9.]/g, '').toNumber()"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,120000,50000,2022-01-12\nLos Angeles,CA,Cafe,95000,45000,2022-02-15\nChicago,IL,Retail,85000,40000,2022-03-15\nHouston,TX,Retail,78000,38000,2022-04-20\nPhoenix,AZ,Restaurant,112000,52000,2022-04-25\nPhiladelphia,PA,Cafe,92000,0,2022-06-01\nSan Antonio,TX,Retail,88000,42000,2022-06-10\nSan Diego,CA,Restaurant,115000,55000,2022-07-07\nDallas,TX,Restaurant,110000,53000,2022-08-15\nSan Jose,CA,Cafe,97000,46000,\nAustin,TX,Retail,84000,41000,2022-08-25\nJacksonville,FL,Restaurant,113000,54000,2022-09-10\nFort Worth,TX,Retail,86000,40000,2022-10-05\nColumbus,OH,Cafe,93000,47000,2022-11-01"}
{"purpose": "Standardize city and business type names, correct date formats, and normalize numeric fields for loan data analysis.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew_york,NY,restuarant,100000,50000,2023/01/15\nLos-angeles,ca,RETAIL,200000,100000,15-02-2023\nChicago,IL,Construction,150000,75000,03/10/2023\nhouston,TX,Retail,NaN,60000,2023-04-05\nphoenix,Az,restuarant,120000,wrong_data,2023/05/20\nphiladelphia,PA,construction,,85000,2023.06.15\nSan Antonio,TX,RETAIL,90000,45000,2023/07/01\nsan_diego,CA,restaurant,110000,55000,07/15/2023\nDallas,tx,CONSTRUCTION,130000,65000,2023/08/20\nSan Jose,CA,Retail,140000,70000,2023/09/10\nAustin,TX,restuarant,115000,57500,2023-10-05\nJacksonville,FL,Construction,125000,62500,2023/11/11\nFort Worth,TX,RETAIL,135000,67500,2023/12/01", "cleaning_workflow": [{"op": "core/mass-edit", "description": "Correct misspellings in BusinessType", "columnName": "BusinessType", "edits": [{"from": ["restuarant", "Restuarant", "restaurant"], "to": "Restaurant"}, {"from": ["RETAIL", "Retail", "retail"], "to": "Retail"}, {"from": ["Construction", "construction", "CONSTRUCTION"], "to": "Construction"}]}, {"op": "core/text-transform", "description": "Normalize City names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.replace(/[_-]/, ' ').split(' ').map(s => s.toLowerCase().capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase", "columnName": "State", "expression": "value.toUpperCase()"}, {"op": "core/text-transform", "description": "Normalize Date to ISO format yyyy-MM-dd", "columnName": "Date", "expression": "value.match(/\\d{4}[/-]\\d{2}[/-]\\d{2}/) ? value.replace(/[./]/g, '-').substring(0,10) : (value.match(/\\d{2}[/-]\\d{2}[/-]\\d{4}/) ? (value.split(/[\\/\\-]/).reverse().join('-')) : value)"}, {"op": "core/mass-edit", "description": "Replace 'NaN' and wrong data in Price and LoanAmount with empty", "columnName": "Price", "edits": [{"from": ["NaN", ""], "to": ""}]}, {"op": "core/mass-edit", "description": "Replace 'wrong_data' and missing values in LoanAmount with empty", "columnName": "LoanAmount", "edits": [{"from": ["wrong_data", ""], "to": ""}]}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,100000,50000,2023-01-15\nLos Angeles,CA,Retail,200000,100000,2023-02-15\nChicago,IL,Construction,150000,75000,2023-03-10\nHouston,TX,Retail,,60000,2023-04-05\nPhoenix,AZ,Restaurant,120000,,2023-05-20\nPhiladelphia,PA,Construction,,85000,2023-06-15\nSan Antonio,TX,Retail,90000,45000,2023-07-01\nSan Diego,CA,Restaurant,110000,55000,2023-07-15\nDallas,TX,Construction,130000,65000,2023-08-20\nSan Jose,CA,Retail,140000,70000,2023-09-10\nAustin,TX,Restaurant,115000,57500,2023-10-05\nJacksonville,FL,Construction,125000,62500,2023-11-11\nFort Worth,TX,Retail,135000,67500,2023-12-01"}
{"purpose": "Standardize inconsistent city and business type names, fix price and date formats, and correct missing and malformed data.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew_york,NY,Cafe,12.5,10000,2023/01/15\nLos-Angeles,ca,Restaurant,15,12000,01-20-2023\nChicago,IL,cafee,10.0,,2023.02.01\nhouston,TX,Retail,-8,8000,2023-03-10\nPHOENIX,az,restaurant,20.00,15000,2023/04/05\nPhiladelphia,pa,,18.5,14000,2023/05/12\nSan-antonio,TX,retail,16,,2023.06.01\nsan diego,CA,Cafe,NaN,11000,2023-07-15\nDallas,tx,restaurnt,22.5,13000,2023/08/20\nSAN JOSE,ca,Retail,19,NaN,2023-09-30\nAustin,TX,cafe,17.75,12500,2023-10-05\nJacksonville,fl,Cafe,-12,9000,2023/11/11\nfort worth,TX,Restaurant,21,13500,2023.12.01\nColumbus,OH,Cafe,14.5,11500,2023/12/15", "cleaning_workflow": [{"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase().replace('_', ' ').replace('-', ' ')"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["cafee", "Cafe", "cafe", "CAFE"], "to": "Cafe"}, {"from": ["restaurnt", "Restaurant", "restaurant", "RESTAURANT"], "to": "Restaurant"}, {"from": ["retail", "Retail", "RETAIL"], "to": "Retail"}]}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": [""], "to": "Unknown"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "isNaN(value) || value < 0 ? null : Number(value)"}, {"op": "core/fill-down", "columnName": "LoanAmount"}, {"op": "core/text-transform", "columnName": "Date", "expression": "value.replace(/[.]/g, '-').replace(/[\\/]/g, '-').replace(/(\\d{2})-(\\d{2})-(\\d{4})/, '$3-$1-$2')"}, {"op": "core/date-parse", "columnName": "Date", "expression": "value", "onError": "keep-original"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Cafe,12.5,10000,2023-01-15\nLos Angeles,CA,Restaurant,15,12000,2023-01-20\nChicago,IL,Cafe,10,12000,2023-02-01\nHouston,TX,Retail,null,8000,2023-03-10\nPhoenix,AZ,Restaurant,20,15000,2023-04-05\nPhiladelphia,PA,Unknown,18.5,14000,2023-05-12\nSan Antonio,TX,Retail,16,14000,2023-06-01\nSan Diego,CA,Cafe,null,11000,2023-07-15\nDallas,TX,Restaurant,22.5,13000,2023-08-20\nSan Jose,CA,Retail,19,13000,2023-09-30\nAustin,TX,Cafe,17.75,12500,2023-10-05\nJacksonville,FL,Cafe,null,9000,2023-11-11\nFort Worth,TX,Restaurant,21,13500,2023-12-01\nColumbus,OH,Cafe,14.5,11500,2023-12-15"}
{"purpose": "Standardize and correct inconsistent business types and dates, and normalize city and state names.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew york,NY,Restaurent,25,15000,01-12-2022\nlos_angeles,ca,Cafe,15,12000,2022/02/15\nChicago,IL,restaurent,30,18000,15-Mar-2022\nhouston,TX,Cafe-,20,14000,03_20_2022\nPHOENIX,Az,Restaurent,35,16000,04-05-22\nPhiladelphia,pa,,40,20000,2022-06-10\nSan-antonio,tx,Cafe,10,10000,07/07/2022\nSan Diego,CA,restaurant,28,17000,2022.08.08\nDallas,tx,Cafe,18,13000,09-09-22\nsan_jose,Ca,Restaurent,22,12500,10-10-2022\nAustin,TX,Cafe,16,11000,11/11/2022\nJacksonville,fl,restaurent,33,15500,2022-12-12\nFort Worth,TX,Cafe,19,13500,13-13-2022\nColumbus,oh,Restaurent,27,14500,\nCharlotte,NC,Cafe,21,12000,2022-01-01", "cleaning_workflow": [{"op": "core/text-transform", "description": "Capitalize first letter and lowercase rest in City", "columnName": "City", "expression": "value.toLowercase().split(/[_\\- ]+/).map(s, s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Uppercase State abbreviations", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["Restaurent", "restaurent", "restaurant", "Restaurent"], "to": "Restaurant"}, {"from": ["Cafe", "Cafe-", "cafe"], "to": "Cafe"}, {"from": [null, ""], "to": "Unknown"}]}, {"op": "core/text-transform", "description": "Fix Date delimiters from underscores and dots to dashes", "columnName": "Date", "expression": "value.replace(/[_\\.]/, '-')"}, {"op": "core/date-parse", "description": "Parse dates to ISO format yyyy-MM-dd", "columnName": "Date", "valueType": "date"}, {"op": "core/mass-edit", "description": "Correct invalid dates (like 13-13-2022) to blank", "columnName": "Date", "edits": [{"from": ["13-13-2022"], "to": ""}]}, {"op": "core/fill-down", "description": "Fill down missing Date values", "columnName": "Date"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,25,15000,2022-01-12\nLos Angeles,CA,Cafe,15,12000,2022-02-15\nChicago,IL,Restaurant,30,18000,2022-03-15\nHouston,TX,Cafe,20,14000,2022-03-20\nPhoenix,AZ,Restaurant,35,16000,2022-04-05\nPhiladelphia,PA,Unknown,40,20000,2022-06-10\nSan Antonio,TX,Cafe,10,10000,2022-07-07\nSan Diego,CA,Restaurant,28,17000,2022-08-08\nDallas,TX,Cafe,18,13000,2022-09-09\nSan Jose,CA,Restaurant,22,12500,2022-10-10\nAustin,TX,Cafe,16,11000,2022-11-11\nJacksonville,FL,Restaurant,33,15500,2022-12-12\nFort Worth,TX,Cafe,19,13500,\nColumbus,OH,Restaurant,27,14500,\nCharlotte,NC,Cafe,21,12000,2022-01-01"}
{"purpose": "Standardize inconsistent product categories and fix date formats for sales records.", "raw_table": "OrderID,CustomerName,ProductCategory,Price,OrderDate,Quantity\n1001,john smith,elec-tronics,299.99,2023/2/15,2\n1002,Jane_Doe,home appliance,NaN,15-03-2023,1\n1003,Mary-Jane,ElecTronics,199.50,2023-04-05,3\n1004,bob lee,HOME-Appliance,250,04/12/2023, \n1005,Linda,Elec-tronics,,2023.03.28,1\n1006,David,Home appliance ,180.75,2023-3-30,2\n1007,Susan_Clark,electronics,299,3/15/2023,1\n1008,Michael,home_appliance,220.40,2023/03/15,2\n1009,Emily,elec-tronics,210.00,20230316,1\n1010,Chris,HOME appliance,250.00,March 17 2023,1\n", "cleaning_workflow": [{"op": "core/text-transform", "description": "Trim whitespace in ProductCategory", "columnName": "ProductCategory", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Replace underscores and hyphens in ProductCategory with space", "columnName": "ProductCategory", "expression": "value.replace(/[_-]/, ' ')"}, {"op": "core/text-transform", "description": "Normalize ProductCategory capitalization", "columnName": "ProductCategory", "expression": "value.toLowercase().replace(/\\bhome appliance\\b/, 'Home Appliance').replace(/\\belectronics\\b/, 'Electronics')"}, {"op": "core/mass-edit", "description": "Fix ProductCategory misspelled variants", "columnName": "ProductCategory", "edits": [{"from": ["elec tronics", "elec tronics"], "to": "Electronics"}, {"from": ["elec tronics", "elec tronics", "elec tronics"], "to": "Electronics"}]}, {"op": "core/mass-edit", "description": "Fix missing Price values", "columnName": "Price", "edits": [{"from": [""], "to": "0"}, {"from": ["NaN"], "to": "0"}, {"from": [" "], "to": "0"}]}, {"op": "core/text-transform", "description": "Parse and normalize all date formats to yyyy-MM-dd", "columnName": "OrderDate", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/mass-edit", "description": "Fix missing Quantity values", "columnName": "Quantity", "edits": [{"from": ["", " "], "to": "1"}]}, {"op": "core/text-transform", "description": "Capitalize CustomerName properly", "columnName": "CustomerName", "expression": "value.split(/[_-]/).map(v, v.toLowercase().replace(/(^|\\s)(\\S)/, function(m, p1, p2) { return p1 + p2.toUppercase(); })).join(' ')"}], "clean_table": "OrderID,CustomerName,ProductCategory,Price,OrderDate,Quantity\n1001,John Smith,Electronics,299.99,2023-02-15,2\n1002,Jane Doe,Home Appliance,0,2023-03-15,1\n1003,Mary Jane,Electronics,199.50,2023-04-05,3\n1004,Bob Lee,Home Appliance,250,2023-04-12,1\n1005,Linda,Electronics,0,2023-03-28,1\n1006,David,Home Appliance,180.75,2023-03-30,2\n1007,Susan Clark,Electronics,299,2023-03-15,1\n1008,Michael,Home Appliance,220.40,2023-03-15,2\n1009,Emily,Electronics,210.00,2023-03-16,1\n1010,Chris,Home Appliance,250.00,2023-03-17,1\n"}
{"purpose": "Standardize and clean inconsistent business location and loan data entries for analysis.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_York,ny,REStaurant,100000,50000,01-15-2023\nlos angeles,CA,retail-store,80000,40000,2023/02/20\nChicago,IL,Restaurent,120000,,03-10-2023\nhouston, TX,Retail_store,95000,48000,2023-04-05\nPhoenix,az,RETAIL-store,87000,42000,04/18/2023\nphiladelphia, Pa,restaurant,,46000,05-01-2023\nSan Antonio,TX,REstaurant,99000,53000,2023-06-10\nsan diego,CA,retail-store,85000,41000,6/15/2023\nDallas,Tx,restuarant,102000,51000,2023-07-20\nSan_Jose,CA,Retail_store,92000,,08-05-2023\nAustin,TX,restaurant,93000,47000,2023/09/10\njacksonville,fl,restuarant,89000,45000,09-25-2023\nfort-worth,TX,retail-store,87000,43000,2023-10-05\nColumbus,oh,RESTAURANT,94000,48000,10/20/2023", "cleaning_workflow": [{"op": "core/mass-edit", "columnName": "City", "edits": [{"from": ["New_York", "San_Jose", "San_Antonio"], "to": "New York"}, {"from": ["San_Jose"], "to": "San Jose"}]}, {"op": "core/text-transform", "columnName": "City", "expression": "value.toTitlecase().replace(/_/,' ')", "description": "Capitalize city names and replace underscores with spaces"}, {"op": "core/text-transform", "columnName": "State", "expression": "value.trim().toUppercase()", "description": "Trim spaces and uppercase state abbreviations"}, {"op": "core/mass-edit", "columnName": "BusinessType", "edits": [{"from": ["REStaurant", "Restaurent", "restuarant", "RESTAURANT", "restaurant", "REstaurant"], "to": "Restaurant"}, {"from": ["retail-store", "Retail_store", "RETAIL-store", "Retail_store"], "to": "Retail Store"}]}, {"op": "core/text-transform", "columnName": "Price", "expression": "if(value=='') null else Number(value)", "description": "Convert Price to number and null if missing"}, {"op": "core/text-transform", "columnName": "LoanAmount", "expression": "if(value=='') null else Number(value)", "description": "Convert LoanAmount to number and null if missing"}, {"op": "core/date-parse", "columnName": "Date", "pattern": "auto", "description": "Parse dates to ISO format"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,100000,50000,2023-01-15T00:00:00Z\nLos Angeles,CA,Retail Store,80000,40000,2023-02-20T00:00:00Z\nChicago,IL,Restaurant,120000,,2023-03-10T00:00:00Z\nHouston,TX,Retail Store,95000,48000,2023-04-05T00:00:00Z\nPhoenix,AZ,Retail Store,87000,42000,2023-04-18T00:00:00Z\nPhiladelphia,PA,Restaurant,,46000,2023-05-01T00:00:00Z\nSan Antonio,TX,Restaurant,99000,53000,2023-06-10T00:00:00Z\nSan Diego,CA,Retail Store,85000,41000,2023-06-15T00:00:00Z\nDallas,TX,Restaurant,102000,51000,2023-07-20T00:00:00Z\nSan Jose,CA,Retail Store,92000,,2023-08-05T00:00:00Z\nAustin,TX,Restaurant,93000,47000,2023-09-10T00:00:00Z\nJacksonville,FL,Restaurant,89000,45000,2023-09-25T00:00:00Z\nFort Worth,TX,Retail Store,87000,43000,2023-10-05T00:00:00Z\nColumbus,OH,Restaurant,94000,48000,2023-10-20T00:00:00Z"}
{"purpose": "Standardize business location and financial data by correcting city and state names, normalizing business types, and fixing date and numeric formats.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nnew york,ny,Restarant,1000,5000,01/15/2023\nSan_Francisco,CA,Cafe,850,3000,2023-02-30\nLOS ANGELES,Ca,restaurent,950,4000,03-05-2023\nChicago,IL,Food Truck,700,3500,2023/04/01\nhouston,tx,Cafe,650,N/A,2023-4-15\nPhoenix,AZ,restaurant,800,2900,04/31/2023\nphiladelphia,pa,Retaurant,900,3100,2023-05-10\nsan diego,ca,food-truck,750,3200,2023-05-20\nDallas,Tx,Cafe,700,3000,2023.06.05\nsan jose,CA,Restarant,880,2800,06/15/2023\nAustin,tx,restaurant,920,3300,2023-06-25\njacksonville,fl,Cafe,670,2700,25/06/2023\nfort worth,TX,Food Truck,730,2900,2023-07-10\nColumbus,oh,Retaurant,810,3100,07/15/2023\ncharlotte,NC,restaurant,890,3400,07-20-2023", "cleaning_workflow": [{"op": "core/mass-edit", "description": "Fix common misspellings and inconsistent business types", "columnName": "BusinessType", "edits": [{"from": ["Restarant", "restaurent", "Retaurant", "Restarant"], "to": "Restaurant"}, {"from": ["food-truck", "Food Truck"], "to": "Food Truck"}, {"from": ["Cafe"], "to": "Cafe"}]}, {"op": "core/text-transform", "description": "Capitalize city names properly", "columnName": "City", "expression": "value.toLowercase().split(' ').map(s => s.capitalize()).join(' ')"}, {"op": "core/text-transform", "description": "Fix underscores and hyphens in city names", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ')"}, {"op": "core/text-transform", "description": "Capitalize state codes", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Fix incorrect or missing LoanAmount values", "columnName": "LoanAmount", "edits": [{"from": ["N/A"], "to": ""}]}, {"op": "core/text-transform", "description": "Remove invalid dates by setting empty where day is invalid", "columnName": "Date", "expression": "if(/\\b02\\/30|04\\/31/.test(value)) {''} else {value}"}, {"op": "core/date-parse", "description": "Parse and standardize date format to yyyy-MM-dd", "columnName": "Date", "patterns": ["MM/dd/yyyy", "yyyy-MM-dd", "MM-dd-yyyy", "yyyy/MM/dd", "yyyy.M.dd", "dd/MM/yyyy"], "onError": "set-to-blank"}, {"op": "core/text-transform", "description": "Trim whitespace from Price and LoanAmount", "columnName": "Price", "expression": "value.trim()"}, {"op": "core/text-transform", "description": "Trim whitespace from LoanAmount", "columnName": "LoanAmount", "expression": "value.trim()"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,1000,5000,2023-01-15\nSan Francisco,CA,Cafe,850,3000,\nLos Angeles,CA,Restaurant,950,4000,2023-03-05\nChicago,IL,Food Truck,700,3500,2023-04-01\nHouston,TX,Cafe,650,,2023-04-15\nPhoenix,AZ,Restaurant,800,2900,\nPhiladelphia,PA,Restaurant,900,3100,2023-05-10\nSan Diego,CA,Food Truck,750,3200,2023-05-20\nDallas,TX,Cafe,700,3000,2023-06-05\nSan Jose,CA,Restaurant,880,2800,2023-06-15\nAustin,TX,Restaurant,920,3300,2023-06-25\nJacksonville,FL,Cafe,670,2700,2023-06-25\nFort Worth,TX,Food Truck,730,2900,2023-07-10\nColumbus,OH,Restaurant,810,3100,2023-07-15\nCharlotte,NC,Restaurant,890,3400,2023-07-20"}
{"purpose": "Standardize city and business type names, correct date formats, and normalize numeric fields for loan analysis.", "raw_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew_york,NY,REStaurant,250000,150000,03/15/2020\nlos angeles,CA,retail-store,175000,NaN,2020-07-22\nCHICAGO,IL,Consulting,300000,200000,15-08-2020\nhouston,TX,restaurnt,NaN,120000,2020/09/10\nPHOENIX,AZ,Retail_Store,225000,130000,2020.10.05\nphiladelphia,PA,Consulting,210000,NaN,Oct 12 2020\nSan Antonio,TX,RESTAURANT,195000,110000,2020-11-01\nsan diego,CA,,180000,90000,2020-12-15\nDALLAS,TX,Retail-store,205000,140000,2021-01-10\nsan jose,CA,Consultng,230000,NaN,01/20/2021\nAustin,TX,restaurant,190000,115000,Feb 14, 2021\njacksonville,FL,retail_store,185000a,100000,2021-03-05\nFORT WORTH,TX,Consulting,NaN,130000,2021-04-18\ncolumbus,OH,Retaill-store,210000,125000,2021-05-20\ncharlotte,NC,restaurant,195000,110000,2021/06/30", "cleaning_workflow": [{"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in City and BusinessType", "columnName": "City", "expression": "value.replace(/[_-]/g, ' ').trim()"}, {"op": "core/text-transform", "description": "Replace underscores and hyphens with spaces in BusinessType", "columnName": "BusinessType", "expression": "value.replace(/[_-]/g, ' ').trim()"}, {"op": "core/text-transform", "description": "Capitalize each word in City", "columnName": "City", "expression": "value.toLowercase().split(' ').map(word, word.charAt(0).toUpperCase() + word.slice(1)).join(' ')"}, {"op": "core/mass-edit", "description": "Standardize BusinessType values", "columnName": "BusinessType", "edits": [{"from": ["REStaurant", "restaurnt", "RESTAURANT", "restaurant"], "to": "Restaurant"}, {"from": ["retail store", "Retail Store", "retail-store", "Retail-store", "retail_store", "Retail_Store", "Retaill store", "Retaill-store", "Retaill-store", "Retail-store"], "to": "Retail Store"}, {"from": ["Consulting", "Consultng"], "to": "Consulting"}]}, {"op": "core/text-transform", "description": "Remove trailing 'a' from Price if present and convert to number", "columnName": "Price", "expression": "value.replace(/a$/, '').toNumber()"}, {"op": "core/text-transform", "description": "Convert LoanAmount to number, replace 'NaN' or blanks with null", "columnName": "LoanAmount", "expression": "isNonBlank(value) && value.toNumber() > 0 ? value.toNumber() : null"}, {"op": "core/date-parse", "description": "Parse Date column to ISO format", "columnName": "Date", "format": "regex", "expression": "value.replace(/\\./g, '-').replace(/-/g, '/').replace(/(\\d{2})\\/(\\d{2})\\/(\\d{4})/, '$1/$2/$3')", "onError": "set-to-blank"}, {"op": "core/text-transform", "description": "Normalize Date column to yyyy-MM-dd", "columnName": "Date", "expression": "value.toDate().toString('yyyy-MM-dd')"}, {"op": "core/fill-down", "description": "Fill down missing BusinessType", "columnName": "BusinessType"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,Date\nNew York,NY,Restaurant,250000,150000,2020-03-15\nLos Angeles,CA,Retail Store,175000,,2020-07-22\nChicago,IL,Consulting,300000,200000,2020-08-15\nHouston,TX,Restaurant,,120000,2020-09-10\nPhoenix,AZ,Retail Store,225000,130000,2020-10-05\nPhiladelphia,PA,Consulting,210000,,2020-10-12\nSan Antonio,TX,Restaurant,195000,110000,2020-11-01\nSan Diego,CA,Restaurant,180000,90000,2020-12-15\nDallas,TX,Retail Store,205000,140000,2021-01-10\nSan Jose,CA,Consulting,230000,,2021-01-20\nAustin,TX,Restaurant,190000,115000,2021-02-14\nJacksonville,FL,Retail Store,185000,100000,2021-03-05\nFort Worth,TX,Consulting,,130000,2021-04-18\nColumbus,OH,Retail Store,210000,125000,2021-05-20\nCharlotte,NC,Restaurant,195000,110000,2021-06-30"}
{"purpose": "Standardize city names, business types, and date formats for loan applications.", "raw_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew_york,NY,Restuarant,120000,50000,12/31/2022\nlos-angeles,CA,Cafe,85000,35000,2023-01-15\nCHICAGO,IL,retail,75000,30000,15-Jan-2023\nhouston,TX,Restaurant,100000,45000,01/18/23\nPhiladelphia,PA,cafe,92000,,2023/01/20\nPhoenix,az,retail,67000,28000,1-22-2023\nSan-antonio,TX,RetaIl,83000,33000,2023.01.25\nDallas,TX,restaurant,115000,48000,01/27/2023\nSan diego,CA,cafe,78000,31000,Jan 29 2023\nAustin,tx,retail,70000,29000,2023-01-30\nJacksonville,FL,restuarant,95000,40000,01/31/2023\nFort Worth,TX,cafE,81000,32000,02-01-2023\nColumbus,Oh,Retail,-,27000,2023/02/03\nCharlotte,NC,restaurant,105000,47000,02/04/2023\nSan francisco,CA,Cafe,90000,35000,2023-02-05", "cleaning_workflow": [{"op": "core/text-transform", "description": "Normalize City names capitalization and remove underscores/hyphens", "columnName": "City", "expression": "value.replace(/[-_]/,' ').toTitlecase()"}, {"op": "core/text-transform", "description": "Normalize State codes to uppercase", "columnName": "State", "expression": "value.toUppercase()"}, {"op": "core/mass-edit", "description": "Correct misspelled business types", "columnName": "BusinessType", "edits": [{"from": ["Restuarant", "restuarant"], "to": "Restaurant"}, {"from": ["Cafe", "cafE", "cafe"], "to": "Cafe"}, {"from": ["retail", "RetaIl", "Retail"], "to": "Retail"}]}, {"op": "core/text-transform", "description": "Replace dash in Price with empty string and convert to number", "columnName": "Price", "expression": "value == '-' ? null : value"}, {"op": "core/text-transform", "description": "Fill missing LoanAmount with null", "columnName": "LoanAmount", "expression": "value==null || value=='' ? null : value"}, {"op": "core/date-parse", "description": "Parse ApplicationDate to ISO yyyy-MM-dd", "columnName": "ApplicationDate", "format": "auto"}, {"op": "core/text-transform", "description": "Format ApplicationDate as yyyy-MM-dd", "columnName": "ApplicationDate", "expression": "cell.value.toDate().toString('yyyy-MM-dd')"}], "clean_table": "City,State,BusinessType,Price,LoanAmount,ApplicationDate\nNew York,NY,Restaurant,120000,50000,2022-12-31\nLos Angeles,CA,Cafe,85000,35000,2023-01-15\nChicago,IL,Retail,75000,30000,2023-01-15\nHouston,TX,Restaurant,100000,45000,2023-01-18\nPhiladelphia,PA,Cafe,92000,,2023-01-20\nPhoenix,AZ,Retail,67000,28000,2023-01-22\nSan Antonio,TX,Retail,83000,33000,2023-01-25\nDallas,TX,Restaurant,115000,48000,2023-01-27\nSan Diego,CA,Cafe,78000,31000,2023-01-29\nAustin,TX,Retail,70000,29000,2023-01-30\nJacksonville,FL,Restaurant,95000,40000,2023-01-31\nFort Worth,TX,Cafe,81000,32000,2023-02-01\nColumbus,OH,Retail,,27000,2023-02-03\nCharlotte,NC,Restaurant,105000,47000,2023-02-04\nSan Francisco,CA,Cafe,90000,35000,2023-02-05"}
